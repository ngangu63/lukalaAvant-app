var tk=Object.create;var nu=Object.defineProperty,nk=Object.defineProperties,rk=Object.getOwnPropertyDescriptor,ik=Object.getOwnPropertyDescriptors,sk=Object.getOwnPropertyNames,U1=Object.getOwnPropertySymbols,$1=Object.getPrototypeOf,W1=Object.prototype.hasOwnProperty,ak=Object.prototype.propertyIsEnumerable,ok=Reflect.get;var hp=(n,e)=>(e=Symbol[n])?e:Symbol.for("Symbol."+n);var H1=(n,e,t)=>e in n?nu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ce=(n,e)=>{for(var t in e||={})W1.call(e,t)&&H1(n,t,e[t]);if(U1)for(var t of U1(e))ak.call(e,t)&&H1(n,t,e[t]);return n},Ke=(n,e)=>nk(n,ik(e));var lk=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),z1=(n,e)=>{for(var t in e)nu(n,t,{get:e[t],enumerable:!0})},ck=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of sk(e))!W1.call(n,i)&&i!==t&&nu(n,i,{get:()=>e[i],enumerable:!(r=rk(e,i))||r.enumerable});return n};var G1=(n,e,t)=>(t=n!=null?tk($1(n)):{},ck(e||!n||!n.__esModule?nu(t,"default",{value:n,enumerable:!0}):t,n));var ka=(n,e,t)=>ok($1(n),t,e);var ee=(n,e,t)=>new Promise((r,i)=>{var s=l=>{try{o(t.next(l))}catch(u){i(u)}},a=l=>{try{o(t.throw(l))}catch(u){i(u)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(n,e)).next())}),ru=function(n,e){this[0]=n,this[1]=e},pp=(n,e,t)=>{var r=(a,o,l,u)=>{try{var c=t[a](o),d=(o=c.value)instanceof ru,f=c.done;Promise.resolve(d?o[0]:o).then(h=>d?r(a==="return"?a:"next",o[1]?{done:h.done,value:h.value}:h,l,u):l({value:h,done:f})).catch(h=>r("throw",h,l,u))}catch(h){u(h)}},i=a=>s[a]=o=>new Promise((l,u)=>r(a,o,l,u)),s={};return t=t.apply(n,e),s[hp("asyncIterator")]=()=>s,i("next"),i("throw"),i("return"),s};var q1=(n,e,t)=>(e=n[hp("asyncIterator")])?e.call(n):(n=n[hp("iterator")](),e={},t=(r,i)=>(i=n[r])&&(e[r]=s=>new Promise((a,o,l)=>(s=i.call(n,s),l=s.done,Promise.resolve(s.value).then(u=>a({value:u,done:l}),o)))),t("next"),t("return"),e);var hv=lk(Af=>{"use strict";(function(){"use strict";var n=function(){this.init()};n.prototype={init:function(){var c=this||e;return c._counter=1e3,c._html5AudioPool=[],c.html5PoolSize=10,c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c._canPlayEvent="canplaythrough",c._navigator=typeof window<"u"&&window.navigator?window.navigator:null,c.masterGain=null,c.noAudio=!1,c.usingWebAudio=!0,c.autoSuspend=!0,c.ctx=null,c.autoUnlock=!0,c._setup(),c},volume:function(c){var d=this||e;if(c=parseFloat(c),d.ctx||u(),typeof c<"u"&&c>=0&&c<=1){if(d._volume=c,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c,e.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var h=d._howls[f]._getSoundIds(),p=0;p<h.length;p++){var g=d._howls[f]._soundById(h[p]);g&&g._node&&(g._node.volume=g._volume*c)}return d}return d._volume},mute:function(c){var d=this||e;d.ctx||u(),d._muted=c,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c?0:d._volume,e.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var h=d._howls[f]._getSoundIds(),p=0;p<h.length;p++){var g=d._howls[f]._soundById(h[p]);g&&g._node&&(g._node.muted=c?!0:g._muted)}return d},stop:function(){for(var c=this||e,d=0;d<c._howls.length;d++)c._howls[d].stop();return c},unload:function(){for(var c=this||e,d=c._howls.length-1;d>=0;d--)c._howls[d].unload();return c.usingWebAudio&&c.ctx&&typeof c.ctx.close<"u"&&(c.ctx.close(),c.ctx=null,u()),c},codecs:function(c){return(this||e)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||e;if(c.state=c.ctx&&c.ctx.state||"suspended",c._autoSuspend(),!c.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(c._canPlayEvent="canplay")}catch{c.noAudio=!0}else c.noAudio=!0;try{var d=new Audio;d.muted&&(c.noAudio=!0)}catch{}return c.noAudio||c._setupCodecs(),c},_setupCodecs:function(){var c=this||e,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return c}if(!d||typeof d.canPlayType!="function")return c;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),h=c._navigator?c._navigator.userAgent:"",p=h.match(/OPR\/(\d+)/g),g=p&&parseInt(p[0].split("/")[1],10)<33,m=h.indexOf("Safari")!==-1&&h.indexOf("Chrome")===-1,v=h.match(/Version\/(.*?) /),x=m&&v&&parseInt(v[1],10)<15;return c._codecs={mp3:!!(!g&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},c},_unlockAudio:function(){var c=this||e;if(!(c._audioUnlocked||!c.ctx)){c._audioUnlocked=!1,c.autoUnlock=!1,!c._mobileUnloaded&&c.ctx.sampleRate!==44100&&(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var d=function(f){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var h=new Audio;h._unlocked=!0,c._releaseHtml5Audio(h)}catch{c.noAudio=!0;break}for(var p=0;p<c._howls.length;p++)if(!c._howls[p]._webAudio)for(var g=c._howls[p]._getSoundIds(),m=0;m<g.length;m++){var v=c._howls[p]._soundById(g[m]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}c._autoResume();var x=c.ctx.createBufferSource();x.buffer=c._scratchBuffer,x.connect(c.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof c.ctx.resume=="function"&&c.ctx.resume(),x.onended=function(){x.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var _=0;_<c._howls.length;_++)c._howls[_]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),c}},_obtainHtml5Audio:function(){var c=this||e;if(c._html5AudioPool.length)return c._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(c){var d=this||e;return c._unlocked&&d._html5AudioPool.push(c),d},_autoSuspend:function(){var c=this;if(!(!c.autoSuspend||!c.ctx||typeof c.ctx.suspend>"u"||!e.usingWebAudio)){for(var d=0;d<c._howls.length;d++)if(c._howls[d]._webAudio){for(var f=0;f<c._howls[d]._sounds.length;f++)if(!c._howls[d]._sounds[f]._paused)return c}return c._suspendTimer&&clearTimeout(c._suspendTimer),c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null,c.state="suspending";var h=function(){c.state="suspended",c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(h,h)}},3e4),c}},_autoResume:function(){var c=this;if(!(!c.ctx||typeof c.ctx.resume>"u"||!e.usingWebAudio))return c.state==="running"&&c.ctx.state!=="interrupted"&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):c.state==="suspended"||c.state==="running"&&c.ctx.state==="interrupted"?(c.ctx.resume().then(function(){c.state="running";for(var d=0;d<c._howls.length;d++)c._howls[d]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):c.state==="suspending"&&(c._resumeAfterSuspend=!0),c}};var e=new n,t=function(c){var d=this;if(!c.src||c.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(c)};t.prototype={init:function(c){var d=this;return e.ctx||u(),d._autoplay=c.autoplay||!1,d._format=typeof c.format!="string"?c.format:[c.format],d._html5=c.html5||!1,d._muted=c.mute||!1,d._loop=c.loop||!1,d._pool=c.pool||5,d._preload=typeof c.preload=="boolean"||c.preload==="metadata"?c.preload:!0,d._rate=c.rate||1,d._sprite=c.sprite||{},d._src=typeof c.src!="string"?c.src:[c.src],d._volume=c.volume!==void 0?c.volume:1,d._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=c.onend?[{fn:c.onend}]:[],d._onfade=c.onfade?[{fn:c.onfade}]:[],d._onload=c.onload?[{fn:c.onload}]:[],d._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],d._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[],d._onpause=c.onpause?[{fn:c.onpause}]:[],d._onplay=c.onplay?[{fn:c.onplay}]:[],d._onstop=c.onstop?[{fn:c.onstop}]:[],d._onmute=c.onmute?[{fn:c.onmute}]:[],d._onvolume=c.onvolume?[{fn:c.onvolume}]:[],d._onrate=c.onrate?[{fn:c.onrate}]:[],d._onseek=c.onseek?[{fn:c.onseek}]:[],d._onunlock=c.onunlock?[{fn:c.onunlock}]:[],d._onresume=[],d._webAudio=e.usingWebAudio&&!d._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var c=this,d=null;if(e.noAudio){c._emit("loaderror",null,"No audio support.");return}typeof c._src=="string"&&(c._src=[c._src]);for(var f=0;f<c._src.length;f++){var h,p;if(c._format&&c._format[f])h=c._format[f];else{if(p=c._src[f],typeof p!="string"){c._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}h=/^data:audio\/([^;,]+);/i.exec(p),h||(h=/\.([^.]+)$/.exec(p.split("?",1)[0])),h&&(h=h[1].toLowerCase())}if(h||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),h&&e.codecs(h)){d=c._src[f];break}}if(!d){c._emit("loaderror",null,"No codec support for selected audio sources.");return}return c._src=d,c._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(c._html5=!0,c._webAudio=!1),new r(c),c._webAudio&&s(c),c},play:function(c,d){var f=this,h=null;if(typeof c=="number")h=c,c=null;else{if(typeof c=="string"&&f._state==="loaded"&&!f._sprite[c])return null;if(typeof c>"u"&&(c="__default",!f._playLock)){for(var p=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(p++,h=f._sounds[g]._id);p===1?c=null:h=null}}var m=h?f._soundById(h):f._inactiveSound();if(!m)return null;if(h&&!c&&(c=m._sprite||"__default"),f._state!=="loaded"){m._sprite=c,m._ended=!1;var v=m._id;return f._queue.push({event:"play",action:function(){f.play(v)}}),v}if(h&&!m._paused)return d||f._loadQueue("play"),m._id;f._webAudio&&e._autoResume();var x=Math.max(0,m._seek>0?m._seek:f._sprite[c][0]/1e3),_=Math.max(0,(f._sprite[c][0]+f._sprite[c][1])/1e3-x),b=_*1e3/Math.abs(m._rate),D=f._sprite[c][0]/1e3,A=(f._sprite[c][0]+f._sprite[c][1])/1e3;m._sprite=c,m._ended=!1;var w=function(){m._paused=!1,m._seek=x,m._start=D,m._stop=A,m._loop=!!(m._loop||f._sprite[c][2])};if(x>=A){f._ended(m);return}var T=m._node;if(f._webAudio){var E=function(){f._playLock=!1,w(),f._refreshBuffer(m);var Y=m._muted||f._muted?0:m._volume;T.gain.setValueAtTime(Y,e.ctx.currentTime),m._playStart=e.ctx.currentTime,typeof T.bufferSource.start>"u"?m._loop?T.bufferSource.noteGrainOn(0,x,86400):T.bufferSource.noteGrainOn(0,x,_):m._loop?T.bufferSource.start(0,x,86400):T.bufferSource.start(0,x,_),b!==1/0&&(f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),b)),d||setTimeout(function(){f._emit("play",m._id),f._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?E():(f._playLock=!0,f.once("resume",E),f._clearTimer(m._id))}else{var P=function(){T.currentTime=x,T.muted=m._muted||f._muted||e._muted||T.muted,T.volume=m._volume*e.volume(),T.playbackRate=m._rate;try{var Y=T.play();if(Y&&typeof Promise<"u"&&(Y instanceof Promise||typeof Y.then=="function")?(f._playLock=!0,w(),Y.then(function(){f._playLock=!1,T._unlocked=!0,d?f._loadQueue():f._emit("play",m._id)}).catch(function(){f._playLock=!1,f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):d||(f._playLock=!1,w(),f._emit("play",m._id)),T.playbackRate=m._rate,T.paused){f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}c!=="__default"||m._loop?f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),b):(f._endTimers[m._id]=function(){f._ended(m),T.removeEventListener("ended",f._endTimers[m._id],!1)},T.addEventListener("ended",f._endTimers[m._id],!1))}catch(se){f._emit("playerror",m._id,se)}};T.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(T.src=f._src,T.load());var N=window&&window.ejecta||!T.readyState&&e._navigator.isCocoonJS;if(T.readyState>=3||N)P();else{f._playLock=!0,f._state="loading";var O=function(){f._state="loaded",P(),T.removeEventListener(e._canPlayEvent,O,!1)};T.addEventListener(e._canPlayEvent,O,!1),f._clearTimer(m._id)}}return m._id},pause:function(c){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(c)}}),d;for(var f=d._getSoundIds(c),h=0;h<f.length;h++){d._clearTimer(f[h]);var p=d._soundById(f[h]);if(p&&!p._paused&&(p._seek=d.seek(f[h]),p._rateSeek=0,p._paused=!0,d._stopFade(f[h]),p._node))if(d._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),d._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||d._emit("pause",p?p._id:null)}return d},stop:function(c,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(c)}}),f;for(var h=f._getSoundIds(c),p=0;p<h.length;p++){f._clearTimer(h[p]);var g=f._soundById(h[p]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(h[p]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),d||f._emit("stop",g._id))}return f},mute:function(c,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(c,d)}}),f;if(typeof d>"u")if(typeof c=="boolean")f._muted=c;else return f._muted;for(var h=f._getSoundIds(d),p=0;p<h.length;p++){var g=f._soundById(h[p]);g&&(g._muted=c,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(c?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:c),f._emit("mute",g._id))}return f},volume:function(){var c=this,d=arguments,f,h;if(d.length===0)return c._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var p=c._getSoundIds(),g=p.indexOf(d[0]);g>=0?h=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),h=parseInt(d[1],10));var m;if(typeof f<"u"&&f>=0&&f<=1){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,d)}}),c;typeof h>"u"&&(c._volume=f),h=c._getSoundIds(h);for(var v=0;v<h.length;v++)m=c._soundById(h[v]),m&&(m._volume=f,d[2]||c._stopFade(h[v]),c._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(f,e.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=f*e.volume()),c._emit("volume",m._id))}else return m=h?c._soundById(h):c._sounds[0],m?m._volume:0;return c},fade:function(c,d,f,h){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(c,d,f,h)}}),p;c=Math.min(Math.max(0,parseFloat(c)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),p.volume(c,h);for(var g=p._getSoundIds(h),m=0;m<g.length;m++){var v=p._soundById(g[m]);if(v){if(h||p._stopFade(g[m]),p._webAudio&&!v._muted){var x=e.ctx.currentTime,_=x+f/1e3;v._volume=c,v._node.gain.setValueAtTime(c,x),v._node.gain.linearRampToValueAtTime(d,_)}p._startFadeInterval(v,c,d,f,g[m],typeof h>"u")}}return p},_startFadeInterval:function(c,d,f,h,p,g){var m=this,v=d,x=f-d,_=Math.abs(x/.01),b=Math.max(4,_>0?h/_:h),D=Date.now();c._fadeTo=f,c._interval=setInterval(function(){var A=(Date.now()-D)/h;D=Date.now(),v+=x*A,v=Math.round(v*100)/100,x<0?v=Math.max(f,v):v=Math.min(f,v),m._webAudio?c._volume=v:m.volume(v,c._id,!0),g&&(m._volume=v),(f<d&&v<=f||f>d&&v>=f)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,m.volume(f,c._id),m._emit("fade",c._id))},b)},_stopFade:function(c){var d=this,f=d._soundById(c);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,c),f._fadeTo=null,d._emit("fade",c)),d},loop:function(){var c=this,d=arguments,f,h,p;if(d.length===0)return c._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],c._loop=f;else return p=c._soundById(parseInt(d[0],10)),p?p._loop:!1;else d.length===2&&(f=d[0],h=parseInt(d[1],10));for(var g=c._getSoundIds(h),m=0;m<g.length;m++)p=c._soundById(g[m]),p&&(p._loop=f,c._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=f,f&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,c.playing(g[m])&&(c.pause(g[m],!0),c.play(g[m],!0)))));return c},rate:function(){var c=this,d=arguments,f,h;if(d.length===0)h=c._sounds[0]._id;else if(d.length===1){var p=c._getSoundIds(),g=p.indexOf(d[0]);g>=0?h=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),h=parseInt(d[1],10));var m;if(typeof f=="number"){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"rate",action:function(){c.rate.apply(c,d)}}),c;typeof h>"u"&&(c._rate=f),h=c._getSoundIds(h);for(var v=0;v<h.length;v++)if(m=c._soundById(h[v]),m){c.playing(h[v])&&(m._rateSeek=c.seek(h[v]),m._playStart=c._webAudio?e.ctx.currentTime:m._playStart),m._rate=f,c._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(f,e.ctx.currentTime):m._node&&(m._node.playbackRate=f);var x=c.seek(h[v]),_=(c._sprite[m._sprite][0]+c._sprite[m._sprite][1])/1e3-x,b=_*1e3/Math.abs(m._rate);(c._endTimers[h[v]]||!m._paused)&&(c._clearTimer(h[v]),c._endTimers[h[v]]=setTimeout(c._ended.bind(c,m),b)),c._emit("rate",m._id)}}else return m=c._soundById(h),m?m._rate:c._rate;return c},seek:function(){var c=this,d=arguments,f,h;if(d.length===0)c._sounds.length&&(h=c._sounds[0]._id);else if(d.length===1){var p=c._getSoundIds(),g=p.indexOf(d[0]);g>=0?h=parseInt(d[0],10):c._sounds.length&&(h=c._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),h=parseInt(d[1],10));if(typeof h>"u")return 0;if(typeof f=="number"&&(c._state!=="loaded"||c._playLock))return c._queue.push({event:"seek",action:function(){c.seek.apply(c,d)}}),c;var m=c._soundById(h);if(m)if(typeof f=="number"&&f>=0){var v=c.playing(h);v&&c.pause(h,!0),m._seek=f,m._ended=!1,c._clearTimer(h),!c._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=f);var x=function(){v&&c.play(h,!0),c._emit("seek",h)};if(v&&!c._webAudio){var _=function(){c._playLock?setTimeout(_,0):x()};setTimeout(_,0)}else x()}else if(c._webAudio){var b=c.playing(h)?e.ctx.currentTime-m._playStart:0,D=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(D+b*Math.abs(m._rate))}else return m._node.currentTime;return c},playing:function(c){var d=this;if(typeof c=="number"){var f=d._soundById(c);return f?!f._paused:!1}for(var h=0;h<d._sounds.length;h++)if(!d._sounds[h]._paused)return!0;return!1},duration:function(c){var d=this,f=d._duration,h=d._soundById(c);return h&&(f=d._sprite[h._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var c=this,d=c._sounds,f=0;f<d.length;f++)d[f]._paused||c.stop(d[f]._id),c._webAudio||(c._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(e._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),e._releaseHtml5Audio(d[f]._node)),delete d[f]._node,c._clearTimer(d[f]._id);var h=e._howls.indexOf(c);h>=0&&e._howls.splice(h,1);var p=!0;for(f=0;f<e._howls.length;f++)if(e._howls[f]._src===c._src||c._src.indexOf(e._howls[f]._src)>=0){p=!1;break}return i&&p&&delete i[c._src],e.noAudio=!1,c._state="unloaded",c._sounds=[],c=null,null},on:function(c,d,f,h){var p=this,g=p["_on"+c];return typeof d=="function"&&g.push(h?{id:f,fn:d,once:h}:{id:f,fn:d}),p},off:function(c,d,f){var h=this,p=h["_on"+c],g=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(g=0;g<p.length;g++){var m=f===p[g].id;if(d===p[g].fn&&m||!d&&m){p.splice(g,1);break}}else if(c)h["_on"+c]=[];else{var v=Object.keys(h);for(g=0;g<v.length;g++)v[g].indexOf("_on")===0&&Array.isArray(h[v[g]])&&(h[v[g]]=[])}return h},once:function(c,d,f){var h=this;return h.on(c,d,f,1),h},_emit:function(c,d,f){for(var h=this,p=h["_on"+c],g=p.length-1;g>=0;g--)(!p[g].id||p[g].id===d||c==="load")&&(setTimeout(function(m){m.call(this,d,f)}.bind(h,p[g].fn),0),p[g].once&&h.off(c,p[g].fn,p[g].id));return h._loadQueue(c),h},_loadQueue:function(c){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===c&&(d._queue.shift(),d._loadQueue()),c||f.action()}return d},_ended:function(c){var d=this,f=c._sprite;if(!d._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(d._ended.bind(d,c),100),d;var h=!!(c._loop||d._sprite[f][2]);if(d._emit("end",c._id),!d._webAudio&&h&&d.stop(c._id,!0).play(c._id),d._webAudio&&h){d._emit("play",c._id),c._seek=c._start||0,c._rateSeek=0,c._playStart=e.ctx.currentTime;var p=(c._stop-c._start)*1e3/Math.abs(c._rate);d._endTimers[c._id]=setTimeout(d._ended.bind(d,c),p)}return d._webAudio&&!h&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,d._clearTimer(c._id),d._cleanBuffer(c._node),e._autoSuspend()),!d._webAudio&&!h&&d.stop(c._id,!0),d},_clearTimer:function(c){var d=this;if(d._endTimers[c]){if(typeof d._endTimers[c]!="function")clearTimeout(d._endTimers[c]);else{var f=d._soundById(c);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[c],!1)}delete d._endTimers[c]}return d},_soundById:function(c){for(var d=this,f=0;f<d._sounds.length;f++)if(c===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var c=this;c._drain();for(var d=0;d<c._sounds.length;d++)if(c._sounds[d]._ended)return c._sounds[d].reset();return new r(c)},_drain:function(){var c=this,d=c._pool,f=0,h=0;if(!(c._sounds.length<d)){for(h=0;h<c._sounds.length;h++)c._sounds[h]._ended&&f++;for(h=c._sounds.length-1;h>=0;h--){if(f<=d)return;c._sounds[h]._ended&&(c._webAudio&&c._sounds[h]._node&&c._sounds[h]._node.disconnect(0),c._sounds.splice(h,1),f--)}}},_getSoundIds:function(c){var d=this;if(typeof c>"u"){for(var f=[],h=0;h<d._sounds.length;h++)f.push(d._sounds[h]._id);return f}else return[c]},_refreshBuffer:function(c){var d=this;return c._node.bufferSource=e.ctx.createBufferSource(),c._node.bufferSource.buffer=i[d._src],c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node),c._node.bufferSource.loop=c._loop,c._loop&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0),c._node.bufferSource.playbackRate.setValueAtTime(c._rate,e.ctx.currentTime),d},_cleanBuffer:function(c){var d=this,f=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!c.bufferSource)return d;if(e._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=null,c.bufferSource.disconnect(0),f))try{c.bufferSource.buffer=e._scratchBuffer}catch{}return c.bufferSource=null,d},_clearSound:function(c){var d=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);d||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(c){this._parent=c,this.init()};r.prototype={init:function(){var c=this,d=c._parent;return c._muted=d._muted,c._loop=d._loop,c._volume=d._volume,c._rate=d._rate,c._seek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++e._counter,d._sounds.push(c),c.create(),c},create:function(){var c=this,d=c._parent,f=e._muted||c._muted||c._parent._muted?0:c._volume;return d._webAudio?(c._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),c._node.gain.setValueAtTime(f,e.ctx.currentTime),c._node.paused=!0,c._node.connect(e.masterGain)):e.noAudio||(c._node=e._obtainHtml5Audio(),c._errorFn=c._errorListener.bind(c),c._node.addEventListener("error",c._errorFn,!1),c._loadFn=c._loadListener.bind(c),c._node.addEventListener(e._canPlayEvent,c._loadFn,!1),c._endFn=c._endListener.bind(c),c._node.addEventListener("ended",c._endFn,!1),c._node.src=d._src,c._node.preload=d._preload===!0?"auto":d._preload,c._node.volume=f*e.volume(),c._node.load()),c},reset:function(){var c=this,d=c._parent;return c._muted=d._muted,c._loop=d._loop,c._volume=d._volume,c._rate=d._rate,c._seek=0,c._rateSeek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++e._counter,c},_errorListener:function(){var c=this;c._parent._emit("loaderror",c._id,c._node.error?c._node.error.code:0),c._node.removeEventListener("error",c._errorFn,!1)},_loadListener:function(){var c=this,d=c._parent;d._duration=Math.ceil(c._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),c._node.removeEventListener(e._canPlayEvent,c._loadFn,!1)},_endListener:function(){var c=this,d=c._parent;d._duration===1/0&&(d._duration=Math.ceil(c._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(c)),c._node.removeEventListener("ended",c._endFn,!1)}};var i={},s=function(c){var d=c._src;if(i[d]){c._duration=i[d].duration,l(c);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),h=new Uint8Array(f.length),p=0;p<f.length;++p)h[p]=f.charCodeAt(p);o(h.buffer,c)}else{var g=new XMLHttpRequest;g.open(c._xhr.method,d,!0),g.withCredentials=c._xhr.withCredentials,g.responseType="arraybuffer",c._xhr.headers&&Object.keys(c._xhr.headers).forEach(function(m){g.setRequestHeader(m,c._xhr.headers[m])}),g.onload=function(){var m=(g.status+"")[0];if(m!=="0"&&m!=="2"&&m!=="3"){c._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}o(g.response,c)},g.onerror=function(){c._webAudio&&(c._html5=!0,c._webAudio=!1,c._sounds=[],delete i[d],c.load())},a(g)}},a=function(c){try{c.send()}catch{c.onerror()}},o=function(c,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},h=function(p){p&&d._sounds.length>0?(i[d._src]=p,l(d,p)):f()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(c).then(h).catch(f):e.ctx.decodeAudioData(c,h,f)},l=function(c,d){d&&!c._duration&&(c._duration=d.duration),Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue())},u=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var c=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),d=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(c&&f&&f<9){var h=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!h&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:t}}),typeof Af<"u"&&(Af.Howler=e,Af.Howl=t),typeof global<"u"?(global.HowlerGlobal=n,global.Howler=e,global.Howl=t,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=n,window.Howler=e,window.Howl=t,window.Sound=r)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var r=t._howls.length-1;r>=0;r--)t._howls[r].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,r){var i=this;if(!i.ctx||!i.ctx.listener)return i;if(t=typeof t!="number"?i._pos[1]:t,r=typeof r!="number"?i._pos[2]:r,typeof e=="number")i._pos=[e,t,r],typeof i.ctx.listener.positionX<"u"?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]);else return i._pos;return i},HowlerGlobal.prototype.orientation=function(e,t,r,i,s,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var l=o._orientation;if(t=typeof t!="number"?l[1]:t,r=typeof r!="number"?l[2]:r,i=typeof i!="number"?l[3]:i,s=typeof s!="number"?l[4]:s,a=typeof a!="number"?l[5]:a,typeof e=="number")o._orientation=[e,t,r,i,s,a],typeof o.ctx.listener.forwardX<"u"?(o.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(e,t,r,i,s,a);else return l;return o},Howl.prototype.init=function(e){return function(t){var r=this;return r._orientation=t.orientation||[1,0,0],r._stereo=t.stereo||null,r._pos=t.pos||null,r._pannerAttr={coneInnerAngle:typeof t.coneInnerAngle<"u"?t.coneInnerAngle:360,coneOuterAngle:typeof t.coneOuterAngle<"u"?t.coneOuterAngle:360,coneOuterGain:typeof t.coneOuterGain<"u"?t.coneOuterGain:0,distanceModel:typeof t.distanceModel<"u"?t.distanceModel:"inverse",maxDistance:typeof t.maxDistance<"u"?t.maxDistance:1e4,panningModel:typeof t.panningModel<"u"?t.panningModel:"HRTF",refDistance:typeof t.refDistance<"u"?t.refDistance:1,rolloffFactor:typeof t.rolloffFactor<"u"?t.rolloffFactor:1},r._onstereo=t.onstereo?[{fn:t.onstereo}]:[],r._onpos=t.onpos?[{fn:t.onpos}]:[],r._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,t){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,t)}}),r;var i=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof t>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var s=r._getSoundIds(t),a=0;a<s.length;a++){var o=r._soundById(s[a]);if(o)if(typeof e=="number")o._stereo=e,o._pos=[e,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",(!o._panner||!o._panner.pan)&&n(o,i),i==="spatial"?typeof o._panner.positionX<"u"?(o._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(e,0,0):o._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",o._id);else return o._stereo}return r},Howl.prototype.pos=function(e,t,r,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(e,t,r,i)}}),s;if(t=typeof t!="number"?0:t,r=typeof r!="number"?-.5:r,typeof i>"u")if(typeof e=="number")s._pos=[e,t,r];else return s._pos;for(var a=s._getSoundIds(i),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l)if(typeof e=="number")l._pos=[e,t,r],l._node&&((!l._panner||l._panner.pan)&&n(l,"spatial"),typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setPosition(e,t,r)),s._emit("pos",l._id);else return l._pos}return s},Howl.prototype.orientation=function(e,t,r,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(e,t,r,i)}}),s;if(t=typeof t!="number"?s._orientation[1]:t,r=typeof r!="number"?s._orientation[2]:r,typeof i>"u")if(typeof e=="number")s._orientation=[e,t,r];else return s._orientation;for(var a=s._getSoundIds(i),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l)if(typeof e=="number")l._orientation=[e,t,r],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),n(l,"spatial")),typeof l._panner.orientationX<"u"?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):l._panner.setOrientation(e,t,r)),s._emit("orientation",l._id);else return l._orientation}return s},Howl.prototype.pannerAttr=function(){var e=this,t=arguments,r,i,s;if(!e._webAudio)return e;if(t.length===0)return e._pannerAttr;if(t.length===1)if(typeof t[0]=="object")r=t[0],typeof i>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return s=e._soundById(parseInt(t[0],10)),s?s._pannerAttr:e._pannerAttr;else t.length===2&&(r=t[0],i=parseInt(t[1],10));for(var a=e._getSoundIds(i),o=0;o<a.length;o++)if(s=e._soundById(a[o]),s){var l=s._pannerAttr;l={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:l.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:l.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:l.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:l.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:l.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:l.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:l.panningModel};var u=s._panner;u||(s._pos||(s._pos=e._pos||[0,0,-.5]),n(s,"spatial"),u=s._panner),u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel}return e},Sound.prototype.init=function(e){return function(){var t=this,r=t._parent;t._orientation=r._orientation,t._stereo=r._stereo,t._pos=r._pos,t._pannerAttr=r._pannerAttr,e.call(this),t._stereo?r.stereo(t._stereo):t._pos&&r.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,r=t._parent;return t._orientation=r._orientation,t._stereo=r._stereo,t._pos=r._pos,t._pannerAttr=r._pannerAttr,t._stereo?r.stereo(t._stereo):t._pos?r.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,r._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var n=function(e,t){t=t||"spatial",t==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var X1=null;var gp=1,mp=Symbol("SIGNAL");function ut(n){let e=X1;return X1=n,e}var Y1={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function uk(n){if(!(xp(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===gp)){if(!n.producerMustRecompute(n)&&!vp(n)){n.dirty=!1,n.lastCleanEpoch=gp;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=gp}}function K1(n){return n&&(n.nextProducerIndex=0),ut(n)}function Q1(n,e){if(ut(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(xp(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)_p(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function vp(n){iu(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(uk(t),r!==t.version))return!0}return!1}function Z1(n){if(iu(n),xp(n))for(let e=0;e<n.producerNode.length;e++)_p(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function _p(n,e){if(dk(n),iu(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)_p(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];iu(i),i.producerIndexOfThis[r]=e}}function xp(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function iu(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function dk(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function fk(){throw new Error}var hk=fk;function J1(n){hk=n}function Te(n){return typeof n=="function"}function Ma(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var su=Ma(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Os(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var jt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Te(r))try{r()}catch(s){e=s instanceof su?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{ey(s)}catch(a){e=e??[],a instanceof su?e=[...e,...a.errors]:e.push(a)}}if(e)throw new su(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ey(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Os(t,e)}remove(e){let{_finalizers:t}=this;t&&Os(t,e),e instanceof n&&e._removeParent(this)}};jt.EMPTY=(()=>{let n=new jt;return n.closed=!0,n})();var yp=jt.EMPTY;function au(n){return n instanceof jt||n&&"closed"in n&&Te(n.remove)&&Te(n.add)&&Te(n.unsubscribe)}function ey(n){Te(n)?n():n.unsubscribe()}var Cr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Fa={setTimeout(n,e,...t){let{delegate:r}=Fa;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Fa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ou(n){Fa.setTimeout(()=>{let{onUnhandledError:e}=Cr;if(e)e(n);else throw n})}function Xo(){}var ty=wp("C",void 0,void 0);function ny(n){return wp("E",void 0,n)}function ry(n){return wp("N",n,void 0)}function wp(n,e,t){return{kind:n,value:e,error:t}}var Ls=null;function Pa(n){if(Cr.useDeprecatedSynchronousErrorHandling){let e=!Ls;if(e&&(Ls={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Ls;if(Ls=null,t)throw r}}else n()}function iy(n){Cr.useDeprecatedSynchronousErrorHandling&&Ls&&(Ls.errorThrown=!0,Ls.error=n)}var Bs=class extends jt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,au(e)&&e.add(this)):this.destination=mk}static create(e,t,r){return new Ra(e,t,r)}next(e){this.isStopped?Ep(ry(e),this):this._next(e)}error(e){this.isStopped?Ep(ny(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ep(ty,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},pk=Function.prototype.bind;function bp(n,e){return pk.call(n,e)}var Ap=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){lu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){lu(r)}else lu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){lu(t)}}},Ra=class extends Bs{constructor(e,t,r){super();let i;if(Te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&Cr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&bp(e.next,s),error:e.error&&bp(e.error,s),complete:e.complete&&bp(e.complete,s)}):i=e}this.destination=new Ap(i)}};function lu(n){Cr.useDeprecatedSynchronousErrorHandling?iy(n):ou(n)}function gk(n){throw n}function Ep(n,e){let{onStoppedNotification:t}=Cr;t&&Fa.setTimeout(()=>t(n,e))}var mk={closed:!0,next:Xo,error:gk,complete:Xo};var Na=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Jn(n){return n}function Cp(...n){return Sp(n)}function Sp(n){return n.length===0?Jn:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ct=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=_k(t)?t:new Ra(t,r,i);return Pa(()=>{let{operator:a,source:o}=this;s.add(a?a.call(s,o):o?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=sy(r),new r((i,s)=>{let a=new Ra({next:o=>{try{t(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:i});this.subscribe(a)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Na](){return this}pipe(...t){return Sp(t)(this)}toPromise(t){return t=sy(t),new t((r,i)=>{let s;this.subscribe(a=>s=a,a=>i(a),()=>r(s))})}}return n.create=e=>new n(e),n})();function sy(n){var e;return(e=n??Cr.Promise)!==null&&e!==void 0?e:Promise}function vk(n){return n&&Te(n.next)&&Te(n.error)&&Te(n.complete)}function _k(n){return n&&n instanceof Bs||vk(n)&&au(n)}function Tp(n){return Te(n?.lift)}function Qe(n){return e=>{if(Tp(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function qe(n,e,t,r,i){return new Dp(n,e,t,r,i)}var Dp=class extends Bs{constructor(e,t,r,i,s,a){super(e),this.onFinalize=s,this.shouldUnsubscribe=a,this._next=t?function(o){try{t(o)}catch(l){e.error(l)}}:super._next,this._error=i?function(o){try{i(o)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Oa(){return Qe((n,e)=>{let t=null;n._refCount++;let r=qe(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var La=class extends ct{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Tp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new jt;let t=this.getSubject();e.add(this.source.subscribe(qe(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=jt.EMPTY)}return e}refCount(){return Oa()(this)}};var ay=Ma(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var on=(()=>{class n extends ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new cu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new ay}next(t){Pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?yp:(this.currentObservers=null,s.push(t),new jt(()=>{this.currentObservers=null,Os(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new ct;return t.source=this,t}}return n.create=(e,t)=>new cu(e,t),n})(),cu=class extends on{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:yp}};var fn=class extends on{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Ip={now(){return(Ip.delegate||Date).now()},delegate:void 0};var uu=class extends jt{constructor(e,t){super()}schedule(e,t=0){return this}};var Yo={setInterval(n,e,...t){let{delegate:r}=Yo;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Yo;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var du=class extends uu{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Yo.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Yo.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Os(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ba=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Ba.now=Ip.now;var fu=class extends Ba{constructor(e,t=Ba.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var oy=new fu(du);var er=new ct(n=>n.complete());function ly(n){return n&&Te(n.schedule)}function cy(n){return n[n.length-1]}function hu(n){return Te(cy(n))?n.pop():void 0}function ns(n){return ly(cy(n))?n.pop():void 0}function dy(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(r.next(c))}catch(d){a(d)}}function l(c){try{u(r.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})}function uy(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vs(n){return this instanceof Vs?(this.v=n,this):new Vs(n)}function fy(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(h){return function(p){return Promise.resolve(p).then(h,d)}}function o(h,p){r[h]&&(i[h]=function(g){return new Promise(function(m,v){s.push([h,g,m,v])>1||l(h,g)})},p&&(i[h]=p(i[h])))}function l(h,p){try{u(r[h](p))}catch(g){f(s[0][3],g)}}function u(h){h.value instanceof Vs?Promise.resolve(h.value.v).then(c,d):f(s[0][2],h)}function c(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function hy(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof uy=="function"?uy(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}var Va=n=>n&&typeof n.length=="number"&&typeof n!="function";function pu(n){return Te(n?.then)}function gu(n){return Te(n[Na])}function mu(n){return Symbol.asyncIterator&&Te(n?.[Symbol.asyncIterator])}function vu(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function xk(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var _u=xk();function xu(n){return Te(n?.[_u])}function yu(n){return fy(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Vs(t.read());if(i)return yield Vs(void 0);yield yield Vs(r)}}finally{t.releaseLock()}})}function wu(n){return Te(n?.getReader)}function Ft(n){if(n instanceof ct)return n;if(n!=null){if(gu(n))return yk(n);if(Va(n))return wk(n);if(pu(n))return bk(n);if(mu(n))return py(n);if(xu(n))return Ek(n);if(wu(n))return Ak(n)}throw vu(n)}function yk(n){return new ct(e=>{let t=n[Na]();if(Te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function wk(n){return new ct(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function bk(n){return new ct(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ou)})}function Ek(n){return new ct(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function py(n){return new ct(e=>{Ck(n,e).catch(t=>e.error(t))})}function Ak(n){return py(yu(n))}function Ck(n,e){var t,r,i,s;return dy(this,void 0,void 0,function*(){try{for(t=hy(n);r=yield t.next(),!r.done;){let a=r.value;if(e.next(a),e.closed)return}}catch(a){i={error:a}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function $n(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function bu(n,e=0){return Qe((t,r)=>{t.subscribe(qe(r,i=>$n(r,n,()=>r.next(i),e),()=>$n(r,n,()=>r.complete(),e),i=>$n(r,n,()=>r.error(i),e)))})}function Eu(n,e=0){return Qe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function gy(n,e){return Ft(n).pipe(Eu(e),bu(e))}function my(n,e){return Ft(n).pipe(Eu(e),bu(e))}function vy(n,e){return new ct(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function _y(n,e){return new ct(t=>{let r;return $n(t,e,()=>{r=n[_u](),$n(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(a){t.error(a);return}s?t.complete():t.next(i)},0,!0)}),()=>Te(r?.return)&&r.return()})}function Au(n,e){if(!n)throw new Error("Iterable cannot be null");return new ct(t=>{$n(t,e,()=>{let r=n[Symbol.asyncIterator]();$n(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function xy(n,e){return Au(yu(n),e)}function yy(n,e){if(n!=null){if(gu(n))return gy(n,e);if(Va(n))return vy(n,e);if(pu(n))return my(n,e);if(mu(n))return Au(n,e);if(xu(n))return _y(n,e);if(wu(n))return xy(n,e)}throw vu(n)}function _t(n,e){return e?yy(n,e):Ft(n)}function Ie(...n){let e=ns(n);return _t(n,e)}function ja(n,e){let t=Te(n)?n:()=>n,r=i=>i.error(t());return new ct(e?i=>e.schedule(r,0,i):r)}function kp(n){return!!n&&(n instanceof ct||Te(n.lift)&&Te(n.subscribe))}var Ei=Ma(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Ze(n,e){return Qe((t,r)=>{let i=0;t.subscribe(qe(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:Sk}=Array;function Tk(n,e){return Sk(e)?n(...e):n(e)}function Ua(n){return Ze(e=>Tk(n,e))}var{isArray:Dk}=Array,{getPrototypeOf:Ik,prototype:kk,keys:Mk}=Object;function Cu(n){if(n.length===1){let e=n[0];if(Dk(e))return{args:e,keys:null};if(Fk(e)){let t=Mk(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function Fk(n){return n&&typeof n=="object"&&Ik(n)===kk}function Su(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Ko(...n){let e=ns(n),t=hu(n),{args:r,keys:i}=Cu(n);if(r.length===0)return _t([],e);let s=new ct(Pk(r,e,i?a=>Su(i,a):Jn));return t?s.pipe(Ua(t)):s}function Pk(n,e,t=Jn){return r=>{wy(e,()=>{let{length:i}=n,s=new Array(i),a=i,o=i;for(let l=0;l<i;l++)wy(e,()=>{let u=_t(n[l],e),c=!1;u.subscribe(qe(r,d=>{s[l]=d,c||(c=!0,o--),o||r.next(t(s.slice()))},()=>{--a||r.complete()}))},r)},r)}}function wy(n,e,t){n?$n(t,n,e):e()}function by(n,e,t,r,i,s,a,o){let l=[],u=0,c=0,d=!1,f=()=>{d&&!l.length&&!u&&e.complete()},h=g=>u<r?p(g):l.push(g),p=g=>{s&&e.next(g),u++;let m=!1;Ft(t(g,c++)).subscribe(qe(e,v=>{i?.(v),s?h(v):e.next(v)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;l.length&&u<r;){let v=l.shift();a?$n(e,a,()=>p(v)):p(v)}f()}catch(v){e.error(v)}}))};return n.subscribe(qe(e,h,()=>{d=!0,f()})),()=>{o?.()}}function Pt(n,e,t=1/0){return Te(e)?Pt((r,i)=>Ze((s,a)=>e(r,s,i,a))(Ft(n(r,i))),t):(typeof e=="number"&&(t=e),Qe((r,i)=>by(r,i,n,t)))}function Ha(n=1/0){return Pt(Jn,n)}function Ey(){return Ha(1)}function $a(...n){return Ey()(_t(n,ns(n)))}function Tu(n){return new ct(e=>{Ft(n()).subscribe(e)})}function Mp(...n){let e=hu(n),{args:t,keys:r}=Cu(n),i=new ct(s=>{let{length:a}=t;if(!a){s.complete();return}let o=new Array(a),l=a,u=a;for(let c=0;c<a;c++){let d=!1;Ft(t[c]).subscribe(qe(s,f=>{d||(d=!0,u--),o[c]=f},()=>l--,void 0,()=>{(!l||!d)&&(u||s.next(r?Su(r,o):o),s.complete())}))}});return e?i.pipe(Ua(e)):i}var Rk=["addListener","removeListener"],Nk=["addEventListener","removeEventListener"],Ok=["on","off"];function St(n,e,t,r){if(Te(t)&&(r=t,t=void 0),r)return St(n,e,t).pipe(Ua(r));let[i,s]=Vk(n)?Nk.map(a=>o=>n[a](e,o,t)):Lk(n)?Rk.map(Ay(n,e)):Bk(n)?Ok.map(Ay(n,e)):[];if(!i&&Va(n))return Pt(a=>St(a,e,t))(Ft(n));if(!i)throw new TypeError("Invalid event target");return new ct(a=>{let o=(...l)=>a.next(1<l.length?l:l[0]);return i(o),()=>s(o)})}function Ay(n,e){return t=>r=>n[t](e,r)}function Lk(n){return Te(n.addListener)&&Te(n.removeListener)}function Bk(n){return Te(n.on)&&Te(n.off)}function Vk(n){return Te(n.addEventListener)&&Te(n.removeEventListener)}function Wn(n,e){return Qe((t,r)=>{let i=0;t.subscribe(qe(r,s=>n.call(e,s,i++)&&r.next(s)))})}function rs(n){return Qe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(qe(t,void 0,void 0,a=>{s=Ft(n(a,rs(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function Cy(n,e,t,r,i){return(s,a)=>{let o=t,l=e,u=0;s.subscribe(qe(a,c=>{let d=u++;l=o?n(l,c,d):(o=!0,c),r&&a.next(l)},i&&(()=>{o&&a.next(l),a.complete()})))}}function js(n,e){return Te(e)?Pt(n,e,1):Pt(n,1)}function Fp(n,e=oy){return Qe((t,r)=>{let i=null,s=null,a=null,o=()=>{if(i){i.unsubscribe(),i=null;let u=s;s=null,r.next(u)}};function l(){let u=a+n,c=e.now();if(c<u){i=this.schedule(void 0,u-c),r.add(i);return}o()}t.subscribe(qe(r,u=>{s=u,a=e.now(),i||(i=e.schedule(l,n),r.add(i))},()=>{o(),r.complete()},void 0,()=>{s=i=null}))})}function is(n){return Qe((e,t)=>{let r=!1;e.subscribe(qe(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Ai(n){return n<=0?()=>er:Qe((e,t)=>{let r=0;e.subscribe(qe(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Pp(n){return Ze(()=>n)}function Du(n=jk){return Qe((e,t)=>{let r=!1;e.subscribe(qe(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function jk(){return new Ei}function Qo(n){return Qe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Xr(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Wn((i,s)=>n(i,s,r)):Jn,Ai(1),t?is(e):Du(()=>new Ei))}function Wa(n){return n<=0?()=>er:Qe((e,t)=>{let r=[];e.subscribe(qe(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Rp(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Wn((i,s)=>n(i,s,r)):Jn,Wa(1),t?is(e):Du(()=>new Ei))}function Np(n,e){return Qe(Cy(n,e,arguments.length>=2,!0))}function Op(...n){let e=ns(n);return Qe((t,r)=>{(e?$a(n,t,e):$a(n,t)).subscribe(r)})}function hr(n,e){return Qe((t,r)=>{let i=null,s=0,a=!1,o=()=>a&&!i&&r.complete();t.subscribe(qe(r,l=>{i?.unsubscribe();let u=0,c=s++;Ft(n(l,c)).subscribe(i=qe(r,d=>r.next(e?e(l,d,c,u++):d),()=>{i=null,o()}))},()=>{a=!0,o()}))})}function xt(n){return Qe((e,t)=>{Ft(n).subscribe(qe(t,()=>t.complete(),Xo)),!t.closed&&e.subscribe(t)})}function hn(n,e,t){let r=Te(n)||e||t?{next:n,error:e,complete:t}:n;return r?Qe((i,s)=>{var a;(a=r.subscribe)===null||a===void 0||a.call(r);let o=!0;i.subscribe(qe(s,l=>{var u;(u=r.next)===null||u===void 0||u.call(r,l),s.next(l)},()=>{var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),s.complete()},l=>{var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),s.error(l)},()=>{var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Jn}var mw="https://g.co/ng/security#xss",be=class extends Error{constructor(e,t){super(sg(e,t)),this.code=e}};function sg(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function cl(n){return{toString:n}.toString()}var Iu="__parameters__";function Uk(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function vw(n,e,t){return cl(()=>{let r=Uk(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let a=new i(...s);return o.annotation=a,o;function o(l,u,c){let d=l.hasOwnProperty(Iu)?l[Iu]:Object.defineProperty(l,Iu,{value:[]})[Iu];for(;d.length<=c;)d.push(null);return(d[c]=d[c]||[]).push(a),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var tr=globalThis;function vt(n){for(let e in n)if(n[e]===vt)return e;throw Error("Could not find renamed property on target object.")}function Hk(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Pn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Pn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function Sy(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var $k=vt({__forward_ref__:vt});function ea(n){return n.__forward_ref__=ea,n.toString=function(){return Pn(this())},n}function Fn(n){return _w(n)?n():n}function _w(n){return typeof n=="function"&&n.hasOwnProperty($k)&&n.__forward_ref__===ea}function Se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ni(n){return{providers:n.providers||[],imports:n.imports||[]}}function od(n){return Ty(n,yw)||Ty(n,ww)}function xw(n){return od(n)!==null}function Ty(n,e){return n.hasOwnProperty(e)?n[e]:null}function Wk(n){let e=n&&(n[yw]||n[ww]);return e||null}function Dy(n){return n&&(n.hasOwnProperty(Iy)||n.hasOwnProperty(zk))?n[Iy]:null}var yw=vt({\u0275prov:vt}),Iy=vt({\u0275inj:vt}),ww=vt({ngInjectableDef:vt}),zk=vt({ngInjectorDef:vt}),Fe=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function bw(n){return n&&!!n.\u0275providers}var Gk=vt({\u0275cmp:vt}),qk=vt({\u0275dir:vt}),Xk=vt({\u0275pipe:vt}),Yk=vt({\u0275mod:vt}),Uu=vt({\u0275fac:vt}),Zo=vt({__NG_ELEMENT_ID__:vt}),ky=vt({__NG_ENV_ID__:vt});function ul(n){return typeof n=="string"?n:n==null?"":String(n)}function Kk(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():ul(n)}function Qk(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new be(-200,n)}function ag(n,e){throw new be(-201,!1)}var Xe=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Xe||{}),Jp;function Ew(){return Jp}function zn(n){let e=Jp;return Jp=n,e}function Aw(n,e,t){let r=od(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Xe.Optional)return null;if(e!==void 0)return e;ag(n,"Injector")}var Zk={},Jo=Zk,e0="__NG_DI_FLAG__",Hu="ngTempTokenPath",Jk="ngTokenPath",eM=/\n/gm,tM="\u0275",My="__source",Ya;function nM(){return Ya}function ss(n){let e=Ya;return Ya=n,e}function rM(n,e=Xe.Default){if(Ya===void 0)throw new be(-203,!1);return Ya===null?Aw(n,void 0,e):Ya.get(n,e&Xe.Optional?null:void 0,e)}function Ne(n,e=Xe.Default){return(Ew()||rM)(Fn(n),e)}function ve(n,e=Xe.Default){return Ne(n,ld(e))}function ld(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function t0(n){let e=[];for(let t=0;t<n.length;t++){let r=Fn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new be(900,!1);let i,s=Xe.Default;for(let a=0;a<r.length;a++){let o=r[a],l=iM(o);typeof l=="number"?l===-1?i=o.token:s|=l:i=o}e.push(Ne(i,s))}else e.push(Ne(r))}return e}function Cw(n,e){return n[e0]=e,n.prototype[e0]=e,n}function iM(n){return n[e0]}function sM(n,e,t,r){let i=n[Hu];throw e[My]&&i.unshift(e[My]),n.message=aM(`
`+n.message,i,t,r),n[Jk]=i,n[Hu]=null,n}function aM(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==tM?n.slice(2):n;let i=Pn(e);if(Array.isArray(e))i=e.map(Pn).join(" -> ");else if(typeof e=="object"){let s=[];for(let a in e)if(e.hasOwnProperty(a)){let o=e[a];s.push(a+":"+(typeof o=="string"?JSON.stringify(o):Pn(o)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(eM,`
  `)}`}var dl=Cw(vw("Optional"),8);var cd=Cw(vw("SkipSelf"),4);function Ws(n,e){let t=n.hasOwnProperty(Uu);return t?n[Uu]:null}function oM(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],s=e[r];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}function lM(n){return n.flat(Number.POSITIVE_INFINITY)}function og(n,e){n.forEach(t=>Array.isArray(t)?og(t,e):e(t))}function Sw(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function $u(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function cM(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function uM(n,e,t){let r=fl(n,e);return r>=0?n[r|1]=t:(r=~r,cM(n,r,e,t)),r}function Lp(n,e){let t=fl(n,e);if(t>=0)return n[t|1]}function fl(n,e){return dM(n,e,1)}function dM(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),a=n[s<<t];if(e===a)return s<<t;a>e?i=s:r=s+1}return~(i<<t)}var Qa={},pr=[],Za=new Fe(""),Tw=new Fe("",-1),Dw=new Fe(""),Wu=class{get(e,t=Jo){if(t===Jo){let r=new Error(`NullInjectorError: No provider for ${Pn(e)}!`);throw r.name="NullInjectorError",r}return t}},Iw=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Iw||{}),Qr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Qr||{}),gt=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(gt||{});function fM(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function n0(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],a=t[r++],o=t[r++];n.setAttribute(e,a,o,s)}else{let s=i,a=t[++r];hM(s)?n.setProperty(e,s,a):n.setAttribute(e,s,a),r++}}return r}function kw(n){return n===3||n===4||n===6}function hM(n){return n.charCodeAt(0)===64}function el(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Fy(n,t,i,null,e[++r]):Fy(n,t,i,null,null))}}return n}function Fy(n,e,t,r,i){let s=0,a=n.length;if(e===-1)a=-1;else for(;s<n.length;){let o=n[s++];if(typeof o=="number"){if(o===e){a=-1;break}else if(o>e){a=s-1;break}}}for(;s<n.length;){let o=n[s];if(typeof o=="number")break;if(o===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}a!==-1&&(n.splice(a,0,e),s=a+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var Mw="ng-template";function pM(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&fM(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(lg(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function lg(n){return n.type===4&&n.value!==Mw}function gM(n,e,t){let r=n.type===4&&!t?Mw:n.value;return e===r}function mM(n,e,t){let r=4,i=n.attrs,s=i!==null?xM(i):0,a=!1;for(let o=0;o<e.length;o++){let l=e[o];if(typeof l=="number"){if(!a&&!Sr(r)&&!Sr(l))return!1;if(a&&Sr(l))continue;a=!1,r=l|r&1;continue}if(!a)if(r&4){if(r=2|r&1,l!==""&&!gM(n,l,t)||l===""&&e.length===1){if(Sr(r))return!1;a=!0}}else if(r&8){if(i===null||!pM(n,i,l,t)){if(Sr(r))return!1;a=!0}}else{let u=e[++o],c=vM(l,i,lg(n),t);if(c===-1){if(Sr(r))return!1;a=!0;continue}if(u!==""){let d;if(c>s?d="":d=i[c+1].toLowerCase(),r&2&&u!==d){if(Sr(r))return!1;a=!0}}}}return Sr(r)||a}function Sr(n){return(n&1)===0}function vM(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let a=e[i];if(a===n)return i;if(a===3||a===6)s=!0;else if(a===1||a===2){let o=e[++i];for(;typeof o=="string";)o=e[++i];continue}else{if(a===4)break;if(a===0){i+=4;continue}}i+=s?1:2}return-1}else return yM(e,n)}function _M(n,e,t=!1){for(let r=0;r<e.length;r++)if(mM(n,e[r],t))return!0;return!1}function xM(n){for(let e=0;e<n.length;e++){let t=n[e];if(kw(t))return e}return n.length}function yM(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Py(n,e){return n?":not("+e.trim()+")":e}function wM(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let a=n[t];if(typeof a=="string")if(r&2){let o=n[++t];i+="["+a+(o.length>0?'="'+o+'"':"")+"]"}else r&8?i+="."+a:r&4&&(i+=" "+a);else i!==""&&!Sr(a)&&(e+=Py(s,i),i=""),r=a,s=s||!Sr(r);t++}return i!==""&&(e+=Py(s,i)),e}function bM(n){return n.map(wM).join(",")}function EM(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!Sr(i))break;i=s}r++}return{attrs:e,classes:t}}function Oe(n){return cl(()=>{let e=Lw(n),t=Ke(ce({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Iw.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Qr.Emulated,styles:n.styles||pr,_:null,schemas:n.schemas||null,tView:null,id:""});Bw(t);let r=n.dependencies;return t.directiveDefs=Ny(r,!1),t.pipeDefs=Ny(r,!0),t.id=SM(t),t})}function AM(n){return os(n)||Pw(n)}function CM(n){return n!==null}function ri(n){return cl(()=>({type:n.type,bootstrap:n.bootstrap||pr,declarations:n.declarations||pr,imports:n.imports||pr,exports:n.exports||pr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Ry(n,e){if(n==null)return Qa;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,a,o=gt.None;Array.isArray(i)?(o=i[0],s=i[1],a=i[2]??s):(s=i,a=i),e?(t[s]=o!==gt.None?[r,o]:r,e[s]=a):t[s]=r}return t}function tn(n){return cl(()=>{let e=Lw(n);return Bw(e),e})}function Fw(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function os(n){return n[Gk]||null}function Pw(n){return n[qk]||null}function Rw(n){return n[Xk]||null}function Nw(n){let e=os(n)||Pw(n)||Rw(n);return e!==null?e.standalone:!1}function Ow(n,e){let t=n[Yk]||null;if(!t&&e===!0)throw new Error(`Type ${Pn(n)} does not have '\u0275mod' property.`);return t}function Lw(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Qa,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||pr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ry(n.inputs,e),outputs:Ry(n.outputs),debugInfo:null}}function Bw(n){n.features?.forEach(e=>e(n))}function Ny(n,e){if(!n)return null;let t=e?Rw:AM;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(CM)}function SM(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function ud(n){return{\u0275providers:n}}function TM(...n){return{\u0275providers:Vw(!0,n),\u0275fromNgModule:!0}}function Vw(n,...e){let t=[],r=new Set,i,s=a=>{t.push(a)};return og(e,a=>{let o=a;r0(o,s,[],r)&&(i||=[],i.push(o))}),i!==void 0&&jw(i,s),t}function jw(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];cg(i,s=>{e(s,r)})}}function r0(n,e,t,r){if(n=Fn(n),!n)return!1;let i=null,s=Dy(n),a=!s&&os(n);if(!s&&!a){let l=n.ngModule;if(s=Dy(l),s)i=l;else return!1}else{if(a&&!a.standalone)return!1;i=n}let o=r.has(i);if(a){if(o)return!1;if(r.add(i),a.dependencies){let l=typeof a.dependencies=="function"?a.dependencies():a.dependencies;for(let u of l)r0(u,e,t,r)}}else if(s){if(s.imports!=null&&!o){r.add(i);let u;try{og(s.imports,c=>{r0(c,e,t,r)&&(u||=[],u.push(c))})}finally{}u!==void 0&&jw(u,e)}if(!o){let u=Ws(i)||(()=>new i);e({provide:i,useFactory:u,deps:pr},i),e({provide:Dw,useValue:i,multi:!0},i),e({provide:Za,useValue:()=>Ne(i),multi:!0},i)}let l=s.providers;if(l!=null&&!o){let u=n;cg(l,c=>{e(c,u)})}}else return!1;return i!==n&&n.providers!==void 0}function cg(n,e){for(let t of n)bw(t)&&(t=t.\u0275providers),Array.isArray(t)?cg(t,e):e(t)}var DM=vt({provide:String,useValue:vt});function Uw(n){return n!==null&&typeof n=="object"&&DM in n}function IM(n){return!!(n&&n.useExisting)}function kM(n){return!!(n&&n.useFactory)}function Ja(n){return typeof n=="function"}function MM(n){return!!n.useClass}var dd=new Fe(""),Nu={},FM={},Bp;function ug(){return Bp===void 0&&(Bp=new Wu),Bp}var Gn=class{},tl=class extends Gn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,s0(e,a=>this.processProvider(a)),this.records.set(Tw,za(void 0,this)),i.has("environment")&&this.records.set(Gn,za(void 0,this));let s=this.records.get(dd);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Dw,pr,Xe.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ut(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ut(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=ss(this),r=zn(void 0),i;try{return e()}finally{ss(t),zn(r)}}get(e,t=Jo,r=Xe.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(ky))return e[ky](this);r=ld(r);let i,s=ss(this),a=zn(void 0);try{if(!(r&Xe.SkipSelf)){let l=this.records.get(e);if(l===void 0){let u=LM(e)&&od(e);u&&this.injectableDefInScope(u)?l=za(i0(e),Nu):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let o=r&Xe.Self?ug():this.parent;return t=r&Xe.Optional&&t===Jo?null:t,o.get(e,t)}catch(o){if(o.name==="NullInjectorError"){if((o[Hu]=o[Hu]||[]).unshift(Pn(e)),s)throw o;return sM(o,e,"R3InjectorError",this.source)}else throw o}finally{zn(a),ss(s)}}resolveInjectorInitializers(){let e=ut(null),t=ss(this),r=zn(void 0),i;try{let s=this.get(Za,pr,Xe.Self);for(let a of s)a()}finally{ss(t),zn(r),ut(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Pn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new be(205,!1)}processProvider(e){e=Fn(e);let t=Ja(e)?e:Fn(e&&e.provide),r=RM(e);if(!Ja(e)&&e.multi===!0){let i=this.records.get(t);i||(i=za(void 0,Nu,!0),i.factory=()=>t0(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ut(null);try{return t.value===Nu&&(t.value=FM,t.value=t.factory()),typeof t.value=="object"&&t.value&&OM(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ut(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Fn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function i0(n){let e=od(n),t=e!==null?e.factory:Ws(n);if(t!==null)return t;if(n instanceof Fe)throw new be(204,!1);if(n instanceof Function)return PM(n);throw new be(204,!1)}function PM(n){if(n.length>0)throw new be(204,!1);let t=Wk(n);return t!==null?()=>t.factory(n):()=>new n}function RM(n){if(Uw(n))return za(void 0,n.useValue);{let e=Hw(n);return za(e,Nu)}}function Hw(n,e,t){let r;if(Ja(n)){let i=Fn(n);return Ws(i)||i0(i)}else if(Uw(n))r=()=>Fn(n.useValue);else if(kM(n))r=()=>n.useFactory(...t0(n.deps||[]));else if(IM(n))r=()=>Ne(Fn(n.useExisting));else{let i=Fn(n&&(n.useClass||n.provide));if(NM(n))r=()=>new i(...t0(n.deps));else return Ws(i)||i0(i)}return r}function za(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function NM(n){return!!n.deps}function OM(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function LM(n){return typeof n=="function"||typeof n=="object"&&n instanceof Fe}function s0(n,e){for(let t of n)Array.isArray(t)?s0(t,e):t&&bw(t)?s0(t.\u0275providers,e):e(t)}function Ti(n,e){n instanceof tl&&n.assertNotDestroyed();let t,r=ss(n),i=zn(void 0);try{return e()}finally{ss(r),zn(i)}}function $w(){return Ew()!==void 0||nM()!=null}function BM(n){if(!$w())throw new be(-203,!1)}function VM(n){return typeof n=="function"}var Di=0,$e=1,Me=2,pn=3,Tr=4,Mr=5,zu=6,nl=7,Dr=8,eo=9,Ir=10,Wt=11,rl=12,Oy=13,io=14,Zr=15,hl=16,Ga=17,Ci=18,fd=19,Ww=20,as=21,Vp=22,zs=23,kr=25,zw=1;var Gs=7,Gu=8,to=9,nr=10,dg=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(dg||{});function Hs(n){return Array.isArray(n)&&typeof n[zw]=="object"}function Ii(n){return Array.isArray(n)&&n[zw]===!0}function Gw(n){return(n.flags&4)!==0}function hd(n){return n.componentOffset>-1}function fg(n){return(n.flags&1)===1}function ls(n){return!!n.template}function jM(n){return(n[Me]&512)!==0}var a0=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function qw(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function ii(){return Xw}function Xw(n){return n.type.prototype.ngOnChanges&&(n.setInput=HM),UM}ii.ngInherit=!0;function UM(){let n=Kw(this),e=n?.current;if(e){let t=n.previous;if(t===Qa)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function HM(n,e,t,r,i){let s=this.declaredInputs[r],a=Kw(n)||$M(n,{previous:Qa,current:null}),o=a.current||(a.current={}),l=a.previous,u=l[s];o[s]=new a0(u&&u.currentValue,t,l===Qa),qw(n,e,i,t)}var Yw="__ngSimpleChanges__";function Kw(n){return n[Yw]||null}function $M(n,e){return n[Yw]=e}var Ly=null;var Yr=function(n,e,t){Ly?.(n,e,t)},WM="svg",zM="math",GM=!1;function qM(){return GM}function Jr(n){for(;Array.isArray(n);)n=n[Di];return n}function Qw(n,e){return Jr(e[n])}function gr(n,e){return Jr(e[n.index])}function Zw(n,e){return n.data[e]}function Jw(n,e){return n[e]}function ds(n,e){let t=e[n];return Hs(t)?t:t[Di]}function XM(n){return(n[Me]&4)===4}function hg(n){return(n[Me]&128)===128}function YM(n){return Ii(n[pn])}function qu(n,e){return e==null?null:n[e]}function eb(n){n[Ga]=0}function KM(n){n[Me]&1024||(n[Me]|=1024,hg(n)&&il(n))}function QM(n,e){for(;n>0;)e=e[io],n--;return e}function pg(n){return!!(n[Me]&9216||n[zs]?.dirty)}function o0(n){n[Ir].changeDetectionScheduler?.notify(1),pg(n)?il(n):n[Me]&64&&(qM()?(n[Me]|=1024,il(n)):n[Ir].changeDetectionScheduler?.notify())}function il(n){n[Ir].changeDetectionScheduler?.notify();let e=sl(n);for(;e!==null&&!(e[Me]&8192||(e[Me]|=8192,!hg(e)));)e=sl(e)}function tb(n,e){if((n[Me]&256)===256)throw new be(911,!1);n[as]===null&&(n[as]=[]),n[as].push(e)}function ZM(n,e){if(n[as]===null)return;let t=n[as].indexOf(e);t!==-1&&n[as].splice(t,1)}function sl(n){let e=n[pn];return Ii(e)?e[pn]:e}var We={lFrame:lb(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function JM(){return We.lFrame.elementDepthCount}function e2(){We.lFrame.elementDepthCount++}function t2(){We.lFrame.elementDepthCount--}function nb(){return We.bindingsEnabled}function n2(){return We.skipHydrationRootTNode!==null}function r2(n){return We.skipHydrationRootTNode===n}function i2(){We.skipHydrationRootTNode=null}function nt(){return We.lFrame.lView}function gn(){return We.lFrame.tView}function fs(n){return We.lFrame.contextLView=n,n[Dr]}function hs(n){return We.lFrame.contextLView=null,n}function qn(){let n=rb();for(;n!==null&&n.type===64;)n=n.parent;return n}function rb(){return We.lFrame.currentTNode}function s2(){let n=We.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function pl(n,e){let t=We.lFrame;t.currentTNode=n,t.isParent=e}function ib(){return We.lFrame.isParent}function a2(){We.lFrame.isParent=!1}function o2(){return We.lFrame.contextLView}function pd(){let n=We.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function l2(n){return We.lFrame.bindingIndex=n}function gd(){return We.lFrame.bindingIndex++}function c2(n){let e=We.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function u2(){return We.lFrame.inI18n}function d2(n,e){let t=We.lFrame;t.bindingIndex=t.bindingRootIndex=n,l0(e)}function f2(){return We.lFrame.currentDirectiveIndex}function l0(n){We.lFrame.currentDirectiveIndex=n}function h2(n){let e=We.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function sb(){return We.lFrame.currentQueryIndex}function gg(n){We.lFrame.currentQueryIndex=n}function p2(n){let e=n[$e];return e.type===2?e.declTNode:e.type===1?n[Mr]:null}function ab(n,e,t){if(t&Xe.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Xe.Host);)if(i=p2(s),i===null||(s=s[io],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=We.lFrame=ob();return r.currentTNode=e,r.lView=n,!0}function mg(n){let e=ob(),t=n[$e];We.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ob(){let n=We.lFrame,e=n===null?null:n.child;return e===null?lb(n):e}function lb(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function cb(){let n=We.lFrame;return We.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var ub=cb;function vg(){let n=cb();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function g2(n){return(We.lFrame.contextLView=QM(n,We.lFrame.contextLView))[Dr]}function so(){return We.lFrame.selectedIndex}function qs(n){We.lFrame.selectedIndex=n}function md(){let n=We.lFrame;return Zw(n.tView,n.selectedIndex)}function m2(){return We.lFrame.currentNamespace}var db=!0;function _g(){return db}function xg(n){db=n}function v2(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let a=Xw(e);(t.preOrderHooks??=[]).push(n,a),(t.preOrderCheckHooks??=[]).push(n,a)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function yg(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:o,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:c}=s;a&&(n.contentHooks??=[]).push(-t,a),o&&((n.contentHooks??=[]).push(t,o),(n.contentCheckHooks??=[]).push(t,o)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),c!=null&&(n.destroyHooks??=[]).push(t,c)}}function Ou(n,e,t){fb(n,e,3,t)}function Lu(n,e,t,r){(n[Me]&3)===t&&fb(n,e,t,r)}function jp(n,e){let t=n[Me];(t&3)===e&&(t&=16383,t+=1,n[Me]=t)}function fb(n,e,t,r){let i=r!==void 0?n[Ga]&65535:0,s=r??-1,a=e.length-1,o=0;for(let l=i;l<a;l++)if(typeof e[l+1]=="number"){if(o=e[l],r!=null&&o>=r)break}else e[l]<0&&(n[Ga]+=65536),(o<s||s==-1)&&(_2(n,t,e,l),n[Ga]=(n[Ga]&4294901760)+l+2),l++}function By(n,e){Yr(4,n,e);let t=ut(null);try{e.call(n)}finally{ut(t),Yr(5,n,e)}}function _2(n,e,t,r){let i=t[r]<0,s=t[r+1],a=i?-t[r]:t[r],o=n[a];i?n[Me]>>14<n[Ga]>>16&&(n[Me]&3)===e&&(n[Me]+=16384,By(o,s)):By(o,s)}var Ka=-1,Xs=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function x2(n){return n instanceof Xs}function y2(n){return(n.flags&8)!==0}function w2(n){return(n.flags&16)!==0}function hb(n){return n!==Ka}function Xu(n){return n&32767}function b2(n){return n>>16}function Yu(n,e){let t=b2(n),r=e;for(;t>0;)r=r[io],t--;return r}var c0=!0;function Ku(n){let e=c0;return c0=n,e}var E2=256,pb=E2-1,gb=5,A2=0,Kr={};function C2(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Zo)&&(r=t[Zo]),r==null&&(r=t[Zo]=A2++);let i=r&pb,s=1<<i;e.data[n+(i>>gb)]|=s}function Qu(n,e){let t=mb(n,e);if(t!==-1)return t;let r=e[$e];r.firstCreatePass&&(n.injectorIndex=e.length,Up(r.data,n),Up(e,null),Up(r.blueprint,null));let i=wg(n,e),s=n.injectorIndex;if(hb(i)){let a=Xu(i),o=Yu(i,e),l=o[$e].data;for(let u=0;u<8;u++)e[s+u]=o[a+u]|l[a+u]}return e[s+8]=i,s}function Up(n,e){n.push(0,0,0,0,0,0,0,0,e)}function mb(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function wg(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=wb(i),r===null)return Ka;if(t++,i=i[io],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ka}function u0(n,e,t){C2(n,e,t)}function S2(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(kw(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function vb(n,e,t){if(t&Xe.Optional||n!==void 0)return n;ag(e,"NodeInjector")}function _b(n,e,t,r){if(t&Xe.Optional&&r===void 0&&(r=null),!(t&(Xe.Self|Xe.Host))){let i=n[eo],s=zn(void 0);try{return i?i.get(e,r,t&Xe.Optional):Aw(e,r,t&Xe.Optional)}finally{zn(s)}}return vb(r,e,t)}function xb(n,e,t,r=Xe.Default,i){if(n!==null){if(e[Me]&2048&&!(r&Xe.Self)){let a=k2(n,e,t,r,Kr);if(a!==Kr)return a}let s=yb(n,e,t,r,Kr);if(s!==Kr)return s}return _b(e,t,r,i)}function yb(n,e,t,r,i){let s=D2(t);if(typeof s=="function"){if(!ab(e,n,r))return r&Xe.Host?vb(i,t,r):_b(e,t,r,i);try{let a;if(a=s(r),a==null&&!(r&Xe.Optional))ag(t);else return a}finally{ub()}}else if(typeof s=="number"){let a=null,o=mb(n,e),l=Ka,u=r&Xe.Host?e[Zr][Mr]:null;for((o===-1||r&Xe.SkipSelf)&&(l=o===-1?wg(n,e):e[o+8],l===Ka||!jy(r,!1)?o=-1:(a=e[$e],o=Xu(l),e=Yu(l,e)));o!==-1;){let c=e[$e];if(Vy(s,o,c.data)){let d=T2(o,e,t,a,r,u);if(d!==Kr)return d}l=e[o+8],l!==Ka&&jy(r,e[$e].data[o+8]===u)&&Vy(s,o,e)?(a=c,o=Xu(l),e=Yu(l,e)):o=-1}}return i}function T2(n,e,t,r,i,s){let a=e[$e],o=a.data[n+8],l=r==null?hd(o)&&c0:r!=a&&(o.type&3)!==0,u=i&Xe.Host&&s===o,c=Bu(o,a,t,l,u);return c!==null?Ys(e,a,c,o):Kr}function Bu(n,e,t,r,i){let s=n.providerIndexes,a=e.data,o=s&1048575,l=n.directiveStart,u=n.directiveEnd,c=s>>20,d=r?o:o+c,f=i?o+c:u;for(let h=d;h<f;h++){let p=a[h];if(h<l&&t===p||h>=l&&p.type===t)return h}if(i){let h=a[l];if(h&&ls(h)&&h.type===t)return l}return null}function Ys(n,e,t,r){let i=n[t],s=e.data;if(x2(i)){let a=i;a.resolving&&Qk(Kk(s[t]));let o=Ku(a.canSeeViewProviders);a.resolving=!0;let l,u=a.injectImpl?zn(a.injectImpl):null,c=ab(n,r,Xe.Default);try{i=n[t]=a.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&v2(t,s[t],e)}finally{u!==null&&zn(u),Ku(o),a.resolving=!1,ub()}}return i}function D2(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Zo)?n[Zo]:void 0;return typeof e=="number"?e>=0?e&pb:I2:e}function Vy(n,e,t){let r=1<<n;return!!(t[e+(n>>gb)]&r)}function jy(n,e){return!(n&Xe.Self)&&!(n&Xe.Host&&e)}var $s=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return xb(this._tNode,this._lView,e,ld(r),t)}};function I2(){return new $s(qn(),nt())}function ao(n){return cl(()=>{let e=n.prototype.constructor,t=e[Uu]||d0(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Uu]||d0(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function d0(n){return _w(n)?()=>{let e=d0(Fn(n));return e&&e()}:Ws(n)}function k2(n,e,t,r,i){let s=n,a=e;for(;s!==null&&a!==null&&a[Me]&2048&&!(a[Me]&512);){let o=yb(s,a,t,r|Xe.Self,Kr);if(o!==Kr)return o;let l=s.parent;if(!l){let u=a[Ww];if(u){let c=u.get(t,Kr,r);if(c!==Kr)return c}l=wb(a),a=a[io]}s=l}return i}function wb(n){let e=n[$e],t=e.type;return t===2?e.declTNode:t===1?n[Mr]:null}function bg(n){return S2(qn(),n)}function Uy(n,e=null,t=null,r){let i=bb(n,e,t,r);return i.resolveInjectorInitializers(),i}function bb(n,e=null,t=null,r,i=new Set){let s=[t||pr,TM(n)];return r=r||(typeof n=="object"?void 0:Pn(n)),new tl(s,e||ug(),r||null,i)}var ki=(()=>{class n{static{this.THROW_IF_NOT_FOUND=Jo}static{this.NULL=new Wu}static create(t,r){if(Array.isArray(t))return Uy({name:""},r,t,"");{let i=t.name??"";return Uy({name:i},t.parent,t.providers,i)}}static{this.\u0275prov=Se({token:n,providedIn:"any",factory:()=>Ne(Tw)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();var M2="ngOriginalError";function Hp(n){return n[M2]}var ei=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Hp(e);for(;t&&Hp(t);)t=Hp(t);return t||null}},Eb=new Fe("",{providedIn:"root",factory:()=>ve(ei).handleError.bind(void 0)}),Eg=(()=>{class n{static{this.__NG_ELEMENT_ID__=F2}static{this.__NG_ENV_ID__=t=>t}}return n})(),f0=class extends Eg{constructor(e){super(),this._lView=e}onDestroy(e){return tb(this._lView,e),()=>ZM(this._lView,e)}};function F2(){return new f0(nt())}function P2(){return oo(qn(),nt())}function oo(n,e){return new Rn(gr(n,e))}var Rn=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=P2}}return n})();function R2(n){return n instanceof Rn?n.nativeElement:n}var h0=class extends on{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,$w()&&(this.destroyRef=ve(Eg,{optional:!0})??void 0)}emit(e){let t=ut(null);try{super.next(e)}finally{ut(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),a=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),s=l.error?.bind(l),a=l.complete?.bind(l)}this.__isAsync&&(s=$p(s),i&&(i=$p(i)),a&&(a=$p(a)));let o=super.subscribe({next:i,error:s,complete:a});return e instanceof jt&&e.add(o),o}};function $p(n){return e=>{setTimeout(n,void 0,e)}}var Et=h0;function N2(){return this._results[Symbol.iterator]()}var p0=class n{get changes(){return this._changes??=new Et}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=n.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=N2)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=lM(e);(this._changesDetected=!oM(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function Ab(n){return(n.flags&128)===128}var Cb=new Map,O2=0;function L2(){return O2++}function B2(n){Cb.set(n[fd],n)}function V2(n){Cb.delete(n[fd])}var Hy="__ngContext__";function Ks(n,e){Hs(e)?(n[Hy]=e[fd],B2(e)):n[Hy]=e}function Sb(n){return Db(n[rl])}function Tb(n){return Db(n[Tr])}function Db(n){for(;n!==null&&!Ii(n);)n=n[Tr];return n}var g0;function Ib(n){g0=n}function kb(){if(g0!==void 0)return g0;if(typeof document<"u")return document;throw new be(210,!1)}var Ag=new Fe("",{providedIn:"root",factory:()=>j2}),j2="ng",Cg=new Fe(""),ps=new Fe("",{providedIn:"platform",factory:()=>"unknown"});var Sg=new Fe("",{providedIn:"root",factory:()=>kb().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var U2="h",H2="b";var $2=()=>null;function Tg(n,e,t=!1){return $2(n,e,t)}var Mb=!1,W2=new Fe("",{providedIn:"root",factory:()=>Mb});var ku;function z2(){if(ku===void 0&&(ku=null,tr.trustedTypes))try{ku=tr.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ku}function vd(n){return z2()?.createHTML(n)||n}var Mu;function Fb(){if(Mu===void 0&&(Mu=null,tr.trustedTypes))try{Mu=tr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Mu}function $y(n){return Fb()?.createHTML(n)||n}function Wy(n){return Fb()?.createScriptURL(n)||n}var Si=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${mw})`}},m0=class extends Si{getTypeName(){return"HTML"}},v0=class extends Si{getTypeName(){return"Style"}},_0=class extends Si{getTypeName(){return"Script"}},x0=class extends Si{getTypeName(){return"URL"}},y0=class extends Si{getTypeName(){return"ResourceURL"}};function Fr(n){return n instanceof Si?n.changingThisBreaksApplicationSecurity:n}function Mi(n,e){let t=G2(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${mw})`)}return t===e}function G2(n){return n instanceof Si&&n.getTypeName()||null}function Pb(n){return new m0(n)}function Rb(n){return new v0(n)}function Nb(n){return new _0(n)}function Ob(n){return new x0(n)}function Lb(n){return new y0(n)}function q2(n){let e=new b0(n);return X2()?new w0(e):e}var w0=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(vd(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}},b0=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=vd(e),t}};function X2(){try{return!!new window.DOMParser().parseFromString(vd(""),"text/html")}catch{return!1}}var Y2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function _d(n){return n=String(n),n.match(Y2)?n:"unsafe:"+n}function Fi(n){let e={};for(let t of n.split(","))e[t]=!0;return e}function gl(...n){let e={};for(let t of n)for(let r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}var Bb=Fi("area,br,col,hr,img,wbr"),Vb=Fi("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jb=Fi("rp,rt"),K2=gl(jb,Vb),Q2=gl(Vb,Fi("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Z2=gl(jb,Fi("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),zy=gl(Bb,Q2,Z2,K2),Ub=Fi("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),J2=Fi("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),eF=Fi("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),tF=gl(Ub,J2,eF),nF=Fi("script,style,template"),E0=class{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,r=!0,i=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild){i.push(t),t=sF(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=iF(t);if(s){t=s;break}t=i.pop()}}return this.buf.join("")}startElement(e){let t=Gy(e).toLowerCase();if(!zy.hasOwnProperty(t))return this.sanitizedSomething=!0,!nF.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let r=e.attributes;for(let i=0;i<r.length;i++){let s=r.item(i),a=s.name,o=a.toLowerCase();if(!tF.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let l=s.value;Ub[o]&&(l=_d(l)),this.buf.push(" ",a,'="',qy(l),'"')}return this.buf.push(">"),!0}endElement(e){let t=Gy(e).toLowerCase();zy.hasOwnProperty(t)&&!Bb.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(qy(e))}};function rF(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function iF(n){let e=n.nextSibling;if(e&&n!==e.previousSibling)throw Hb(e);return e}function sF(n){let e=n.firstChild;if(e&&rF(n,e))throw Hb(e);return e}function Gy(n){let e=n.nodeName;return typeof e=="string"?e:"FORM"}function Hb(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}var aF=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,oF=/([^\#-~ |!])/g;function qy(n){return n.replace(/&/g,"&amp;").replace(aF,function(e){let t=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+((t-55296)*1024+(r-56320)+65536)+";"}).replace(oF,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Fu;function Dg(n,e){let t=null;try{Fu=Fu||q2(n);let r=e?String(e):"";t=Fu.getInertBodyElement(r);let i=5,s=r;do{if(i===0)throw new Error("Failed to sanitize html because the input is unstable");i--,r=s,s=t.innerHTML,t=Fu.getInertBodyElement(r)}while(r!==s);let o=new E0().sanitizeChildren(Xy(t)||t);return vd(o)}finally{if(t){let r=Xy(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function Xy(n){return"content"in n&&lF(n)?n.content:null}function lF(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}var Pr=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Pr||{});function $b(n){let e=kg();return e?$y(e.sanitize(Pr.HTML,n)||""):Mi(n,"HTML")?$y(Fr(n)):Dg(kb(),ul(n))}function rr(n){let e=kg();return e?e.sanitize(Pr.URL,n)||"":Mi(n,"URL")?Fr(n):_d(ul(n))}function Ig(n){let e=kg();if(e)return Wy(e.sanitize(Pr.RESOURCE_URL,n)||"");if(Mi(n,"ResourceURL"))return Wy(Fr(n));throw new be(904,!1)}function cF(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?Ig:rr}function Wb(n,e,t){return cF(e,t)(n)}function kg(){let n=nt();return n&&n[Ir].sanitizer}function zb(n){return n instanceof Function?n():n}function uF(n){return(n??ve(ki)).get(ps)==="browser"}var ti=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(ti||{}),dF;function Mg(n,e){return dF(n,e)}function qa(n,e,t,r,i){if(r!=null){let s,a=!1;Ii(r)?s=r:Hs(r)&&(a=!0,r=r[Di]);let o=Jr(r);n===0&&t!==null?i==null?Kb(e,t,o):Zu(e,t,o,i||null,!0):n===1&&t!==null?Zu(e,t,o,i||null,!0):n===2?DF(e,o,a):n===3&&e.destroyNode(o),s!=null&&kF(e,n,s,t,i)}}function fF(n,e){return n.createText(e)}function hF(n,e,t){n.setValue(e,t)}function Gb(n,e,t){return n.createElement(e,t)}function pF(n,e){qb(n,e),e[Di]=null,e[Mr]=null}function gF(n,e,t,r,i,s){r[Di]=i,r[Mr]=e,xd(n,r,t,1,i,s)}function qb(n,e){e[Ir].changeDetectionScheduler?.notify(1),xd(n,e,e[Wt],2,null,null)}function mF(n){let e=n[rl];if(!e)return Wp(n[$e],n);for(;e;){let t=null;if(Hs(e))t=e[rl];else{let r=e[nr];r&&(t=r)}if(!t){for(;e&&!e[Tr]&&e!==n;)Hs(e)&&Wp(e[$e],e),e=e[pn];e===null&&(e=n),Hs(e)&&Wp(e[$e],e),t=e&&e[Tr]}e=t}}function vF(n,e,t,r){let i=nr+r,s=t.length;r>0&&(t[i-1][Tr]=e),r<s-nr?(e[Tr]=t[i],Sw(t,nr+r,e)):(t.push(e),e[Tr]=null),e[pn]=t;let a=e[hl];a!==null&&t!==a&&_F(a,e);let o=e[Ci];o!==null&&o.insertView(n),o0(e),e[Me]|=128}function _F(n,e){let t=n[to],i=e[pn][pn][Zr];e[Zr]!==i&&(n[Me]|=dg.HasTransplantedViews),t===null?n[to]=[e]:t.push(e)}function Xb(n,e){let t=n[to],r=t.indexOf(e);t.splice(r,1)}function A0(n,e){if(n.length<=nr)return;let t=nr+e,r=n[t];if(r){let i=r[hl];i!==null&&i!==n&&Xb(i,r),e>0&&(n[t-1][Tr]=r[Tr]);let s=$u(n,nr+e);pF(r[$e],r);let a=s[Ci];a!==null&&a.detachView(s[$e]),r[pn]=null,r[Tr]=null,r[Me]&=-129}return r}function Yb(n,e){if(!(e[Me]&256)){let t=e[Wt];t.destroyNode&&xd(n,e,t,3,null,null),mF(e)}}function Wp(n,e){if(e[Me]&256)return;let t=ut(null);try{e[Me]&=-129,e[Me]|=256,e[zs]&&Z1(e[zs]),yF(n,e),xF(n,e),e[$e].type===1&&e[Wt].destroy();let r=e[hl];if(r!==null&&Ii(e[pn])){r!==e[pn]&&Xb(r,e);let i=e[Ci];i!==null&&i.detachView(n)}V2(e)}finally{ut(t)}}function xF(n,e){let t=n.cleanup,r=e[nl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[nl]=null);let i=e[as];if(i!==null){e[as]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}}function yF(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Xs)){let s=t[r+1];if(Array.isArray(s))for(let a=0;a<s.length;a+=2){let o=i[s[a]],l=s[a+1];Yr(4,o,l);try{l.call(o)}finally{Yr(5,o,l)}}else{Yr(4,i,s);try{s.call(i)}finally{Yr(5,i,s)}}}}}function wF(n,e,t){return bF(n,e.parent,t)}function bF(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[Di];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===Qr.None||s===Qr.Emulated)return null}return gr(r,t)}}function Zu(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Kb(n,e,t){n.appendChild(e,t)}function Yy(n,e,t,r,i){r!==null?Zu(n,e,t,r,i):Kb(n,e,t)}function EF(n,e,t,r){n.removeChild(e,t,r)}function Fg(n,e){return n.parentNode(e)}function AF(n,e){return n.nextSibling(e)}function CF(n,e,t){return TF(n,e,t)}function SF(n,e,t){return n.type&40?gr(n,t):null}var TF=SF,Ky;function Pg(n,e,t,r){let i=wF(n,r,e),s=e[Wt],a=r.parent||e[Mr],o=CF(a,r,e);if(i!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)Yy(s,i,t[l],o,!1);else Yy(s,i,t,o,!1);Ky!==void 0&&Ky(s,r,e,t,i)}function Vu(n,e){if(e!==null){let t=e.type;if(t&3)return gr(e,n);if(t&4)return C0(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Vu(n,r);{let i=n[e.index];return Ii(i)?C0(-1,i):Jr(i)}}else{if(t&32)return Mg(e,n)()||Jr(n[e.index]);{let r=Qb(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=sl(n[Zr]);return Vu(i,r)}else return Vu(n,e.next)}}}return null}function Qb(n,e){if(e!==null){let r=n[Zr][Mr],i=e.projection;return r.projection[i]}return null}function C0(n,e){let t=nr+n+1;if(t<e.length){let r=e[t],i=r[$e].firstChild;if(i!==null)return Vu(r,i)}return e[Gs]}function DF(n,e,t){let r=Fg(n,e);r&&EF(n,r,e,t)}function Rg(n,e,t,r,i,s,a){for(;t!=null;){let o=r[t.index],l=t.type;if(a&&e===0&&(o&&Ks(Jr(o),r),t.flags|=2),(t.flags&32)!==32)if(l&8)Rg(n,e,t.child,r,i,s,!1),qa(e,n,i,o,s);else if(l&32){let u=Mg(t,r),c;for(;c=u();)qa(e,n,i,c,s);qa(e,n,i,o,s)}else l&16?IF(n,e,r,t,i,s):qa(e,n,i,o,s);t=a?t.projectionNext:t.next}}function xd(n,e,t,r,i,s){Rg(t,r,n.firstChild,e,i,s,!1)}function IF(n,e,t,r,i,s){let a=t[Zr],l=a[Mr].projection[r.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++){let c=l[u];qa(e,n,i,c,s)}else{let u=l,c=a[pn];Ab(r)&&(u.flags|=128),Rg(n,e,u,c,i,s,!0)}}function kF(n,e,t,r,i){let s=t[Gs],a=Jr(t);s!==a&&qa(e,n,r,s,i);for(let o=nr;o<t.length;o++){let l=t[o];xd(l[$e],l,n,e,r,s)}}function MF(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:ti.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=ti.Important),n.setStyle(t,r,i,s))}}function FF(n,e,t){n.setAttribute(e,"style",t)}function Zb(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Jb(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&n0(n,e,r),i!==null&&Zb(n,e,i),s!==null&&FF(n,e,s)}var Pi={};function ne(n=1){eE(gn(),nt(),so()+n,!1)}function eE(n,e,t,r){if(!r)if((e[Me]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Ou(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Lu(e,s,0,t)}qs(t)}function Ce(n,e=Xe.Default){let t=nt();if(t===null)return Ne(n,e);let r=qn();return xb(r,t,Fn(n),e)}function tE(){let n="invalid";throw new Error(n)}function nE(n,e,t,r,i,s){let a=ut(null);try{let o=null;i&gt.SignalBased&&(o=e[r][mp]),o!==null&&o.transformFn!==void 0&&(s=o.transformFn(s)),i&gt.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,o,s,t,r):qw(e,o,r,s)}finally{ut(a)}}function PF(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)qs(~i);else{let s=i,a=t[++r],o=t[++r];d2(a,s);let l=e[s];o(2,l)}}}finally{qs(-1)}}function yd(n,e,t,r,i,s,a,o,l,u,c){let d=e.blueprint.slice();return d[Di]=i,d[Me]=r|4|128|8|64,(u!==null||n&&n[Me]&2048)&&(d[Me]|=2048),eb(d),d[pn]=d[io]=n,d[Dr]=t,d[Ir]=a||n&&n[Ir],d[Wt]=o||n&&n[Wt],d[eo]=l||n&&n[eo]||null,d[Mr]=s,d[fd]=L2(),d[zu]=c,d[Ww]=u,d[Zr]=e.type==2?n[Zr]:d,d}function wd(n,e,t,r,i){let s=n.data[e];if(s===null)s=RF(n,e,t,r,i),u2()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let a=s2();s.injectorIndex=a===null?-1:a.injectorIndex}return pl(s,!0),s}function RF(n,e,t,r,i){let s=rb(),a=ib(),o=a?s:s&&s.parent,l=n.data[e]=jF(n,o,t,e,r,i);return n.firstChild===null&&(n.firstChild=l),s!==null&&(a?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function rE(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function iE(n,e,t,r,i){let s=so(),a=r&2;try{qs(-1),a&&e.length>kr&&eE(n,e,kr,!1),Yr(a?2:0,i),t(r,i)}finally{qs(s),Yr(a?3:1,i)}}function sE(n,e,t){if(Gw(e)){let r=ut(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let a=i;a<s;a++){let o=n.data[a];if(o.contentQueries){let l=t[a];o.contentQueries(1,l,a)}}}finally{ut(r)}}}function aE(n,e,t){nb()&&(GF(n,e,t,gr(t,e)),(t.flags&64)===64&&dE(n,e,t))}function oE(n,e,t=gr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let a=r[s+1],o=a===-1?t(e,n):n[a];n[i++]=o}}}function lE(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Ng(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Ng(n,e,t,r,i,s,a,o,l,u,c){let d=kr+r,f=d+i,h=NF(d,f),p=typeof u=="function"?u():u;return h[$e]={type:n,blueprint:h,template:t,queries:null,viewQuery:o,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof a=="function"?a():a,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:c}}function NF(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Pi);return t}function OF(n,e,t,r){let s=r.get(W2,Mb)||t===Qr.ShadowDom,a=n.selectRootElement(e,s);return LF(a),a}function LF(n){BF(n)}var BF=()=>null;function VF(n,e,t,r){let i=pE(e);i.push(t),n.firstCreatePass&&gE(n).push(r,i.length-1)}function jF(n,e,t,r,i,s){let a=e?e.injectorIndex:-1,o=0;return n2()&&(o|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:a,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:o,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Qy(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let a=e[s];if(a===void 0)continue;r??={};let o,l=gt.None;Array.isArray(a)?(o=a[0],l=a[1]):o=a;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}n===0?Zy(r,t,u,o,l):Zy(r,t,u,o)}return r}function Zy(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function UF(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,a=e.attrs,o=[],l=null,u=null;for(let c=r;c<i;c++){let d=s[c],f=t?t.get(d):null,h=f?f.inputs:null,p=f?f.outputs:null;l=Qy(0,d.inputs,c,l,h),u=Qy(1,d.outputs,c,u,p);let g=l!==null&&a!==null&&!lg(e)?rP(l,c,a):null;o.push(g)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=o,e.inputs=l,e.outputs=u}function HF(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Og(n,e,t,r,i,s,a,o){let l=gr(e,t),u=e.inputs,c;!o&&u!=null&&(c=u[r])?(Lg(n,t,c,r,i),hd(e)&&$F(t,e.index)):e.type&3?(r=HF(r),i=a!=null?a(i,e.value||"",r):i,s.setProperty(l,r,i)):e.type&12}function $F(n,e){let t=ds(e,n);t[Me]&16||(t[Me]|=64)}function cE(n,e,t,r){if(nb()){let i=r===null?null:{"":-1},s=XF(n,t),a,o;s===null?a=o=null:[a,o]=s,a!==null&&uE(n,e,t,a,i,o),i&&YF(t,r,i)}t.mergedAttrs=el(t.mergedAttrs,t.attrs)}function uE(n,e,t,r,i,s){for(let u=0;u<r.length;u++)u0(Qu(t,e),n,r[u].type);QF(t,n.data.length,r.length);for(let u=0;u<r.length;u++){let c=r[u];c.providersResolver&&c.providersResolver(c)}let a=!1,o=!1,l=rE(n,e,r.length,null);for(let u=0;u<r.length;u++){let c=r[u];t.mergedAttrs=el(t.mergedAttrs,c.hostAttrs),ZF(n,t,e,l,c),KF(l,c,i),c.contentQueries!==null&&(t.flags|=4),(c.hostBindings!==null||c.hostAttrs!==null||c.hostVars!==0)&&(t.flags|=64);let d=c.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),a=!0),!o&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),o=!0),l++}UF(n,t,s)}function WF(n,e,t,r,i){let s=i.hostBindings;if(s){let a=n.hostBindingOpCodes;a===null&&(a=n.hostBindingOpCodes=[]);let o=~e.index;zF(a)!=o&&a.push(o),a.push(t,r,s)}}function zF(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function GF(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;hd(t)&&JF(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Qu(t,e),Ks(r,e);let a=t.initialInputs;for(let o=i;o<s;o++){let l=n.data[o],u=Ys(e,n,o,t);if(Ks(u,e),a!==null&&nP(e,o-i,u,l,t,a),ls(l)){let c=ds(t.index,e);c[Dr]=Ys(e,n,o,t)}}}function dE(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,a=f2();try{qs(s);for(let o=r;o<i;o++){let l=n.data[o],u=e[o];l0(o),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&qF(l,u)}}finally{qs(-1),l0(a)}}function qF(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function XF(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let a=t[s];if(_M(e,a.selectors,!1))if(r||(r=[]),ls(a))if(a.findHostDirectiveDefs!==null){let o=[];i=i||new Map,a.findHostDirectiveDefs(a,o,i),r.unshift(...o,a);let l=o.length;S0(n,e,l)}else r.unshift(a),S0(n,e,0);else i=i||new Map,a.findHostDirectiveDefs?.(a,r,i),r.push(a)}return r===null?null:[r,i]}function S0(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function YF(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new be(-301,!1);r.push(e[i],s)}}}function KF(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;ls(e)&&(t[""]=n)}}function QF(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function ZF(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Ws(i.type,!0)),a=new Xs(s,ls(i),Ce);n.blueprint[r]=a,t[r]=a,WF(n,e,r,rE(n,t,i.hostVars,Pi),i)}function JF(n,e,t){let r=gr(e,n),i=lE(t),s=n[Ir].rendererFactory,a=16;t.signals?a=4096:t.onPush&&(a=64);let o=bd(n,yd(n,i,null,a,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=o}function eP(n,e,t,r,i,s){let a=gr(n,e);tP(e[Wt],a,s,n.value,t,r,i)}function tP(n,e,t,r,i,s,a){if(s==null)n.removeAttribute(e,i,t);else{let o=a==null?ul(s):a(s,r||"",i);n.setAttribute(e,i,o,t)}}function nP(n,e,t,r,i,s){let a=s[e];if(a!==null)for(let o=0;o<a.length;){let l=a[o++],u=a[o++],c=a[o++],d=a[o++];nE(r,t,l,u,c,d)}}function rP(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let a=n[s];for(let o=0;o<a.length;o+=3)if(a[o]===e){r.push(s,a[o+1],a[o+2],t[i+1]);break}}i+=2}return r}function fE(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function hE(n,e){let t=n.contentQueries;if(t!==null){let r=ut(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],a=t[i+1];if(a!==-1){let o=n.data[a];gg(s),o.contentQueries(2,e[a],a)}}}finally{ut(r)}}}function bd(n,e){return n[rl]?n[Oy][Tr]=e:n[rl]=e,n[Oy]=e,e}function T0(n,e,t){gg(0);let r=ut(null);try{e(n,t)}finally{ut(r)}}function pE(n){return n[nl]||(n[nl]=[])}function gE(n){return n.cleanup||(n.cleanup=[])}function mE(n,e){let t=n[eo],r=t?t.get(ei,null):null;r&&r.handleError(e)}function Lg(n,e,t,r,i){for(let s=0;s<t.length;){let a=t[s++],o=t[s++],l=t[s++],u=e[a],c=n.data[a];nE(c,u,r,o,l,i)}}function iP(n,e,t){let r=Qw(e,n);hF(n[Wt],r,t)}function sP(n,e){let t=ds(e,n),r=t[$e];aP(r,t);let i=t[Di];i!==null&&t[zu]===null&&(t[zu]=Tg(i,t[eo])),Bg(r,t,t[Dr])}function aP(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function Bg(n,e,t){mg(e);try{let r=n.viewQuery;r!==null&&T0(1,r,t);let i=n.template;i!==null&&iE(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ci]?.finishViewCreation(n),n.staticContentQueries&&hE(n,e),n.staticViewQueries&&T0(2,n.viewQuery,t);let s=n.components;s!==null&&oP(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[Me]&=-5,vg()}}function oP(n,e){for(let t=0;t<e.length;t++)sP(n,e[t])}function lP(n,e,t,r){let i=ut(null);try{let s=e.tView,o=n[Me]&4096?4096:16,l=yd(n,s,t,o,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];l[hl]=u;let c=n[Ci];return c!==null&&(l[Ci]=c.createEmbeddedView(s)),Bg(s,l,t),l}finally{ut(i)}}function Jy(n,e){return!e||e.firstChild===null||Ab(n)}function cP(n,e,t,r=!0){let i=e[$e];if(vF(i,e,n,t),r){let a=C0(t,n),o=e[Wt],l=Fg(o,n[Gs]);l!==null&&gF(i,n[Mr],o,e,l,a)}let s=e[zu];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Ju(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(Jr(s)),Ii(s)&&uP(s,r);let a=t.type;if(a&8)Ju(n,e,t.child,r);else if(a&32){let o=Mg(t,e),l;for(;l=o();)r.push(l)}else if(a&16){let o=Qb(e,t);if(Array.isArray(o))r.push(...o);else{let l=sl(e[Zr]);Ju(l[$e],l,o,r,!0)}}t=i?t.projectionNext:t.next}return r}function uP(n,e){for(let t=nr;t<n.length;t++){let r=n[t],i=r[$e].firstChild;i!==null&&Ju(r[$e],r,i,e)}n[Gs]!==n[Di]&&e.push(n[Gs])}var vE=[];function dP(n){return n[zs]??fP(n)}function fP(n){let e=vE.pop()??Object.create(pP);return e.lView=n,e}function hP(n){n.lView[zs]!==n&&(n.lView=null,vE.push(n))}var pP=Ke(ce({},Y1),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{il(n.lView)},consumerOnSignalRead(){this.lView[zs]=this}}),_E=100;function xE(n,e=!0,t=0){let r=n[Ir],i=r.rendererFactory,s=!1;s||i.begin?.();try{gP(n,t)}catch(a){throw e&&mE(n,a),a}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function gP(n,e){D0(n,e);let t=0;for(;pg(n);){if(t===_E)throw new be(103,!1);t++,D0(n,1)}}function mP(n,e,t,r){let i=e[Me];if((i&256)===256)return;let s=!1;!s&&e[Ir].inlineEffectRunner?.flush(),mg(e);let a=null,o=null;!s&&vP(n)&&(o=dP(e),a=K1(o));try{eb(e),l2(n.bindingStartIndex),t!==null&&iE(n,e,t,2,r);let l=(i&3)===3;if(!s)if(l){let d=n.preOrderCheckHooks;d!==null&&Ou(e,d,null)}else{let d=n.preOrderHooks;d!==null&&Lu(e,d,0,null),jp(e,0)}if(_P(e),yE(e,0),n.contentQueries!==null&&hE(n,e),!s)if(l){let d=n.contentCheckHooks;d!==null&&Ou(e,d)}else{let d=n.contentHooks;d!==null&&Lu(e,d,1),jp(e,1)}PF(n,e);let u=n.components;u!==null&&bE(e,u,0);let c=n.viewQuery;if(c!==null&&T0(2,c,r),!s)if(l){let d=n.viewCheckHooks;d!==null&&Ou(e,d)}else{let d=n.viewHooks;d!==null&&Lu(e,d,2),jp(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Vp]){for(let d of e[Vp])d();e[Vp]=null}s||(e[Me]&=-73)}catch(l){throw il(e),l}finally{o!==null&&(Q1(o,a),hP(o)),vg()}}function vP(n){return n.type!==2}function yE(n,e){for(let t=Sb(n);t!==null;t=Tb(t))for(let r=nr;r<t.length;r++){let i=t[r];wE(i,e)}}function _P(n){for(let e=Sb(n);e!==null;e=Tb(e)){if(!(e[Me]&dg.HasTransplantedViews))continue;let t=e[to];for(let r=0;r<t.length;r++){let i=t[r],s=i[pn];KM(i)}}}function xP(n,e,t){let r=ds(e,n);wE(r,t)}function wE(n,e){hg(n)&&D0(n,e)}function D0(n,e){let r=n[$e],i=n[Me],s=n[zs],a=!!(e===0&&i&16);if(a||=!!(i&64&&e===0),a||=!!(i&1024),a||=!!(s?.dirty&&vp(s)),s&&(s.dirty=!1),n[Me]&=-9217,a)mP(r,n,r.template,n[Dr]);else if(i&8192){yE(n,1);let o=r.components;o!==null&&bE(n,o,1)}}function bE(n,e,t){for(let r=0;r<e.length;r++)xP(n,e[r],t)}function Vg(n){for(n[Ir].changeDetectionScheduler?.notify();n;){n[Me]|=64;let e=sl(n);if(jM(n)&&!e)return n;n=e}return null}var Qs=class{get rootNodes(){let e=this._lView,t=e[$e];return Ju(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Dr]}set context(e){this._lView[Dr]=e}get destroyed(){return(this._lView[Me]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[pn];if(Ii(e)){let t=e[Gu],r=t?t.indexOf(this):-1;r>-1&&(A0(e,r),$u(t,r))}this._attachedToViewContainer=!1}Yb(this._lView[$e],this._lView)}onDestroy(e){tb(this._lView,e)}markForCheck(){Vg(this._cdRefInjectingView||this._lView)}detach(){this._lView[Me]&=-129}reattach(){o0(this._lView),this._lView[Me]|=128}detectChanges(){this._lView[Me]|=1024,xE(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new be(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,qb(this._lView[$e],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new be(902,!1);this._appRef=e,o0(this._lView)}},Zs=(()=>{class n{static{this.__NG_ELEMENT_ID__=bP}}return n})(),yP=Zs,wP=class extends yP{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=lP(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Qs(i)}};function bP(){return Ed(qn(),nt())}function Ed(n,e){return n.type&4?new wP(e,n,oo(n,e)):null}var mZ=new RegExp(`^(\\d+)*(${H2}|${U2})*(.*)`);var EP=()=>null;function ew(n,e){return EP(n,e)}var ed=class{},I0=class{},td=class{};function AP(n){let e=Error(`No component factory found for ${Pn(n)}.`);return e[CP]=n,e}var CP="ngComponent";var k0=class{resolveComponentFactory(e){throw AP(e)}},Ad=(()=>{class n{static{this.NULL=new k0}}return n})(),al=class{},Ri=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>SP()}}return n})();function SP(){let n=nt(),e=qn(),t=ds(e.index,n);return(Hs(t)?t:n)[Wt]}var TP=(()=>{class n{static{this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>null})}}return n})(),zp={};var tw=new Set;function jg(n){tw.has(n)||(tw.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function nw(...n){}function DP(){let n=typeof tr.requestAnimationFrame=="function",e=tr[n?"requestAnimationFrame":"setTimeout"],t=tr[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var At=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Et(!1),this.onMicrotaskEmpty=new Et(!1),this.onStable=new Et(!1),this.onError=new Et(!1),typeof Zone>"u")throw new be(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=DP().nativeRequestAnimationFrame,MP(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new be(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new be(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+i,e,IP,nw,nw);try{return s.runTask(a,t,r)}finally{s.cancelTask(a)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},IP={};function Ug(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function kP(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(tr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,M0(n),n.isCheckStableRunning=!0,Ug(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),M0(n))}function MP(n){let e=()=>{kP(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,a,o)=>{if(FP(o))return t.invokeTask(i,s,a,o);try{return rw(n),t.invokeTask(i,s,a,o)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),iw(n)}},onInvoke:(t,r,i,s,a,o,l)=>{try{return rw(n),t.invoke(i,s,a,o,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),iw(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,M0(n),Ug(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function M0(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function rw(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function iw(n){n._nesting--,Ug(n)}function FP(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}var Xa=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Xa||{}),PP={destroy(){}};function Cd(n,e){!e&&BM(Cd);let t=e?.injector??ve(ki);if(!uF(t))return PP;jg("NgAfterNextRender");let r=t.get(Hg),i=r.handler??=new P0,s=e?.phase??Xa.MixedReadWrite,a=()=>{i.unregister(l),o()},o=t.get(Eg).onDestroy(a),l=Ti(t,()=>new F0(s,()=>{a(),n()}));return i.register(l),{destroy:a}}var F0=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=ve(At),this.errorHandler=ve(ei,{optional:!0}),ve(ed,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},P0=class{constructor(){this.executingCallbacks=!1,this.buckets={[Xa.EarlyRead]:new Set,[Xa.Write]:new Set,[Xa.MixedReadWrite]:new Set,[Xa.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Hg=(()=>{class n{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let t=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of t)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static{this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>new n})}}return n})();function R0(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let a=0;a<e.length;a++){let o=e[a];if(typeof o=="number")s=o;else if(s==1)i=Sy(i,o);else if(s==2){let l=o,u=e[++a];r=Sy(r,l+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var nd=class extends Ad{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=os(e);return new no(t,this.ngModule)}};function sw(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function RP(n){let e=n.toLowerCase();return e==="svg"?WM:e==="math"?zM:null}var N0=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=ld(r);let i=this.injector.get(e,zp,r);return i!==zp||t===zp?i:this.parentInjector.get(e,t,r)}},no=class extends td{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=sw(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return sw(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=bM(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=ut(null);try{i=i||this.ngModule;let a=i instanceof Gn?i:i?.injector;a&&this.componentDef.getStandaloneInjector!==null&&(a=this.componentDef.getStandaloneInjector(a)||a);let o=a?new N0(e,a):e,l=o.get(al,null);if(l===null)throw new be(407,!1);let u=o.get(TP,null),c=o.get(Hg,null),d=o.get(ed,null),f={rendererFactory:l,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:d},h=l.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?OF(h,r,this.componentDef.encapsulation,o):Gb(h,p,RP(p)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let v=null;g!==null&&(v=Tg(g,o,!0));let x=Ng(0,null,null,1,0,null,null,null,null,null,null),_=yd(null,x,null,m,null,null,f,h,o,null,v);mg(_);let b,D;try{let A=this.componentDef,w,T=null;A.findHostDirectiveDefs?(w=[],T=new Map,A.findHostDirectiveDefs(A,w,T),w.push(A)):w=[A];let E=NP(_,g),P=OP(E,g,A,w,_,f,h);D=Zw(x,kr),g&&VP(h,A,g,r),t!==void 0&&jP(D,this.ngContentSelectors,t),b=BP(P,A,w,T,_,[UP]),Bg(x,_,null)}finally{vg()}return new O0(this.componentType,b,oo(D,_),_,D)}finally{ut(s)}}},O0=class extends I0{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Qs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;Lg(s[$e],s,i,e,t),this.previousInputValues.set(e,t);let a=ds(this._tNode.index,s);Vg(a)}}get injector(){return new $s(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function NP(n,e){let t=n[$e],r=kr;return n[r]=e,wd(t,r,2,"#host",null)}function OP(n,e,t,r,i,s,a){let o=i[$e];LP(r,n,e,a);let l=null;e!==null&&(l=Tg(e,i[eo]));let u=s.rendererFactory.createRenderer(e,t),c=16;t.signals?c=4096:t.onPush&&(c=64);let d=yd(i,lE(t),null,c,i[n.index],n,s,u,null,null,l);return o.firstCreatePass&&S0(o,n,r.length-1),bd(i,d),i[n.index]=d}function LP(n,e,t,r){for(let i of n)e.mergedAttrs=el(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(R0(e,e.mergedAttrs,!0),t!==null&&Jb(r,t,e))}function BP(n,e,t,r,i,s){let a=qn(),o=i[$e],l=gr(a,i);uE(o,i,a,t,null,r);for(let c=0;c<t.length;c++){let d=a.directiveStart+c,f=Ys(i,o,d,a);Ks(f,i)}dE(o,i,a),l&&Ks(l,i);let u=Ys(i,o,a.directiveStart+a.componentOffset,a);if(n[Dr]=i[Dr]=u,s!==null)for(let c of s)c(u,e);return sE(o,a,i),u}function VP(n,e,t,r){if(r)n0(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=EM(e.selectors[0]);i&&n0(n,t,i),s&&s.length>0&&Zb(n,t,s.join(" "))}}function jP(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function UP(){let n=qn();yg(nt()[$e],n)}var gs=(()=>{class n{static{this.__NG_ELEMENT_ID__=HP}}return n})();function HP(){let n=qn();return AE(n,nt())}var $P=gs,EE=class extends $P{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return oo(this._hostTNode,this._hostLView)}get injector(){return new $s(this._hostTNode,this._hostLView)}get parentInjector(){let e=wg(this._hostTNode,this._hostLView);if(hb(e)){let t=Yu(e,this._hostLView),r=Xu(e),i=t[$e].data[r+8];return new $s(i,t)}else return new $s(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=aw(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-nr}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let a=ew(this._lContainer,e.ssrId),o=e.createEmbeddedViewImpl(t||{},s,a);return this.insertImpl(o,i,Jy(this._hostTNode,a)),o}createComponent(e,t,r,i,s){let a=e&&!VM(e),o;if(a)o=t;else{let p=t||{};o=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=a?e:new no(os(e)),u=r||this.parentInjector;if(!s&&l.ngModule==null){let g=(a?u:this.parentInjector).get(Gn,null);g&&(s=g)}let c=os(l.componentType??{}),d=ew(this._lContainer,c?.id??null),f=d?.firstChild??null,h=l.create(u,i,f,s);return this.insertImpl(h.hostView,o,Jy(this._hostTNode,d)),h}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(YM(i)){let o=this.indexOf(e);if(o!==-1)this.detach(o);else{let l=i[pn],u=new EE(l,l[Mr],l[pn]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(t),a=this._lContainer;return cP(a,i,s,r),e.attachToViewContainerRef(),Sw(Gp(a),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=aw(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=A0(this._lContainer,t);r&&($u(Gp(this._lContainer),t),Yb(r[$e],r))}detach(e){let t=this._adjustIndex(e,-1),r=A0(this._lContainer,t);return r&&$u(Gp(this._lContainer),t)!=null?new Qs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function aw(n){return n[Gu]}function Gp(n){return n[Gu]||(n[Gu]=[])}function AE(n,e){let t,r=e[n.index];return Ii(r)?t=r:(t=fE(r,e,null,n),e[n.index]=t,bd(e,t)),zP(t,e,n,r),new EE(t,n,e)}function WP(n,e){let t=n[Wt],r=t.createComment(""),i=gr(e,n),s=Fg(t,i);return Zu(t,s,r,AF(t,i),!1),r}var zP=XP,GP=()=>!1;function qP(n,e,t){return GP(n,e,t)}function XP(n,e,t,r){if(n[Gs])return;let i;t.type&8?i=Jr(r):i=WP(e,t),n[Gs]=i}var L0=class n{constructor(e){this.queryList=e,this.matches=null}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},B0=class n{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let s=0;s<r;s++){let a=t.getByIndex(s),o=this.queries[a.indexInDeclarationView];i.push(o.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)$g(e,t).matches!==null&&this.queries[t].setDirty()}},V0=class{constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=nR(e):this.predicate=e}},j0=class n{constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,t!==null?t.push(s):t=[s])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},U0=class n{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let s=r[i];this.matchTNodeWithReadOption(e,t,YP(t,s)),this.matchTNodeWithReadOption(e,t,Bu(t,e,s,!1,!1))}else r===Zs?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Bu(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===Rn||i===gs||i===Zs&&t.type&4)this.addMatch(t.index,-2);else{let s=Bu(t,e,i,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function YP(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function KP(n,e){return n.type&11?oo(n,e):n.type&4?Ed(n,e):null}function QP(n,e,t,r){return t===-1?KP(e,n):t===-2?ZP(n,e,r):Ys(n,n[$e],t,e)}function ZP(n,e,t){if(t===Rn)return oo(e,n);if(t===Zs)return Ed(e,n);if(t===gs)return AE(e,n)}function CE(n,e,t,r){let i=e[Ci].queries[r];if(i.matches===null){let s=n.data,a=t.matches,o=[];for(let l=0;a!==null&&l<a.length;l+=2){let u=a[l];if(u<0)o.push(null);else{let c=s[u];o.push(QP(e,c,a[l+1],t.metadata.read))}}i.matches=o}return i.matches}function H0(n,e,t,r){let i=n.queries.getByIndex(t),s=i.matches;if(s!==null){let a=CE(n,e,i,t);for(let o=0;o<s.length;o+=2){let l=s[o];if(l>0)r.push(a[o/2]);else{let u=s[o+1],c=e[-l];for(let d=nr;d<c.length;d++){let f=c[d];f[hl]===f[pn]&&H0(f[$e],f,u,r)}if(c[to]!==null){let d=c[to];for(let f=0;f<d.length;f++){let h=d[f];H0(h[$e],h,u,r)}}}}}return r}function JP(n,e){return n[Ci].queries[e].queryList}function eR(n,e,t){let r=new p0((t&4)===4);return VF(n,e,r,r.destroy),(e[Ci]??=new B0).queries.push(new L0(r))-1}function tR(n,e,t){let r=gn();return r.firstCreatePass&&(rR(r,new V0(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),eR(r,nt(),e)}function nR(n){return n.split(",").map(e=>e.trim())}function rR(n,e,t){n.queries===null&&(n.queries=new j0),n.queries.track(new U0(e,t))}function $g(n,e){return n.queries.getByIndex(e)}function iR(n,e){let t=n[$e],r=$g(t,e);return r.crossesNgTemplate?H0(t,n,e,[]):CE(t,n,r,e)}function sR(n){return typeof n=="function"&&n[mp]!==void 0}function SE(n){return sR(n)&&typeof n.set=="function"}function aR(n){return Object.getPrototypeOf(n.prototype).constructor}function Ni(n){let e=aR(n.type),t=!0,r=[n];for(;e;){let i;if(ls(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new be(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let a=n;a.inputs=Pu(n.inputs),a.inputTransforms=Pu(n.inputTransforms),a.declaredInputs=Pu(n.declaredInputs),a.outputs=Pu(n.outputs);let o=i.hostBindings;o&&dR(n,o);let l=i.viewQuery,u=i.contentQueries;if(l&&cR(n,l),u&&uR(n,u),oR(n,i),Hk(n.outputs,i.outputs),ls(i)&&i.data.animation){let c=n.data;c.animation=(c.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let a=0;a<s.length;a++){let o=s[a];o&&o.ngInherit&&o(n),o===Ni&&(t=!1)}}e=Object.getPrototypeOf(e)}lR(r)}function oR(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function lR(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=el(i.hostAttrs,t=el(t,i.hostAttrs))}}function Pu(n){return n===Qa?{}:n===pr?[]:n}function cR(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function uR(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function dR(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function Wg(n){let e=n.inputConfig,t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}n.inputTransforms=t}var cs=class{},ol=class{};var $0=class extends cs{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nd(this);let i=Ow(e);this._bootstrapComponents=zb(i.bootstrap),this._r3Injector=bb(e,t,[{provide:cs,useValue:this},{provide:Ad,useValue:this.componentFactoryResolver},...r],Pn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},W0=class extends ol{constructor(e){super(),this.moduleType=e}create(e){return new $0(this.moduleType,e,[])}};var rd=class extends cs{constructor(e){super(),this.componentFactoryResolver=new nd(this),this.instance=null;let t=new tl([...e.providers,{provide:cs,useValue:this},{provide:Ad,useValue:this.componentFactoryResolver}],e.parent||ug(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Sd(n,e,t=null){return new rd({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Td=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new fn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function TE(n){return zg(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function fR(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function zg(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function Dd(n,e,t){return n[e]=t}function hR(n,e){return n[e]}function us(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function z0(n,e,t,r){let i=us(n,e,t);return us(n,e+1,r)||i}function pR(n,e,t,r,i,s){let a=z0(n,e,t,r);return z0(n,e+2,i,s)||a}function gR(n){return(n.flags&32)===32}function mR(n,e,t,r,i,s,a,o,l){let u=e.consts,c=wd(e,n,4,a||null,qu(u,o));cE(e,t,c,qu(u,l)),yg(e,c);let d=c.tView=Ng(2,c,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,c),d.queries=e.queries.embeddedTView(c)),c}function zt(n,e,t,r,i,s,a,o){let l=nt(),u=gn(),c=n+kr,d=u.firstCreatePass?mR(c,u,l,e,t,r,i,s,a):u.data[c];pl(d,!1);let f=vR(u,l,d,n);_g()&&Pg(u,l,f,d),Ks(f,l);let h=fE(f,l,f,d);return l[c]=h,bd(l,h),qP(h,d,l),fg(d)&&aE(u,l,d),a!=null&&oE(l,d,o),zt}var vR=_R;function _R(n,e,t,r){return xg(!0),e[Wt].createComment("")}function ml(n,e,t,r){let i=nt(),s=gd();if(us(i,s,e)){let a=gn(),o=md();eP(o,i,n,e,t,r)}return ml}function DE(n,e,t,r){return us(n,gd(),t)?e+ul(t)+r:Pi}function Ru(n,e){return n<<17|e<<2}function Js(n){return n>>17&32767}function xR(n){return(n&2)==2}function yR(n,e){return n&131071|e<<17}function G0(n){return n|2}function ro(n){return(n&131068)>>2}function qp(n,e){return n&-131069|e<<2}function wR(n){return(n&1)===1}function q0(n){return n|1}function bR(n,e,t,r,i,s){let a=s?e.classBindings:e.styleBindings,o=Js(a),l=ro(a);n[r]=t;let u=!1,c;if(Array.isArray(t)){let d=t;c=d[1],(c===null||fl(d,c)>0)&&(u=!0)}else c=t;if(i)if(l!==0){let f=Js(n[o+1]);n[r+1]=Ru(f,o),f!==0&&(n[f+1]=qp(n[f+1],r)),n[o+1]=yR(n[o+1],r)}else n[r+1]=Ru(o,0),o!==0&&(n[o+1]=qp(n[o+1],r)),o=r;else n[r+1]=Ru(l,0),o===0?o=r:n[l+1]=qp(n[l+1],r),l=r;u&&(n[r+1]=G0(n[r+1])),ow(n,c,r,!0),ow(n,c,r,!1),ER(e,c,n,r,s),a=Ru(o,l),s?e.classBindings=a:e.styleBindings=a}function ER(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&fl(s,e)>=0&&(t[r+1]=q0(t[r+1]))}function ow(n,e,t,r){let i=n[t+1],s=e===null,a=r?Js(i):ro(i),o=!1;for(;a!==0&&(o===!1||s);){let l=n[a],u=n[a+1];AR(l,e)&&(o=!0,n[a+1]=r?q0(u):G0(u)),a=r?Js(u):ro(u)}o&&(n[t+1]=r?G0(i):q0(i))}function AR(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?fl(n,e)>=0:!1}function Z(n,e,t){let r=nt(),i=gd();if(us(r,i,e)){let s=gn(),a=md();Og(s,a,r,n,e,r[Wt],t,!1)}return Z}function lw(n,e,t,r,i){let s=e.inputs,a=i?"class":"style";Lg(n,t,s[a],a,r)}function vl(n,e,t){return IE(n,e,t,!1),vl}function Id(n,e){return IE(n,e,null,!0),Id}function IE(n,e,t,r){let i=nt(),s=gn(),a=c2(2);if(s.firstUpdatePass&&SR(s,n,a,r),e!==Pi&&us(i,a,e)){let o=s.data[so()];MR(s,o,i,i[Wt],n,i[a+1]=FR(e,t),r,a)}}function CR(n,e){return e>=n.expandoStartIndex}function SR(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[so()],a=CR(n,t);PR(s,r)&&e===null&&!a&&(e=!1),e=TR(i,s,e,r),bR(i,s,e,t,a,r)}}function TR(n,e,t,r){let i=h2(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Xp(null,n,e,t,r),t=ll(t,e.attrs,r),s=null);else{let a=e.directiveStylingLast;if(a===-1||n[a]!==i)if(t=Xp(i,n,e,t,r),s===null){let l=DR(n,e,r);l!==void 0&&Array.isArray(l)&&(l=Xp(null,n,e,l[1],r),l=ll(l,e.attrs,r),IR(n,e,r,l))}else s=kR(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function DR(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ro(r)!==0)return n[Js(r)]}function IR(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Js(i)]=r}function kR(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let a=n[s].hostAttrs;r=ll(r,a,t)}return ll(r,e.attrs,t)}function Xp(n,e,t,r,i){let s=null,a=t.directiveEnd,o=t.directiveStylingLast;for(o===-1?o=t.directiveStart:o++;o<a&&(s=e[o],r=ll(r,s.hostAttrs,i),s!==n);)o++;return n!==null&&(t.directiveStylingLast=o),r}function ll(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];typeof a=="number"?i=a:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),uM(n,a,t?!0:e[++s]))}return n===void 0?null:n}function MR(n,e,t,r,i,s,a,o){if(!(e.type&3))return;let l=n.data,u=l[o+1],c=wR(u)?cw(l,e,t,i,ro(u),a):void 0;if(!id(c)){id(s)||xR(u)&&(s=cw(l,null,t,i,o,a));let d=Qw(so(),t);MF(r,a,d,i,s)}}function cw(n,e,t,r,i,s){let a=e===null,o;for(;i>0;){let l=n[i],u=Array.isArray(l),c=u?l[1]:l,d=c===null,f=t[i+1];f===Pi&&(f=d?pr:void 0);let h=d?Lp(f,r):c===r?f:void 0;if(u&&!id(h)&&(h=Lp(l,r)),id(h)&&(o=h,a))return o;let p=n[i+1];i=a?Js(p):ro(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(o=Lp(l,r))}return o}function id(n){return n!==void 0}function FR(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=Pn(Fr(n)))),n}function PR(n,e){return(n.flags&(e?8:16))!==0}function RR(n,e,t,r,i,s){let a=e.consts,o=qu(a,i),l=wd(e,n,2,r,o);return cE(e,t,l,qu(a,s)),l.attrs!==null&&R0(l,l.attrs,!1),l.mergedAttrs!==null&&R0(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function B(n,e,t,r){let i=nt(),s=gn(),a=kr+n,o=i[Wt],l=s.firstCreatePass?RR(a,s,i,e,t,r):s.data[a],u=NR(s,i,l,o,e,n);i[a]=u;let c=fg(l);return pl(l,!0),Jb(o,u,l),!gR(l)&&_g()&&Pg(s,i,u,l),JM()===0&&Ks(u,i),e2(),c&&(aE(s,i,l),sE(s,l,i)),r!==null&&oE(i,l),B}function V(){let n=qn();ib()?a2():(n=n.parent,pl(n,!1));let e=n;r2(e)&&i2(),t2();let t=gn();return t.firstCreatePass&&(yg(t,n),Gw(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&y2(e)&&lw(t,e,nt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&w2(e)&&lw(t,e,nt(),e.stylesWithoutHost,!1),V}function re(n,e,t,r){return B(n,e,t,r),V(),re}var NR=(n,e,t,r,i,s)=>(xg(!0),Gb(r,i,m2()));function lo(){return nt()}var Us=void 0;function OR(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var LR=["en",[["a","p"],["AM","PM"],Us],[["AM","PM"],Us,Us],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Us,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Us,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Us,"{1} 'at' {0}",Us],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",OR],Yp={};function kd(n){let e=BR(n),t=uw(e);if(t)return t;let r=e.split("-")[0];if(t=uw(r),t)return t;if(r==="en")return LR;throw new be(701,!1)}function uw(n){return n in Yp||(Yp[n]=tr.ng&&tr.ng.common&&tr.ng.common.locales&&tr.ng.common.locales[n]),Yp[n]}var ta=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ta||{});function BR(n){return n.toLowerCase().replace(/_/g,"-")}var sd="en-US",VR="USD";var jR=sd;function UR(n){typeof n=="string"&&(jR=n.toLowerCase().replace(/_/g,"-"))}function dt(n,e,t,r){let i=nt(),s=gn(),a=qn();return kE(s,i,i[Wt],a,n,e,r),dt}function HR(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let a=i[s];if(a===t&&i[s+1]===r){let o=e[nl],l=i[s+2];return o.length>l?o[l]:null}typeof a=="string"&&(s+=2)}return null}function kE(n,e,t,r,i,s,a){let o=fg(r),u=n.firstCreatePass&&gE(n),c=e[Dr],d=pE(e),f=!0;if(r.type&3||a){let g=gr(r,e),m=a?a(g):g,v=d.length,x=a?b=>a(Jr(b[r.index])):r.index,_=null;if(!a&&o&&(_=HR(n,e,i,r.index)),_!==null){let b=_.__ngLastListenerFn__||_;b.__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,f=!1}else{s=fw(r,e,c,s,!1);let b=t.listen(m,i,s);d.push(s,b),u&&u.push(i,x,v,v+1)}}else s=fw(r,e,c,s,!1);let h=r.outputs,p;if(f&&h!==null&&(p=h[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let v=p[m],x=p[m+1],D=e[v][x].subscribe(s),A=d.length;d.push(s,D),u&&u.push(i,r.index,A,-(A+1))}}}function dw(n,e,t,r){let i=ut(null);try{return Yr(6,e,t),t(r)!==!1}catch(s){return mE(n,s),!1}finally{Yr(7,e,t),ut(i)}}function fw(n,e,t,r,i){return function s(a){if(a===Function)return r;let o=n.componentOffset>-1?ds(n.index,e):e;Vg(o);let l=dw(e,t,r,a),u=s.__ngNextListenerFn__;for(;u;)l=dw(e,t,u,a)&&l,u=u.__ngNextListenerFn__;return i&&l===!1&&a.preventDefault(),l}}function ot(n=1){return g2(n)}function na(n,e,t){return ME(n,"",e,"",t),na}function ME(n,e,t,r,i){let s=nt(),a=DE(s,e,t,r);if(a!==Pi){let o=gn(),l=md();Og(o,l,s,n,a,s[Wt],i,!1)}return ME}function FE(n,e,t){tR(n,e,t)}function Gg(n){let e=nt(),t=gn(),r=sb();gg(r+1);let i=$g(t,r);if(n.dirty&&XM(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let s=iR(e,r);n.reset(s,R2),n.notifyOnChanges()}return!0}return!1}function qg(){return JP(nt(),sb())}function $R(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function Md(n){let e=o2();return Jw(e,kr+n)}function q(n,e=""){let t=nt(),r=gn(),i=n+kr,s=r.firstCreatePass?wd(r,i,1,e,null):r.data[i],a=WR(r,t,s,e,n);t[i]=a,_g()&&Pg(r,t,a,s),pl(s,!1)}var WR=(n,e,t,r,i)=>(xg(!0),fF(e[Wt],r));function Tt(n){return Rr("",n,""),Tt}function Rr(n,e,t){let r=nt(),i=DE(r,n,e,t);return i!==Pi&&iP(r,so(),i),Rr}function Fd(n,e,t){SE(e)&&(e=e());let r=nt(),i=gd();if(us(r,i,e)){let s=gn(),a=md();Og(s,a,r,n,e,r[Wt],t,!1)}return Fd}function Xg(n,e){let t=SE(n);return t&&n.set(e),t}function Pd(n,e){let t=nt(),r=gn(),i=qn();return kE(r,t,t[Wt],i,n,e),Pd}function zR(n,e,t){let r=gn();if(r.firstCreatePass){let i=ls(n);X0(t,r.data,r.blueprint,i,!0),X0(e,r.data,r.blueprint,i,!1)}}function X0(n,e,t,r,i){if(n=Fn(n),Array.isArray(n))for(let s=0;s<n.length;s++)X0(n[s],e,t,r,i);else{let s=gn(),a=nt(),o=qn(),l=Ja(n)?n:Fn(n.provide),u=Hw(n),c=o.providerIndexes&1048575,d=o.directiveStart,f=o.providerIndexes>>20;if(Ja(n)||!n.multi){let h=new Xs(u,i,Ce),p=Qp(l,e,i?c:c+f,d);p===-1?(u0(Qu(o,a),s,l),Kp(s,n,e.length),e.push(l),o.directiveStart++,o.directiveEnd++,i&&(o.providerIndexes+=1048576),t.push(h),a.push(h)):(t[p]=h,a[p]=h)}else{let h=Qp(l,e,c+f,d),p=Qp(l,e,c,c+f),g=h>=0&&t[h],m=p>=0&&t[p];if(i&&!m||!i&&!g){u0(Qu(o,a),s,l);let v=XR(i?qR:GR,t.length,i,r,u);!i&&m&&(t[p].providerFactory=v),Kp(s,n,e.length,0),e.push(l),o.directiveStart++,o.directiveEnd++,i&&(o.providerIndexes+=1048576),t.push(v),a.push(v)}else{let v=PE(t[i?p:h],u,!i&&r);Kp(s,n,h>-1?h:p,v)}!i&&r&&m&&t[p].componentProviders++}}}function Kp(n,e,t,r){let i=Ja(e),s=MM(e);if(i||s){let l=(s?Fn(e.useClass):e).prototype.ngOnDestroy;if(l){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let c=u.indexOf(t);c===-1?u.push(t,[r,l]):u[c+1].push(r,l)}else u.push(t,l)}}}function PE(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Qp(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function GR(n,e,t,r){return Y0(this.multi,[])}function qR(n,e,t,r){let i=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,o=Ys(t,t[$e],this.providerFactory.index,r);s=o.slice(0,a),Y0(i,s);for(let l=a;l<o.length;l++)s.push(o[l])}else s=[],Y0(i,s);return s}function Y0(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function XR(n,e,t,r,i){let s=new Xs(n,t,Ce);return s.multi=[],s.index=e,s.componentProviders=0,PE(s,i,r&&!t),s}function _l(n,e=[]){return t=>{t.providersResolver=(r,i)=>zR(r,i?i(n):n,e)}}var YR=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=Vw(!1,t.type),i=r.length>0?Sd([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Se({token:n,providedIn:"environment",factory:()=>new n(Ne(Gn))})}}return n})();function Ve(n){jg("NgStandalone"),n.getStandaloneInjector=e=>e.get(YR).getOrCreateStandaloneInjector(n)}function De(n,e,t){let r=pd()+n,i=nt();return i[r]===Pi?Dd(i,r,t?e.call(t):e()):hR(i,r)}function xl(n,e,t,r){return KR(nt(),pd(),n,e,t,r)}function RE(n,e,t,r,i){return QR(nt(),pd(),n,e,t,r,i)}function Yg(n,e){let t=n[e];return t===Pi?void 0:t}function KR(n,e,t,r,i,s){let a=e+t;return us(n,a,i)?Dd(n,a+1,s?r.call(s,i):r(i)):Yg(n,a+1)}function QR(n,e,t,r,i,s,a){let o=e+t;return z0(n,o,i,s)?Dd(n,o+2,a?r.call(a,i,s):r(i,s)):Yg(n,o+2)}function ZR(n,e,t,r,i,s,a,o,l){let u=e+t;return pR(n,u,i,s,a,o)?Dd(n,u+4,l?r.call(l,i,s,a,o):r(i,s,a,o)):Yg(n,u+4)}function yl(n,e){let t=gn(),r,i=n+kr;t.firstCreatePass?(r=JR(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Ws(r.type,!0)),a,o=zn(Ce);try{let l=Ku(!1),u=s();return Ku(l),$R(t,nt(),i,u),u}finally{zn(o)}}function JR(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function wl(n,e,t,r,i,s){let a=n+kr,o=nt(),l=Jw(o,a);return eN(o,a)?ZR(o,pd(),e,l.transform,t,r,i,s,l):l.transform(t,r,i,s)}function eN(n,e){return n[$e].data[e].pure}function Rd(n,e){return Ed(n,e)}var Nd=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var NE=new Fe("");function ra(n){return!!n&&typeof n.then=="function"}function OE(n){return!!n&&typeof n.subscribe=="function"}var Od=new Fe(""),LE=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ve(Od,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=i();if(ra(s))t.push(s);else if(OE(s)){let a=new Promise((o,l)=>{s.subscribe({complete:o,error:l})});t.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ld=new Fe("");function tN(){J1(()=>{throw new be(600,!1)})}function nN(n){return n.isBoundToModule}function rN(n,e,t){try{let r=t();return ra(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var bl=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(Eb),this.afterRenderEffectManager=ve(Hg),this.externalTestViews=new Set,this.beforeRender=new on,this.afterTick=new on,this.componentTypes=[],this.components=[],this.isStable=ve(Td).hasPendingTasks.pipe(Ze(t=>!t)),this._injector=ve(Gn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof td;if(!this._injector.get(LE).done){let f=!i&&Nw(t),h=!1;throw new be(405,h)}let a;i?a=t:a=this._injector.get(Ad).resolveComponentFactory(t),this.componentTypes.push(a.componentType);let o=nN(a)?void 0:this._injector.get(cs),l=r||a.selector,u=a.create(ki.NULL,[],l,o),c=u.location.nativeElement,d=u.injector.get(NE,null);return d?.registerApplication(c),u.onDestroy(()=>{this.detachView(u.hostView),Zp(this.components,u),d?.unregisterApplication(c)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(t){if(this._runningTick)throw new be(101,!1);let r=ut(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(t)}catch(i){this.internalErrorHandler(i)}finally{this.afterTick.next(),this._runningTick=!1,ut(r)}}detectChangesInAttachedViews(t){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===_E)throw new be(103,!1);if(t){let s=r===0;this.beforeRender.next(s);for(let{_lView:a,notifyErrorHandler:o}of this._views)iN(a,s,o)}if(r++,i.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>K0(s))&&(i.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>K0(s))))break}}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Zp(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(Ld,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Zp(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new be(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Zp(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function iN(n,e,t){!e&&!K0(n)||sN(n,t,e)}function K0(n){return pg(n)}function sN(n,e,t){let r;t?(r=0,n[Me]|=1024):n[Me]&64?r=0:r=1,xE(n,e,r)}var Q0=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Bd=(()=>{class n{compileModuleSync(t){return new W0(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=Ow(t),s=zb(i.declarations).reduce((a,o)=>{let l=os(o);return l&&a.push(new no(l)),a},[]);return new Q0(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var aN=(()=>{class n{constructor(){this.zone=ve(At),this.applicationRef=ve(bl)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function oN(n){return[{provide:At,useFactory:n},{provide:Za,multi:!0,useFactory:()=>{let e=ve(aN,{optional:!0});return()=>e.initialize()}},{provide:Za,multi:!0,useFactory:()=>{let e=ve(dN);return()=>{e.initialize()}}},{provide:Eb,useFactory:lN}]}function lN(){let n=ve(At),e=ve(ei);return t=>n.runOutsideAngular(()=>e.handleError(t))}function cN(n){let e=oN(()=>new At(uN(n)));return ud([[],e])}function uN(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var dN=(()=>{class n{constructor(){this.subscription=new jt,this.initialized=!1,this.zone=ve(At),this.pendingTasks=ve(Td)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{At.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function fN(){return typeof $localize<"u"&&$localize.locale||sd}var Vd=new Fe("",{providedIn:"root",factory:()=>ve(Vd,Xe.Optional|Xe.SkipSelf)||fN()}),BE=new Fe("",{providedIn:"root",factory:()=>VR});var VE=new Fe("");var ju=null;function hN(n=[],e){return ki.create({name:e,providers:[{provide:dd,useValue:"platform"},{provide:VE,useValue:new Set([()=>ju=null])},...n]})}function pN(n=[]){if(ju)return ju;let e=hN(n);return ju=e,tN(),gN(e),e}function gN(n){n.get(Cg,null)?.forEach(t=>t())}var ia=(()=>{class n{static{this.__NG_ELEMENT_ID__=mN}}return n})();function mN(n){return vN(qn(),nt(),(n&16)===16)}function vN(n,e,t){if(hd(n)&&!t){let r=ds(n.index,e);return new Qs(r,r)}else if(n.type&47){let r=e[Zr];return new Qs(r,e)}return null}var Z0=class{constructor(){}supports(e){return TE(e)}create(e){return new J0(e)}},_N=(n,e)=>e,J0=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||_N}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let a=!r||t&&t.currentIndex<hw(r,i,s)?t:r,o=hw(a,i,s),l=a.currentIndex;if(a===r)i--,r=r._nextRemoved;else if(t=t._next,a.previousIndex==null)i++;else{s||(s=[]);let u=o-i,c=l-i;if(u!=c){for(let f=0;f<u;f++){let h=f<s.length?s[f]:s[f]=0,p=h+f;c<=p&&p<u&&(s[f]=h+1)}let d=a.previousIndex;s[d]=c-u}}o!==l&&e(a,o,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!TE(e))throw new be(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,a;if(Array.isArray(e)){this.length=e.length;for(let o=0;o<this.length;o++)s=e[o],a=this._trackByFn(o,s),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,s,a,o),r=!0):(r&&(t=this._verifyReinsertion(t,s,a,o)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,fR(e,o=>{a=this._trackByFn(i,o),t===null||!Object.is(t.trackById,a)?(t=this._mismatch(t,o,a,i),r=!0):(r&&(t=this._verifyReinsertion(t,o,a,i)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new eg(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new ad),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new ad),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},eg=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},tg=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},ad=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new tg,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function hw(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}var ng=class{constructor(){}supports(e){return e instanceof Map||zg(e)}create(){return new rg}},rg=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||zg(e)))throw new be(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{let s=this._getOrCreateRecordForKey(i,r);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let i=this._records.get(e);this._maybeAddToChanges(i,t);let s=i._prev,a=i._next;return s&&(s._next=a),a&&(a._prev=s),i._next=null,i._prev=null,i}let r=new ig(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}},ig=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function pw(){return new Kg([new Z0])}var Kg=(()=>{class n{static{this.\u0275prov=Se({token:n,providedIn:"root",factory:pw})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||pw()),deps:[[n,new cd,new dl]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new be(901,!1)}}return n})();function gw(){return new Qg([new ng])}var Qg=(()=>{class n{static{this.\u0275prov=Se({token:n,providedIn:"root",factory:gw})}constructor(t){this.factories=t}static create(t,r){if(r){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||gw()),deps:[[n,new cd,new dl]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r)return r;throw new be(901,!1)}}return n})();function jE(n){try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=pN(r),s=[cN(),...t||[]],o=new rd({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,l=o.get(At);return l.run(()=>{o.resolveInjectorInitializers();let u=o.get(ei,null),c;l.runOutsideAngular(()=>{c=l.onError.subscribe({next:h=>{u.handleError(h)}})});let d=()=>o.destroy(),f=i.get(VE);return f.add(d),o.onDestroy(()=>{c.unsubscribe(),f.delete(d)}),rN(u,l,()=>{let h=o.get(LE);return h.runInitializers(),h.donePromise.then(()=>{let p=o.get(Vd,sd);UR(p||sd);let g=o.get(bl);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}function ms(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function UE(n){let e=os(n);if(!e)return null;let t=new no(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var YE=null;function Bi(){return YE}function KE(n){YE??=n}var jd=class{};var Nn=new Fe(""),am=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(xN),providedIn:"platform"})}}return n})(),QE=new Fe(""),xN=(()=>{class n extends am{constructor(){super(),this._doc=ve(Nn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Bi().getBaseHref(this._doc)}onPopState(t){let r=Bi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Bi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function om(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function HE(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Oi(n){return n&&n[0]!=="?"?"?"+n:n}var Nr=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(lm),providedIn:"root"})}}return n})(),ZE=new Fe(""),lm=(()=>{class n extends Nr{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ve(Nn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return om(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Oi(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Oi(s));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Oi(s));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(am),Ne(ZE,8))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),$d=(()=>{class n extends Nr{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=om(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Oi(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Oi(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(am),Ne(ZE,8))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),co=(()=>{class n{constructor(t){this._subject=new Et,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=bN(HE($E(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Oi(r))}normalize(t){return n.stripTrailingSlash(wN(this._basePath,$E(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Oi(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Oi(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Oi}static{this.joinWithSlash=om}static{this.stripTrailingSlash=HE}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nr))}}static{this.\u0275prov=Se({token:n,factory:()=>yN(),providedIn:"root"})}}return n})();function yN(){return new co(Ne(Nr))}function wN(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function $E(n){return n.replace(/\/index.html$/,"")}function bN(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var JE={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},eA=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(eA||{});var Li={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function El(n,e){let t=kd(n),r=t[ta.NumberSymbols][e];if(typeof r>"u"){if(e===Li.CurrencyDecimal)return t[ta.NumberSymbols][Li.Decimal];if(e===Li.CurrencyGroup)return t[ta.NumberSymbols][Li.Group]}return r}function EN(n,e){return kd(n)[ta.NumberFormats][e]}function AN(n){return kd(n)[ta.Currencies]}function CN(n,e,t="en"){let r=AN(t)[n]||JE[n]||[],i=r[1];return e==="narrow"&&typeof i=="string"?i:r[0]||n}var SN=2;function TN(n){let e,t=JE[n];return t&&(e=t[2]),typeof e=="number"?e:SN}var DN=/^(\d+)?\.((\d+)(-(\d+))?)?$/,WE=22,Ud=".",Al="0",IN=";",kN=",",Zg="#",zE="\xA4";function MN(n,e,t,r,i,s,a=!1){let o="",l=!1;if(!isFinite(n))o=El(t,Li.Infinity);else{let u=NN(n);a&&(u=RN(u));let c=e.minInt,d=e.minFrac,f=e.maxFrac;if(s){let x=s.match(DN);if(x===null)throw new Error(`${s} is not a valid digit info`);let _=x[1],b=x[3],D=x[5];_!=null&&(c=Jg(_)),b!=null&&(d=Jg(b)),D!=null?f=Jg(D):b!=null&&d>f&&(f=d)}ON(u,d,f);let h=u.digits,p=u.integerLen,g=u.exponent,m=[];for(l=h.every(x=>!x);p<c;p++)h.unshift(0);for(;p<0;p++)h.unshift(0);p>0?m=h.splice(p,h.length):(m=h,h=[0]);let v=[];for(h.length>=e.lgSize&&v.unshift(h.splice(-e.lgSize,h.length).join(""));h.length>e.gSize;)v.unshift(h.splice(-e.gSize,h.length).join(""));h.length&&v.unshift(h.join("")),o=v.join(El(t,r)),m.length&&(o+=El(t,i)+m.join("")),g&&(o+=El(t,Li.Exponential)+"+"+g)}return n<0&&!l?o=e.negPre+o+e.negSuf:o=e.posPre+o+e.posSuf,o}function FN(n,e,t,r,i){let s=EN(e,eA.Currency),a=PN(s,El(e,Li.MinusSign));return a.minFrac=TN(r),a.maxFrac=a.minFrac,MN(n,a,e,Li.CurrencyGroup,Li.CurrencyDecimal,i).replace(zE,t).replace(zE,"").trim()}function PN(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(IN),i=r[0],s=r[1],a=i.indexOf(Ud)!==-1?i.split(Ud):[i.substring(0,i.lastIndexOf(Al)+1),i.substring(i.lastIndexOf(Al)+1)],o=a[0],l=a[1]||"";t.posPre=o.substring(0,o.indexOf(Zg));for(let c=0;c<l.length;c++){let d=l.charAt(c);d===Al?t.minFrac=t.maxFrac=c+1:d===Zg?t.maxFrac=c+1:t.posSuf+=d}let u=o.split(kN);if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,s){let c=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf(Zg);t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+c).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function RN(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function NN(n){let e=Math.abs(n)+"",t=0,r,i,s,a,o;for((i=e.indexOf(Ud))>-1&&(e=e.replace(Ud,"")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;e.charAt(s)===Al;s++);if(s===(o=e.length))r=[0],i=1;else{for(o--;e.charAt(o)===Al;)o--;for(i-=s,r=[],a=0;s<=o;s++,a++)r[a]=Number(e.charAt(s))}return i>WE&&(r=r.splice(0,WE-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function ON(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,s=Math.min(Math.max(e,i),t),a=s+n.integerLen,o=r[a];if(a>0){r.splice(Math.max(n.integerLen,a));for(let d=a;d<r.length;d++)r[d]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,a=s+1),r[0]=0;for(let d=1;d<a;d++)r[d]=0}if(o>=5)if(a-1<0){for(let d=0;d>a;d--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[a-1]++;for(;i<Math.max(0,s);i++)r.push(0);let l=s!==0,u=e+n.integerLen,c=r.reduceRight(function(d,f,h,p){return f=f+d,p[h]=f<10?f:f-10,l&&(p[h]===0&&h>=u?p.pop():l=!1),f>=10?1:0},0);c&&(r.unshift(c),n.integerLen++)}function Jg(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function tA(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var em=/\s+/,GE=[],nA=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=GE,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(em):GE}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(em):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(em).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(Ce(Rn),Ce(Ri))}}static{this.\u0275dir=tn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[gt.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();var tm=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},uo=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,a)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new tm(i.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)r.remove(s===null?void 0:s);else if(s!==null){let o=r.get(s);r.move(o,a),qE(o,i)}});for(let i=0,s=r.length;i<s;i++){let o=r.get(i).context;o.index=i,o.count=s,o.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);qE(s,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(Ce(gs),Ce(Zs),Ce(Kg))}}static{this.\u0275dir=tn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function qE(n,e){n.context.$implicit=e.item}var mr=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new nm,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){XE("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){XE("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(Ce(gs),Ce(Zs))}}static{this.\u0275dir=tn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})(),nm=class{constructor(){this.$implicit=null,this.ngIf=null}};function XE(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Pn(e)}'.`)}var rA=(()=>{class n{constructor(t,r,i){this._ngEl=t,this._differs=r,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){let t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,r){let[i,s]=t.split("."),a=i.indexOf("-")===-1?void 0:ti.DashCase;r!=null?this._renderer.setStyle(this._ngEl.nativeElement,i,s?`${r}${s}`:r,a):this._renderer.removeStyle(this._ngEl.nativeElement,i,a)}_applyChanges(t){t.forEachRemovedItem(r=>this._setStyle(r.key,null)),t.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),t.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static{this.\u0275fac=function(r){return new(r||n)(Ce(Rn),Ce(Qg),Ce(Ri))}}static{this.\u0275dir=tn({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return n})();function LN(n,e){return new be(2100,!1)}var iA=(()=>{class n{constructor(t,r="USD"){this._locale=t,this._defaultCurrencyCode=r}transform(t,r=this._defaultCurrencyCode,i="symbol",s,a){if(!BN(t))return null;a||=this._locale,typeof i=="boolean"&&(i=i?"symbol":"code");let o=r||this._defaultCurrencyCode;i!=="code"&&(i==="symbol"||i==="symbol-narrow"?o=CN(o,i==="symbol"?"wide":"narrow",a):o=i);try{let l=VN(t);return FN(l,a,o,r,s)}catch(l){throw LN(n,l.message)}}static{this.\u0275fac=function(r){return new(r||n)(Ce(Vd,16),Ce(BE,16))}}static{this.\u0275pipe=Fw({name:"currency",type:n,pure:!0,standalone:!0})}}return n})();function BN(n){return!(n==null||n===""||n!==n)}function VN(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var On=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ri({type:n})}static{this.\u0275inj=ni({})}}return n})(),cm="browser",jN="server";function UN(n){return n===cm}function um(n){return n===jN}var sA=(()=>{class n{static{this.\u0275prov=Se({token:n,providedIn:"root",factory:()=>UN(ve(ps))?new rm(ve(Nn),window):new im})}}return n})(),rm=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=HN(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function HN(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let a=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(a)return a}i=r.nextNode()}}return null}var im=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Hd=class{};var hm=class extends jd{constructor(){super(...arguments),this.supportsDOMEvents=!0}},pm=class n extends hm{static makeCurrent(){KE(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=$N();return t==null?null:WN(t)}resetBaseElement(){Cl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return tA(document.cookie,e)}},Cl=null;function $N(){return Cl=Cl||document.querySelector("base"),Cl?Cl.getAttribute("href"):null}function WN(n){return new URL(n,document.baseURI).pathname}var zN=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),gm=new Fe(""),cA=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new be(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Ne(gm),Ne(At))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),Wd=class{constructor(e){this._doc=e}},dm="ng-app-id",uA=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=um(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${dm}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(dm),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(dm,this.appId),t.appendChild(a),a}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,a=s.get(r)?.elements;a?a.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nn),Ne(Ag),Ne(Sg,8),Ne(ps))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),fm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},vm=/%COMP%/g,dA="%COMP%",GN=`_nghost-${dA}`,qN=`_ngcontent-${dA}`,XN=!0,YN=new Fe("",{providedIn:"root",factory:()=>XN});function KN(n){return qN.replace(vm,n)}function QN(n){return GN.replace(vm,n)}function fA(n,e){return e.map(t=>t.replace(vm,n))}var aA=(()=>{class n{constructor(t,r,i,s,a,o,l,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=o,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=um(o),this.defaultRenderer=new Sl(t,a,l,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Qr.ShadowDom&&(r=Ke(ce({},r),{encapsulation:Qr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof zd?i.applyToHost(t):i instanceof Tl&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let a=this.doc,o=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,c=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case Qr.Emulated:s=new zd(l,u,r,this.appId,c,a,o,d);break;case Qr.ShadowDom:return new mm(l,u,t,r,a,o,this.nonce,d);default:s=new Tl(l,u,r,c,a,o,d);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Ne(cA),Ne(uA),Ne(Ag),Ne(YN),Ne(Nn),Ne(ps),Ne(At),Ne(Sg))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),Sl=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(fm[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(oA(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(oA(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new be(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=fm[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=fm[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(ti.DashCase|ti.Important)?e.style.setProperty(t,r,i&ti.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&ti.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=Bi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function oA(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var mm=class extends Sl{constructor(e,t,r,i,s,a,o,l){super(e,s,a,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=fA(i.id,i.styles);for(let c of u){let d=document.createElement("style");o&&d.setAttribute("nonce",o),d.textContent=c,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Tl=class extends Sl{constructor(e,t,r,i,s,a,o,l){super(e,s,a,o),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?fA(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},zd=class extends Tl{constructor(e,t,r,i,s,a,o,l){let u=i+"-"+r.id;super(e,t,r,s,a,o,l,u),this.contentAttr=KN(u),this.hostAttr=QN(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},ZN=(()=>{class n extends Wd{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nn))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})(),lA=["alt","control","meta","shift"],JN={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},eO={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},tO=(()=>{class n extends Wd{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Bi().onAndCancel(t,s.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),a="",o=r.indexOf("code");if(o>-1&&(r.splice(o,1),a="code."),lA.forEach(u=>{let c=r.indexOf(u);c>-1&&(r.splice(c,1),a+=u+".")}),a+=s,r.length!=0||s.length===0)return null;let l={};return l.domEventName=i,l.fullKey=a,l}static matchEventFullKeyCode(t,r){let i=JN[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),lA.forEach(a=>{if(a!==i){let o=eO[a];o(t)&&(s+=a+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nn))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})();function hA(n,e){return jE(ce({rootComponent:n},nO(e)))}function nO(n){return{appProviders:[...oO,...n?.providers??[]],platformProviders:aO}}function rO(){pm.makeCurrent()}function iO(){return new ei}function sO(){return Ib(document),document}var aO=[{provide:ps,useValue:cm},{provide:Cg,useValue:rO,multi:!0},{provide:Nn,useFactory:sO,deps:[]}];var oO=[{provide:dd,useValue:"root"},{provide:ei,useFactory:iO,deps:[]},{provide:gm,useClass:ZN,multi:!0,deps:[Nn,At,ps]},{provide:gm,useClass:tO,multi:!0,deps:[Nn]},aA,uA,cA,{provide:al,useExisting:aA},{provide:Hd,useClass:zN,deps:[]},[]];var pA=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nn))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var _m=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=Ne(lO),i},providedIn:"root"})}}return n})(),lO=(()=>{class n extends _m{constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case Pr.NONE:return r;case Pr.HTML:return Mi(r,"HTML")?Fr(r):Dg(this._doc,String(r)).toString();case Pr.STYLE:return Mi(r,"Style")?Fr(r):r;case Pr.SCRIPT:if(Mi(r,"Script"))return Fr(r);throw new be(5200,!1);case Pr.URL:return Mi(r,"URL")?Fr(r):_d(String(r));case Pr.RESOURCE_URL:if(Mi(r,"ResourceURL"))return Fr(r);throw new be(5201,!1);default:throw new be(5202,!1)}}bypassSecurityTrustHtml(t){return Pb(t)}bypassSecurityTrustStyle(t){return Rb(t)}bypassSecurityTrustScript(t){return Nb(t)}bypassSecurityTrustUrl(t){return Ob(t)}bypassSecurityTrustResourceUrl(t){return Lb(t)}static{this.\u0275fac=function(r){return new(r||n)(Ne(Nn))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Ue="primary",$l=Symbol("RouteTitle"),Em=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function mo(n){return new Em(n)}function cO(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],o=n[s];if(a.startsWith(":"))i[a.substring(1)]=o;else if(a!==o.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function uO(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!si(n[t],e[t]))return!1;return!0}function si(n,e){let t=n?Am(n):void 0,r=e?Am(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!AA(n[i],e[i]))return!1;return!0}function Am(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function AA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function CA(n){return n.length>0?n[n.length-1]:null}function ys(n){return kp(n)?n:ra(n)?_t(Promise.resolve(n)):Ie(n)}var dO={exact:TA,subset:DA},SA={exact:fO,subset:hO,ignored:()=>!0};function mA(n,e,t){return dO[t.paths](n.root,e.root,t.matrixParams)&&SA[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function fO(n,e){return si(n,e)}function TA(n,e,t){if(!oa(n.segments,e.segments)||!Xd(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!TA(n.children[r],e.children[r],t))return!1;return!0}function hO(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>AA(n[t],e[t]))}function DA(n,e,t){return IA(n,e,e.segments,t)}function IA(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!oa(i,t)||e.hasChildren()||!Xd(i,t,r))}else if(n.segments.length===t.length){if(!oa(n.segments,t)||!Xd(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!DA(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!oa(n.segments,i)||!Xd(n.segments,i,r)||!n.children[Ue]?!1:IA(n.children[Ue],e,s,r)}}function Xd(n,e,t){return e.every((r,i)=>SA[t](n[i].parameters,r.parameters))}var vs=class{constructor(e=new ft([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=mo(this.queryParams),this._queryParamMap}toString(){return mO.serialize(this)}},ft=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Yd(this)}},aa=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=mo(this.parameters),this._parameterMap}toString(){return MA(this)}};function pO(n,e){return oa(n,e)&&n.every((t,r)=>si(t.parameters,e[r].parameters))}function oa(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function gO(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Ue&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Ue&&(t=t.concat(e(i,r)))}),t}var Wl=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>new Rl,providedIn:"root"})}}return n})(),Rl=class{parse(e){let t=new Sm(e);return new vs(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Dl(e.root,!0)}`,r=xO(e.queryParams),i=typeof e.fragment=="string"?`#${vO(e.fragment)}`:"";return`${t}${r}${i}`}},mO=new Rl;function Yd(n){return n.segments.map(e=>MA(e)).join("/")}function Dl(n,e){if(!n.hasChildren())return Yd(n);if(e){let t=n.children[Ue]?Dl(n.children[Ue],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==Ue&&r.push(`${i}:${Dl(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=gO(n,(r,i)=>i===Ue?[Dl(n.children[Ue],!1)]:[`${i}:${Dl(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ue]!=null?`${Yd(n)}/${t[0]}`:`${Yd(n)}/(${t.join("//")})`}}function kA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Gd(n){return kA(n).replace(/%3B/gi,";")}function vO(n){return encodeURI(n)}function Cm(n){return kA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Kd(n){return decodeURIComponent(n)}function vA(n){return Kd(n.replace(/\+/g,"%20"))}function MA(n){return`${Cm(n.path)}${_O(n.parameters)}`}function _O(n){return Object.entries(n).map(([e,t])=>`;${Cm(e)}=${Cm(t)}`).join("")}function xO(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Gd(t)}=${Gd(i)}`).join("&"):`${Gd(t)}=${Gd(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var yO=/^[^\/()?;#]+/;function xm(n){let e=n.match(yO);return e?e[0]:""}var wO=/^[^\/()?;=#]+/;function bO(n){let e=n.match(wO);return e?e[0]:""}var EO=/^[^=?&#]+/;function AO(n){let e=n.match(EO);return e?e[0]:""}var CO=/^[^&#]+/;function SO(n){let e=n.match(CO);return e?e[0]:""}var Sm=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ft([],{}):new ft([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Ue]=new ft(e,t)),r}parseSegment(){let e=xm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new be(4009,!1);return this.capture(e),new aa(Kd(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=bO(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=xm(this.remaining);i&&(r=i,this.capture(r))}e[Kd(t)]=Kd(r)}parseQueryParam(e){let t=AO(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=SO(this.remaining);a&&(r=a,this.capture(r))}let i=vA(t),s=vA(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=xm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new be(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ue);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[Ue]:new ft([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new be(4011,!1)}};function FA(n){return n.segments.length>0?new ft([],{[Ue]:n}):n}function PA(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=PA(i);if(r===Ue&&s.segments.length===0&&s.hasChildren())for(let[a,o]of Object.entries(s.children))e[a]=o;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ft(n.segments,e);return TO(t)}function TO(n){if(n.numberOfChildren===1&&n.children[Ue]){let e=n.children[Ue];return new ft(n.segments.concat(e.segments),e.children)}return n}function vo(n){return n instanceof vs}function DO(n,e,t=null,r=null){let i=RA(n);return NA(i,e,t,r)}function RA(n){let e;function t(s){let a={};for(let l of s.children){let u=t(l);a[l.outlet]=u}let o=new ft(s.url,a);return s===n&&(e=o),o}let r=t(n.root),i=FA(r);return e??i}function NA(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return ym(i,i,i,t,r);let s=IO(e);if(s.toRoot())return ym(i,i,new ft([],{}),t,r);let a=kO(s,i,n),o=a.processChildren?Ml(a.segmentGroup,a.index,s.commands):LA(a.segmentGroup,a.index,s.commands);return ym(i,a.segmentGroup,o,t,r)}function Qd(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Nl(n){return typeof n=="object"&&n!=null&&n.outlets}function ym(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(c=>`${c}`):`${u}`});let a;n===e?a=t:a=OA(n,e,t);let o=FA(PA(a));return new vs(o,s,i)}function OA(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=OA(s,e,t)}),new ft(n.segments,r)}var Zd=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Qd(r[0]))throw new be(4003,!1);let i=r.find(Nl);if(i&&i!==CA(r))throw new be(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function IO(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Zd(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let o={};return Object.entries(s.outlets).forEach(([l,u])=>{o[l]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:o}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((o,l)=>{l==0&&o==="."||(l==0&&o===""?t=!0:o===".."?e++:o!=""&&i.push(o))}),i):[...i,s]},[]);return new Zd(t,e,r)}var po=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function kO(n,e,t){if(n.isAbsolute)return new po(e,!0,0);if(!t)return new po(e,!1,NaN);if(t.parent===null)return new po(t,!0,0);let r=Qd(n.commands[0])?0:1,i=t.segments.length-1+r;return MO(t,i,n.numberOfDoubleDots)}function MO(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new be(4005,!1);i=r.segments.length}return new po(r,!1,i-s)}function FO(n){return Nl(n[0])?n[0].outlets:{[Ue]:n}}function LA(n,e,t){if(n??=new ft([],{}),n.segments.length===0&&n.hasChildren())return Ml(n,e,t);let r=PO(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ft(n.segments.slice(0,r.pathIndex),{});return s.children[Ue]=new ft(n.segments.slice(r.pathIndex),n.children),Ml(s,0,i)}else return r.match&&i.length===0?new ft(n.segments,{}):r.match&&!n.hasChildren()?Tm(n,e,t):r.match?Ml(n,0,i):Tm(n,e,t)}function Ml(n,e,t){if(t.length===0)return new ft(n.segments,{});{let r=FO(t),i={};if(Object.keys(r).some(s=>s!==Ue)&&n.children[Ue]&&n.numberOfChildren===1&&n.children[Ue].segments.length===0){let s=Ml(n.children[Ue],e,t);return new ft(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=LA(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new ft(n.segments,i)}}function PO(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],o=t[r];if(Nl(o))break;let l=`${o}`,u=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!xA(l,u,a))return s;r+=2}else{if(!xA(l,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Tm(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Nl(s)){let l=RO(s.outlets);return new ft(r,l)}if(i===0&&Qd(t[0])){let l=n.segments[e];r.push(new aa(l.path,_A(t[0]))),i++;continue}let a=Nl(s)?s.outlets[Ue]:`${s}`,o=i<t.length-1?t[i+1]:null;a&&o&&Qd(o)?(r.push(new aa(a,_A(o))),i+=2):(r.push(new aa(a,{})),i++)}return new ft(r,{})}function RO(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Tm(new ft([],{}),0,r))}),e}function _A(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function xA(n,e,t){return n==t.path&&si(e,t.parameters)}var Fl="imperative",ln=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ln||{}),vr=class{constructor(e,t){this.id=e,this.url=t}},_o=class extends vr{constructor(e,t,r="imperative",i=null){super(e,t),this.type=ln.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ai=class extends vr{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=ln.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},sr=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(sr||{}),Jd=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Jd||{}),_s=class extends vr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ln.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},xs=class extends vr{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=ln.NavigationSkipped}},Ol=class extends vr{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=ln.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ef=class extends vr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ln.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dm=class extends vr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ln.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Im=class extends vr{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=ln.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},km=class extends vr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ln.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mm=class extends vr{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=ln.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fm=class{constructor(e){this.route=e,this.type=ln.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Pm=class{constructor(e){this.route=e,this.type=ln.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Rm=class{constructor(e){this.snapshot=e,this.type=ln.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nm=class{constructor(e){this.snapshot=e,this.type=ln.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Om=class{constructor(e){this.snapshot=e,this.type=ln.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lm=class{constructor(e){this.snapshot=e,this.type=ln.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tf=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=ln.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Ll=class{},Bl=class{constructor(e){this.url=e}};var Bm=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new zl,this.attachRef=null}},zl=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Bm,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),nf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Vm(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Vm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=jm(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return jm(e,this._root).map(t=>t.value)}};function Vm(n,e){if(n===e.value)return e;for(let t of e.children){let r=Vm(n,t);if(r)return r}return null}function jm(n,e){if(n===e.value)return[e];for(let t of e.children){let r=jm(n,t);if(r.length)return r.unshift(e),r}return[]}var ir=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ho(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var rf=class extends nf{constructor(e,t){super(e),this.snapshot=t,Km(this,e)}toString(){return this.snapshot.toString()}};function BA(n){let e=NO(n),t=new fn([new aa("",{})]),r=new fn({}),i=new fn({}),s=new fn({}),a=new fn(""),o=new oi(t,r,s,a,i,Ue,n,e.root);return o.snapshot=e.root,new rf(new ir(o,[]),e)}function NO(n){let e={},t={},r={},i="",s=new Vl([],e,r,i,t,Ue,n,null,{});return new sf("",new ir(s,[]))}var oi=class{constructor(e,t,r,i,s,a,o,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=o,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ze(u=>u[$l]))??Ie(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ze(e=>mo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ze(e=>mo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ym(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:ce(ce({},e.params),n.params),data:ce(ce({},e.data),n.data),resolve:ce(ce(ce(ce({},n.data),e.data),i?.data),n._resolvedData)}:r={params:ce({},n.params),data:ce({},n.data),resolve:ce(ce({},n.data),n._resolvedData??{})},i&&jA(i)&&(r.resolve[$l]=i.title),r}var Vl=class{get title(){return this.data?.[$l]}constructor(e,t,r,i,s,a,o,l,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=o,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=mo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=mo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},sf=class extends nf{constructor(e,t){super(t),this.url=e,Km(this,t)}toString(){return VA(this._root)}};function Km(n,e){e.value._routerState=n,e.children.forEach(t=>Km(n,t))}function VA(n){let e=n.children.length>0?` { ${n.children.map(VA).join(", ")} } `:"";return`${n.value}${e}`}function wm(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,si(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),si(e.params,t.params)||n.paramsSubject.next(t.params),uO(e.url,t.url)||n.urlSubject.next(t.url),si(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Um(n,e){let t=si(n.params,e.params)&&pO(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Um(n.parent,e.parent))}function jA(n){return typeof n.title=="string"||n.title===null}var Qm=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ue,this.activateEvents=new Et,this.deactivateEvents=new Et,this.attachEvents=new Et,this.detachEvents=new Et,this.parentContexts=ve(zl),this.location=ve(gs),this.changeDetector=ve(ia),this.environmentInjector=ve(Gn),this.inputBinder=ve(cf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new be(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new be(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new be(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new be(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,o=this.parentContexts.getOrCreateContext(this.name).children,l=new Hm(t,o,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=tn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ii]})}}return n})(),Hm=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===oi?this.route:e===zl?this.childContexts:this.parent.get(e,t)}},cf=new Fe(""),yA=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Ko([r.queryParams,r.params,r.data]).pipe(hr(([s,a,o],l)=>(o=ce(ce(ce({},s),a),o),l===0?Ie(o):Promise.resolve(o)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let a=UE(r.component);if(!a){this.unsubscribeFromRouteData(t);return}for(let{templateName:o}of a.inputs)t.activatedComponentRef.setInput(o,s[o])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})();function OO(n,e,t){let r=jl(n,e._root,t?t._root:void 0);return new rf(r,e)}function jl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=LO(n,e,t);return new ir(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(o=>jl(n,o)),a}}let r=BO(e.value),i=e.children.map(s=>jl(n,s));return new ir(r,i)}}function LO(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return jl(n,r,i);return jl(n,r)})}function BO(n){return new oi(new fn(n.url),new fn(n.params),new fn(n.queryParams),new fn(n.fragment),new fn(n.data),n.outlet,n.component,n)}var UA="ngNavigationCancelingError";function HA(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=vo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=$A(!1,sr.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function $A(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[UA]=!0,t.cancellationCode=e,t}function VO(n){return WA(n)&&vo(n.url)}function WA(n){return!!n&&n[UA]}var jO=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["ng-component"]],standalone:!0,features:[Ve],decls:1,vars:0,template:function(r,i){r&1&&re(0,"router-outlet")},dependencies:[Qm],encapsulation:2})}}return n})();function UO(n,e){return n.providers&&!n._injector&&(n._injector=Sd(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Zm(n){let e=n.children&&n.children.map(Zm),t=e?Ke(ce({},n),{children:e}):ce({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ue&&(t.component=jO),t}function li(n){return n.outlet||Ue}function HO(n,e){let t=n.filter(r=>li(r)===e);return t.push(...n.filter(r=>li(r)!==e)),t}function Gl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var $O=(n,e,t,r)=>Ze(i=>(new $m(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),$m=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),wm(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ho(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ho(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),o=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:o})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ho(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ho(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Lm(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Nm(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(wm(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let o=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(o.contexts),a.attachRef=o.componentRef,a.route=o.route.value,a.outlet&&a.outlet.attach(o.componentRef,o.route.value),wm(o.route.value),this.activateChildRoutes(e,null,a.children)}else{let o=Gl(i.snapshot);a.attachRef=null,a.route=i,a.injector=o,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,r)}},af=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},go=class{constructor(e,t){this.component=e,this.route=t}};function WO(n,e,t){let r=n._root,i=e?e._root:null;return Il(r,i,t,[r.value])}function zO(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function yo(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!xw(n)?n:e.get(n):r}function Il(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ho(e);return n.children.forEach(a=>{GO(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,o])=>Pl(o,t.getContext(a),i)),i}function GO(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,o=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let l=qO(a,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new af(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Il(n,e,o?o.children:null,r,i):Il(n,e,t,r,i),l&&o&&o.outlet&&o.outlet.isActivated&&i.canDeactivateChecks.push(new go(o.outlet.component,a))}else a&&Pl(e,o,i),i.canActivateChecks.push(new af(r)),s.component?Il(n,null,o?o.children:null,r,i):Il(n,null,t,r,i);return i}function qO(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!oa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!oa(n.url,e.url)||!si(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Um(n,e)||!si(n.queryParams,e.queryParams);case"paramsChange":default:return!Um(n,e)}}function Pl(n,e,t){let r=ho(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Pl(a,e.children.getContext(s),t):Pl(a,null,t):Pl(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new go(e.outlet.component,i)):t.canDeactivateChecks.push(new go(null,i)):t.canDeactivateChecks.push(new go(null,i))}function ql(n){return typeof n=="function"}function XO(n){return typeof n=="boolean"}function YO(n){return n&&ql(n.canLoad)}function KO(n){return n&&ql(n.canActivate)}function QO(n){return n&&ql(n.canActivateChild)}function ZO(n){return n&&ql(n.canDeactivate)}function JO(n){return n&&ql(n.canMatch)}function zA(n){return n instanceof Ei||n?.name==="EmptyError"}var qd=Symbol("INITIAL_VALUE");function xo(){return hr(n=>Ko(n.map(e=>e.pipe(Ai(1),Op(qd)))).pipe(Ze(e=>{for(let t of e)if(t!==!0){if(t===qd)return qd;if(t===!1||t instanceof vs)return t}return!0}),Wn(e=>e!==qd),Ai(1)))}function eL(n,e){return Pt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?Ie(Ke(ce({},t),{guardsResult:!0})):tL(a,r,i,n).pipe(Pt(o=>o&&XO(o)?nL(r,s,n,e):Ie(o)),Ze(o=>Ke(ce({},t),{guardsResult:o})))})}function tL(n,e,t,r){return _t(n).pipe(Pt(i=>oL(i.component,i.route,t,e,r)),Xr(i=>i!==!0,!0))}function nL(n,e,t,r){return _t(e).pipe(js(i=>$a(iL(i.route.parent,r),rL(i.route,r),aL(n,i.path,t),sL(n,i.route,t))),Xr(i=>i!==!0,!0))}function rL(n,e){return n!==null&&e&&e(new Om(n)),Ie(!0)}function iL(n,e){return n!==null&&e&&e(new Rm(n)),Ie(!0)}function sL(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Ie(!0);let i=r.map(s=>Tu(()=>{let a=Gl(e)??t,o=yo(s,a),l=KO(o)?o.canActivate(e,n):Ti(a,()=>o(e,n));return ys(l).pipe(Xr())}));return Ie(i).pipe(xo())}function aL(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>zO(a)).filter(a=>a!==null).map(a=>Tu(()=>{let o=a.guards.map(l=>{let u=Gl(a.node)??t,c=yo(l,u),d=QO(c)?c.canActivateChild(r,n):Ti(u,()=>c(r,n));return ys(d).pipe(Xr())});return Ie(o).pipe(xo())}));return Ie(s).pipe(xo())}function oL(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Ie(!0);let a=s.map(o=>{let l=Gl(e)??i,u=yo(o,l),c=ZO(u)?u.canDeactivate(n,e,t,r):Ti(l,()=>u(n,e,t,r));return ys(c).pipe(Xr())});return Ie(a).pipe(xo())}function lL(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return Ie(!0);let s=i.map(a=>{let o=yo(a,n),l=YO(o)?o.canLoad(e,t):Ti(n,()=>o(e,t));return ys(l)});return Ie(s).pipe(xo(),GA(r))}function GA(n){return Cp(hn(e=>{if(vo(e))throw HA(n,e)}),Ze(e=>e===!0))}function cL(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return Ie(!0);let s=i.map(a=>{let o=yo(a,n),l=JO(o)?o.canMatch(e,t):Ti(n,()=>o(e,t));return ys(l)});return Ie(s).pipe(xo(),GA(r))}var Ul=class{constructor(e){this.segmentGroup=e||null}},of=class extends Error{constructor(e){super(),this.urlTree=e}};function fo(n){return ja(new Ul(n))}function uL(n){return ja(new be(4e3,!1))}function dL(n){return ja($A(!1,sr.GuardRejected))}var Wm=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Ie(r);if(i.numberOfChildren>1||!i.children[Ue])return uL(e.redirectTo);i=i.children[Ue]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new of(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new vs(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let o=s.substring(1);r[i]=t[o]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([o,l])=>{a[o]=this.createSegmentGroup(e,l,r,i)}),new ft(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new be(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},zm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function fL(n,e,t,r,i){let s=Jm(n,e,t);return s.matched?(r=UO(e,r),cL(r,e,t,i).pipe(Ze(a=>a===!0?s:ce({},zm)))):Ie(s)}function Jm(n,e,t){if(e.path==="**")return hL(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?ce({},zm):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||cO)(t,n,e);if(!i)return ce({},zm);let s={};Object.entries(i.posParams??{}).forEach(([o,l])=>{s[o]=l.path});let a=i.consumed.length>0?ce(ce({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function hL(n){return{matched:!0,parameters:n.length>0?CA(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function wA(n,e,t,r){return t.length>0&&mL(n,t,r)?{segmentGroup:new ft(e,gL(r,new ft(t,n.children))),slicedSegments:[]}:t.length===0&&vL(n,t,r)?{segmentGroup:new ft(n.segments,pL(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ft(n.segments,n.children),slicedSegments:t}}function pL(n,e,t,r){let i={};for(let s of t)if(uf(n,e,s)&&!r[li(s)]){let a=new ft([],{});i[li(s)]=a}return ce(ce({},r),i)}function gL(n,e){let t={};t[Ue]=e;for(let r of n)if(r.path===""&&li(r)!==Ue){let i=new ft([],{});t[li(r)]=i}return t}function mL(n,e,t){return t.some(r=>uf(n,e,r)&&li(r)!==Ue)}function vL(n,e,t){return t.some(r=>uf(n,e,r))}function uf(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function _L(n,e,t,r){return li(n)!==r&&(r===Ue||!uf(e,t,n))?!1:Jm(e,n,t).matched}function xL(n,e,t){return e.length===0&&!n.children[t]}var Gm=class{};function yL(n,e,t,r,i,s,a="emptyOnly"){return new qm(n,e,t,r,i,a,s).recognize()}var wL=31,qm=class{constructor(e,t,r,i,s,a,o){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=o,this.applyRedirects=new Wm(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new be(4002,`'${e.segmentGroup}'`)}recognize(){let e=wA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Ze(t=>{let r=new Vl([],Object.freeze({}),Object.freeze(ce({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ue,this.rootComponentType,null,{}),i=new ir(r,t),s=new sf("",i),a=DO(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Ue).pipe(rs(r=>{if(r instanceof of)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Ul?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=Ym(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(Ze(s=>s instanceof ir?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return _t(i).pipe(js(s=>{let a=r.children[s],o=HO(t,s);return this.processSegmentGroup(e,o,a,s)}),Np((s,a)=>(s.push(...a),s)),is(null),Rp(),Pt(s=>{if(s===null)return fo(r);let a=qA(s);return bL(a),Ie(a)}))}processSegment(e,t,r,i,s,a){return _t(t).pipe(js(o=>this.processSegmentAgainstRoute(o._injector??e,t,o,r,i,s,a).pipe(rs(l=>{if(l instanceof Ul)return Ie(null);throw l}))),Xr(o=>!!o),rs(o=>{if(zA(o))return xL(r,i,s)?Ie(new Gm):fo(r);throw o}))}processSegmentAgainstRoute(e,t,r,i,s,a,o){return _L(r,i,s,a)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a):this.allowRedirects&&o?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a):fo(i):fo(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a){let{matched:o,consumedSegments:l,positionalParamSegments:u,remainingSegments:c}=Jm(t,i,s);if(!o)return fo(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>wL&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(Pt(f=>this.processSegment(e,r,t,f.concat(c),a,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let a=fL(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(hr(o=>o.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(hr(({routes:l})=>{let u=r._loadedInjector??e,{consumedSegments:c,remainingSegments:d,parameters:f}=o,h=new Vl(c,f,Object.freeze(ce({},this.urlTree.queryParams)),this.urlTree.fragment,AL(r),li(r),r.component??r._loadedComponent??null,r,CL(r)),{segmentGroup:p,slicedSegments:g}=wA(t,c,d,l);if(g.length===0&&p.hasChildren())return this.processChildren(u,l,p).pipe(Ze(v=>v===null?null:new ir(h,v)));if(l.length===0&&g.length===0)return Ie(new ir(h,[]));let m=li(r)===s;return this.processSegment(u,l,p,g,m?Ue:s,!0).pipe(Ze(v=>new ir(h,v instanceof ir?[v]:[])))}))):fo(t)))}getChildConfig(e,t,r){return t.children?Ie({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Ie({routes:t._loadedRoutes,injector:t._loadedInjector}):lL(e,t,r,this.urlSerializer).pipe(Pt(i=>i?this.configLoader.loadChildren(e,t).pipe(hn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):dL(t))):Ie({routes:[],injector:e})}};function bL(n){n.sort((e,t)=>e.value.outlet===Ue?-1:t.value.outlet===Ue?1:e.value.outlet.localeCompare(t.value.outlet))}function EL(n){let e=n.value.routeConfig;return e&&e.path===""}function qA(n){let e=[],t=new Set;for(let r of n){if(!EL(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=qA(r.children);e.push(new ir(r.value,i))}return e.filter(r=>!t.has(r))}function AL(n){return n.data||{}}function CL(n){return n.resolve||{}}function SL(n,e,t,r,i,s){return Pt(a=>yL(n,e,t,r,a.extractedUrl,i,s).pipe(Ze(({state:o,tree:l})=>Ke(ce({},a),{targetSnapshot:o,urlAfterRedirects:l}))))}function TL(n,e){return Pt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Ie(t);let s=new Set(i.map(l=>l.route)),a=new Set;for(let l of s)if(!a.has(l))for(let u of XA(l))a.add(u);let o=0;return _t(a).pipe(js(l=>s.has(l)?DL(l,r,n,e):(l.data=Ym(l,l.parent,n).resolve,Ie(void 0))),hn(()=>o++),Wa(1),Pt(l=>o===a.size?Ie(t):er))})}function XA(n){let e=n.children.map(t=>XA(t)).flat();return[n,...e]}function DL(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!jA(i)&&(s[$l]=i.title),IL(s,n,e,r).pipe(Ze(a=>(n._resolvedData=a,n.data=Ym(n,n.parent,t).resolve,null)))}function IL(n,e,t,r){let i=Am(n);if(i.length===0)return Ie({});let s={};return _t(i).pipe(Pt(a=>kL(n[a],e,t,r).pipe(Xr(),hn(o=>{s[a]=o}))),Wa(1),Pp(s),rs(a=>zA(a)?er:ja(a)))}function kL(n,e,t,r){let i=Gl(e)??r,s=yo(n,i),a=s.resolve?s.resolve(e,t):Ti(i,()=>s(e,t));return ys(a)}function bm(n){return hr(e=>{let t=n(e);return t?_t(t).pipe(Ze(()=>e)):Ie(e)})}var YA=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Ue);return r}getResolvedTitleForRoute(t){return t.data[$l]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(ML),providedIn:"root"})}}return n})(),ML=(()=>{class n extends YA{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Ne(pA))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Xl=new Fe("",{providedIn:"root",factory:()=>({})}),Hl=new Fe(""),ev=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ve(Bd)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ie(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=ys(t.loadComponent()).pipe(Ze(KA),hn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Qo(()=>{this.componentLoaders.delete(t)})),i=new La(r,()=>new on).pipe(Oa());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Ie({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=FL(r,this.compiler,t,this.onLoadEndListener).pipe(Qo(()=>{this.childrenLoaders.delete(r)})),a=new La(s,()=>new on).pipe(Oa());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function FL(n,e,t,r){return ys(n.loadChildren()).pipe(Ze(KA),Pt(i=>i instanceof ol||Array.isArray(i)?Ie(i):_t(e.compileModuleAsync(i))),Ze(i=>{r&&r(n);let s,a,o=!1;return Array.isArray(i)?(a=i,o=!0):(s=i.create(t).injector,a=s.get(Hl,[],{optional:!0,self:!0}).flat()),{routes:a.map(Zm),injector:s}}))}function PL(n){return n&&typeof n=="object"&&"default"in n}function KA(n){return PL(n)?n.default:n}var tv=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(RL),providedIn:"root"})}}return n})(),RL=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),QA=new Fe(""),ZA=new Fe("");function NL(n,e,t){let r=n.get(ZA),i=n.get(Nn);return n.get(At).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s,a=new Promise(u=>{s=u}),o=i.startViewTransition(()=>(s(),OL(n))),{onViewTransitionCreated:l}=r;return l&&Ti(n,()=>l({transition:o,from:e,to:t})),a})}function OL(n){return new Promise(e=>{Cd(e,{injector:n})})}var nv=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new on,this.transitionAbortSubject=new on,this.configLoader=ve(ev),this.environmentInjector=ve(Gn),this.urlSerializer=ve(Wl),this.rootContexts=ve(zl),this.location=ve(co),this.inputBindingEnabled=ve(cf,{optional:!0})!==null,this.titleStrategy=ve(YA),this.options=ve(Xl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ve(tv),this.createViewTransition=ve(QA,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ie(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Fm(i)),r=i=>this.events.next(new Pm(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Ke(ce(ce({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new fn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Fl,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Wn(s=>s.id!==0),Ze(s=>Ke(ce({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),hr(s=>{let a=!1,o=!1;return Ie(s).pipe(hr(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",sr.SupersededByNewNavigation),er;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Ke(ce({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&c!=="reload"){let d="";return this.events.next(new xs(l.id,this.urlSerializer.serialize(l.rawUrl),d,Jd.IgnoredSameUrlNavigation)),l.resolve(null),er}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Ie(l).pipe(hr(d=>{let f=this.transitions?.getValue();return this.events.next(new _o(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions?.getValue()?er:Promise.resolve(d)}),SL(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),hn(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=Ke(ce({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let f=new ef(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:f,source:h,restoredState:p,extras:g}=l,m=new _o(d,this.urlSerializer.serialize(f),h,p);this.events.next(m);let v=BA(this.rootComponentType).snapshot;return this.currentTransition=s=Ke(ce({},l),{targetSnapshot:v,urlAfterRedirects:f,extras:Ke(ce({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,Ie(s)}else{let d="";return this.events.next(new xs(l.id,this.urlSerializer.serialize(l.extractedUrl),d,Jd.IgnoredByUrlHandlingStrategy)),l.resolve(null),er}}),hn(l=>{let u=new Dm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),Ze(l=>(this.currentTransition=s=Ke(ce({},l),{guards:WO(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),eL(this.environmentInjector,l=>this.events.next(l)),hn(l=>{if(s.guardsResult=l.guardsResult,vo(l.guardsResult))throw HA(this.urlSerializer,l.guardsResult);let u=new Im(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Wn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",sr.GuardRejected),!1)),bm(l=>{if(l.guards.canActivateChecks.length)return Ie(l).pipe(hn(u=>{let c=new km(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),hr(u=>{let c=!1;return Ie(u).pipe(TL(this.paramsInheritanceStrategy,this.environmentInjector),hn({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(u,"",sr.NoDataFromResolver)}}))}),hn(u=>{let c=new Mm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}))}),bm(l=>{let u=c=>{let d=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(c.routeConfig).pipe(hn(f=>{c.component=f}),Ze(()=>{})));for(let f of c.children)d.push(...u(f));return d};return Ko(u(l.targetSnapshot.root)).pipe(is(null),Ai(1))}),bm(()=>this.afterPreactivation()),hr(()=>{let{currentSnapshot:l,targetSnapshot:u}=s,c=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return c?_t(c).pipe(Ze(()=>s)):Ie(s)}),Ze(l=>{let u=OO(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=Ke(ce({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),hn(()=>{this.events.next(new Ll)}),$O(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ai(1),hn({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ai(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),xt(this.transitionAbortSubject.pipe(hn(l=>{throw l}))),Qo(()=>{!a&&!o&&this.cancelNavigationTransition(s,"",sr.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),rs(l=>{if(o=!0,WA(l))this.events.next(new _s(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),VO(l)?this.events.next(new Bl(l.url)):s.resolve(!1);else{this.events.next(new Ol(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return er}))}))}cancelNavigationTransition(t,r,i){let s=new _s(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function LL(n){return n!==Fl}var BL=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(VL),providedIn:"root"})}}return n})(),Xm=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},VL=(()=>{class n extends Xm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ao(n)))(i||n)}})()}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),JA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:()=>ve(jL),providedIn:"root"})}}return n})(),jL=(()=>{class n extends JA{constructor(){super(...arguments),this.location=ve(co),this.urlSerializer=ve(Wl),this.options=ve(Xl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ve(tv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new vs,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=BA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof _o)this.stateMemento=this.createStateMemento();else if(t instanceof xs)this.rawUrlTree=r.initialUrl;else if(t instanceof ef){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(i,r)}}else t instanceof Ll?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):t instanceof _s&&(t.code===sr.GuardRejected||t.code===sr.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ol?this.restoreHistory(r,!0):t instanceof ai&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,a=ce(ce({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",a)}else{let s=ce(ce({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ao(n)))(i||n)}})()}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),kl=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(kl||{});function eC(n,e){n.events.pipe(Wn(t=>t instanceof ai||t instanceof _s||t instanceof Ol||t instanceof xs),Ze(t=>t instanceof ai||t instanceof xs?kl.COMPLETE:(t instanceof _s?t.code===sr.Redirect||t.code===sr.SupersededByNewNavigation:!1)?kl.REDIRECTING:kl.FAILED),Wn(t=>t!==kl.REDIRECTING),Ai(1)).subscribe(()=>{e()})}function UL(n){throw n}var HL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},$L={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Or=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=ve(Nd),this.stateManager=ve(JA),this.options=ve(Xl,{optional:!0})||{},this.pendingTasks=ve(Td),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ve(nv),this.urlSerializer=ve(Wl),this.location=ve(co),this.urlHandlingStrategy=ve(tv),this._events=new on,this.errorHandler=this.options.errorHandler||UL,this.navigated=!1,this.routeReuseStrategy=ve(BL),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ve(Hl,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ve(cf,{optional:!0}),this.eventsSubscription=new jt,this.isNgZoneEnabled=ve(At)instanceof At&&At.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof _s&&r.code!==sr.Redirect&&r.code!==sr.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ai)this.navigated=!0;else if(r instanceof Bl){let a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),o={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||LL(i.source)};this.scheduleNavigation(a,Fl,null,o,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}zL(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Fl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let l=ce({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let o=this.parseUrl(t);this.scheduleNavigation(o,r,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Zm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:o,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a,c=null;switch(o){case"merge":c=ce(ce({},this.currentUrlTree.queryParams),s);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=s||null}c!==null&&(c=this.removeEmptyProps(c));let d;try{let f=i?i.snapshot:this.routerState.snapshot.root;d=RA(f)}catch{(typeof t[0]!="string"||!t[0].startsWith("/"))&&(t=[]),d=this.currentUrlTree.root}return NA(d,t,c,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=vo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Fl,null,r)}navigate(t,r={skipLocationChange:!1}){return WL(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=ce({},HL):r===!1?i=ce({},$L):i=r,vo(t))return mA(this.currentUrlTree,t,i);let s=this.parseUrl(t);return mA(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,a){if(this.disposed)return Promise.resolve(!1);let o,l,u;a?(o=a.resolve,l=a.reject,u=a.promise):u=new Promise((d,f)=>{o=d,l=f});let c=this.pendingTasks.add();return eC(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(c))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:o,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(d=>Promise.reject(d))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function WL(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new be(4008,!1)}function zL(n){return!(n instanceof Ll)&&!(n instanceof Bl)}var tC=(()=>{class n{constructor(t,r,i,s,a,o){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=a,this.locationStrategy=o,this.href=null,this.commands=null,this.onChanges=new on,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof ai&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t!=null?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,s,a){let o=this.urlTree;if(o===null||this.isAnchorElement&&(t!==0||r||i||s||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(o,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Wb(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||n)(Ce(Or),Ce(oi),bg("tabindex"),Ce(Ri),Ce(Rn),Ce(Nr))}}static{this.\u0275dir=tn({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&dt("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&ml("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[gt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ms],skipLocationChange:[gt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ms],replaceUrl:[gt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ms],routerLink:"routerLink"},standalone:!0,features:[Wg,ii]})}}return n})();var lf=class{};var GL=(()=>{class n{constructor(t,r,i,s,a){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Wn(t=>t instanceof ai),js(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Sd(s.providers,t,`Route: ${s.path}`));let a=s._injector??t,o=s._loadedInjector??a;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(a,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(o,s.children??s._loadedRoutes))}return _t(i).pipe(Ha())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=Ie(null);let s=i.pipe(Pt(a=>a===null?Ie(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??t,a.routes))));if(r.loadComponent&&!r._loadedComponent){let a=this.loader.loadComponent(r);return _t([s,a]).pipe(Ha())}else return s})}static{this.\u0275fac=function(r){return new(r||n)(Ne(Or),Ne(Bd),Ne(Gn),Ne(lf),Ne(ev))}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),nC=new Fe(""),qL=(()=>{class n{constructor(t,r,i,s,a={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=ve(Gn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof _o?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ai?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof xs&&t.code===Jd.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof tf&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>ee(this,null,function*(){yield new Promise(i=>{setTimeout(()=>{i()}),Cd(()=>{i()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new tf(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){tE()}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac})}}return n})();function rC(n,...e){return ud([{provide:Hl,multi:!0,useValue:n},[],{provide:oi,useFactory:iC,deps:[Or]},{provide:Ld,multi:!0,useFactory:sC},e.map(t=>t.\u0275providers)])}function iC(n){return n.routerState.root}function Yl(n,e){return{\u0275kind:n,\u0275providers:e}}function sC(){let n=ve(ki);return e=>{let t=n.get(bl);if(e!==t.components[0])return;let r=n.get(Or),i=n.get(aC);n.get(rv)===1&&r.initialNavigation(),n.get(oC,null,Xe.Optional)?.setUpPreloading(),n.get(nC,null,Xe.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var aC=new Fe("",{factory:()=>new on}),rv=new Fe("",{providedIn:"root",factory:()=>1});function XL(){return Yl(2,[{provide:rv,useValue:0},{provide:Od,multi:!0,deps:[ki],useFactory:e=>{let t=e.get(QE,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Or),s=e.get(aC);eC(i,()=>{r(!0)}),e.get(nv).afterPreactivation=()=>(r(!0),s.closed?Ie(void 0):s),i.initialNavigation()}))}}])}function YL(){return Yl(3,[{provide:Od,multi:!0,useFactory:()=>{let e=ve(Or);return()=>{e.setUpLocationChangeListener()}}},{provide:rv,useValue:2}])}var oC=new Fe("");function KL(n){return Yl(0,[{provide:oC,useExisting:GL},{provide:lf,useExisting:n}])}function QL(){return Yl(8,[yA,{provide:cf,useExisting:yA}])}function ZL(n){let e=[{provide:QA,useValue:NL},{provide:ZA,useValue:ce({skipNextTransition:!!n?.skipInitialTransition},n)}];return Yl(9,e)}var bA=new Fe("ROUTER_FORROOT_GUARD"),JL=[co,{provide:Wl,useClass:Rl},Or,zl,{provide:oi,useFactory:iC,deps:[Or]},ev,[]],lC=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[JL,[],{provide:Hl,multi:!0,useValue:t},{provide:bA,useFactory:r4,deps:[[Or,new dl,new cd]]},{provide:Xl,useValue:r||{}},r?.useHash?t4():n4(),e4(),r?.preloadingStrategy?KL(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?i4(r):[],r?.bindToComponentInputs?QL().\u0275providers:[],r?.enableViewTransitions?ZL().\u0275providers:[],s4()]}}static forChild(t){return{ngModule:n,providers:[{provide:Hl,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(Ne(bA,8))}}static{this.\u0275mod=ri({type:n})}static{this.\u0275inj=ni({})}}return n})();function e4(){return{provide:nC,useFactory:()=>{let n=ve(sA),e=ve(At),t=ve(Xl),r=ve(nv),i=ve(Wl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new qL(i,r,n,e,t)}}}function t4(){return{provide:Nr,useClass:$d}}function n4(){return{provide:Nr,useClass:lm}}function r4(n){return"guarded"}function i4(n){return[n.initialNavigation==="disabled"?YL().\u0275providers:[],n.initialNavigation==="enabledBlocking"?XL().\u0275providers:[]]}var EA=new Fe("");function s4(){return[{provide:EA,useFactory:sC},{provide:Ld,multi:!0,useExisting:EA}]}var uC=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-myfooter"]],standalone:!0,features:[Ve],decls:9,vars:0,consts:[[1,"bg-light"],[1,"text-center","p-2","z-index:","-1;",2,"background-color","rgba(0, 0, 0, 0.2)","width","100%","height","40px","vertical-align","text-top"],[1,"text-dark"],[1,"text-primary"]],template:function(r,i){r&1&&(B(0,"footer",0)(1,"div",1)(2,"p",2),q(3," \xA9 2025 Webmaster: "),B(4,"span",3),q(5," Remy Miantezila "),V(),q(6," Contact:"),B(7,"span",3),q(8," banabalukala@gmail.com"),V()()()())}})}}return n})();var ws=(()=>{class n{constructor(){this.bigPictures=[{name:"L\xE9opold Ngoma",role:"Pr\xE9sident , ",location:"Angleterre",imageUrl:"assets/images/dirigeants/LeopoldNgoma.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Pierre Matondo Nzingu",role:"Vice-Pr\xE9sident Afrique , ",location:"DR Congo",imageUrl:"assets/images/dirigeants/JuniorNzingu1.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Antoine Dede Kavungu",role:"Vice-Pr\xE9sident Europe , ",location:"France",imageUrl:"assets/images/dirigeants/DedeKavunguUpdate.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Gerry Mabiala",role:"Vice-Pr\xE9sident Amerique , ",location:"\xC9tats-Unis",imageUrl:"assets/images/dirigeants/GerryMabiala.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"R\xE9my Miantezila",role:"Conseiller , Webmaster ; ",location:"\xC9tats-Unis",imageUrl:"assets/images/Remy_Cravate2.jpg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"Software Engineer",message:"Sending love to all of you!",LinkedIn:"https://www.linkedin.com/in/remy-miantezila-miabwa/"},{name:"Eugenie Malayi",role:"Tr\xE9sori\xE8re , ",location:"Canada",imageUrl:"assets/images/dirigeants/EugenieMalayi2.jpg",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Pascal Mieluzeyi",role:"Secr\xE9taire , ",location:"Canada",imageUrl:"assets/images/dirigeants/Pascal5Mieluzeyi.jpg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Daniel Meboya",role:"Coordonnateur  , ",location:"Ouganda",imageUrl:"assets/images/dirigeants/DanielMeboya2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Germaine Nsenga",role:"",location:"France",imageUrl:"assets/images/NsengaGermaine.jpeg",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Josky Wasukama ",role:"Conseiller , ",location:"France",imageUrl:"assets/images/dirigeants/MasukalaJosky2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Coco Mitouche",role:"Commissaire aux comptes , ",location:"France",imageUrl:"assets/images/dirigeants/Mitouche2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Niko J T Bubuzi",role:"Conseiller , ",location:"France",imageUrl:"assets/images/dirigeants/NicoBubuzi.jpg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Mathieu Tusalamo Mfumu Buala",role:"Conseiller , ",location:"Belgique",imageUrl:"assets/images/dirigeants/MathewTusalamo2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Simon Sakade Nsakala",role:"Avocat , ",location:"DR Congo",imageUrl:"assets/images/dirigeants/Simon_Sakade_Nsakala2.jpg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Dally Mvemba",role:"Conseiller",location:"France",imageUrl:"assets/images/dirigeants/MvembaDally.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Ais\xE9 Ngeyitala ",role:"",location:"\xC9tats-Unis",imageUrl:"assets/images/membres/AiseMiantezila.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Marcelline Mboyi",role:"",location:"Angletere",imageUrl:"assets/images/membres/Marceline1Mboyi.jpg",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Shay Nlandu",role:"",location:"Angola",imageUrl:"assets/images/membres/Nlandu_Shay2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Silumpunisa Baron Luyituku",role:"",location:"DR Congo",imageUrl:"assets/images/membres/Silumpunisa1.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Jean Marc Simbi",role:"",location:"\xC9tats-Unis",imageUrl:"assets/images/membres/JeanMarcSimbi.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Jason Tamba",role:"",location:"\xC9tats-Unis",imageUrl:"assets/images/membres/JasonTamba.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Jos\xE9 Nzayambela",role:"",location:"France",imageUrl:"assets/images/membres/JosyNzayambela.jpeg",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Jean Pierre Miankodila",role:"",location:"\xC9tats-Unis",imageUrl:"assets/images/membres/JPMinkodila.jpeg",gender:1,defaultImage:"assets/images/JPMinkodila.jpeg",profession:"",message:"",LinkedIn:""},{name:"Samuel Mankuika",role:"",location:"DR Congo",imageUrl:"assets/images/membres/SaintMankuika.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Massonet Massongele",role:"",location:"DR Congo",imageUrl:"assets/images/membres/MassongeleMasonnet2.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"R\xE9ne Mamingi",role:"",location:"DR Congo",imageUrl:"assets/images/membres/ReneMamingi.jpeg",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Fidele Menavanza",role:"",location:"\xC9tats-Unis",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Cl\xE9mentine Buaka",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Constant Lutonda",role:"",location:"Br\xE9sil",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Darry",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Houmba Dezai N'Accompa",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Dieu Kindomba",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Donat Bitazi",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Emma Kindomba",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Mamie Kindomba",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Nicole DUZE",role:"",location:"Angleterre",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Felicien Kindomba",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Fran\xE7oise Mankuika",role:"",location:"Angleterre",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Gina Kiaku ",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Justin Kulabuna",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Lipasa Olivier",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Luza Charlotte",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Charlotte Nsongo",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Malu",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Marie Landu",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Fuakuingi Every",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Niorra Ntonzi",role:"",location:"Canada",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Nzuzi Mvula",role:"",location:"Allemagne",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Piff Bitazi",role:"",location:"Angleterre",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Constance Nsungi Matondo",role:"",location:"\xC9tats-Unis",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Rose Mankuika",role:"",location:"Angletere",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Soukouma Lipasa",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Valentin Kitemoko ",role:"",location:"Allemagne",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Willy Mieluzeye",role:"",location:"Irlande",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Zoumack Mafuila",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Nicole",role:"",location:"Angleterre",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Adrien Ngudiankama",role:"",location:"\xC9tats-Unis",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Alex Diandimba",role:"",location:"Canada",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Alpha Nsimba",role:"",location:"Allemagne",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Ars\xE8ne Mpulusu",role:"",location:"Angleterre",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Bona Kiaku",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Bulay",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Glody Ngeyitala ",role:"",location:"\xC9tats-Unis",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Edo Makobokele",role:"",location:"France",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Ma Maguy",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Teresa Maria Kindomba",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Anaclet Masamba",role:"",location:"DR Congo",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Rachel Bakala",role:"",location:"France",imageUrl:"",gender:0,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""},{name:"Mo\xEFse Fuakuingi",role:"",location:"Angleterre",imageUrl:"",gender:1,defaultImage:"assets/images/Remy_Cravate1.jpg",profession:"",message:"",LinkedIn:""}]}getBigPictures(){return this.bigPictures}searchBigPictureByName(t){let r=this.bigPictures.filter(i=>i.name.toLowerCase().includes(t.toLowerCase().trim()));return Ie(r)}getBigPictureByName(t){let r=this.bigPictures.filter(i=>i.name.toLowerCase().includes(t.toLowerCase().trim()));return r.length!=0?r:this.lookAgain(this.bigPictures,t)}lookAgain(t,r){let i=[];for(let s of t)this.isSubstringWithTolerance(r.toLowerCase().trim(),s.name.toLowerCase().trim())&&i.push(s);return i}getBigPictureByIndex(t){return this.bigPictures[t]}isSubstringWithTolerance(t,r){function i(a,o){if(a.length!==o.length)return!1;let l=0;for(let u=0;u<a.length;u++)if(a[u]!==o[u]&&(l++,l>1))return!1;return l===1}let s=r.split(" ");for(let a of s)if(a===t||i(a,t))return!0;return!1}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Se({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function a4(n,e){if(n&1&&re(0,"img",26),n&2){let t=ot().$implicit;na("alt",t.name),Z("src",t.imageUrl,rr)}}function o4(n,e){if(n&1&&re(0,"img",27),n&2){let t=ot().$implicit;na("alt",t.name),Z("src",t.defaultImage,rr)}}function l4(n,e){if(n&1){let t=lo();B(0,"div",20),dt("click",function(){let i=fs(t).$implicit,s=ot();return hs(s.openPicture(i))}),zt(1,a4,1,2,"img",21)(2,o4,1,2,"ng-template",null,0,Rd),B(4,"div",22)(5,"h3",23),q(6),V(),B(7,"p",24),q(8),B(9,"span",25),q(10),V()()()()}if(n&2){let t=e.$implicit,r=Md(3);ne(),Z("ngIf",t.imageUrl)("ngIfElse",r),ne(5),Tt(t.name),ne(2),Rr("",t.role," "),ne(2),Rr(" ",t.location,"")}}var ff=(()=>{class n{constructor(t){this.pictureService=t,this.pictures=[],this.modalPicture="",this.personName="",this.message=""}ngOnInit(){this.pictures=this.pictureService.getBigPictures(),this.getMemberPicture(this.pictures)}getMemberPicture(t){let r=[];for(let i=0;i<t.length;i++)t[i].role&&r.push(t[i]);for(let i=0;i<t.length;i++)t[i].role||r.push(t[i]);this.pictures=r}openPicture(t){let r=document.getElementById("myModal");this.modalPicture=t.imageUrl,this.personName=t.name,this.message=t.message,r!=null&&(r.style.display="block")}CloseModel(){let t=document.getElementById("myModal");t!=null&&(t.style.display="none")}static{this.\u0275fac=function(r){return new(r||n)(Ce(ws))}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-others-members"]],standalone:!0,features:[Ve],decls:26,vars:4,consts:[["defaultImage",""],[1,"slider-container","justify-content-center"],[1,"controls",2,"margin-top","5px","margin-bottom","60px"],[1,"picture-grid",2,"width","95%","margin-left","1%","margin-right","1%","height","800px","overflow-y","auto"],["class","picture-card","data-bs-toggle","modal","data-bs-target","#myModal",3,"click",4,"ngFor","ngForOf"],["id","myModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container","mt-5"],[1,"row","align-items-center"],[1,"col-md-6"],["alt","Sample Image",1,"img-fluid","rounded",3,"src"],[1,"mb-3","mycontainer"],[2,"text-align","center"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],["data-bs-toggle","modal","data-bs-target","#myModal",1,"picture-card",3,"click"],["style","width: 250px; height: 300px;",3,"src","alt",4,"ngIf","ngIfElse"],[1,"info"],[2,"color","blue"],[2,"color","green"],[2,"color","rgb(255, 119, 0)"],[2,"width","250px","height","300px",3,"src","alt"],[2,"width","250px","height","300px","filter","blur(30px)",3,"src","alt"]],template:function(r,i){r&1&&(B(0,"div",1)(1,"div",2)(2,"div",3),zt(3,l4,11,5,"div",4),V()(),B(4,"div",5)(5,"div",6)(6,"div",7)(7,"div",8)(8,"h4",9),q(9),V(),B(10,"button",10),dt("click",function(){return i.CloseModel()}),V()(),B(11,"div",11)(12,"div",12)(13,"div",13)(14,"div",14),re(15,"img",15),V(),B(16,"div",14)(17,"div")(18,"h4",16),q(19,"\xC0 propos de moi"),V(),B(20,"div",17)(21,"p"),q(22),V()()()()()()(),B(23,"div",18)(24,"button",19),dt("click",function(){return i.CloseModel()}),q(25,"Close"),V()()()()()()),r&2&&(ne(3),Z("ngForOf",i.pictures),ne(6),Tt(i.personName),ne(6),Z("src",i.modalPicture,rr),ne(7),Rr(" ",i.message," "))},dependencies:[On,uo,mr],styles:[".slider-container[_ngcontent-%COMP%]{width:100%;margin:auto;text-align:center}.picture-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px}.picture-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:16px;border-radius:8px;text-align:center}.picture-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px}.info[_ngcontent-%COMP%]{margin-top:8px}.mycontainer[_ngcontent-%COMP%]{height:250px;border:1px solid transparent;padding-top:0;display:block}"]})}}return n})();function c4(n,e){if(n&1&&re(0,"img",26),n&2){let t=ot().$implicit;na("alt",t.name),Z("src",t.imageUrl,rr)}}function u4(n,e){if(n&1&&re(0,"img",27),n&2){let t=ot().$implicit;na("alt",t.name),Z("src",t.defaultImage,rr)}}function d4(n,e){if(n&1){let t=lo();B(0,"div",20),dt("click",function(){let i=fs(t).$implicit,s=ot();return hs(s.openPicture(i))}),zt(1,c4,1,2,"img",21)(2,u4,1,2,"ng-template",null,0,Rd),B(4,"div",22)(5,"h3",23),q(6),V(),B(7,"p",24),q(8),B(9,"span",25),q(10),V()()()()}if(n&2){let t=e.$implicit,r=Md(3);ne(),Z("ngIf",t.imageUrl)("ngIfElse",r),ne(5),Tt(t.name),ne(2),Rr("",t.role," "),ne(2),Rr(" ",t.location,"")}}var hf=(()=>{class n{constructor(t){this.pictureService=t,this.pictures=[],this.modalPicture="",this.personName="",this.message=""}ngOnInit(){this.pictures=this.pictureService.getBigPictures(),this.getDirigeantMemberPicture(this.pictures)}getDirigeantMemberPicture(t){this.pictures=t.filter(r=>r.role)}openPicture(t){let r=document.getElementById("myModal");this.modalPicture=t.imageUrl,this.personName=t.name,this.message=t.message,r!=null&&(r.style.display="block")}CloseModel(){let t=document.getElementById("myModal");t!=null&&(t.style.display="none")}static{this.\u0275fac=function(r){return new(r||n)(Ce(ws))}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-les-dirigeants"]],standalone:!0,features:[Ve],decls:26,vars:4,consts:[["defaultImage",""],[1,"slider-container","justify-content-center"],[1,"controls",2,"margin-top","5px","margin-bottom","60px"],[1,"picture-grid",2,"width","95%","margin-left","1%","margin-right","1%","height","800px","overflow-y","auto"],["class","picture-card","data-bs-toggle","modal","data-bs-target","#myModal",3,"click",4,"ngFor","ngForOf"],["id","myModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container","mt-5"],[1,"row","align-items-center"],[1,"col-md-6"],["alt","Sample Image",1,"img-fluid","rounded",3,"src"],[1,"mb-3","mycontainer"],[2,"text-align","center"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],["data-bs-toggle","modal","data-bs-target","#myModal",1,"picture-card",3,"click"],["style","width: 250px; height: 300px;",3,"src","alt",4,"ngIf","ngIfElse"],[1,"info"],[2,"color","blue"],[2,"color","green"],[2,"color","rgb(255, 119, 0)"],[2,"width","250px","height","300px",3,"src","alt"],[2,"width","250px","height","300px","filter","blur(30px)",3,"src","alt"]],template:function(r,i){r&1&&(B(0,"div",1)(1,"div",2)(2,"div",3),zt(3,d4,11,5,"div",4),V()(),B(4,"div",5)(5,"div",6)(6,"div",7)(7,"div",8)(8,"h4",9),q(9),V(),B(10,"button",10),dt("click",function(){return i.CloseModel()}),V()(),B(11,"div",11)(12,"div",12)(13,"div",13)(14,"div",14),re(15,"img",15),V(),B(16,"div",14)(17,"div")(18,"h4",16),q(19,"\xC0 propos de moi"),V(),B(20,"div",17)(21,"p"),q(22),V()()()()()()(),B(23,"div",18)(24,"button",19),dt("click",function(){return i.CloseModel()}),q(25,"Close"),V()()()()()()),r&2&&(ne(3),Z("ngForOf",i.pictures),ne(6),Tt(i.personName),ne(6),Z("src",i.modalPicture,rr),ne(7),Tt(i.message))},dependencies:[On,uo,mr],styles:[".slider-container[_ngcontent-%COMP%]{width:100%;margin:auto;text-align:center}.picture-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px}.picture-card[_ngcontent-%COMP%]{border:1px solid #ddd;padding:16px;border-radius:8px;text-align:center}.picture-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px}.info[_ngcontent-%COMP%]{margin-top:8px}.mycontainer[_ngcontent-%COMP%]{height:250px;border:1px solid transparent;padding-top:0;display:block}"]})}}return n})();var xC=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(Ce(Ri),Ce(Rn))}}static{this.\u0275dir=tn({type:n})}}return n})(),f4=(()=>{class n extends xC{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ao(n)))(i||n)}})()}static{this.\u0275dir=tn({type:n,features:[Ni]})}}return n})(),yC=new Fe("");var h4={provide:yC,useExisting:ea(()=>yf),multi:!0};function p4(){let n=Bi()?Bi().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var g4=new Fe(""),yf=(()=>{class n extends xC{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!p4())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(Ce(Ri),Ce(Rn),Ce(g4,8))}}static{this.\u0275dir=tn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&dt("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},features:[_l([h4]),Ni]})}}return n})();function m4(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var sv=new Fe(""),wC=new Fe("");function v4(n){return m4(n.value)?{required:!0}:null}function dC(n){return null}function bC(n){return n!=null}function EC(n){return ra(n)?_t(n):n}function AC(n){let e={};return n.forEach(t=>{e=t!=null?ce(ce({},e),t):e}),Object.keys(e).length===0?null:e}function CC(n,e){return e.map(t=>t(n))}function _4(n){return!n.validate}function SC(n){return n.map(e=>_4(e)?e:t=>e.validate(t))}function x4(n){if(!n)return null;let e=n.filter(bC);return e.length==0?null:function(t){return AC(CC(t,e))}}function av(n){return n!=null?x4(SC(n)):null}function y4(n){if(!n)return null;let e=n.filter(bC);return e.length==0?null:function(t){let r=CC(t,e).map(EC);return Mp(r).pipe(Ze(AC))}}function ov(n){return n!=null?y4(SC(n)):null}function fC(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function w4(n){return n._rawValidators}function b4(n){return n._rawAsyncValidators}function iv(n){return n?Array.isArray(n)?n:[n]:[]}function gf(n,e){return Array.isArray(n)?n.includes(e):n===e}function hC(n,e){let t=iv(e);return iv(n).forEach(i=>{gf(t,i)||t.push(i)}),t}function pC(n,e){return iv(e).filter(t=>!gf(n,t))}var mf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=av(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ov(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},bo=class extends mf{get formDirective(){return null}get path(){return null}},Jl=class extends mf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},vf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},E4={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},UJ=Ke(ce({},E4),{"[class.ng-submitted]":"isSubmitted"}),TC=(()=>{class n extends vf{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ce(Jl,2))}}static{this.\u0275dir=tn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Id("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ni]})}}return n})(),DC=(()=>{class n extends vf{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(Ce(bo,10))}}static{this.\u0275dir=tn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Id("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Ni]})}}return n})();var Kl="VALID",pf="INVALID",wo="PENDING",Ql="DISABLED";function IC(n){return(wf(n)?n.validators:n)||null}function A4(n){return Array.isArray(n)?av(n):n||null}function kC(n,e){return(wf(e)?e.asyncValidators:n)||null}function C4(n){return Array.isArray(n)?ov(n):n||null}function wf(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function S4(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new be(1e3,"");if(!r[t])throw new be(1001,"")}function T4(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new be(1002,"")})}var _f=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Kl}get invalid(){return this.status===pf}get pending(){return this.status==wo}get disabled(){return this.status===Ql}get enabled(){return this.status!==Ql}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(hC(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(hC(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(pC(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(pC(e,this._rawAsyncValidators))}hasValidator(e){return gf(this._rawValidators,e)}hasAsyncValidator(e){return gf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=wo,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ql,this.errors=null,this._forEachChild(r=>{r.disable(Ke(ce({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ke(ce({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Kl,this._forEachChild(r=>{r.enable(Ke(ce({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ke(ce({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Kl||this.status===wo)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ql:Kl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=wo,this._hasOwnPendingAsyncValidator=!0;let t=EC(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Et,this.statusChanges=new Et}_calculateStatus(){return this._allControlsDisabled()?Ql:this.errors?pf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(wo)?wo:this._anyControlsHaveStatus(pf)?pf:Kl}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){wf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=A4(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=C4(this._rawAsyncValidators)}},xf=class extends _f{constructor(e,t,r){super(IC(t),kC(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){T4(this,!0,e),Object.keys(e).forEach(r=>{S4(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var lv=new Fe("CallSetDisabledState",{providedIn:"root",factory:()=>cv}),cv="always";function D4(n,e){return[...e.path,n]}function MC(n,e,t=cv){FC(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),k4(n,e),F4(n,e),M4(n,e),I4(n,e)}function gC(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function I4(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function FC(n,e){let t=w4(n);e.validator!==null?n.setValidators(fC(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=b4(n);e.asyncValidator!==null?n.setAsyncValidators(fC(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();gC(e._rawValidators,i),gC(e._rawAsyncValidators,i)}function k4(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&PC(n,e)})}function M4(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&PC(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function PC(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function F4(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function P4(n,e){n==null,FC(n,e)}function R4(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function N4(n){return Object.getPrototypeOf(n.constructor)===f4}function O4(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function L4(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===yf?t=s:N4(s)?r=s:i=s}),i||r||t||null}var B4={provide:bo,useExisting:ea(()=>uv)},Zl=Promise.resolve(),uv=(()=>{class n extends bo{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Et,this.form=new xf({},av(t),ov(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Zl.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),MC(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Zl.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Zl.then(()=>{let r=this._findContainer(t.path),i=new xf({});P4(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Zl.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Zl.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,O4(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||n)(Ce(sv,10),Ce(wC,10),Ce(lv,8))}}static{this.\u0275dir=tn({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&dt("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[gt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[_l([B4]),Ni]})}}return n})();function mC(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function vC(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var V4=class extends _f{constructor(e=null,t,r){super(IC(t),kC(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),wf(t)&&(t.nonNullable||t.initialValueIsDefault)&&(vC(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){mC(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){mC(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){vC(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var j4={provide:Jl,useExisting:ea(()=>dv)},_C=Promise.resolve(),dv=(()=>{class n extends Jl{constructor(t,r,i,s,a,o){super(),this._changeDetectorRef=a,this.callSetDisabledState=o,this.control=new V4,this._registered=!1,this.name="",this.update=new Et,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=L4(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),R4(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){MC(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){_C.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&ms(r);_C.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?D4(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(Ce(bo,9),Ce(sv,10),Ce(wC,10),Ce(yC,10),Ce(ia,8),Ce(lv,8))}}static{this.\u0275dir=tn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[gt.None,"disabled","isDisabled"],model:[gt.None,"ngModel","model"],options:[gt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[_l([j4]),Ni,ii]})}}return n})(),RC=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=tn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})();var U4=(()=>{class n{constructor(){this._validator=dC}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):dC,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=tn({type:n,features:[ii]})}}return n})();var H4={provide:sv,useExisting:ea(()=>fv),multi:!0};var fv=(()=>{class n extends U4{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=ms,this.createValidator=t=>v4}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=ao(n)))(i||n)}})()}static{this.\u0275dir=tn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&ml("required",i._enabled?"":null)},inputs:{required:"required"},features:[_l([H4]),Ni]})}}return n})();var $4=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ri({type:n})}static{this.\u0275inj=ni({})}}return n})();var NC=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:lv,useValue:t.callSetDisabledState??cv}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ri({type:n})}static{this.\u0275inj=ni({imports:[$4]})}}return n})();var z4=()=>["/ASummerPlace","3ofmPuHBCCc"],G4=()=>["/Accident","31LxCq1DPDk"],q4=()=>["/CoastLine","b0i4h4ywO1w"],X4=()=>["/AinTNobody","rcAv1cGAeXE"],Y4=()=>["/VousLesFemmes","FWhwwSX3fEA"],K4=()=>["/CarelessWhisper","izGwDsrQ1eQ"],Q4=()=>["/WhenIseeYouAngain","3R878g-SppU"],Z4=()=>["/KissOfLife","MmOau-PMWJk"],J4=()=>["/Kinshasa","lzZz_yVZ9Y0"],e3=()=>["/LaVieEnRose","E5M7l_z93rg"],t3=()=>["/Carnavale","-A2Wwyuqa6g"],n3=()=>["/LikeALady","3jqHdZi3EYU"],r3=()=>["/WhatToKnow","r3Pr1_v7hsw"],i3=()=>["/SummerInCity","jpbK4tLQH_s"],s3=()=>["/PrendSoinDelle","hPZvuowFkx8"],a3=()=>["/Fideles","cqS-VrUEiHo"],o3=()=>["/Shiver","8VLnxe7BBq0"],l3=()=>["/OurDream","IQsbmLqNF1A"],c3=()=>["/Holiday","h4bP9tj_0Zk"],u3=()=>["/Fresh","sTJ1XwGDcA4"],d3=()=>["/TheFinest","iK0YkFOD18U"],f3=()=>["/SaturdayLove","efLcgUQmyT8"],h3=()=>["/Centi\xE8meDossier","gIfxaiLOjPQ"],p3=()=>["/Koukoulou","j8gCb6bKC44"],g3=()=>["/TokomaBaCamarade","m7N5ZvrsmjE"],m3=()=>["/Orgasy","ihmtjqUyFWQ"],v3=()=>["/PointFinal","ulznRM_QQPc"],_3=()=>["/NzotoMoko","Po0U1sF45S0"],x3=()=>["/Maya","e9cKkBGleGE"],y3=()=>["/Z\xE9roFaute","sDCoVhUilys"],w3=()=>["/Coucou","HZNKqR6C1cE"],b3=()=>["/Ngobila","ka-M15DX0Pw"],E3=()=>["/Ndaya","hNco9iib8nM"],A3=()=>["/FauteYaCommer\xE7ant","uUzK50qrITw"],C3=()=>["/Mukungu","zveJw24HErM"],S3=()=>["/Djino","xaGTNwnHqXM"],T3=()=>["/PesaPosition","iIwgqiSKGCk"],D3=()=>["/Mabele","RAnITiF0Fgc"],I3=()=>["/KaribouYaBintou","8kR_o9daD2I"],k3=()=>["/Deliya","YNuSZ3EUS10"],M3=()=>["/Kelya","-t6_DXt7jW8"],F3=()=>["/Mikolo","VpvDSz8skb8"],P3=()=>["/Longo","NzLK08ISCbU"],R3=()=>["/LembaLemba","l77Hw47dEDE"],N3=()=>["/BonbonSucr\xE9","snFPbHQoL7I"],O3=()=>["/Nzale","khl2e6to5Co"],L3=()=>["/Souvenir3","T9CPEkxsNxE"],B3=()=>["/Monzo","-njsS91vSac"],OC=(()=>{class n{constructor(t,r){this.pictureService=t,this.router=r,this.title="myDropDown-app",this.isSearchEnabled=!0,this.searchQuery="",this.searchResults=[],this.modalPicture="",this.message="",this.personName="",this.isModalOpen=!1,this.password="",this.validPassword="2025"}checkPassword(t){this.password===this.validPassword?(this.password="",this.isModalOpen=!1,this.router.navigate([t])):(alert("Invalid password!"),this.router.navigate(["#"]))}toggleSearch(t){this.isSearchEnabled=!0}onChildActivate(t){this.isSearchEnabled=t instanceof hf||t instanceof ff}onSearch(){this.searchQuery.trim()&&(this.searchResults=this.pictureService.getBigPictureByName(this.searchQuery.trim())),this.searchResults.length==0?(this.personName="Aucun nom trouv\xE9",this.modalPicture="",this.message=""):(this.modalPicture=this.searchResults[0].imageUrl,this.message=this.searchResults[0].message,this.personName=this.searchResults[0].name)}CloseModel(){let t=document.getElementById("myModal");t!=null&&(t.style.display="none")}ClosepassModel(){let t=document.getElementById("passwordModal");t!=null&&(t.style.display="none")}static{this.\u0275fac=function(r){return new(r||n)(Ce(ws),Ce(Or))}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-root"]],standalone:!0,features:[Ve],decls:362,vars:101,consts:[[2,"width","95%","margin","auto"],[1,"position-relative",2,"width","100%","height","200px"],[1,"p-5","text-center","bg-image","w-100","h-100","rounded-3",2,"background-image","url('assets/images/CantineVersion2.jpg')","background-repeat","no-repeat","background-size","cover","background-position","center","position","relative"],["src","assets/images/LogoLND.jpeg","alt","Example Image",1,"position-absolute","top-0","start-0",2,"width","20%","height","auto","max-width","200px","max-height","200px"],[1,"container"],[1,"row","justify-content-center"],[1,"col-8","text-white","text-center"],[1,"mb-3"],[1,"navbar","navbar-expand-lg","border-bottom","border-body",2,"width","100%","background-color","#e3f2fd"],[1,"container-fluid"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["aria-current","page","href","#/Accueil",1,"nav-link","active"],[1,"nav-item","dropdown"],["href","#","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle"],[1,"dropdown-menu"],["href","#/TousLesMembres",1,"dropdown-item"],[1,"dropdown-divider"],["href","#/Contact",1,"dropdown-item"],["href","#/Finance","data-bs-toggle","modal","data-bs-target","#passwordModal",1,"dropdown-item",3,"click"],["href","#/morgue",1,"dropdown-item"],["href","#/Fonctionnement",1,"dropdown-item"],["href","#/Viabilite",1,"dropdown-item"],["href","#/ROI",1,"dropdown-item"],["href","#/Intention",1,"dropdown-item"],["href","#/Notarie",1,"dropdown-item"],["href","#/Status",1,"dropdown-item"],["href","#/vueEnPlan",1,"dropdown-item"],["href","#/FicheDeProject1",1,"dropdown-item"],["href","#/PlanStrategique",1,"dropdown-item"],["href","#/Messages",1,"nav-link"],["href","#/N\xE9crologie",1,"nav-link"],[1,"dropdown-menu","scrollable-dropdown"],[1,"dropdown-item",3,"routerLink"],["href","#","id","loisirDropdown","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle"],["aria-labelledby","loisirDropdown",1,"dropdown-menu",2,"z-index","200"],["role","search",1,"d-flex","mx-auto",3,"ngSubmit"],["name","search","type","search","placeholder","Cherchez un nom","aria-label","Search","required","",1,"form-control","me-2",3,"ngModelChange","ngModel"],["type","submit","data-bs-toggle","modal","data-bs-target","#searchModal",1,"picture-card",3,"click"],[3,"activate"],["id","searchModal",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal",1,"btn-close",3,"click"],[1,"modal-body"],[1,"container","mt-5"],[1,"row","align-items-center"],[1,"col-md-6"],["alt","Sample Image",1,"img-fluid","rounded",3,"src"],[1,"mb-3","mycontainer"],[2,"text-align","center"],["id","passwordModal",1,"modal","fade"],["type","password","placeholder","Enter password",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click"],[1,"fixed-bottom",2,"width","95%","margin","auto"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"div")(2,"div",1)(3,"div",2),re(4,"img",3),B(5,"div",4)(6,"div",5)(7,"div",6)(8,"h1",7),q(9,"Lukala Ngangu D\xE9veloppement"),V()()()()()(),B(10,"div")(11,"nav",8)(12,"div",9)(13,"button",10),re(14,"span",11),V(),B(15,"div",12)(16,"ul",13)(17,"li",14)(18,"a",15),q(19,"Accueil"),V()(),B(20,"li",16)(21,"a",17),q(22," Membres "),V(),B(23,"ul",18)(24,"li")(25,"a",19),q(26,"Membres"),V()(),B(27,"li"),re(28,"hr",20),V(),B(29,"li")(30,"a",21),q(31,"Contact"),V()(),B(32,"li"),re(33,"hr",20),V(),B(34,"li")(35,"a",22),dt("click",function(){return i.isModalOpen=!0}),q(36,"Finance"),V()()()(),B(37,"li",16)(38,"a",17),q(39," Projects "),V(),B(40,"ul",18)(41,"li")(42,"a",23),q(43,"Morgue"),V()(),B(44,"li"),re(45,"hr",20),V()()(),B(46,"li",16)(47,"a",17),q(48," Documents "),V(),B(49,"ul",18)(50,"li")(51,"a",24),q(52,"Autorisation de Fonctionnement"),V()(),B(53,"li"),re(54,"hr",20),V(),B(55,"li")(56,"a",25),q(57,"Etat des lieux de viabilit\xE9"),V()(),B(58,"li"),re(59,"hr",20),V(),B(60,"li")(61,"a",26),q(62,"R\xE8glement d'ordre int\xE9rieur"),V()(),B(63,"li"),re(64,"hr",20),V(),B(65,"li")(66,"a",27),q(67,"D\xE9claration d'intention"),V()(),B(68,"li"),re(69,"hr",20),V(),B(70,"li")(71,"a",28),q(72,"Acte-Notarie"),V()(),B(73,"li"),re(74,"hr",20),V(),B(75,"li")(76,"a",29),q(77,"Projet de Status"),V()(),B(78,"li"),re(79,"hr",20),V(),B(80,"li")(81,"a",30),q(82,"Vue en plan cot\xE9 de la morgue"),V()(),B(83,"li"),re(84,"hr",20),V(),B(85,"li")(86,"a",31),q(87,"Fiche de project 1"),V()(),B(88,"li"),re(89,"hr",20),V(),B(90,"li")(91,"a",32),q(92,"Plan strategique 2025\u20132029"),V()()()(),B(93,"li",14)(94,"a",33),q(95,"Messages"),V()(),B(96,"li",14)(97,"a",34),q(98,"N\xE9crologie"),V()(),B(99,"li",16)(100,"a",17),q(101," World Music "),V(),B(102,"ul",35)(103,"li"),re(104,"hr",20),V(),B(105,"li")(106,"a",36),q(107,'Percy Faith: The Theme from "A Summer Place'),V()(),B(108,"li"),re(109,"hr",20),V(),B(110,"li")(111,"a",36),q(112,"Dieudonne Larose - Accident"),V()(),B(113,"li"),re(114,"hr",20),V(),B(115,"li")(116,"a",36),q(117,"Thomas Frinking: Coastline "),V()(),B(118,"li"),re(119,"hr",20),V(),B(120,"li")(121,"a",36),q(122,"Chaka Khan: Ain't Nobody "),V()(),re(123,"li"),B(124,"li"),re(125,"hr",20),V(),B(126,"li")(127,"a",36),q(128,"Julio Iglesias: Vous les femmes"),V()(),B(129,"li"),re(130,"hr",20),V(),B(131,"li")(132,"a",36),q(133,"George Michael: Careless Whisper"),V()(),B(134,"li"),re(135,"hr",20),V(),B(136,"li")(137,"a",36),q(138,"The Three Degrees: When Will I See You Again"),V()(),re(139,"li"),B(140,"li"),re(141,"hr",20),V(),B(142,"li")(143,"a",36),q(144,"Sade - Kiss Of Life"),V()(),B(145,"li"),re(146,"hr",20),V(),B(147,"li")(148,"a",36),q(149,"Francis Bebey: Bana ba Zaire"),V()(),B(150,"li"),re(151,"hr",20),V(),B(152,"li")(153,"a",36),q(154,"Grace Jones: La Vie En Rose"),V()(),B(155,"li"),re(156,"hr",20),V(),B(157,"li")(158,"a",36),q(159,"EL Negro Y RAY: Carnaval"),V()(),B(160,"li"),re(161,"hr",20),V(),B(162,"li")(163,"a",36),q(164,"The Temptations: Treat Her Like A Lady"),V()(),B(165,"li"),re(166,"hr",20),V(),B(167,"li")(168,"a",36),q(169,"Foreigner: I want to Know What Love Is"),V()(),B(170,"li"),re(171,"hr",20),V(),B(172,"li")(173,"a",36),q(174,"Quicy Jones: Summer In The City "),V()(),B(175,"li"),re(176,"hr",20),V(),B(177,"li")(178,"a",36),q(179,"Claude Barzotti: Prends bien soin d'elle "),V()(),B(180,"li"),re(181,"hr",20),V(),B(182,"li")(183,"a",36),q(184,"Julio Iglesias: Fideles "),V()(),B(185,"li"),re(186,"hr",20),V(),B(187,"li")(188,"a",36),q(189,"George Benson: Shiver "),V()(),B(190,"li"),re(191,"hr",20),V(),B(192,"li")(193,"a",36),q(194," The EQS: In Our Dream "),V()(),B(195,"li"),re(196,"hr",20),V(),B(197,"li")(198,"a",36),q(199," Madona: Holiday "),V()(),B(200,"li"),re(201,"hr",20),V(),B(202,"li")(203,"a",36),q(204," Kool and The Gang: Fresh "),V()(),B(205,"li"),re(206,"hr",20),V(),B(207,"li")(208,"a",36),q(209," S.O.S Band: The Finest "),V()(),B(210,"li"),re(211,"hr",20),V(),B(212,"li")(213,"a",36),q(214," Cherrelle: Saturday Love "),V()()()(),B(215,"li",16)(216,"a",37),q(217," Musique Congolaise "),V(),B(218,"ul",38)(219,"li")(220,"a",36),q(221,"Centieme Dossier"),V()(),re(222,"hr",20),B(223,"li")(224,"a",36),q(225,"Koukoulou"),V()(),re(226,"hr",20),B(227,"li")(228,"a",36),q(229,"Tokoma ba Camarade Pamba"),V()(),re(230,"hr",20),B(231,"li")(232,"a",36),q(233,"Orgasy "),V()(),re(234,"hr",20),B(235,"li")(236,"a",36),q(237,"Point Final"),V()(),re(238,"hr",20),B(239,"li")(240,"a",36),q(241,"Nzoto Na Nga Se Moko"),V()(),re(242,"hr",20),B(243,"li")(244,"a",36),q(245,"Maya"),V()(),re(246,"hr",20),B(247,"li")(248,"a",36),q(249,"Z\xE9ro faute"),V()(),re(250,"hr",20),B(251,"li")(252,"a",36),q(253,"Coucou"),V()(),re(254,"hr",20),B(255,"li")(256,"a",36),q(257,"Ngobila"),V()(),re(258,"hr",20),B(259,"li")(260,"a",36),q(261,"Ndaya"),V()(),re(262,"hr",20),B(263,"li")(264,"a",36),q(265,"Faute Ya Commer\xE7ant"),V()(),re(266,"hr",20),B(267,"li")(268,"a",36),q(269,"Mukungu "),V()(),re(270,"hr",20),B(271,"li")(272,"a",36),q(273,"DJINO "),V()(),re(274,"hr",20),B(275,"li")(276,"a",36),q(277,"Pesa Position "),V()(),re(278,"hr",20),B(279,"li")(280,"a",36),q(281,"Mabele (Ntoto) "),V(),re(282,"hr",20),V(),B(283,"li")(284,"a",36),q(285,"Karibou ya Bintou"),V()(),re(286,"hr",20),B(287,"li")(288,"a",36),q(289,"Deliya"),V()(),re(290,"hr",20),B(291,"li")(292,"a",36),q(293,"Kelya"),V()(),re(294,"hr",20),B(295,"li")(296,"a",36),q(297,"Hortense"),V()(),re(298,"hr",20),B(299,"li")(300,"a",36),q(301,"Longo"),V()(),re(302,"hr",20),B(303,"li")(304,"a",36),q(305,"Nzaya Nzayadio -Lemba Lemba"),V()(),re(306,"hr",20),B(307,"li")(308,"a",36),q(309,"Bonbon sucr\xE9"),V()(),re(310,"hr",20),B(311,"li")(312,"a",36),q(313,"Nzale"),V()(),re(314,"hr",20),B(315,"li")(316,"a",36),q(317,"Nono"),V()(),re(318,"hr",20),B(319,"li")(320,"a",36),q(321,"Monzo "),V()(),re(322,"hr",20),V()()(),B(323,"form",39),dt("ngSubmit",function(){return i.onSearch()}),B(324,"input",40),Pd("ngModelChange",function(a){return Xg(i.searchQuery,a)||(i.searchQuery=a),a}),V(),B(325,"button",41),dt("click",function(){return i.onSearch()}),q(326," Search "),V()()()()()()(),B(327,"div")(328,"router-outlet",42),dt("activate",function(a){return i.onChildActivate(a)}),V()(),B(329,"div",43)(330,"div",44)(331,"div",45)(332,"div",46)(333,"h4",47),q(334),V(),B(335,"button",48),dt("click",function(){return i.CloseModel()}),V()(),B(336,"div",49)(337,"div",50)(338,"div",51)(339,"div",52),re(340,"img",53),V(),B(341,"div",52)(342,"div")(343,"h4",54),q(344,"\xC0 propos de moi"),V(),B(345,"div",55)(346,"p"),q(347),V()()()()()()()()()(),B(348,"div",56)(349,"div",44)(350,"div",45)(351,"div",46)(352,"h5",47),q(353,"Entrez le mot de passe"),V(),B(354,"button",48),dt("click",function(){return i.ClosepassModel()}),V()(),B(355,"div",49)(356,"input",57),Pd("ngModelChange",function(a){return Xg(i.password,a)||(i.password=a),a}),V()(),B(357,"div",58)(358,"button",59),dt("click",function(){return i.checkPassword("/Finance")}),q(359," Submit "),V()()()()(),B(360,"div",60),re(361,"app-myfooter"),V()()),r&2&&(ne(106),Z("routerLink",De(53,z4)),ne(5),Z("routerLink",De(54,G4)),ne(5),Z("routerLink",De(55,q4)),ne(5),Z("routerLink",De(56,X4)),ne(6),Z("routerLink",De(57,Y4)),ne(5),Z("routerLink",De(58,K4)),ne(5),Z("routerLink",De(59,Q4)),ne(6),Z("routerLink",De(60,Z4)),ne(5),Z("routerLink",De(61,J4)),ne(5),Z("routerLink",De(62,e3)),ne(5),Z("routerLink",De(63,t3)),ne(5),Z("routerLink",De(64,n3)),ne(5),Z("routerLink",De(65,r3)),ne(5),Z("routerLink",De(66,i3)),ne(5),Z("routerLink",De(67,s3)),ne(5),Z("routerLink",De(68,a3)),ne(5),Z("routerLink",De(69,o3)),ne(5),Z("routerLink",De(70,l3)),ne(5),Z("routerLink",De(71,c3)),ne(5),Z("routerLink",De(72,u3)),ne(5),Z("routerLink",De(73,d3)),ne(5),Z("routerLink",De(74,f3)),ne(7),Z("routerLink",De(75,h3)),ne(4),Z("routerLink",De(76,p3)),ne(4),Z("routerLink",De(77,g3)),ne(4),Z("routerLink",De(78,m3)),ne(4),Z("routerLink",De(79,v3)),ne(4),Z("routerLink",De(80,_3)),ne(4),Z("routerLink",De(81,x3)),ne(4),Z("routerLink",De(82,y3)),ne(4),Z("routerLink",De(83,w3)),ne(4),Z("routerLink",De(84,b3)),ne(4),Z("routerLink",De(85,E3)),ne(4),Z("routerLink",De(86,A3)),ne(4),Z("routerLink",De(87,C3)),ne(4),Z("routerLink",De(88,S3)),ne(4),Z("routerLink",De(89,T3)),ne(4),Z("routerLink",De(90,D3)),ne(4),Z("routerLink",De(91,I3)),ne(4),Z("routerLink",De(92,k3)),ne(4),Z("routerLink",De(93,M3)),ne(4),Z("routerLink",De(94,F3)),ne(4),Z("routerLink",De(95,P3)),ne(4),Z("routerLink",De(96,R3)),ne(4),Z("routerLink",De(97,N3)),ne(4),Z("routerLink",De(98,O3)),ne(4),Z("routerLink",De(99,L3)),ne(4),Z("routerLink",De(100,B3)),ne(4),Fd("ngModel",i.searchQuery),ne(10),Tt(i.personName),ne(6),Z("src",i.modalPicture,rr),ne(7),Rr(" ",i.message," "),ne(9),Fd("ngModel",i.password))},dependencies:[Qm,uC,lC,tC,On,NC,RC,yf,TC,DC,fv,dv,uv],styles:[`.dropdown-menu[_ngcontent-%COMP%] {
    max-height: 250px;
    overflow-y: auto;
  }`]})}}return n})();var bf=n=>({color:n});function V3(n,e){if(n&1&&re(0,"iframe",4),n&2){let t=ot();Z("src",t.sanitizedUrl,Ig)}}function j3(n,e){if(n&1&&(B(0,"div",5)(1,"span",6),q(2),V(),B(3,"span"),q(4,"\xA0 \xA0 \xA0 \xA0\xA0 \xA0 \xA0 \xA0"),V(),B(5,"span",6),q(6),V(),B(7,"span"),q(8,"\xA0 \xA0 \xA0 \xA0\xA0 \xA0 \xA0 \xA0"),V(),B(9,"span",6),q(10),V()()),n&2){let t=ot();ne(),Z("ngStyle",xl(6,bf,t.currentColor1)),ne(),Tt(t.htmlName1),ne(3),Z("ngStyle",xl(8,bf,t.currentColor2)),ne(),Tt(t.htmlName2),ne(3),Z("ngStyle",xl(10,bf,t.currentColor3)),ne(),Tt(t.htmlName3)}}function U3(n,e){if(n&1&&(B(0,"div",5)(1,"span",6),q(2," La r\xE9union de l'Assembl\xE9e G\xE9n\xE9rale se tiendra le dimanche 24 Novembre 2024 \xE0 22h00, heure de Paris. La pr\xE9sence de tous les membres est vivement attendue. "),V()()),n&2){let t=ot();ne(),Z("ngStyle",xl(1,bf,t.currentColor4))}}var Ef=function(n){return n[n.female=0]="female",n[n.male=1]="male",n}(Ef||{}),Ee=(()=>{class n{constructor(t,r,i){this.route=t,this.pictureService=r,this.sanitizer=i,this.names=[],this.videoId="",this.videoUrl="",this.sanitizedUrl=null,this.index=0,this.myBoolean=!0,this.currentName1=null,this.htmlName1="",this.currentName2=null,this.htmlName2="",this.currentName3=null,this.htmlName3="",this.currentName4=null,this.htmlName4="",this.currentColor1="blue",this.currentColor2="green",this.currentColor3="blue",this.currentColor4="black"}ngOnInit(){this.route.paramMap.subscribe(t=>{let r=t.get("videoId");r&&(this.videoUrl=`https://www.youtube.com/embed/${r}`,this.sanitizedUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.videoUrl))}),this.names=this.pictureService.getBigPictures(),this.startNameScrolling()}startNameScrolling(){this.updateName(),setInterval(()=>this.updateName(),1e4)}shuffleNames(){for(let t=this.names.length-1;t>0;t--){let r=Math.floor(Math.random()*(t+1));[this.names[t],this.names[r]]=[this.names[r],this.names[t]]}}updateName(){this.shuffleNames();let t=this.index;this.currentName1=this.names[t],this.htmlName1=this.currentName1.name,this.currentName1.gender===Ef.female?this.currentColor1="#F33A6A":this.currentColor1=this.currentColor1==="blue"?"green":"blue";let r=++this.index;this.currentName2=this.names[r],this.htmlName2=this.currentName2.name,this.currentName2.gender===Ef.female?this.currentColor2="#F33A6A":this.currentColor2=this.currentColor1==="green"?"blue":"green";let i=++this.index;this.currentName3=this.names[i],this.htmlName3=this.currentName3.name,this.currentName3.gender===Ef.female?this.currentColor3="#F33A6A":this.currentColor3=this.currentColor2==="blue"?"green":"blue",this.index+2==this.names.length&&(this.shuffleNames(),this.index=0);let s=0;this.currentName4=null,this.toggleValue()}toggleValue(){}static{this.\u0275fac=function(r){return new(r||n)(Ce(oi),Ce(ws),Ce(_m))}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-youtube"]],standalone:!0,features:[Ve],decls:5,vars:3,consts:[[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12"],["style",`width: 95vw; height: 80vh; position: relative;
    margin-right: 35px;
    margin-top: 0px;
    margin-bottom: 60px;`,"frameborder","0","allowfullscreen","",3,"src",4,"ngIf"],["class","scrolling-text","style","width: 95vw; height: 10vh; position: relative; margin-bottom: 35px; z-index: 20;",4,"ngIf"],["frameborder","0","allowfullscreen","",2,"width","95vw","height","80vh","position","relative","margin-right","35px","margin-top","0px","margin-bottom","60px",3,"src"],[1,"scrolling-text",2,"width","95vw","height","10vh","position","relative","margin-bottom","35px","z-index","20"],[3,"ngStyle"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"div",1),zt(2,V3,1,1,"iframe",2),V()(),zt(3,j3,11,12,"div",3)(4,U3,3,3,"div",3)),r&2&&(ne(2),Z("ngIf",i.sanitizedUrl),ne(),Z("ngIf",(i.currentName1||i.currentName2||i.currentName3)&&i.myBoolean),ne(),Z("ngIf",!i.myBoolean))},dependencies:[On,mr,rA],styles:[".scrolling-text[_ngcontent-%COMP%]{position:fixed;bottom:10px;width:100%;text-align:center;font-size:150%;font-weight:700;white-space:nowrap;font-style:italic;word-wrap:break-word;animation:_ngcontent-%COMP%_scroll 10s linear infinite}@keyframes _ngcontent-%COMP%_scroll{0%{transform:translate(100%)}to{transform:translate(-100%)}}"]})}}return n})();var LC=G1(hv());function H3(n,e){if(n&1&&(B(0,"h1",10),q(1),V()),n&2){let t=ot();ne(),Tt(t.emoji)}}var BC=(()=>{class n{constructor(){this.isPlaying=!1,this.emoji="\u{1F62D}"}initializePlayer(){this.player=new LC.Howl({src:["assets/mp3/HOMMAGE_A_NOS_MORTS.mp3"],html5:!0,onplay:()=>{this.isPlaying=!0},onpause:()=>{this.isPlaying=!1},onend:()=>{this.isPlaying=!1}})}play(){this.player||this.initializePlayer(),this.player.play()}pause(){this.player&&this.player.pause()}stop(){this.player&&(this.player.stop(),this.isPlaying=!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-mp3-player"]],standalone:!0,features:[Ve],decls:14,vars:2,consts:[[1,"mp3-player","container","text-center","py-4",2,"margin-top","50px"],[1,"mb-4"],["style","font-size: 100px;",4,"ngIf"],["role","group","aria-label","MP3 Player Controls",1,"btn-group"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-play-fill"],[1,"btn","btn-warning",3,"click","disabled"],[1,"bi","bi-pause-fill"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-stop-fill"],[2,"font-size","100px"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"h3",1),q(2,"Hommage \xE0 nos morts "),V(),zt(3,H3,2,1,"h1",2),B(4,"div",3)(5,"button",4),dt("click",function(){return i.play()}),re(6,"i",5),q(7," Jouer "),V(),B(8,"button",6),dt("click",function(){return i.pause()}),re(9,"i",7),q(10," Pause "),V(),B(11,"button",8),dt("click",function(){return i.stop()}),re(12,"i",9),q(13," Arr\xEAter "),V()()()),r&2&&(ne(3),Z("ngIf",i.emoji),ne(5),Z("disabled",!i.isPlaying))},dependencies:[On,mr],styles:[".mp3-player[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:10px;box-shadow:0 4px 8px #0000001a;max-width:400px;margin:auto}button[_ngcontent-%COMP%]{width:100px}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}"]})}}return n})();var VC=G1(hv());function $3(n,e){if(n&1&&(B(0,"div",5)(1,"video",6),re(2,"source",7),q(3," Your browser does not support the video tag. "),V()()),n&2){let t=ot();ne(2),Z("src",t.fileSource,rr)}}function W3(n,e){if(n&1){let t=lo();B(0,"div")(1,"div",8)(2,"button",9),dt("click",function(){fs(t);let i=ot();return hs(i.play())}),re(3,"i",10),q(4," Play "),V(),B(5,"button",11),dt("click",function(){fs(t);let i=ot();return hs(i.pause())}),re(6,"i",12),q(7," Pause "),V(),B(8,"button",13),dt("click",function(){fs(t);let i=ot();return hs(i.stop())}),re(9,"i",14),q(10," Stop "),V()()()}if(n&2){let t=ot();ne(5),Z("disabled",!t.isPlaying)}}var jC=(()=>{class n{constructor(){this.fileSource="",this.fileType="mp3",this.isPlaying=!1,this.isVideo=!1}ngOnInit(){this.isVideo=this.fileType==="mp4",this.isVideo||this.initializePlayer()}initializePlayer(){this.fileSource&&(this.player=new VC.Howl({src:[this.fileSource],html5:!0,onplay:()=>this.isPlaying=!0,onpause:()=>this.isPlaying=!1,onend:()=>this.isPlaying=!1}))}play(){if(this.isVideo){let t=document.getElementById("video-player");t&&(t.play(),this.isPlaying=!0)}else this.player?.play()}pause(){if(this.isVideo){let t=document.getElementById("video-player");t&&(t.pause(),this.isPlaying=!1)}else this.player?.pause()}stop(){if(this.isVideo){let t=document.getElementById("video-player");t&&(t.pause(),t.currentTime=0,this.isPlaying=!1)}else this.player?.stop(),this.isPlaying=!1}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-mp4-player"]],inputs:{fileSource:"fileSource",fileType:"fileType"},standalone:!0,features:[Ve],decls:8,vars:2,consts:[[1,"mp3-player","container","text-center","py-4"],[1,"mb-4"],[2,"font-family","'Courier New', monospace"],["style","margin-top: 50px;",4,"ngIf"],[4,"ngIf"],[2,"margin-top","50px"],["id","video-player","width","100%","controls",""],["type","video/mp4",3,"src"],["role","group","aria-label","Audio Controls",1,"btn-group"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-play-fill"],[1,"btn","btn-warning",3,"click","disabled"],[1,"bi","bi-pause-fill"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-stop-fill"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"h3",1),q(2,"\u{1F339}"),B(3,"span",2),q(4,"Lukala"),V(),q(5,"\u{1F339}"),V(),zt(6,$3,4,1,"div",3)(7,W3,11,1,"div",4),V()),r&2&&(ne(6),Z("ngIf",i.isVideo),ne(),Z("ngIf",!i.isVideo))},dependencies:[On,mr],styles:[".mp3-player[_ngcontent-%COMP%]{background-color:#f8f9fa;border-radius:10px;box-shadow:0 4px 8px #0000001a;max-width:600px;margin:auto}video[_ngcontent-%COMP%]{border-radius:10px;box-shadow:0 4px 8px #0000001a;margin-bottom:20px}"]})}}return n})();var Cf=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-home"]],standalone:!0,features:[Ve],decls:6,vars:2,consts:[[1,"d-flex","justify-content-center","align-items-center","text-center",2,"width","100%","height","15vh","background-color","rgb(246, 248, 244)"],[1,"mb-3"],[1,"display-6",2,"color","blue","font-style","italic","margin","0"],[1,"video",2,"margin-top","1px","background-color","rgb(219, 241, 227)"],[3,"fileSource","fileType"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"h1",1)(2,"p",2),q(3," Nous, ressortissants de Lukala, vous souhaitons la bienvenue sur notre interface. "),V()()(),B(4,"div",3),re(5,"app-mp4-player",4),V()),r&2&&(ne(5),Z("fileSource","assets/mp3/LukalaVideo.mp4")("fileType","mp4"))},dependencies:[jC]})}}return n})();var To={};z1(To,{AbortException:()=>HB,AnnotationEditorLayer:()=>$B,AnnotationEditorParamsType:()=>WB,AnnotationEditorType:()=>W_,AnnotationEditorUIManager:()=>zB,AnnotationLayer:()=>GB,AnnotationMode:()=>qB,ColorPicker:()=>XB,DOMSVGFactory:()=>YB,DrawLayer:()=>KB,FeatureTest:()=>QB,GlobalWorkerOptions:()=>z_,ImageKind:()=>ZB,InvalidPDFException:()=>JB,MissingPDFException:()=>e8,OPS:()=>t8,OutputScale:()=>n8,PDFDataRangeTransport:()=>r8,PDFDateString:()=>i8,PDFWorker:()=>s8,PasswordResponses:()=>a8,PermissionFlag:()=>o8,PixelsPerInch:()=>l8,RenderingCancelledException:()=>c8,TextLayer:()=>u8,UnexpectedResponseException:()=>d8,Util:()=>f8,VerbosityLevel:()=>G_,XfaLayer:()=>h8,build:()=>p8,createValidAbsoluteUrl:()=>g8,fetchData:()=>m8,getDocument:()=>q_,getFilenameFromUrl:()=>v8,getPdfFilenameFromUrl:()=>_8,getXfaPageViewport:()=>x8,isDataScheme:()=>y8,isPdfFile:()=>w8,noContextMenu:()=>b8,normalizeUnicode:()=>E8,setLayerDimensions:()=>A8,shadow:()=>C8,version:()=>yc});var ic={};ic.d=(n,e)=>{for(var t in e)ic.o(e,t)&&!ic.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};ic.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Le=globalThis.pdfjsLib={};ic.d(Le,{AbortException:()=>Wi,AnnotationEditorLayer:()=>UB,AnnotationEditorParamsType:()=>Pe,AnnotationEditorType:()=>He,AnnotationEditorUIManager:()=>uc,AnnotationLayer:()=>k_,AnnotationMode:()=>bs,ColorPicker:()=>dh,DOMSVGFactory:()=>gc,DrawLayer:()=>O_,FeatureTest:()=>mn,GlobalWorkerOptions:()=>ca,ImageKind:()=>Ff,InvalidPDFException:()=>Nf,MissingPDFException:()=>$i,OPS:()=>Lr,OutputScale:()=>cc,PDFDataRangeTransport:()=>Qf,PDFDateString:()=>Lf,PDFWorker:()=>Co,PasswordResponses:()=>Y3,PermissionFlag:()=>X3,PixelsPerInch:()=>Es,RenderingCancelledException:()=>lc,TextLayer:()=>hc,UnexpectedResponseException:()=>So,Util:()=>Ae,VerbosityLevel:()=>hh,XfaLayer:()=>eh,build:()=>VB,createValidAbsoluteUrl:()=>J3,fetchData:()=>vh,getDocument:()=>NB,getFilenameFromUrl:()=>oB,getPdfFilenameFromUrl:()=>lB,getXfaPageViewport:()=>cB,isDataScheme:()=>_h,isPdfFile:()=>V_,noContextMenu:()=>xr,normalizeUnicode:()=>iB,setLayerDimensions:()=>ua,shadow:()=>Je,version:()=>BB});var wn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),nS=[1,0,0,1,0,0],xv=[.001,0,0,.001,0,0],z3=1e7,Mf=1.35,G3=.35,cee=G3/Mf,or={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},bs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},q3="pdfjs_internal_editor_",He={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Pe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},X3={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},yn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ff={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},nn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var ec={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var hh={ERRORS:0,WARNINGS:1,INFOS:5},Lr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Y3={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},ph=hh.WARNINGS;function K3(n){Number.isInteger(n)&&(ph=n)}function Q3(){return ph}function gh(n){ph>=hh.INFOS&&console.log(`Info: ${n}`)}function ze(n){ph>=hh.WARNINGS&&console.log(`Warning: ${n}`)}function Ct(n){throw new Error(n)}function rn(n,e){n||Ct(e)}function Z3(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function J3(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=rB(n)}catch{}let r=e?new URL(n,e):new URL(n);if(Z3(r))return r}catch{}return null}function Je(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}var As=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}(),sc=class extends As{constructor(e,t){super(e,"PasswordException"),this.code=t}},ac=class extends As{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},Nf=class extends As{constructor(e){super(e,"InvalidPDFException")}},$i=class extends As{constructor(e){super(e,"MissingPDFException")}},So=class extends As{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},yv=class extends As{constructor(e){super(e,"FormatError")}},Wi=class extends As{constructor(e){super(e,"AbortException")}};function rS(n){(typeof n!="object"||n?.length===void 0)&&Ct("Invalid argument for bytesToString");let e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);let r=[];for(let i=0;i<e;i+=t){let s=Math.min(i+t,e),a=n.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function mh(n){typeof n!="string"&&Ct("Invalid argument for stringToBytes");let e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function eB(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function L_(n){let e=Object.create(null);for(let[t,r]of n)e[t]=r;return e}function tB(){let n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function nB(){try{return new Function(""),!0}catch{return!1}}var mn=class{static get isLittleEndian(){return Je(this,"isLittleEndian",tB())}static get isEvalSupported(){return Je(this,"isEvalSupported",nB())}static get isOffscreenCanvasSupported(){return Je(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Je(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Je(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Je(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},pv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0")),Ae=class{static makeHexColor(e,t,r){return`#${pv[e]}${pv[t]}${pv[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let r=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[r,i]}static applyInverseTransform(e,t){let r=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r;return[i,s]}static getAxialAlignedBoundingBox(e,t){let r=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(r[0],i[0],s[0],a[0]),Math.min(r[1],i[1],s[1],a[1]),Math.max(r[0],i[0],s[0],a[0]),Math.max(r[1],i[1],s[1],a[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(r+a)/2,l=Math.sqrt((r+a)**2-4*(r*a-s*i))/2,u=o+l||1,c=o-l||1;return[Math.sqrt(u),Math.sqrt(c)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;let s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[r,s,i,a]}static#e(e,t,r,i,s,a,o,l,u,c){if(u<=0||u>=1)return;let d=1-u,f=u*u,h=f*u,p=d*(d*(d*e+3*u*t)+3*f*r)+h*i,g=d*(d*(d*s+3*u*a)+3*f*o)+h*l;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],g),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],g)}static#t(e,t,r,i,s,a,o,l,u,c,d,f){if(Math.abs(u)<1e-12){Math.abs(c)>=1e-12&&this.#e(e,t,r,i,s,a,o,l,-d/c,f);return}let h=c**2-4*d*u;if(h<0)return;let p=Math.sqrt(h),g=2*u;this.#e(e,t,r,i,s,a,o,l,(-c+p)/g,f),this.#e(e,t,r,i,s,a,o,l,(-c-p)/g,f)}static bezierBoundingBox(e,t,r,i,s,a,o,l,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],this.#t(e,r,s,o,t,i,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),u),this.#t(e,r,s,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),u),u}};function rB(n){return decodeURIComponent(escape(n))}var gv=null,UC=null;function iB(n){return gv||(gv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,UC=new Map([["\uFB05","\u017Ft"]])),n.replaceAll(gv,(e,t,r)=>t?t.normalize("NFKC"):UC.get(r))}function sB(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();let n=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(n);else for(let e=0;e<32;e++)n[e]=Math.floor(Math.random()*255);return rS(n)}var B_="pdfjs_internal_id_",Vi={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function aB(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(rS(n))}var Ui="http://www.w3.org/2000/svg",Es=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};function vh(n,e="text"){return ee(this,null,function*(){if(rc(n,document.baseURI)){let t=yield fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{let i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})})}var oc=class n{constructor({viewBox:e,scale:t,rotation:r,offsetX:i=0,offsetY:s=0,dontFlip:a=!1}){this.viewBox=e,this.scale=t,this.rotation=r,this.offsetX=i,this.offsetY=s;let o=(e[2]+e[0])/2,l=(e[3]+e[1])/2,u,c,d,f;switch(r%=360,r<0&&(r+=360),r){case 180:u=-1,c=0,d=0,f=1;break;case 90:u=0,c=1,d=1,f=0;break;case 270:u=0,c=-1,d=-1,f=0;break;case 0:u=1,c=0,d=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,f=-f);let h,p,g,m;u===0?(h=Math.abs(l-e[1])*t+i,p=Math.abs(o-e[0])*t+s,g=(e[3]-e[1])*t,m=(e[2]-e[0])*t):(h=Math.abs(o-e[0])*t+i,p=Math.abs(l-e[1])*t+s,g=(e[2]-e[0])*t,m=(e[3]-e[1])*t),this.transform=[u*t,c*t,d*t,f*t,h-u*t*o-d*t*l,p-c*t*o-f*t*l],this.width=g,this.height=m}get rawDims(){let{viewBox:e}=this;return Je(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new n({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){return Ae.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=Ae.applyTransform([e[0],e[1]],this.transform),r=Ae.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){return Ae.applyInverseTransform([e,t],this.transform)}},lc=class extends As{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function _h(n){let e=n.length,t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function V_(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function oB(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function lB(n,e="document.pdf"){if(typeof n!="string")return e;if(_h(n))return ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n),s=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||e}var Of=class{started=Object.create(null);times=[];time(e){e in this.started&&ze(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ze(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:r}of this.times)t=Math.max(r.length,t);for(let{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(t)} ${s-i}ms
`);return e.join("")}};function rc(n,e){try{let{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function xr(n){n.preventDefault()}function HC(n){console.log("Deprecated API usage: "+n)}var Lf=class{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=this.#e.exec(e);if(!t)return null;let r=parseInt(t[1],10),i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;let u=t[7]||"Z",c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=c,o+=d):u==="+"&&(a-=c,o-=d),new Date(Date.UTC(r,i,s,a,o,l))}};function cB(n,{scale:e=1,rotation:t=0}){let{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new oc({viewBox:s,scale:e,rotation:t})}function j_(n){if(n.startsWith("#")){let e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ze(`Not a valid color format: "${n}"`),[0,0,0])}function uB(n){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of n.keys()){e.style.color=t;let r=window.getComputedStyle(e).color;n.set(t,j_(r))}e.remove()}function kt(n){let{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform();return[e,t,r,i,s,a]}function ji(n){let{a:e,b:t,c:r,d:i,e:s,f:a}=n.getTransform().invertSelf();return[e,t,r,i,s,a]}function ua(n,e,t=!1,r=!0){if(e instanceof oc){let{pageWidth:i,pageHeight:s}=e.rawDims,{style:a}=n,o=mn.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${s}px`,c=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=c,a.height=d):(a.width=d,a.height=c)}r&&n.setAttribute("data-main-rotation",e.rotation)}var cc=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}},wv=class n{#e=null;#t=null;#n;#r=null;#i=null;static#s=null;constructor(e){this.#n=e,n.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");let t=this.#n._uiManager._signal;e.addEventListener("contextmenu",xr,{signal:t}),e.addEventListener("pointerdown",n.#l,{signal:t});let r=this.#r=document.createElement("div");r.className="buttons",e.append(r);let i=this.#n.toolbarPosition;if(i){let{style:s}=e,a=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#c(e){this.#n._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()}#u(e){this.#n._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()}#o(e){let t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",xr,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}#d(){let{editorType:e,_uiManager:t}=this.#n,r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",n.#s[e]),this.#o(r),r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#r.append(r)}get#a(){let e=document.createElement("div");return e.className="divider",e}addAltText(e){return ee(this,null,function*(){let t=yield e.render();this.#o(t),this.#r.prepend(t,this.#a),this.#i=e})}addColorPicker(e){this.#t=e;let t=e.renderButton();this.#o(t),this.#r.prepend(t,this.#a)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}},bv=class{#e=null;#t=null;#n;constructor(e){this.#n=e}#r(){let e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",xr,{signal:this.#n._signal});let t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#i(e,t){let r=0,i=0;for(let s of e){let a=s.y+s.height;if(a<r)continue;let o=s.x+(t?s.width:0);if(a>r){i=o,r=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,r]}show(e,t,r){let[i,s]=this.#i(t,r),{style:a}=this.#t||=this.#r();e.append(this.#t),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let r=this.#n._signal;e.addEventListener("contextmenu",xr,{signal:r}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:r}),this.#e.append(e)}};function Bf(n,e,t){for(let r of t)e.addEventListener(r,n[r].bind(n))}function dB(n){return Math.round(Math.min(255,Math.max(1,255*n))).toString(16).padStart(2,"0")}var Ev=class{#e=0;get id(){return`${q3}${this.#e++}`}},Av=class n{#e=sB();#t=0;#n=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;let s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Je(this,"_isSVGFittingCanvas",s)}#r(e,t){return ee(this,null,function*(){this.#n||=new Map;let r=this.#n.get(e);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(r.url=t,i=yield vh(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){let s=n._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,c)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,u()},a.onload=()=>ee(this,null,function*(){let d=r.svgUrl=a.result;o.src=(yield s)?`${d}#svgView(preserveAspectRatio(none))`:d}),o.onerror=a.onerror=c});a.readAsDataURL(i),yield l}else r.bitmap=yield createImageBitmap(i);r.refCounter=1}catch(i){console.error(i),r=null}return this.#n.set(e,r),r&&this.#n.set(r.id,r),r})}getFromFile(e){return ee(this,null,function*(){let{lastModified:t,name:r,size:i,type:s}=e;return this.#r(`${t}_${r}_${i}_${s}`,e)})}getFromUrl(e){return ee(this,null,function*(){return this.#r(e,e)})}getFromBlob(e,t){return ee(this,null,function*(){let r=yield t;return this.#r(e,r)})}getFromId(e){return ee(this,null,function*(){this.#n||=new Map;let t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)})}getFromCanvas(e,t){this.#n||=new Map;let r=this.#n.get(e);if(r?.bitmap)return r.refCounter+=1,r;let i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,r),this.#n.set(r.id,r),r}getSvgUrl(e){let t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;let t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;let{bitmap:r}=t;if(!t.url&&!t.file){let i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}r.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}},Cv=class{#e=[];#t=!1;#n;#r=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),this.#t)return;let l={cmd:e,undo:t,post:r,type:s};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(l);return}if(a&&this.#e[this.#r].type===s){o&&(l.undo=this.#e[this.#r].undo),this.#e[this.#r]=l;return}let u=this.#r+1;u===this.#n?this.#e.splice(0,1):(this.#r=u,u<this.#e.length&&this.#e.splice(u)),this.#e.push(l)}undo(){if(this.#r===-1)return;this.#t=!0;let{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;let{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}destroy(){this.#e=null}},da=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=mn.platform;for(let[r,i,s={}]of e)for(let a of r){let o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let r=this.callbacks.get(this.#e(t));if(!r)return;let{callback:i,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(i.bind(e,...a,t)(),s||(t.stopPropagation(),t.preventDefault()))}},Sv=class n{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return uB(e),Je(this,"_colors",e)}convert(e){let t=j_(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[r,i]of this._colors)if(i.every((s,a)=>s===t[a]))return n._colorsMapping.get(r);return t}getHexCode(e){let t=this._colors.get(e);return t?Ae.makeHexColor(...t):e}},uc=(()=>{class n{#e=new AbortController;#t=null;#n=new Map;#r=new Map;#i=null;#s=null;#l=null;#c=new Cv;#u=null;#o=0;#d=new Set;#a=null;#f=null;#p=new Set;#h=!1;#g=!1;#v=!1;#m=null;#_=null;#y=null;#E=null;#w=!1;#b=null;#k=new Ev;#T=!1;#A=!1;#D=null;#S=null;#M=null;#P=null;#C=He.NONE;#x=new Set;#I=null;#F=null;#L=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#O=null;#B=null;#V=null;#R=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=n.prototype,r=o=>o.#B.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:l})=>{if(l instanceof HTMLInputElement){let{type:u}=l;return u!=="text"&&u!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Je(this,"_keyboardManager",new da([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#B.contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#B.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:r}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:r}]]))}constructor(t,r,i,s,a,o,l,u,c,d,f){let h=this._signal=this.#e.signal;this.#B=t,this.#V=r,this.#i=i,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:h}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:h}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:h}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:h}),s._on("setpreference",this.onSetPreference.bind(this),{signal:h}),s._on("switchannotationeditorparams",p=>this.updateParams(p.type,p.value),{signal:h}),this.#ee(),this.#ie(),this.#q(),this.#s=a.annotationStorage,this.#m=a.filterFactory,this.#F=o,this.#E=l||null,this.#h=u,this.#g=c,this.#v=d,this.#P=f||null,this.viewParameters={realScale:Es.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#R?.resolve(),this.#R=null,this.#e?.abort(),this.#e=null,this._signal=null;for(let t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#t=null,this.#x.clear(),this.#c.destroy(),this.#i?.destroy(),this.#b?.hide(),this.#b=null,this.#_&&(clearTimeout(this.#_),this.#_=null),this.#O&&(clearTimeout(this.#O),this.#O=null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#P}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Je(this,"hcmFilter",this.#F?this.#m.addHCMFilter(this.#F.foreground,this.#F.background):"none")}get direction(){return Je(this,"direction",getComputedStyle(this.#B).direction)}get highlightColors(){return Je(this,"highlightColors",this.#E?new Map(this.#E.split(",").map(t=>t.split("=").map(r=>r.trim()))):null)}get highlightColorNames(){return Je(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){this.#M=t}editAltText(t,r=!1){this.#i?.editAltText(this,t,r)}switchToMode(t,r){this._eventBus.on("annotationeditormodechanged",r,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,r){this._eventBus.dispatch("setpreference",{source:this,name:t,value:r})}onSetPreference({name:t,value:r}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=r;break}}onPageChanging({pageNumber:t}){this.#o=t-1}focusMainContainer(){this.#B.focus()}findParent(t,r){for(let i of this.#r.values()){let{x:s,y:a,width:o,height:l}=i.div.getBoundingClientRect();if(t>=s&&t<=s+o&&r>=a&&r<=a+l)return i}return null}disableUserSelect(t=!1){this.#V.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Es.PDF_TO_CSS_UNITS;for(let r of this.#p)r.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#G(t){let{currentLayer:r}=this;if(r.hasTextLayer(t))return r;for(let i of this.#r.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t=""){let r=document.getSelection();if(!r||r.isCollapsed)return;let{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o}=r,l=r.toString(),c=this.#W(r).closest(".textLayer"),d=this.getSelectionBoxes(c);if(!d)return;r.empty();let f=this.#G(c),h=this.#C===He.NONE,p=()=>{f?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o,text:l}),h&&this.showAllEditors("highlight",!0,!0)};if(h){this.switchToMode(He.HIGHLIGHT,p);return}p()}#Z(){let t=document.getSelection();if(!t||t.isCollapsed)return;let i=this.#W(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#b||=new bv(this),this.#b.show(i,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#J(){let t=document.getSelection();if(!t||t.isCollapsed){this.#I&&(this.#b?.hide(),this.#I=null,this.#N({hasSelectedText:!1}));return}let{anchorNode:r}=t;if(r===this.#I)return;let s=this.#W(t).closest(".textLayer");if(!s){this.#I&&(this.#b?.hide(),this.#I=null,this.#N({hasSelectedText:!1}));return}if(this.#b?.hide(),this.#I=r,this.#N({hasSelectedText:!0}),!(this.#C!==He.HIGHLIGHT&&this.#C!==He.NONE)&&(this.#C===He.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#w=this.isShiftKeyDown,!this.isShiftKeyDown)){let a=this.#C===He.HIGHLIGHT?this.#G(s):null;a?.toggleDrawing();let o=new AbortController,l=this.combinedSignal(o),u=c=>{c.type==="pointerup"&&c.button!==0||(o.abort(),a?.toggleDrawing(!0),c.type==="pointerup"&&this.#z("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#z(t=""){this.#C===He.HIGHLIGHT?this.highlightSelection(t):this.#h&&this.#Z()}#ee(){document.addEventListener("selectionchange",this.#J.bind(this),{signal:this._signal})}#te(){if(this.#y)return;this.#y=new AbortController;let t=this.combinedSignal(this.#y);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ne(){this.#y?.abort(),this.#y=null}blur(){if(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#z("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let r of this.#x)if(r.div.contains(t)){this.#S=[r,t],r._focusEventsAllowed=!1;break}}focus(){if(!this.#S)return;let[t,r]=this.#S;this.#S=null,r.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),r.focus()}#q(){if(this.#D)return;this.#D=new AbortController;let t=this.combinedSignal(this.#D);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#re(){this.#D?.abort(),this.#D=null}#X(){if(this.#u)return;this.#u=new AbortController;let t=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Y(){this.#u?.abort(),this.#u=null}#ie(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#q(),this.#X()}removeEditListeners(){this.#re(),this.#Y()}dragOver(t){for(let{type:r}of t.dataTransfer.items)for(let i of this.#f)if(i.isHandlingMimeForPasting(r)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let r of t.dataTransfer.items)for(let i of this.#f)if(i.isHandlingMimeForPasting(r.type)){i.paste(r,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;let r=[];for(let i of this.#x){let s=i.serialize(!0);s&&r.push(s)}r.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(r))}cut(t){this.copy(t),this.delete()}paste(t){return ee(this,null,function*(){t.preventDefault();let{clipboardData:r}=t;for(let a of r.items)for(let o of this.#f)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let i=r.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){ze(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();let s=this.currentLayer;try{let a=[];for(let u of i){let c=yield s.deserialize(u);if(!c)return;a.push(c)}let o=()=>{for(let u of a)this.#K(u);this.#Q(a)},l=()=>{for(let u of a)u.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(a){ze(`paste: "${a.message}".`)}})}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==He.NONE&&!this.isEditorHandlingKeyboard&&n._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#z("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#N(t){Object.entries(t).some(([i,s])=>this.#U[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,t)}),this.#C===He.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[Pe.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#te(),this.#X(),this.#N({isEditing:this.#C!==He.NONE,isEmpty:this.#$(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#Y(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#f){this.#f=t;for(let r of this.#f)this.#H(r.defaultPropertiesToUpdate)}}getId(){return this.#k.id}get currentLayer(){return this.#r.get(this.#o)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#o}addLayer(t){this.#r.set(t.pageIndex,t),this.#T?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}updateMode(t,r=null,i=!1){return ee(this,null,function*(){if(this.#C!==t&&!(this.#R&&(yield this.#R.promise,!this.#R))){if(this.#R=Promise.withResolvers(),this.#C=t,t===He.NONE){this.setEditingState(!1),this.#ae(),this.#R.resolve();return}this.setEditingState(!0),yield this.#se(),this.unselectAll();for(let s of this.#r.values())s.updateMode(t);if(!r){i&&this.addNewEditorFromKeyboard(),this.#R.resolve();return}for(let s of this.#n.values())s.annotationElementId===r?(this.setSelected(s),s.enterInEditMode()):s.unselect();this.#R.resolve()}})}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,r){if(this.#f){switch(t){case Pe.CREATE:this.currentLayer.addNewEditor();return;case Pe.HIGHLIGHT_DEFAULT_COLOR:this.#M?.updateColor(r);break;case Pe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#L||=new Map).set(t,r),this.showAllEditors("highlight",r);break}for(let i of this.#x)i.updateParams(t,r);for(let i of this.#f)i.updateDefaultParams(t,r)}}showAllEditors(t,r,i=!1){for(let a of this.#n.values())a.editorType===t&&a.show(r);(this.#L?.get(Pe.HIGHLIGHT_SHOW_ALL)??!0)!==r&&this.#H([[Pe.HIGHLIGHT_SHOW_ALL,r]])}enableWaiting(t=!1){if(this.#A!==t){this.#A=t;for(let r of this.#r.values())t?r.disableClick():r.enableClick(),r.div.classList.toggle("waiting",t)}}#se(){return ee(this,null,function*(){if(!this.#T){this.#T=!0;let t=[];for(let r of this.#r.values())t.push(r.enable());yield Promise.all(t);for(let r of this.#n.values())r.enable()}})}#ae(){if(this.unselectAll(),this.#T){this.#T=!1;for(let t of this.#r.values())t.disable();for(let t of this.#n.values())t.disable()}}getEditors(t){let r=[];for(let i of this.#n.values())i.pageIndex===t&&r.push(i);return r}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.focusMainContainer(),this.#_=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#d.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#d.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#d.has(t)}removeDeletedAnnotationElement(t){this.#d.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#K(t){let r=this.#r.get(t.pageIndex);r?r.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#t!==t&&(this.#t=t,t&&this.#H(t.propertiesToUpdate))}get#oe(){let t=null;for(t of this.#x);return t}updateUI(t){this.#oe===t&&this.#H(t.propertiesToUpdate)}toggleSelected(t){if(this.#x.has(t)){this.#x.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#x.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){for(let r of this.#x)r!==t&&r.unselect();this.#x.clear(),this.#x.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#x.has(t)}get firstSelectedEditor(){return this.#x.values().next().value}unselect(t){t.unselect(),this.#x.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#x.size!==0}get isEnterHandled(){return this.#x.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#$()})}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#$()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#$()})}#$(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(let t of this.#n.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;let t=[...this.#x],r=()=>{for(let s of t)s.remove()},i=()=>{for(let s of t)this.#K(s)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#Q(t){for(let r of this.#x)r.unselect();this.#x.clear();for(let r of t)r.isEmpty()||(this.#x.add(r),r.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#x)t.commit();this.#Q(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#C!==He.NONE))&&this.hasSelection){for(let t of this.#x)t.unselect();this.#x.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,r,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=r;let[s,a]=this.#j,o=[...this.#x],l=1e3;this.#O&&clearTimeout(this.#O),this.#O=setTimeout(()=>{this.#O=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(let u of o)this.#n.has(u.id)&&u.translateInPage(s,a)},undo:()=>{for(let u of o)this.#n.has(u.id)&&u.translateInPage(-s,-a)},mustExec:!1})},l);for(let u of o)u.translateInPage(t,r)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#a=new Map;for(let t of this.#x)this.#a.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#a)return!1;this.disableUserSelect(!1);let t=this.#a;this.#a=null;let r=!1;for(let[{x:s,y:a,pageIndex:o},l]of t)l.newX=s,l.newY=a,l.newPageIndex=o,r||=s!==l.savedX||a!==l.savedY||o!==l.savedPageIndex;if(!r)return!1;let i=(s,a,o,l)=>{if(this.#n.has(s.id)){let u=this.#r.get(l);u?s._setParentAndPosition(u,a,o):(s.pageIndex=l,s.x=a,s.y=o)}};return this.addCommands({cmd:()=>{for(let[s,{newX:a,newY:o,newPageIndex:l}]of t)i(s,a,o,l)},undo:()=>{for(let[s,{savedX:a,savedY:o,savedPageIndex:l}]of t)i(s,a,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,r){if(this.#a)for(let i of this.#a.keys())i.drag(t,r)}rebuild(t){if(t.parent===null){let r=this.getLayer(t.pageIndex);r?(r.changeParent(t),r.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#x.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#t===t}getActive(){return this.#t}getMode(){return this.#C}get imageManager(){return Je(this,"imageManager",new Av)}getSelectionBoxes(t){if(!t)return null;let r=document.getSelection();for(let c=0,d=r.rangeCount;c<d;c++)if(!t.contains(r.getRangeAt(c).commonAncestorContainer))return null;let{x:i,y:s,width:a,height:o}=t.getBoundingClientRect(),l;switch(t.getAttribute("data-main-rotation")){case"90":l=(c,d,f,h)=>({x:(d-s)/o,y:1-(c+f-i)/a,width:h/o,height:f/a});break;case"180":l=(c,d,f,h)=>({x:1-(c+f-i)/a,y:1-(d+h-s)/o,width:f/a,height:h/o});break;case"270":l=(c,d,f,h)=>({x:1-(d+h-s)/o,y:(c-i)/a,width:h/o,height:f/a});break;default:l=(c,d,f,h)=>({x:(c-i)/a,y:(d-s)/o,width:f/a,height:h/o});break}let u=[];for(let c=0,d=r.rangeCount;c<d;c++){let f=r.getRangeAt(c);if(!f.collapsed)for(let{x:h,y:p,width:g,height:m}of f.getClientRects())g===0||m===0||u.push(l(h,p,g,m))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:r}){(this.#l||=new Map).set(t,r)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){let r=this.#l?.get(t.data.id);if(!r)return;let i=this.#s.getRawValue(r);i&&(this.#C===He.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}}return n})(),$C=(()=>{class n{#e=null;#t=!1;#n=null;#r=null;#i=null;#s=null;#l=!1;#c=null;#u=null;#o=null;#d=null;#a=!1;static#f=null;static _l10n=null;constructor(t){this.#u=t,this.#a=t._uiManager.useNewAltTextFlow,n.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){n._l10n??=t}render(){return ee(this,null,function*(){let t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";let r=this.#r=document.createElement("span");t.append(r),this.#a?(t.classList.add("new"),t.setAttribute("data-l10n-id",n.#f.missing),r.setAttribute("data-l10n-id",n.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));let i=this.#u._uiManager._signal;t.addEventListener("contextmenu",xr,{signal:i}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});let s=a=>{a.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#a&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#l=!0,s(a))},{signal:i}),yield this.#h(),t})}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#a?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#a?this.#e!==null||!!this.#o:this.isEmpty()}get guessedText(){return this.#o}setGuessedText(t){return ee(this,null,function*(){this.#e===null&&(this.#o=t,this.#d=yield n._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#h())})}toggleAltTextBadge(t=!1){if(!this.#a||this.#e){this.#c?.remove(),this.#c=null;return}if(!this.#c){let r=this.#c=document.createElement("div");r.className="noAltTextBadge",this.#u.div.append(r)}this.#c.classList.toggle("hidden",!t)}serialize(t){let r=this.#e;return!t&&this.#o===r&&(r=this.#d),{altText:r,decorative:this.#t,guessedText:this.#o,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:t,decorative:r,guessedText:i,textWithDisclaimer:s,cancel:a=!1}){i&&(this.#o=i,this.#d=s),!(this.#e===t&&this.#t===r)&&(a||(this.#e=t,this.#t=r),this.#h())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#i=null,this.#c?.remove(),this.#c=null}#h(){return ee(this,null,function*(){let t=this.#n;if(!t)return;if(this.#a){if(t.classList.toggle("done",!!this.#e),t.setAttribute("data-l10n-id",n.#f[this.#p]),this.#r?.setAttribute("data-l10n-id",n.#f[`${this.#p}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){t.classList.remove("done"),this.#i?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let r=this.#i;if(!r){this.#i=r=document.createElement("span"),r.className="tooltip",r.setAttribute("role","tooltip"),r.id=`alt-text-tooltip-${this.#u.id}`;let s=100,a=this.#u._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#i.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i?.classList.remove("show")},{signal:a})}this.#t?r.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(r.removeAttribute("data-l10n-id"),r.textContent=this.#e),r.parentNode||t.append(r),this.#u.getImageForAltText()?.setAttribute("aria-describedby",r.id)})}}return n})(),pt=class n{#e=null;#t=null;#n=null;#r=!1;#i=!1;#s=null;#l=null;#c=null;#u="";#o=!1;#d=null;#a=!1;#f=!1;#p=!1;#h=null;#g=0;#v=0;#m=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#y=n._zIndex++;static _borderLineWidth=-1;static _colorManager=new Sv;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=n.prototype._resizeWithKeyboard,t=uc.TRANSLATE_SMALL,r=uc.TRANSLATE_BIG;return Je(this,"_resizerKeyboardManager",new da([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],n.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];let[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Je(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new Tv({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(n._l10n??=e,n._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),n._borderLineWidth!==-1)return;let r=getComputedStyle(document.documentElement);n._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ct("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(e){this.#_=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#y}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#L(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#o?this.#o=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){let[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(t+i)/a,this.fixAndSetPosition()}#E([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this.fixAndSetPosition()}translate(e,t){this.#E(this.parentDimensions,e,t)}translateInPage(e,t){this.#d||=[this.x,this.y],this.#E(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#d||=[this.x,this.y];let[r,i]=this.parentDimensions;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:u,y:c}=this.div.getBoundingClientRect();this.parent.findNewParent(this,u,c)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:a}=this,[o,l]=this.getBaseTranslation();s+=o,a+=l,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#d&&(this.#d[0]!==this.x||this.#d[1]!==this.y)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:r}=n,i=r/e,s=r/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let[t,r]=this.pageDimensions,{x:i,y:s,width:a,height:o}=this;if(a*=t,o*=r,i*=t,s*=r,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(t-a,i)),s=Math.max(0,Math.min(r-o,s));break;case 90:i=Math.max(0,Math.min(t-o,i)),s=Math.min(r,Math.max(a,s));break;case 180:i=Math.min(t,Math.max(a,i)),s=Math.min(r,Math.max(o,s));break;case 270:i=Math.min(t,Math.max(o,i)),s=Math.max(0,Math.min(r-a,s));break}this.x=i/=t,this.y=s/=r;let[l,u]=this.getBaseTranslation();i+=l,s+=u;let{style:c}=this.div;c.left=`${(100*i).toFixed(2)}%`,c.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#w(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return n.#w(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return n.#w(e,t,360-this.parentRotation)}#b(e){switch(e){case 90:{let[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){let[r,i]=this.parentDimensions;this.div.style.width=`${(100*e/r).toFixed(2)}%`,this.#i||(this.div.style.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:r}=e,i=r.endsWith("%"),s=!this.#i&&t.endsWith("%");if(i&&s)return;let[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(r)/a).toFixed(2)}%`),!this.#i&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#k(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let r of e){let i=document.createElement("div");this.#s.append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",this.#T.bind(this,r),{signal:t}),i.addEventListener("contextmenu",xr,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#s)}#T(e,t){t.preventDefault();let{isMac:r}=mn.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#n?.toggle(!1);let i=this._isDraggable;this._isDraggable=!1;let s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#D.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("contextmenu",xr,{signal:a});let o=this.x,l=this.y,u=this.width,c=this.height,d=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let h=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=d,this.div.style.cursor=f,this.#A(o,l,u,c)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}#A(e,t,r,i){let s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===r&&l===i||this.addCommands({cmd:()=>{this.width=o,this.height=l,this.x=s,this.y=a;let[u,c]=this.parentDimensions;this.setDims(u*o,c*l),this.fixAndSetPosition()},undo:()=>{this.width=r,this.height=i,this.x=e,this.y=t;let[u,c]=this.parentDimensions;this.setDims(u*r,c*i),this.fixAndSetPosition()},mustExec:!0})}#D(e,t){let[r,i]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,u=n.MIN_SIZE/r,c=n.MIN_SIZE/i,d=J=>Math.round(J*1e4)/1e4,f=this.#b(this.rotation),h=(J,_e)=>[f[0]*J+f[2]*_e,f[1]*J+f[3]*_e],p=this.#b(360-this.rotation),g=(J,_e)=>[p[0]*J+p[2]*_e,p[1]*J+p[3]*_e],m,v,x=!1,_=!1;switch(e){case"topLeft":x=!0,m=(J,_e)=>[0,0],v=(J,_e)=>[J,_e];break;case"topMiddle":m=(J,_e)=>[J/2,0],v=(J,_e)=>[J/2,_e];break;case"topRight":x=!0,m=(J,_e)=>[J,0],v=(J,_e)=>[0,_e];break;case"middleRight":_=!0,m=(J,_e)=>[J,_e/2],v=(J,_e)=>[0,_e/2];break;case"bottomRight":x=!0,m=(J,_e)=>[J,_e],v=(J,_e)=>[0,0];break;case"bottomMiddle":m=(J,_e)=>[J/2,_e],v=(J,_e)=>[J/2,0];break;case"bottomLeft":x=!0,m=(J,_e)=>[0,_e],v=(J,_e)=>[J,0];break;case"middleLeft":_=!0,m=(J,_e)=>[0,_e/2],v=(J,_e)=>[J,_e/2];break}let b=m(o,l),D=v(o,l),A=h(...D),w=d(s+A[0]),T=d(a+A[1]),E=1,P=1,[N,O]=this.screenToPageTranslation(t.movementX,t.movementY);if([N,O]=g(N/r,O/i),x){let J=Math.hypot(o,l);E=P=Math.max(Math.min(Math.hypot(D[0]-b[0]-N,D[1]-b[1]-O)/J,1/o,1/l),u/o,c/l)}else _?E=Math.max(u,Math.min(1,Math.abs(D[0]-b[0]-N)))/o:P=Math.max(c,Math.min(1,Math.abs(D[1]-b[1]-O)))/l;let Y=d(o*E),se=d(l*P);A=h(...v(Y,se));let ie=w-A[0],ge=T-A[1];this.width=Y,this.height=se,this.x=ie,this.y=ge,this.setDims(r*Y,i*se),this.fixAndSetPosition()}altTextFinish(){this.#n?.finish()}addEditToolbar(){return ee(this,null,function*(){return this._editToolbar||this.#f?this._editToolbar:(this._editToolbar=new wv(this),this.div.append(this._editToolbar.render()),this.#n&&(yield this._editToolbar.addAltText(this.#n)),this._editToolbar)})}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return ee(this,null,function*(){this.#n||($C.initialize(n._l10n),this.#n=new $C(this),this.#e&&(this.#n.data=this.#e,this.#e=null),yield this.addEditToolbar())})}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}setGuessedAltText(e){return ee(this,null,function*(){yield this.#n?.setGuessedText(e)})}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#r?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#P();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[r,i]=this.getInitialTranslation();return this.translate(r,i),Bf(this,this.div,["pointerdown"]),this.div}pointerdown(e){let{isMac:t}=mn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#o=!0,this._isDraggable){this.#M(e);return}this.#S(e)}get isSelected(){return this._uiManager.isSelected(this)}#S(e){let{isMac:t}=mn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#M(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let r=new AbortController,i=this._uiManager.combinedSignal(r);if(t){this.div.classList.add("moving"),this.#g=e.clientX,this.#v=e.clientY;let a=o=>{let{clientX:l,clientY:u}=o,[c,d]=this.screenToPageTranslation(l-this.#g,u-this.#v);this.#g=l,this.#v=u,this._uiManager.dragSelectedEditors(c,d)};window.addEventListener("pointermove",a,{passive:!0,capture:!0,signal:i})}let s=()=>{r.abort(),t&&this.div.classList.remove("moving"),this.#o=!1,this._uiManager.endDragSession()||this.#S(e)};window.addEventListener("pointerup",s,{signal:i}),window.addEventListener("blur",s,{signal:i})}moveInDOM(){this.#h&&clearTimeout(this.#h),this.#h=setTimeout(()=>{this.#h=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition()}getRect(e,t,r=this.rotation){let i=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/i,c=t/i,d=this.x*s,f=this.y*a,h=this.width*s,p=this.height*a;switch(r){case 0:return[d+u+o,a-f-c-p+l,d+u+h+o,a-f-c+l];case 90:return[d+c+o,a-f+u+l,d+c+p+o,a-f+u+h+l];case 180:return[d-u-h+o,a-f+c+l,d-u+o,a-f+c+p+l];case 270:return[d-c-p+o,a-f-u-h+l,d-c+o,a-f-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[r,i,s,a]=e,o=s-r,l=a-i;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-i,l,o];case 180:return[s,t-i,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#f=!0}disableEditMode(){this.#f=!1}isInEditMode(){return this.#f}shouldGetKeyboardEvents(){return this.#p}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}#P(){if(this.#c||!this.div)return;this.#c=new AbortController;let e=this._uiManager.combinedSignal(this.#c);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#P()}rotate(e){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Ct("An editor must be serializable")}static deserialize(e,t,r){return ee(this,null,function*(){let i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});i.rotation=e.rotation,i.#e=e.accessibilityData;let[s,a]=i.pageDimensions,[o,l,u,c]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/s,i.y=l/a,i.width=u/s,i.height=c/a,i})}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#c?.abort(),this.#c=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#h&&(clearTimeout(this.#h),this.#h=null),this.#L(),this.removeEditToolbar(),this.#m){for(let e of this.#m.values())clearTimeout(e);this.#m=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#k(),this.#s.classList.remove("hidden"),Bf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#s.children;if(!this.#t){this.#t=Array.from(t);let a=this.#C.bind(this),o=this.#x.bind(this),l=this._uiManager._signal;for(let u of this.#t){let c=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",this.#I.bind(this,c),{signal:l}),u.setAttribute("data-l10n-id",n._l10nResizer[c])}}let r=this.#t[0],i=0;for(let a of t){if(a===r)break;i++}let s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==i){if(s<i)for(let o=0;o<i-s;o++)this.#s.append(this.#s.firstChild);else if(s>i)for(let o=0;o<s-i;o++)this.#s.firstChild.before(this.#s.lastChild);let a=0;for(let o of t){let u=this.#t[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",n._l10nResizer[u])}}this.#F(0),this.#p=!0,this.#s.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#C(e){n._resizerKeyboardManager.exec(this,e)}#x(e){this.#p&&e.relatedTarget?.parentNode!==this.#s&&this.#L()}#I(e){this.#u=this.#p?e:""}#F(e){if(this.#t)for(let t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#p&&this.#D(this.#u,{movementX:e,movementY:t})}#L(){if(this.#p=!1,this.#F(-1),this.#l){let{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=this.#l;this.#A(e,t,r,i),this.#l=null}}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#a}set isEditing(e){this.#a=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#i=!0;let r=e/t,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#m||=new Map;let{action:r}=e,i=this.#m.get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#m.delete(r),this.#m.size===0&&(this.#m=null)},n._telemetryTimeout),this.#m.set(r,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},Tv=class extends pt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},WC=3285377520,_r=4294901760,ci=65535,Vf=class{constructor(e){this.h1=e?e&4294967295:WC,this.h2=e?e&4294967295:WC}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let g=0,m=e.length;g<m;g++){let v=e.charCodeAt(g);v<=255?t[r++]=v:(t[r++]=v>>>8,t[r++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let i=r>>2,s=r-i*4,a=new Uint32Array(t.buffer,0,i),o=0,l=0,u=this.h1,c=this.h2,d=3432918353,f=461845907,h=d&ci,p=f&ci;for(let g=0;g<i;g++)g&1?(o=a[g],o=o*d&_r|o*h&ci,o=o<<15|o>>>17,o=o*f&_r|o*p&ci,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[g],l=l*d&_r|l*h&ci,l=l<<15|l>>>17,l=l*f&_r|l*p&ci,c^=l,c=c<<13|c>>>19,c=c*5+3864292196);switch(o=0,s){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*d&_r|o*h&ci,o=o<<15|o>>>17,o=o*f&_r|o*p&ci,i&1?u^=o:c^=o}this.h1=u,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&_r|e*36045&ci,t=t*4283543511&_r|((t<<16|e>>>16)*2950163797&_r)>>>16,e^=t>>>1,e=e*444984403&_r|e*60499&ci,t=t*3301882366&_r|((t<<16|e>>>16)*3120437893&_r)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},Dv=Object.freeze({map:null,hash:"",transfer:void 0}),dc=class{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let r=this.#n.get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#n.values())if(t instanceof pt)return;this.onAnnotationEditor(null)}}setValue(e,t){let r=this.#n.get(e),i=!1;if(r!==void 0)for(let[s,a]of Object.entries(t))r[s]!==a&&(i=!0,r[s]=a);else i=!0,this.#n.set(e,t);i&&this.#r(),t instanceof pt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}getAll(){return this.#n.size>0?L_(this.#n):null}setAll(e){for(let[t,r]of Object.entries(e))this.setValue(t,r)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new jf(this)}get serializable(){if(this.#n.size===0)return Dv;let e=new Map,t=new Vf,r=[],i=Object.create(null),s=!1;for(let[a,o]of this.#n){let l=o instanceof pt?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||=!!l.bitmap)}if(s)for(let a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:Dv}get editorStats(){let e=null,t=new Map;for(let r of this.#n.values()){if(!(r instanceof pt))continue;let i=r.telemetryFinalData;if(!i)continue;let{type:s}=i;t.has(s)||t.set(s,Object.getPrototypeOf(r).constructor),e||=Object.create(null);let a=e[s]||=new Map;for(let[o,l]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));let c=u.get(l)??0;u.set(l,c+1)}}for(let[r,i]of t)e[r]=i.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;let e=[];for(let t of this.#n.values())!(t instanceof pt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}},jf=class extends dc{#e;constructor(e){super();let{map:t,hash:r,transfer:i}=e.serializable,s=structuredClone(t,i?{transfer:i}:null);this.#e={map:s,hash:r,transfer:i}}get print(){Ct("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Je(this,"modifiedIds",{ids:new Set,hash:""})}},Iv=class{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(r){return ee(this,arguments,function*({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(rn(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:i,src:s,style:a}=e,o=new FontFace(i,s,a);this.addNativeFontFace(o);try{yield o.load(),this.#e.add(i),t?.(e)}catch{ze(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ct("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(e){return ee(this,null,function*(){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){yield this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{yield r.loaded}catch(i){throw ze(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;yield new Promise(r=>{let i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}})}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return Je(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(wn||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Je(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(rn(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){let s=r.shift();setTimeout(s.callback,0)}}let{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Je(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(b,D){return b.charCodeAt(D)<<24|b.charCodeAt(D+1)<<16|b.charCodeAt(D+2)<<8|b.charCodeAt(D+3)&255}function i(b,D,A,w){let T=b.substring(0,D),E=b.substring(D+A);return T+w+E}let s,a,o=this._document.createElement("canvas");o.width=1,o.height=1;let l=o.getContext("2d"),u=0;function c(b,D){if(++u>30){ze("Load test font never loaded."),D();return}if(l.font="30px "+b,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(c.bind(null,b,D))}let d=`lt${Date.now()}${this.loadTestFontId++}`,f=this._loadTestFont;f=i(f,976,d.length,d);let p=16,g=1482184792,m=r(f,p);for(s=0,a=d.length-3;s<a;s+=4)m=m-g+r(d,s)|0;s<d.length&&(m=m-g+r(d+"XXX",s)|0),f=i(f,p,4,eB(m));let v=`url(data:font/opentype;base64,${btoa(f)});`,x=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(x);let _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(let b of[e.loadedName,d]){let D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=b,_.append(D)}this._document.body.append(_),c(d,()=>{_.remove(),t.complete()})}},kv=class{constructor(e,{disableFontFace:t=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(let i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${aB(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let r;try{r=e.get(this.loadedName+"_path_"+t)}catch(s){ze(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(r)||r.length===0)return this.compiledGlyphs[t]=function(s,a){};let i=[];for(let s=0,a=r.length;s<a;)switch(r[s++]){case Vi.BEZIER_CURVE_TO:{let[o,l,u,c,d,f]=r.slice(s,s+6);i.push(h=>h.bezierCurveTo(o,l,u,c,d,f)),s+=6}break;case Vi.MOVE_TO:{let[o,l]=r.slice(s,s+2);i.push(u=>u.moveTo(o,l)),s+=2}break;case Vi.LINE_TO:{let[o,l]=r.slice(s,s+2);i.push(u=>u.lineTo(o,l)),s+=2}break;case Vi.QUADRATIC_CURVE_TO:{let[o,l,u,c]=r.slice(s,s+4);i.push(d=>d.quadraticCurveTo(o,l,u,c)),s+=4}break;case Vi.RESTORE:i.push(o=>o.restore());break;case Vi.SAVE:i.push(o=>o.save());break;case Vi.SCALE:rn(i.length===2,"Scale command is only valid at the third position.");break;case Vi.TRANSFORM:{let[o,l,u,c,d,f]=r.slice(s,s+6);i.push(h=>h.transform(o,l,u,c,d,f)),s+=6}break;case Vi.TRANSLATE:{let[o,l]=r.slice(s,s+2);i.push(u=>u.translate(o,l)),s+=2}break}return this.compiledGlyphs[t]=function(a,o){i[0](a),i[1](a),a.scale(o,-o);for(let l=2,u=i.length;l<u;l++)i[l](a)}}},Uf=class{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ct("Abstract method `_createCanvas` called.")}},Mv=class extends Uf{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let r=this._document.createElement("canvas");return r.width=e,r.height=t,r}},Hf=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}fetch(t){return ee(this,arguments,function*({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let r=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(r).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${r}`)})})}_fetch(e){return ee(this,null,function*(){Ct("Abstract method `_fetch` called.")})}},$f=class extends Hf{_fetch(e){return ee(this,null,function*(){let t=yield vh(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):mh(t)})}},Wf=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,s){return"none"}destroy(e=!1){}},Fv=class extends Wf{#e;#t;#n;#r;#i;#s;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#i=t}get#c(){return this.#t||=new Map}get#u(){return this.#s||=new Map}get#o(){if(!this.#n){let e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let r=this.#i.createElementNS(Ui,"svg");r.setAttribute("width",0),r.setAttribute("height",0),this.#n=this.#i.createElementNS(Ui,"defs"),e.append(r),r.append(this.#n),this.#i.body.append(e)}return this.#n}#d(e){if(e.length===1){let l=e[0],u=new Array(256);for(let d=0;d<256;d++)u[d]=l[d]/255;let c=u.join(",");return[c,c,c]}let[t,r,i]=e,s=new Array(256),a=new Array(256),o=new Array(256);for(let l=0;l<256;l++)s[l]=t[l]/255,a[l]=r[l]/255,o[l]=i[l]/255;return[s.join(","),a.join(","),o.join(",")]}#a(e){if(this.#e===void 0){this.#e="";let t=this.#i.URL;t!==this.#i.baseURI&&(_h(t)?ze('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#c.get(e);if(t)return t;let[r,i,s]=this.#d(e),a=e.length===1?r:`${r}${i}${s}`;if(t=this.#c.get(a),t)return this.#c.set(e,t),t;let o=`g_${this.#r}_transfer_map_${this.#l++}`,l=this.#a(o);this.#c.set(e,l),this.#c.set(a,l);let u=this.#h(o);return this.#v(r,i,s,u),l}addHCMFilter(e,t){let r=`${e}-${t}`,i="base",s=this.#u.get(i);if(s?.key===r||(s?(s.filter?.remove(),s.key=r,s.url="none",s.filter=null):(s={key:r,url:"none",filter:null},this.#u.set(i,s)),!e||!t))return s.url;let a=this.#_(e);e=Ae.makeHexColor(...a);let o=this.#_(t);if(t=Ae.makeHexColor(...o),this.#o.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;let l=new Array(256);for(let h=0;h<=255;h++){let p=h/255;l[h]=p<=.03928?p/12.92:((p+.055)/1.055)**2.4}let u=l.join(","),c=`g_${this.#r}_hcm_filter`,d=s.filter=this.#h(c);this.#v(u,u,u,d),this.#p(d);let f=(h,p)=>{let g=a[h]/255,m=o[h]/255,v=new Array(p+1);for(let x=0;x<=p;x++)v[x]=g+x/p*(m-g);return v.join(",")};return this.#v(f(0,5),f(1,5),f(2,5),d),s.url=this.#a(c),s.url}addAlphaFilter(e){let t=this.#c.get(e);if(t)return t;let[r]=this.#d([e]),i=`alpha_${r}`;if(t=this.#c.get(i),t)return this.#c.set(e,t),t;let s=`g_${this.#r}_alpha_map_${this.#l++}`,a=this.#a(s);this.#c.set(e,a),this.#c.set(i,a);let o=this.#h(s);return this.#m(r,o),a}addLuminosityFilter(e){let t=this.#c.get(e||"luminosity");if(t)return t;let r,i;if(e?([r]=this.#d([e]),i=`luminosity_${r}`):i="luminosity",t=this.#c.get(i),t)return this.#c.set(e,t),t;let s=`g_${this.#r}_luminosity_map_${this.#l++}`,a=this.#a(s);this.#c.set(e,a),this.#c.set(i,a);let o=this.#h(s);return this.#f(o),e&&this.#m(r,o),a}addHighlightHCMFilter(e,t,r,i,s){let a=`${t}-${r}-${i}-${s}`,o=this.#u.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#u.set(e,o)),!t||!r))return o.url;let[l,u]=[t,r].map(this.#_.bind(this)),c=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[f,h]=[i,s].map(this.#_.bind(this));d<c&&([c,d,f,h]=[d,c,h,f]),this.#o.style.color="";let p=(v,x,_)=>{let b=new Array(256),D=(d-c)/_,A=v/255,w=(x-v)/(255*_),T=0;for(let E=0;E<=_;E++){let P=Math.round(c+E*D),N=A+E*w;for(let O=T;O<=P;O++)b[O]=N;T=P+1}for(let E=T;E<256;E++)b[E]=b[T-1];return b.join(",")},g=`g_${this.#r}_hcm_${e}_filter`,m=o.filter=this.#h(g);return this.#p(m),this.#v(p(f[0],h[0],5),p(f[1],h[1],5),p(f[2],h[2],5),m),o.url=this.#a(g),o.url}destroy(e=!1){e&&this.#u.size!==0||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#t&&(this.#t.clear(),this.#t=null),this.#l=0)}#f(e){let t=this.#i.createElementNS(Ui,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){let t=this.#i.createElementNS(Ui,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#h(e){let t=this.#i.createElementNS(Ui,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#o.append(t),t}#g(e,t,r){let i=this.#i.createElementNS(Ui,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),e.append(i)}#v(e,t,r,i){let s=this.#i.createElementNS(Ui,"feComponentTransfer");i.append(s),this.#g(s,"feFuncR",e),this.#g(s,"feFuncG",t),this.#g(s,"feFuncB",r)}#m(e,t){let r=this.#i.createElementNS(Ui,"feComponentTransfer");t.append(r),this.#g(r,"feFuncA",e)}#_(e){return this.#o.style.color=e,j_(getComputedStyle(this.#o).getPropertyValue("color"))}},zf=class{constructor({baseUrl:e=null}){this.baseUrl=e}fetch(t){return ee(this,arguments,function*({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let r=`${this.baseUrl}${e}`;return this._fetch(r).catch(i=>{throw new Error(`Unable to load font data at: ${r}`)})})}_fetch(e){return ee(this,null,function*(){Ct("Abstract method `_fetch` called.")})}},Gf=class extends zf{_fetch(e){return ee(this,null,function*(){let t=yield vh(e,"arraybuffer");return new Uint8Array(t)})}};wn&&(Pf=Promise.withResolvers(),Rf=null,ee(void 0,null,function*(){let e=yield import("./chunk-L2HEV66R.js"),t=yield import("./chunk-BMBYILCS.js"),r=yield import("./chunk-ALIQTIYY.js"),i=yield import("./chunk-NYZOWURK.js"),s,a;return new Map(Object.entries({fs:e,http:t,https:r,url:i,canvas:s,path2d:a}))}).then(e=>{Rf=e,Pf.resolve()},e=>{ze(`loadPackages: ${e}`),Rf=new Map,Pf.resolve()}));var Pf,Rf,ui=class{static get promise(){return Pf.promise}static get(e){return Rf?.get(e)}};function iS(n){return ee(this,null,function*(){let t=yield ui.get("fs").promises.readFile(n);return new Uint8Array(t)})}var Pv=class extends Wf{},Rv=class extends Uf{_createCanvas(e,t){return ui.get("canvas").createCanvas(e,t)}},Nv=class extends Hf{_fetch(e){return ee(this,null,function*(){return iS(e)})}},Ov=class extends zf{_fetch(e){return ee(this,null,function*(){return iS(e)})}},Ln={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Lv(n,e){if(!e)return;let t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}var fc=class{getPattern(){Ct("Abstract method `getPattern` called.")}},Bv=class extends fc{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let s;if(i===Ln.STROKE||i===Ln.FILL){let a=t.current.getClippedPathBoundingBox(i,kt(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),c=u.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),r=Ae.transform(r,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),Lv(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=e.createPattern(u.canvas,"no-repeat");let d=new DOMMatrix(r);s.setTransform(d)}else Lv(e,this._bbox),s=this._createGradient(e);return s}};function mv(n,e,t,r,i,s,a,o){let l=e.coords,u=e.colors,c=n.data,d=n.width*4,f;l[t+1]>l[r+1]&&(f=t,t=r,r=f,f=s,s=a,a=f),l[r+1]>l[i+1]&&(f=r,r=i,i=f,f=a,a=o,o=f),l[t+1]>l[r+1]&&(f=t,t=r,r=f,f=s,s=a,a=f);let h=(l[t]+e.offsetX)*e.scaleX,p=(l[t+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,m=(l[r+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY;if(p>=x)return;let _=u[s],b=u[s+1],D=u[s+2],A=u[a],w=u[a+1],T=u[a+2],E=u[o],P=u[o+1],N=u[o+2],O=Math.round(p),Y=Math.round(x),se,ie,ge,J,_e,de,ye,K;for(let F=O;F<=Y;F++){if(F<m){let oe=F<p?0:(p-F)/(p-m);se=h-(h-g)*oe,ie=_-(_-A)*oe,ge=b-(b-w)*oe,J=D-(D-T)*oe}else{let oe;F>x?oe=1:m===x?oe=0:oe=(m-F)/(m-x),se=g-(g-v)*oe,ie=A-(A-E)*oe,ge=w-(w-P)*oe,J=T-(T-N)*oe}let U;F<p?U=0:F>x?U=1:U=(p-F)/(p-x),_e=h-(h-v)*U,de=_-(_-E)*U,ye=b-(b-P)*U,K=D-(D-N)*U;let j=Math.round(Math.min(se,_e)),L=Math.round(Math.max(se,_e)),Q=d*F+j*4;for(let oe=j;oe<=L;oe++)U=(se-oe)/(se-_e),U<0?U=0:U>1&&(U=1),c[Q++]=ie-(ie-de)*U|0,c[Q++]=ge-(ge-ye)*U|0,c[Q++]=J-(J-K)*U|0,c[Q++]=255}}function fB(n,e,t){let r=e.coords,i=e.colors,s,a;switch(e.type){case"lattice":let o=e.verticesPerRow,l=Math.floor(r.length/o)-1,u=o-1;for(s=0;s<l;s++){let c=s*o;for(let d=0;d<u;d++,c++)mv(n,t,r[c],r[c+1],r[c+o],i[c],i[c+1],i[c+o]),mv(n,t,r[c+o+1],r[c+1],r[c+o],i[c+o+1],i[c+1],i[c+o])}break;case"triangles":for(s=0,a=r.length;s<a;s+=3)mv(n,t,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}var Vv=class extends fc{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,r){let o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,c=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(c*e[1]*1.1)),3e3),h=u/d,p=c/f,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/h,scaleY:1/p},m=d+2*2,v=f+2*2,x=r.getCanvas("mesh",m,v),_=x.context,b=_.createImageData(d,f);if(t){let A=b.data;for(let w=0,T=A.length;w<T;w+=4)A[w]=t[0],A[w+1]=t[1],A[w+2]=t[2],A[w+3]=255}for(let A of this._figures)fB(b,A,g);return _.putImageData(b,2,2),{canvas:x.canvas,offsetX:o-2*h,offsetY:l-2*p,scaleX:h,scaleY:p}}getPattern(e,t,r,i){Lv(e,this._bbox);let s;if(i===Ln.SHADING)s=Ae.singularValueDecompose2dScale(kt(e));else if(s=Ae.singularValueDecompose2dScale(t.baseTransform),this.matrix){let o=Ae.singularValueDecompose2dScale(this.matrix);s=[s[0]*o[0],s[1]*o[1]]}let a=this._createMeshCanvas(s,i===Ln.SHADING?null:this._background,t.cachedCanvases);return i!==Ln.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}},jv=class extends fc{getPattern(){return"hotpink"}};function hB(n){switch(n[0]){case"RadialAxial":return new Bv(n);case"Mesh":return new Vv(n);case"Dummy":return new jv}throw new Error(`Unknown IR type: ${n[0]}`)}var zC={COLORED:1,UNCOLORED:2},pB=(()=>{class n{static MAX_PATTERN_SIZE=3e3;constructor(t,r,i,s,a){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=r,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t){let{bbox:r,operatorList:i,paintType:s,tilingType:a,color:o,canvasGraphicsFactory:l}=this,{xstep:u,ystep:c}=this;u=Math.abs(u),c=Math.abs(c),gh("TilingType: "+a);let d=r[0],f=r[1],h=r[2],p=r[3],g=h-d,m=p-f,v=Ae.singularValueDecompose2dScale(this.matrix),x=Ae.singularValueDecompose2dScale(this.baseTransform),_=v[0]*x[0],b=v[1]*x[1],D=g,A=m,w=!1,T=!1,E=Math.ceil(u*_),P=Math.ceil(c*b),N=Math.ceil(g*_),O=Math.ceil(m*b);E>=N?D=u:w=!0,P>=O?A=c:T=!0;let Y=this.getSizeAndScale(D,this.ctx.canvas.width,_),se=this.getSizeAndScale(A,this.ctx.canvas.height,b),ie=t.cachedCanvases.getCanvas("pattern",Y.size,se.size),ge=ie.context,J=l.createCanvasGraphics(ge);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,s,o),ge.translate(-Y.scale*d,-se.scale*f),J.transform(Y.scale,0,0,se.scale,0,0),ge.save(),this.clipBbox(J,d,f,h,p),J.baseTransform=kt(J.ctx),J.executeOperatorList(i),J.endDrawing(),ge.restore(),w||T){let _e=ie.canvas;w&&(D=u),T&&(A=c);let de=this.getSizeAndScale(D,this.ctx.canvas.width,_),ye=this.getSizeAndScale(A,this.ctx.canvas.height,b),K=de.size,F=ye.size,U=t.cachedCanvases.getCanvas("pattern-workaround",K,F),j=U.context,L=w?Math.floor(g/u):0,Q=T?Math.floor(m/c):0;for(let oe=0;oe<=L;oe++)for(let ue=0;ue<=Q;ue++)j.drawImage(_e,K*oe,F*ue,K,F,0,0,K,F);return{canvas:U.canvas,scaleX:de.scale,scaleY:ye.scale,offsetX:d,offsetY:f}}return{canvas:ie.canvas,scaleX:Y.scale,scaleY:se.scale,offsetX:d,offsetY:f}}getSizeAndScale(t,r,i){let s=Math.max(n.MAX_PATTERN_SIZE,r),a=Math.ceil(t*i);return a>=s?a=s:i=a/t,{scale:i,size:a}}clipBbox(t,r,i,s,a){let o=s-r,l=a-i;t.ctx.rect(r,i,o,l),t.current.updateRectMinMax(kt(t.ctx),[r,i,s,a]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,r,i){let s=t.ctx,a=t.current;switch(r){case zC.COLORED:let o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,a.fillColor=o.fillStyle,a.strokeColor=o.strokeStyle;break;case zC.UNCOLORED:let l=Ae.makeHexColor(i[0],i[1],i[2]);s.fillStyle=l,s.strokeStyle=l,a.fillColor=l,a.strokeColor=l;break;default:throw new yv(`Unsupported paint type: ${r}`)}}getPattern(t,r,i,s){let a=i;s!==Ln.SHADING&&(a=Ae.transform(a,r.baseTransform),this.matrix&&(a=Ae.transform(a,this.matrix)));let o=this.createPatternCanvas(r),l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);let u=t.createPattern(o.canvas,"repeat");return u.setTransform(l),u}}return n})();function gB({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){let o=mn.isLittleEndian?4278190080:255,[l,u]=a?[s,o]:[o,s],c=r>>3,d=r&7,f=n.length;t=new Uint32Array(t.buffer);let h=0;for(let p=0;p<i;p++){for(let m=e+c;e<m;e++){let v=e<f?n[e]:255;t[h++]=v&128?u:l,t[h++]=v&64?u:l,t[h++]=v&32?u:l,t[h++]=v&16?u:l,t[h++]=v&8?u:l,t[h++]=v&4?u:l,t[h++]=v&2?u:l,t[h++]=v&1?u:l}if(d===0)continue;let g=e<f?n[e++]:255;for(let m=0;m<d;m++)t[h++]=g&1<<7-m?u:l}return{srcPos:e,destPos:h}}var GC=16,qC=100,mB=15,XC=10,YC=1e3,Yn=16;function vB(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(r,i){e.translate(r,i),this.__originalTranslate(r,i)},n.scale=function(r,i){e.scale(r,i),this.__originalScale(r,i)},n.transform=function(r,i,s,a,o,l){e.transform(r,i,s,a,o,l),this.__originalTransform(r,i,s,a,o,l)},n.setTransform=function(r,i,s,a,o,l){e.setTransform(r,i,s,a,o,l),this.__originalSetTransform(r,i,s,a,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(r){e.rotate(r),this.__originalRotate(r)},n.clip=function(r){e.clip(r),this.__originalClip(r)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,s,a,o){e.bezierCurveTo(t,r,i,s,a,o),this.__originalBezierCurveTo(t,r,i,s,a,o)},n.rect=function(t,r,i,s){e.rect(t,r,i,s),this.__originalRect(t,r,i,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var Uv=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function Sf(n,e,t,r,i,s,a,o,l,u){let[c,d,f,h,p,g]=kt(n);if(d===0&&f===0){let x=a*c+p,_=Math.round(x),b=o*h+g,D=Math.round(b),A=(a+l)*c+p,w=Math.abs(Math.round(A)-_)||1,T=(o+u)*h+g,E=Math.abs(Math.round(T)-D)||1;return n.setTransform(Math.sign(c),0,0,Math.sign(h),_,D),n.drawImage(e,t,r,i,s,0,0,w,E),n.setTransform(c,d,f,h,p,g),[w,E]}if(c===0&&h===0){let x=o*f+p,_=Math.round(x),b=a*d+g,D=Math.round(b),A=(o+u)*f+p,w=Math.abs(Math.round(A)-_)||1,T=(a+l)*d+g,E=Math.abs(Math.round(T)-D)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,_,D),n.drawImage(e,t,r,i,s,0,0,E,w),n.setTransform(c,d,f,h,p,g),[E,w]}n.drawImage(e,t,r,i,s,a,o,l,u);let m=Math.hypot(c,d),v=Math.hypot(f,h);return[m*l,v*u]}function _B(n){let{width:e,height:t}=n;if(e>YC||t>YC)return null;let r=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1,a=new Uint8Array(s*(t+1)),o,l,u,c=e+7&-8,d=new Uint8Array(c*t),f=0;for(let v of n.data){let x=128;for(;x>0;)d[f++]=v&x?0:255,x>>=1}let h=0;for(f=0,d[f]!==0&&(a[0]=1,++h),l=1;l<e;l++)d[f]!==d[f+1]&&(a[l]=d[f]?2:1,++h),f++;for(d[f]!==0&&(a[l]=2,++h),o=1;o<t;o++){f=o*c,u=o*s,d[f-c]!==d[f]&&(a[u]=d[f]?1:8,++h);let v=(d[f]?4:0)+(d[f-c]?8:0);for(l=1;l<e;l++)v=(v>>2)+(d[f+1]?4:0)+(d[f-c+1]?8:0),i[v]&&(a[u+l]=i[v],++h),f++;if(d[f-c]!==d[f]&&(a[u+l]=d[f]?2:4,++h),h>r)return null}for(f=c*(t-1),u=o*s,d[f]!==0&&(a[u]=8,++h),l=1;l<e;l++)d[f]!==d[f+1]&&(a[u+l]=d[f]?4:8,++h),f++;if(d[f]!==0&&(a[u+l]=4,++h),h>r)return null;let p=new Int32Array([0,s,-1,0,-s,0,0,0,1]),g=new Path2D;for(o=0;h&&o<=t;o++){let v=o*s,x=v+e;for(;v<x&&!a[v];)v++;if(v===x)continue;g.moveTo(v%s,o);let _=v,b=a[v];do{let D=p[b];do v+=D;while(!a[v]);let A=a[v];A!==5&&A!==10?(b=A,a[v]=0):(b=A&51*b>>4,a[v]&=b>>2|b<<2),g.lineTo(v%s,v/s|0),a[v]||--h}while(_!==v);--o}return d=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(g),v.beginPath(),v.restore()}}var qf=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=nS,this.textMatrixScale=1,this.fontMatrix=xv,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=yn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,r){[t,r]=Ae.applyTransform([t,r],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(e,t){let r=Ae.applyTransform(t,e),i=Ae.applyTransform(t.slice(2),e),s=Ae.applyTransform([t[0],t[3]],e),a=Ae.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,r[0],i[0],s[0],a[0]),this.minY=Math.min(this.minY,r[1],i[1],s[1],a[1]),this.maxX=Math.max(this.maxX,r[0],i[0],s[0],a[0]),this.maxY=Math.max(this.maxY,r[1],i[1],s[1],a[1])}updateScalingPathMinMax(e,t){Ae.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,r,i,s,a,o,l,u,c){let d=Ae.bezierBoundingBox(t,r,i,s,a,o,l,u,c);c||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Ln.FILL,t=null){let r=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ln.STROKE){t||Ct("Stroke bounding box must include transform.");let i=Ae.singularValueDecompose2dScale(t),s=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;r[0]-=s,r[1]-=a,r[2]+=s,r[3]+=a}return r}updateClipFromPath(){let e=Ae.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ln.FILL,t=null){return Ae.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function KC(n,e){if(typeof ImageData<"u"&&e instanceof ImageData){n.putImageData(e,0,0);return}let t=e.height,r=e.width,i=t%Yn,s=(t-i)/Yn,a=i===0?s:s+1,o=n.createImageData(r,Yn),l=0,u,c=e.data,d=o.data,f,h,p,g;if(e.kind===Ff.GRAYSCALE_1BPP){let m=c.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),x=v.length,_=r+7>>3,b=4294967295,D=mn.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(p=f<s?Yn:i,u=0,h=0;h<p;h++){let A=m-l,w=0,T=A>_?r:A*8-7,E=T&-8,P=0,N=0;for(;w<E;w+=8)N=c[l++],v[u++]=N&128?b:D,v[u++]=N&64?b:D,v[u++]=N&32?b:D,v[u++]=N&16?b:D,v[u++]=N&8?b:D,v[u++]=N&4?b:D,v[u++]=N&2?b:D,v[u++]=N&1?b:D;for(;w<T;w++)P===0&&(N=c[l++],P=128),v[u++]=N&P?b:D,P>>=1}for(;u<x;)v[u++]=0;n.putImageData(o,0,f*Yn)}}else if(e.kind===Ff.RGBA_32BPP){for(h=0,g=r*Yn*4,f=0;f<s;f++)d.set(c.subarray(l,l+g)),l+=g,n.putImageData(o,0,h),h+=Yn;f<a&&(g=r*i*4,d.set(c.subarray(l,l+g)),n.putImageData(o,0,h))}else if(e.kind===Ff.RGB_24BPP)for(p=Yn,g=r*p,f=0;f<a;f++){for(f>=s&&(p=i,g=r*p),u=0,h=g;h--;)d[u++]=c[l++],d[u++]=c[l++],d[u++]=c[l++],d[u++]=255;n.putImageData(o,0,f*Yn)}else throw new Error(`bad image kind: ${e.kind}`)}function QC(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}let t=e.height,r=e.width,i=t%Yn,s=(t-i)/Yn,a=i===0?s:s+1,o=n.createImageData(r,Yn),l=0,u=e.data,c=o.data;for(let d=0;d<a;d++){let f=d<s?Yn:i;({srcPos:l}=gB({src:u,srcPos:l,dest:c,width:r,height:f,nonBlackColor:0})),n.putImageData(o,0,d*Yn)}}function tc(n,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Tf(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!wn){let{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function ZC(n,e){if(e)return!0;let t=Ae.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let r=Math.fround((globalThis.devicePixelRatio||1)*Es.PDF_TO_CSS_UNITS);return t[0]<=r&&t[1]<=r}var xB=["butt","round","square"],yB=["miter","round","bevel"],wB={},JC={},Ao=class n{constructor(e,t,r,i,s,{optionalContentConfig:a,markedContentStack:o=null},l,u){this.ctx=e,this.current=new qf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Uv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){let s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){let l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...kt(this.compositeCtx))}this.ctx.save(),Tf(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=kt(this.ctx)}executeOperatorList(e,t,r,i){let s=e.argsArray,a=e.fnArray,o=t||0,l=s.length;if(l===o)return o;let u=l-o>XC&&typeof r=="function",c=u?Date.now()+mB:0,d=0,f=this.commonObjs,h=this.objs,p;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,r),o;if(p=a[o],p!==Lr.dependency)this[p].apply(this,s[o]);else for(let g of s[o]){let m=g.startsWith("g_")?f:h;if(!m.has(g))return m.get(g,r),o}if(o++,o===l)return o;if(u&&++d>XC){if(Date.now()>c)return r(),o;d=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let r=e.width??e.displayWidth,i=e.height??e.displayHeight,s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=i,u="prescale1",c,d;for(;s>2&&o>1||a>2&&l>1;){let f=o,h=l;s>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/f),a>2&&l>1&&(h=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/h),c=this.cachedCanvases.getCanvas(u,f,h),d=c.context,d.clearRect(0,0,f,h),d.drawImage(e,0,0,o,l,0,0,f,h),e=c.canvas,o=f,l=h,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){let t=this.ctx,{width:r,height:i}=e,s=this.current.fillColor,a=this.current.patternFill,o=kt(t),l,u,c,d;if((e.bitmap||e.data)&&e.count>1){let T=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(T),l||(l=new Map,this._cachedBitmapsMap.set(T,l));let E=l.get(u);if(E&&!a){let P=Math.round(Math.min(o[0],o[2])+o[4]),N=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:E,offsetX:P,offsetY:N}}c=E}c||(d=this.cachedCanvases.getCanvas("maskCanvas",r,i),QC(d.context,e));let f=Ae.transform(o,[1/r,0,0,-1/i,0,0]);f=Ae.transform(f,[1,0,0,1,0,-i]);let[h,p,g,m]=Ae.getAxialAlignedBoundingBox([0,0,r,i],f),v=Math.round(g-h)||1,x=Math.round(m-p)||1,_=this.cachedCanvases.getCanvas("fillCanvas",v,x),b=_.context,D=h,A=p;b.translate(-D,-A),b.transform(...f),c||(c=this._scaleImage(d.canvas,ji(b)),c=c.img,l&&a&&l.set(u,c)),b.imageSmoothingEnabled=ZC(kt(b),e.interpolate),Sf(b,c,0,0,c.width,c.height,0,0,r,i),b.globalCompositeOperation="source-in";let w=Ae.transform(ji(b),[1,0,0,1,-D,-A]);return b.fillStyle=a?s.getPattern(t,this,w,Ln.FILL):s,b.fillRect(0,0,r,i),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,_.canvas)),{canvas:_.canvas,offsetX:Math.round(D),offsetY:Math.round(A)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=xB[e]}setLineJoin(e){this.ctx.lineJoin=yB[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;let s=this.ctx;s.setTransform(...kt(this.suspendedCtx)),tc(this.suspendedCtx,s),vB(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),tc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){let s=i[0],a=i[1],o=i[2]-s,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,s,a,o,l,u,c,d){let f=e.canvas,h=l-c,p=u-d;if(a){let m=Ae.makeHexColor(...a);if(h<0||p<0||h+r>f.width||p+i>f.height){let v=this.cachedCanvases.getCanvas("maskExtension",r,i),x=v.context;x.drawImage(f,-h,-p),x.globalCompositeOperation="destination-atop",x.fillStyle=m,x.fillRect(0,0,r,i),x.globalCompositeOperation="source-over",f=v.canvas,h=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let v=new Path2D;v.rect(h,p,r,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=m,e.fillRect(h,p,r,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));let g=new Path2D;g.rect(l,u,r,i),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(f,h,p,r,i,l,u,r,i),t.restore()}save(){this.inSMaskMode?(tc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),tc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,r,i,s,a){this.ctx.transform(e,t,r,i,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){let i=this.ctx,s=this.current,a=s.x,o=s.y,l,u,c=kt(i),d=c[0]===0&&c[3]===0||c[1]===0&&c[2]===0,f=d?r.slice(0):null;for(let h=0,p=0,g=e.length;h<g;h++)switch(e[h]|0){case Lr.rectangle:a=t[p++],o=t[p++];let m=t[p++],v=t[p++],x=a+m,_=o+v;i.moveTo(a,o),m===0||v===0?i.lineTo(x,_):(i.lineTo(x,o),i.lineTo(x,_),i.lineTo(a,_)),d||s.updateRectMinMax(c,[a,o,x,_]),i.closePath();break;case Lr.moveTo:a=t[p++],o=t[p++],i.moveTo(a,o),d||s.updatePathMinMax(c,a,o);break;case Lr.lineTo:a=t[p++],o=t[p++],i.lineTo(a,o),d||s.updatePathMinMax(c,a,o);break;case Lr.curveTo:l=a,u=o,a=t[p+4],o=t[p+5],i.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],a,o),s.updateCurvePathMinMax(c,l,u,t[p],t[p+1],t[p+2],t[p+3],a,o,f),p+=6;break;case Lr.curveTo2:l=a,u=o,i.bezierCurveTo(a,o,t[p],t[p+1],t[p+2],t[p+3]),s.updateCurvePathMinMax(c,l,u,a,o,t[p],t[p+1],t[p+2],t[p+3],f),a=t[p+2],o=t[p+3],p+=4;break;case Lr.curveTo3:l=a,u=o,a=t[p+2],o=t[p+3],i.bezierCurveTo(t[p],t[p+1],a,o,a,o),s.updateCurvePathMinMax(c,l,u,t[p],t[p+1],a,o,a,o,f),p+=4;break;case Lr.closePath:i.closePath();break}d&&s.updateScalingPathMinMax(c,f),s.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,r=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&r?.getPattern?(t.save(),t.strokeStyle=r.getPattern(t,this,ji(t),Ln.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,r=this.current.fillColor,i=this.current.patternFill,s=!1;i&&(t.save(),t.fillStyle=r.getPattern(t,this,ji(t),Ln.FILL),s=!0);let a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=wB}eoClip(){this.pendingClip=JC}beginText(){this.current.textMatrix=nS,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(let r of e)t.setTransform(...r.transform),t.translate(r.x,r.y),r.addToPath(t,r.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let r=this.commonObjs.get(e),i=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=r.fontMatrix||xv,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ze("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;let s=r.loadedName||"sans-serif",a=r.systemFontInfo?.css||`"${s}", ${r.fallbackName}`,o="normal";r.black?o="900":r.bold&&(o="bold");let l=r.italic?"italic":"normal",u=t;t<GC?u=GC:t>qC&&(u=qC),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,r,i,s,a){this.current.textMatrix=[e,t,r,i,s,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,r,i){let s=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,c=l&yn.FILL_STROKE_MASK,d=!!(l&yn.ADD_TO_PATH_FLAG),f=a.patternFill&&!o.missingFile,h;(o.disableFontFace||d||f)&&(h=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||f?(s.save(),s.translate(t,r),s.beginPath(),h(s,u),i&&s.setTransform(...i),(c===yn.FILL||c===yn.FILL_STROKE)&&s.fill(),(c===yn.STROKE||c===yn.FILL_STROKE)&&s.stroke(),s.restore()):((c===yn.FILL||c===yn.FILL_STROKE)&&s.fillText(e,t,r),(c===yn.STROKE||c===yn.FILL_STROKE)&&s.strokeText(e,t,r)),d&&(this.pendingTextPaths||=[]).push({transform:kt(s),x:t,y:r,fontSize:u,addToPath:h})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Je(this,"isFontSubpixelAAEnabled",r)}showText(e){let t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);let i=t.fontSize;if(i===0)return;let s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,c=t.textHScale*u,d=e.length,f=r.vertical,h=f?1:-1,p=r.defaultVMetrics,g=i*t.fontMatrix[0],m=t.textRenderingMode===yn.FILL&&!r.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),u>0?s.scale(c,-1):s.scale(c,1);let v;if(t.patternFill){s.save();let A=t.fillColor.getPattern(s,this,ji(s),Ln.FILL);v=kt(s),s.restore(),s.fillStyle=A}let x=t.lineWidth,_=t.textMatrixScale;if(_===0||x===0){let A=t.textRenderingMode&yn.FILL_STROKE_MASK;(A===yn.STROKE||A===yn.FILL_STROKE)&&(x=this.getSinglePixelWidth())}else x/=_;if(a!==1&&(s.scale(a,a),x/=a),s.lineWidth=x,r.isInvalidPDFjsFont){let A=[],w=0;for(let T of e)A.push(T.unicode),w+=T.width;s.fillText(A.join(""),0,0),t.x+=w*g*c,s.restore(),this.compose();return}let b=0,D;for(D=0;D<d;++D){let A=e[D];if(typeof A=="number"){b+=h*A*i/1e3;continue}let w=!1,T=(A.isSpace?l:0)+o,E=A.fontChar,P=A.accent,N,O,Y=A.width;if(f){let ie=A.vmetric||p,ge=-(A.vmetric?ie[1]:Y*.5)*g,J=ie[2]*g;Y=ie?-ie[0]:Y,N=ge/a,O=(b+J)/a}else N=b/a,O=0;if(r.remeasure&&Y>0){let ie=s.measureText(E).width*1e3/i*a;if(Y<ie&&this.isFontSubpixelAAEnabled){let ge=Y/ie;w=!0,s.save(),s.scale(ge,1),N/=ge}else Y!==ie&&(N+=(Y-ie)/2e3*i/a)}if(this.contentVisible&&(A.isInFont||r.missingFile)){if(m&&!P)s.fillText(E,N,O);else if(this.paintChar(E,N,O,v),P){let ie=N+i*P.offset.x/a,ge=O-i*P.offset.y/a;this.paintChar(P.fontChar,ie,ge,v)}}let se=f?Y*g-T*u:Y*g+T*u;b+=se,w&&s.restore()}f?t.y-=b:t.x+=b*c,s.restore(),this.compose()}showType3Text(e){let t=this.ctx,r=this.current,i=r.font,s=r.fontSize,a=r.fontDirection,o=i.vertical?1:-1,l=r.charSpacing,u=r.wordSpacing,c=r.textHScale*a,d=r.fontMatrix||xv,f=e.length,h=r.textRenderingMode===yn.INVISIBLE,p,g,m,v;if(!(h||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...r.textMatrix),t.translate(r.x,r.y),t.scale(c,a),p=0;p<f;++p){if(g=e[p],typeof g=="number"){v=o*g*s/1e3,this.ctx.translate(v,0),r.x+=v*c;continue}let x=(g.isSpace?u:0)+l,_=i.charProcOperatorList[g.operatorListId];if(!_){ze(`Type3 character "${g.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=g,this.save(),t.scale(s,s),t.transform(...d),this.executeOperatorList(_),this.restore()),m=Ae.applyTransform([g.width,0],d)[0]*s+x,t.translate(m,0),r.x+=m*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,i,s,a){this.ctx.rect(r,i,s-r,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let r=e[1],i=this.baseTransform||kt(this.ctx),s={createCanvasGraphics:a=>new n(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new pB(e,r,this.ctx,s,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,r){this.ctx.strokeStyle=this.current.strokeColor=Ae.makeHexColor(e,t,r)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,r){this.ctx.fillStyle=this.current.fillColor=Ae.makeHexColor(e,t,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=hB(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,ji(t),Ln.SHADING);let i=ji(t);if(i){let{width:s,height:a}=t.canvas,[o,l,u,c]=Ae.getAxialAlignedBoundingBox([0,0,s,a],i);this.ctx.fillRect(o,l,u-o,c-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ct("Should not call beginInlineImage")}beginImageData(){Ct("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=kt(this.ctx),t)){let r=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],r,i),this.current.updateRectMinMax(kt(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||gh("TODO: Support non-isolated groups."),e.knockout&&ze("Knockout groups not supported.");let r=kt(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Ae.getAxialAlignedBoundingBox(e.bbox,kt(t)),s=[0,0,t.canvas.width,t.canvas.height];i=Ae.intersect(i,s)||[0,0,0,0];let a=Math.floor(i[0]),o=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,u]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);let d=this.cachedCanvases.getCanvas(c,l,u),f=d.context;f.translate(-a,-o),f.transform(...r),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),tc(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let i=kt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);let s=Ae.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,r,i,s){if(this.#e(),Tf(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;let[l,u]=Ae.singularValueDecompose2dScale(kt(this.ctx)),{viewportScale:c}=this,d=Math.ceil(a*this.outputScaleX*c),f=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,f);let{canvas:h,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,o*u),Tf(this.ctx)}else Tf(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new qf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let r=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=_B(e)),i.compiled)){i.compiled(r);return}let s=this._createMaskCanvas(e),a=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(a,s.offsetX,s.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,i=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);let o=this.ctx;o.save();let l=kt(o);o.transform(t,r,i,s,0,0);let u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let c=0,d=a.length;c<d;c+=2){let f=Ae.transform(l,[t,r,i,s,a[c],a[c+1]]),[h,p]=Ae.applyTransform([0,0],f);o.drawImage(u.canvas,h,p)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(let s of e){let{data:a,width:o,height:l,transform:u}=s,c=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=c.context;d.save();let f=this.getObject(a,s);QC(d,f),d.globalCompositeOperation="source-in",d.fillStyle=i?r.getPattern(d,this,ji(t),Ln.FILL):r,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),Sf(t,c.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,i){if(!this.contentVisible)return;let s=this.getObject(e);if(!s){ze("Dependent image isn't ready yet");return}let a=s.width,o=s.height,l=[];for(let u=0,c=i.length;u<c;u+=2)l.push({transform:[t,0,0,r,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,r=e.height,i=this.ctx;if(this.save(),!wn){let{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/r);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{let l=this.cachedCanvases.getCanvas("inlineImage",t,r).context;KC(l,e),s=this.applyTransferMapsToCanvas(l)}let a=this._scaleImage(s,ji(i));i.imageSmoothingEnabled=ZC(kt(i),e.interpolate),Sf(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let r=this.ctx,i;if(e.bitmap)i=e.bitmap;else{let s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;KC(l,e),i=this.applyTransferMapsToCanvas(l)}for(let s of t)r.save(),r.transform(...s.transform),r.scale(1,-1),Sf(r,i,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let r=this.ctx;this.pendingClip&&(t||(this.pendingClip===JC?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:r,c:i,d:s}=this.ctx.getTransform(),a,o;if(r===0&&i===0){let l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)a=o=1/l;else{let c=l*e;a=o=c<1?1/c:1}else if(e===0)a=1/l,o=1/u;else{let c=l*e,d=u*e;a=c<1?1/c:1,o=d<1?1/d:1}}else{let l=Math.abs(t*s-r*i),u=Math.hypot(t,r),c=Math.hypot(i,s);if(e===0)a=c/l,o=u/l;else{let d=e*l;a=c>d?c/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:r}=this.current,[i,s]=this.getScaleForStroking();if(t.lineWidth=r||1,i===1&&s===1){t.stroke();return}let a=t.getLineDash();if(e&&t.save(),t.scale(i,s),a.length>0){let o=Math.max(i,s);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let n in Lr)Ao.prototype[n]!==void 0&&(Ao.prototype[Lr[n]]=Ao.prototype[n]);var ca=class{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}},Df={UNKNOWN:0,DATA:1,ERROR:2},Gt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ar(n){switch(n instanceof Error||typeof n=="object"&&n!==null||Ct('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Wi(n.message);case"MissingPDFException":return new $i(n.message);case"PasswordException":return new sc(n.message,n.code);case"UnexpectedResponseException":return new So(n.message,n.status);case"UnknownErrorException":return new ac(n.message,n.details);default:return new ac(n.message,n.toString())}}var la=class{#e=new AbortController;constructor(e,t,r){this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){let r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===Df.DATA)i.resolve(e.data);else if(e.callback===Df.ERROR)i.reject(ar(e.reason));else throw new Error("Unexpected callback case");return}let t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let r=this.sourceName,i=e.sourceName,s=this.comObj;new Promise(function(a){a(t(e.data))}).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:Df.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:Df.ERROR,callbackId:e.callbackId,reason:ar(a)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){let r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){let i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,r,i){let s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{let c=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:u.desiredSize},i),c.promise},pull:u=>{let c=Promise.withResolvers();return this.streamControllers[s].pullCall=c,l.postMessage({sourceName:a,targetName:o,stream:Gt.PULL,streamId:s,desiredSize:u.desiredSize}),c.promise},cancel:u=>{rn(u instanceof Error,"cancel must have a valid reason");let c=Promise.withResolvers();return this.streamControllers[s].cancelCall=c,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Gt.CANCEL,streamId:s,reason:ar(u)}),c.promise}},r)}#n(e){let t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,c=1,d){if(this.isCancelled)return;let f=this.desiredSize;this.desiredSize-=c,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:Gt.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:Gt.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){rn(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:Gt.ERROR,streamId:t,reason:ar(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(u){u(o(e.data,l))}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:Gt.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:Gt.START_COMPLETE,streamId:t,reason:ar(u)})})}#r(e){let t=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Gt.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ar(e.reason));break;case Gt.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ar(e.reason));break;case Gt.PULL:if(!o){s.postMessage({sourceName:r,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,new Promise(function(l){l(o.onPull?.())}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:r,targetName:i,stream:Gt.PULL_COMPLETE,streamId:t,reason:ar(l)})});break;case Gt.ENQUEUE:if(rn(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Gt.CLOSE:if(rn(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#i(a,t);break;case Gt.ERROR:rn(a,"error should have stream controller"),a.controller.error(ar(e.reason)),this.#i(a,t);break;case Gt.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ar(e.reason)),this.#i(a,t);break;case Gt.CANCEL:if(!o)break;new Promise(function(l){l(o.onCancel?.(ar(e.reason)))}).then(function(){s.postMessage({sourceName:r,targetName:i,stream:Gt.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){s.postMessage({sourceName:r,targetName:i,stream:Gt.CANCEL_COMPLETE,streamId:t,reason:ar(l)})}),o.sinkCapability.reject(ar(e.reason)),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}#i(e,t){return ee(this,null,function*(){yield Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]})}destroy(){this.#e?.abort(),this.#e=null}},Hv=class{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return L_(this.#e)}has(e){return this.#e.has(e)}},Eo=Symbol("INTERNAL"),$v=class{#e=!1;#t=!1;#n=!1;#r=!0;constructor(e,{name:t,intent:r,usage:i,rbGroups:s}){this.#e=!!(e&or.DISPLAY),this.#t=!!(e&or.PRINT),this.name=t,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;let{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,r=!1){e!==Eo&&Ct("Internal method `_setVisible` called."),this.#n=r,this.#r=t}},Wv=class{#e=null;#t=new Map;#n=null;#r=null;constructor(e,t=or.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(let r of e.groups)this.#t.set(r.id,new $v(t,r));if(e.baseState==="OFF")for(let r of this.#t.values())r._setVisible(Eo,!1);for(let r of e.on)this.#t.get(r)._setVisible(Eo,!0);for(let r of e.off)this.#t.get(r)._setVisible(Eo,!1);this.#n=this.getHash()}}#i(e){let t=e.length;if(t<2)return!0;let r=e[0];for(let i=1;i<t;i++){let s=e[i],a;if(Array.isArray(s))a=this.#i(s);else if(this.#t.has(s))a=this.#t.get(s).visible;else return ze(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return gh("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(ze(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#t.has(t))return ze(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return ze(`Unknown optional content policy ${e.policy}.`),!0}return ze(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){let i=this.#t.get(e);if(!i){ze(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(let s of i.rbGroups)for(let a of s)a!==e&&this.#t.get(a)?._setVisible(Eo,!1,!0);i._setVisible(Eo,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let r;for(let i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}let s=this.#t.get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?L_(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;let e=new Vf;for(let[t,r]of this.#t)e.update(`${t}:${r.visible}`);return this.#e=e.hexdigest()}},zv=class{constructor(e,{disableRange:t=!1,disableStream:r=!1}){rn(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,s?.length>0){let l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{let i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});rn(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){rn(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new Gv(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=new qv(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},Gv=class{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=V_(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(let s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return ee(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},qv=class{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return ee(this,null,function*(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function bB(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let c=o(t);return c=unescape(c),c=l(c),c=u(c),s(c)}if(t=a(n),t){let c=u(t);return s(c)}if(t=r("filename","i").exec(n),t){t=t[1];let c=o(t);return c=u(c),s(c)}function r(c,d){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(c,d){if(c){if(!/^[\x00-\xFF]+$/.test(d))return d;try{let f=new TextDecoder(c,{fatal:!0}),h=mh(d);d=f.decode(h),e=!1}catch{}}return d}function s(c){return e&&/[\x80-\xff]/.test(c)&&(c=i("utf-8",c),e&&(c=i("iso-8859-1",c))),c}function a(c){let d=[],f,h=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=h.exec(c))!==null;){let[,g,m,v]=f;if(g=parseInt(g,10),g in d){if(g===0)break;continue}d[g]=[m,v]}let p=[];for(let g=0;g<d.length&&g in d;++g){let[m,v]=d[g];v=o(v),m&&(v=unescape(v),g===0&&(v=l(v))),p.push(v)}return p.join("")}function o(c){if(c.startsWith('"')){let d=c.slice(1).split('\\"');for(let f=0;f<d.length;++f){let h=d[f].indexOf('"');h!==-1&&(d[f]=d[f].slice(0,h),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}c=d.join('"')}return c}function l(c){let d=c.indexOf("'");if(d===-1)return c;let f=c.slice(0,d),p=c.slice(d+1).replace(/^[^']*'/,"");return i(f,p)}function u(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,h,p){if(h==="q"||h==="Q")return p=p.replaceAll("_"," "),p=p.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,m){return String.fromCharCode(parseInt(m,16))}),i(f,p);try{p=atob(p)}catch{}return i(f,p)})}return""}function U_(n,e){let t=new Headers;if(!n||!e||typeof e!="object")return t;for(let r in e){let i=e[r];i!==void 0&&t.append(r,i)}return t}function H_({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){let i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function $_(n){let e=n.get("Content-Disposition");if(e){let t=bB(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(V_(t))return t}return null}function xh(n,e){return n===404||n===0&&e.startsWith("file:")?new $i('Missing PDF "'+e+'".'):new So(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function sS(n){return n===200||n===206}function aS(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function oS(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ze(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}var Xf=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=U_(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return rn(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Xv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=new Yv(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Xv=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let r=new Headers(e.headers),i=t.url;fetch(i,aS(r,this._withCredentials,this._abortController)).then(s=>{if(!sS(s.status))throw xh(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();let a=s.headers,{allowRangeRequests:o,suggestedLength:l}=H_({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=$_(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ee(this,null,function*(){yield this._headersCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:oS(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},Yv=class{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;let i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;let s=new Headers(e.headers);s.append("Range",`bytes=${t}-${r-1}`);let a=i.url;fetch(a,aS(s,this._withCredentials,this._abortController)).then(o=>{if(!sS(o.status))throw xh(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return ee(this,null,function*(){yield this._readCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:oS(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},vv=200,_v=206;function EB(n){let e=n.response;return typeof e!="string"?e:mh(e).buffer}var Kv=class{constructor({url:e,httpHeaders:t,withCredentials:r}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=U_(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,r){let i={begin:e,end:t};for(let s in r)i[s]=r[s];return this.request(i)}requestFull(e){return this.request(e)}request(e){let t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=_v):i.expectedStatus=vv,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){let r=this.pendingRequests[e];r&&r.onProgress?.(t)}onStateChange(e,t){let r=this.pendingRequests[e];if(!r)return;let i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError?.(i.status);return}let s=i.status||vv;if(!(s===vv&&r.expectedStatus===_v)&&s!==r.expectedStatus){r.onError?.(i.status);return}let o=EB(i);if(s===_v){let l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);r.onDone({begin:parseInt(u[1],10),chunk:o})}else o?r.onDone({begin:0,chunk:o}):r.onError?.(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},Qv=class{constructor(e){this._source=e,this._manager=new Kv(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return rn(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Zv(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let r=new Jv(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Zv=class{constructor(e,t){this._manager=e;let r={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(r),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e),r=new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(a=>{let[o,...l]=a.split(": ");return[o,l.join(": ")]})),{allowRangeRequests:i,suggestedLength:s}=H_({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=$_(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=xh(e,this._url),this._headersCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}read(){return ee(this,null,function*(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},Jv=class{constructor(e,t,r){this._manager=e;let i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,r,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=xh(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}read(){return ee(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},AB=/^[a-z][a-z0-9\-+.]+:/i;function CB(n){if(AB.test(n))return new URL(n);let e=ui.get("url");return new URL(e.pathToFileURL(n))}function lS(n,e,t){return n.protocol==="http:"?ui.get("http").request(n,{headers:e},t):ui.get("https").request(n,{headers:e},t)}var e_=class{constructor(e){this.source=e,this.url=CB(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.headers=U_(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return rn(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new r_(this):new t_(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let r=this.isFsUrl?new i_(this,e,t):new n_(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Yf=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return ee(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},Kf=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){return ee(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},t_=class extends Yf{constructor(e){super(e);let t=Object.fromEntries(e.headers),r=i=>{if(i.statusCode===404){let l=new $i(`Missing PDF "${this._url}".`);this._storedError=l,this._headersCapability.reject(l);return}this._headersCapability.resolve(),this._setReadableStream(i);let s=new Headers(this._readableStream.headers),{allowRangeRequests:a,suggestedLength:o}=H_({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=$_(s)};this._request=lS(this._url,t,r),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}},n_=class extends Kf{constructor(e,t,r){super(e);let i=Object.fromEntries(e.headers);i.Range=`bytes=${t}-${r-1}`;let s=a=>{if(a.statusCode===404){let o=new $i(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(a)};this._request=lS(this._url,i,s),this._request.on("error",a=>{this._storedError=a}),this._request.end()}},r_=class extends Yf{constructor(e){super(e);let t=ui.get("fs");t.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(t.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new $i(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}},i_=class extends Kf{constructor(e,t,r){super(e);let i=ui.get("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:r-1}))}},SB=1e5,Xn=30,TB=.8,hc=class n{#e=Promise.withResolvers();#t=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#i=null;#s=null;#l=0;#c=0;#u=null;#o=null;#d=0;#a=0;#f=Object.create(null);#p=[];#h=null;#g=[];#v=new WeakMap;#m=null;static#_=new Map;static#y=new Map;static#E=new WeakMap;static#w=null;static#b=new Set;constructor({textContentSource:e,container:t,viewport:r}){if(e instanceof ReadableStream)this.#h=e;else if(typeof e=="object")this.#h=new ReadableStream({start(l){l.enqueue(e),l.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#o=t,this.#a=r.scale*(globalThis.devicePixelRatio||1),this.#d=r.rotation,this.#s={div:null,properties:null,ctx:null};let{pageWidth:i,pageHeight:s,pageX:a,pageY:o}=r.rawDims;this.#m=[1,0,0,-1,-a,o+s],this.#c=i,this.#l=s,n.#M(),ua(t,r),this.#e.promise.finally(()=>{n.#b.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=mn.platform;return Je(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){let e=()=>{this.#u.read().then(({value:t,done:r})=>{if(r){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#u=this.#h.getReader(),n.#b.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){let r=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==this.#d&&(t?.(),this.#d=i,ua(this.#o,{rotation:i})),r!==this.#a){t?.(),this.#a=r;let s={div:null,properties:null,ctx:n.#D(this.#i)};for(let a of this.#g)s.properties=this.#v.get(a),s.div=a,this.#A(s)}}cancel(){let e=new Wi("TextLayer task cancelled.");this.#u?.cancel(e).catch(()=>{}),this.#u=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#p}#k(e){if(this.#n)return;this.#s.ctx??=n.#D(this.#i);let t=this.#g,r=this.#p;for(let i of e){if(t.length>SB){ze("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){let s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),s.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}r.push(i.str),this.#T(i)}}#T(e){let t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);let i=Ae.transform(this.#m,e.transform),s=Math.atan2(i[1],i[0]),a=this.#f[e.fontName];a.vertical&&(s+=Math.PI/2);let o=this.#r&&a.fontSubstitution||a.fontFamily;o=n.fontFamilyMap.get(o)||o;let l=Math.hypot(i[2],i[3]),u=l*n.#P(o,this.#i),c,d;s===0?(c=i[4],d=i[5]-u):(c=i[4]+u*Math.sin(s),d=i[5]-u*Math.cos(s));let f="calc(var(--scale-factor)*",h=t.style;this.#t===this.#o?(h.left=`${(100*c/this.#c).toFixed(2)}%`,h.top=`${(100*d/this.#l).toFixed(2)}%`):(h.left=`${f}${c.toFixed(2)}px)`,h.top=`${f}${d.toFixed(2)}px)`),h.fontSize=`${f}${(n.#w*l).toFixed(2)}px)`,h.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let g=Math.abs(e.transform[0]),m=Math.abs(e.transform[3]);g!==m&&Math.max(g,m)/Math.min(g,m)>1.5&&(p=!0)}if(p&&(r.canvasWidth=a.vertical?e.height:e.width),this.#v.set(t,r),this.#s.div=t,this.#s.properties=r,this.#A(this.#s),r.hasText&&this.#t.append(t),r.hasEOL){let g=document.createElement("br");g.setAttribute("role","presentation"),this.#t.append(g)}}#A(e){let{div:t,properties:r,ctx:i}=e,{style:s}=t,a="";if(n.#w>1&&(a=`scale(${1/n.#w})`),r.canvasWidth!==0&&r.hasText){let{fontFamily:o}=s,{canvasWidth:l,fontSize:u}=r;n.#S(i,u*this.#a,o);let{width:c}=i.measureText(t.textContent);c>0&&(a=`scaleX(${l*this.#a/c}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)}static cleanup(){if(!(this.#b.size>0)){this.#_.clear();for(let{canvas:e}of this.#y.values())e.remove();this.#y.clear()}}static#D(e=null){let t=this.#y.get(e||="");if(!t){let r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(e,t),this.#E.set(t,{size:0,family:""})}return t}static#S(e,t,r){let i=this.#E.get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)}static#M(){if(this.#w!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#w=e.getBoundingClientRect().height,e.remove()}static#P(e,t){let r=this.#_.get(e);if(r)return r;let i=this.#D(t);i.canvas.width=i.canvas.height=Xn,this.#S(i,Xn,e);let s=i.measureText(""),a=s.fontBoundingBoxAscent,o=Math.abs(s.fontBoundingBoxDescent);if(a){let c=a/(a+o);return this.#_.set(e,c),i.canvas.width=i.canvas.height=0,c}i.strokeStyle="red",i.clearRect(0,0,Xn,Xn),i.strokeText("g",0,0);let l=i.getImageData(0,0,Xn,Xn).data;o=0;for(let c=l.length-1-3;c>=0;c-=4)if(l[c]>0){o=Math.ceil(c/4/Xn);break}i.clearRect(0,0,Xn,Xn),i.strokeText("A",0,Xn),l=i.getImageData(0,0,Xn,Xn).data,a=0;for(let c=0,d=l.length;c<d;c+=4)if(l[c]>0){a=Xn-Math.floor(c/4/Xn);break}i.canvas.width=i.canvas.height=0;let u=a?a/(a+o):TB;return this.#_.set(e,u),u}},pc=class n{static textContent(e){let t=[],r={items:t,styles:Object.create(null)};function i(s){if(!s)return;let a=null,o=s.name;if(o==="#text")a=s.value;else if(n.shouldBuildText(o))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(let l of s.children)i(l)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},DB=65536,IB=100,kB=5e3,MB=wn?Rv:Mv,FB=wn?Nv:$f,PB=wn?Pv:Fv,RB=wn?Ov:Gf;function NB(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});let e=new s_,{docId:t}=e,r=n.url?OB(n.url):null,i=n.data?LB(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof Qf?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:DB,c=n.worker instanceof Co?n.worker:null,d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!_h(n.docBaseUrl)?n.docBaseUrl:null,h=typeof n.cMapUrl=="string"?n.cMapUrl:null,p=n.cMapPacked!==!1,g=n.CMapReaderFactory||FB,m=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||RB,x=n.stopAtErrors!==!0,_=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,b=n.isEvalSupported!==!1,D=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!wn,A=typeof n.isChrome=="boolean"?n.isChrome:!mn.platform.isFirefox&&typeof window<"u"&&!!window?.chrome,w=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,T=typeof n.disableFontFace=="boolean"?n.disableFontFace:wn,E=n.fontExtraProperties===!0,P=n.enableXfa===!0,N=n.ownerDocument||globalThis.document,O=n.disableRange===!0,Y=n.disableStream===!0,se=n.disableAutoFetch===!0,ie=n.pdfBug===!0,ge=n.CanvasFactory||MB,J=n.FilterFactory||PB,_e=n.enableHWA===!0,de=l?l.length:n.length??NaN,ye=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!wn&&!T,K=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:g===$f&&v===Gf&&h&&m&&rc(h,document.baseURI)&&rc(m,document.baseURI);n.canvasFactory&&HC("`canvasFactory`-instance option, please use `CanvasFactory` instead."),n.filterFactory&&HC("`filterFactory`-instance option, please use `FilterFactory` instead.");let F=null;K3(d);let U={canvasFactory:new ge({ownerDocument:N,enableHWA:_e}),filterFactory:new J({docId:t,ownerDocument:N}),cMapReaderFactory:K?null:new g({baseUrl:h,isCompressed:p}),standardFontDataFactory:K?null:new v({baseUrl:m})};if(!c){let Q={verbosity:d,port:ca.workerPort};c=Q.port?Co.fromPort(Q):new Co(Q),e._worker=c}let j={docId:t,apiVersion:"4.8.69",data:i,password:o,disableAutoFetch:se,rangeChunkSize:u,length:de,docBaseUrl:f,enableXfa:P,evaluatorOptions:{maxImageSize:_,disableFontFace:T,ignoreErrors:x,isEvalSupported:b,isOffscreenCanvasSupported:D,isChrome:A,canvasMaxAreaInBytes:w,fontExtraProperties:E,useSystemFonts:ye,cMapUrl:K?h:null,standardFontDataUrl:K?m:null}},L={disableFontFace:T,fontExtraProperties:E,ownerDocument:N,pdfBug:ie,styleElement:F,loadingParams:{disableAutoFetch:se,enableXfa:P}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");let Q=c.messageHandler.sendWithPromise("GetDocRequest",j,i?[i.buffer]:null),oe;if(l)oe=new zv(l,{disableRange:O,disableStream:Y});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");let ue;wn?ue=typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&rc(r)?Xf:e_:ue=rc(r)?Xf:Qv,oe=new ue({url:r,length:de,httpHeaders:s,withCredentials:a,rangeChunkSize:u,disableRange:O,disableStream:Y})}return Q.then(ue=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");let me=new la(t,ue,c.port),ae=new c_(me,e,oe,L,U);e._transport=ae,me.send("Ready",null)})}).catch(e._capability.reject),e}function OB(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(wn&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function LB(n){if(wn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return mh(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function eS(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}var s_=class n{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${n.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return ee(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}},Qf=class{constructor(e,t,r=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let r of this._rangeListeners)r(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let r of this._progressListeners)r(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ct("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},a_=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Je(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},o_=class{#e=null;#t=!1;constructor(e,t,r,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new Of:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new Zf,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new oc({viewBox:this.view,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Je(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return ee(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:i=bs.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:c=null,isEditing:d=!1}){this._stats?.time("Overall");let f=this._transport.getRenderingIntent(r,i,c,d),{renderingIntent:h,cacheKey:p}=f;this.#t=!1,this.#r(),o||=this._transport.getOptionalContentConfig(h);let g=this._intentStates.get(p);g||(g=Object.create(null),this._intentStates.set(p,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);let m=!!(h&or.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));let v=b=>{g.renderTasks.delete(x),(this._maybeCleanupAfterRender||m)&&(this.#t=!0),this.#n(!m),b?(x.capability.reject(b),this._abortOperatorList({intentState:g,reason:b instanceof Error?b:new Error(b)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new d_({callback:v,params:{canvasContext:e,viewport:t,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:u});(g.renderTasks||=new Set).add(x);let _=x.task;return Promise.all([g.displayReadyCapability.promise,o]).then(([b,D])=>{if(this.destroyed){v();return}if(this._stats?.time("Rendering"),!(D.renderingIntent&h))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:b,optionalContentConfig:D}),x.operatorListChanged()}).catch(v),_}getOperatorList({intent:e="display",annotationMode:t=bs.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}let a=this._transport.getRenderingIntent(e,t,r,i,!0),o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>pc.textContent(r));let t=this.streamTextContent(e);return new Promise(function(r,i){function s(){a.read().then(function({value:l,done:u}){if(u){r(o);return}o.lang??=l.lang,Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},i)}let a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),this.#t=!1,this.#r(),Promise.all(e)}cleanup(e=!1){this.#t=!0;let t=this.#n(!1);return e&&t&&(this._stats&&=new Of),t}#n(e=!1){if(this.#r(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},kB),!1;for(let{renderTasks:t,operatorList:r}of this._intentStates.values())if(t.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#r(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){let r=this._intentStates.get(t);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let r of t.renderTasks)r.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){let{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;let c=()=>{l.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),c())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(let f of u.renderTasks)f.operatorListChanged();this.#n(!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};c()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof lc){let i=IB;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Wi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}},l_=class{#e=new Map;#t=Promise.resolve();postMessage(e,t){let r={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(let[i]of this.#e)i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){let{signal:s}=r;if(s.aborted){ze("LoopbackPort - cannot use an `aborted` signal.");return}let a=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(let[,e]of this.#e)e?.();this.#e.clear()}},Co=class n{static#e=0;static#t=!1;static#n;static{wn&&(this.#t=!0,ca.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let r;try{if(r=new URL(e),!r.origin||r.origin==="null")return!1}catch{return!1}let i=new URL(t,r);return r.origin===i.origin},this._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}}constructor({name:e=null,port:t=null,verbosity:r=Q3()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(n.#n?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(n.#n||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return wn?Promise.all([ui.promise,this._readyCapability.promise]):this._readyCapability.promise}#r(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new la("main","worker",e),this._messageHandler.on("ready",function(){}),this.#r()}_initialize(){if(n.#t||n.#i){this._setupFakeWorker();return}let{workerSrc:e}=n;try{n._isSameOrigin(window.location.href,e)||(e=n._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),r=new la("main","worker",t),i=()=>{s.abort(),r.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){i();return}this._messageHandler=r,this._port=t,this._webWorker=t,this.#r()}),r.on("ready",o=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});let a=()=>{let o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{gh("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){n.#t||(ze("Setting up fake worker."),n.#t=!0),n._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new l_;this._port=t;let r=`fake${n.#e++}`,i=new la(r+"_worker",r,t);e.setup(i,t),this._messageHandler=new la(r,r+"_worker",t),this.#r()}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),n.#n?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=this.#n?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new n(e)}static get workerSrc(){if(ca.workerSrc)return ca.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#i(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Je(this,"_setupFakeWorkerGlobal",ee(this,null,function*(){return this.#i?this.#i:(yield import(this.workerSrc)).WorkerMessageHandler}))}},c_=class{#e=new Map;#t=new Map;#n=new Map;#r=new Map;#i=null;constructor(e,t,r,i,s){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Zf,this.fontLoader=new Iv({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){let r=this.#e.get(e);if(r)return r;let i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Je(this,"annotationStorage",new dc)}getRenderingIntent(e,t=bs.ENABLE,r=null,i=!1,s=!1){let a=or.DISPLAY,o=Dv;switch(e){case"any":a=or.ANY;break;case"display":break;case"print":a=or.PRINT;break;default:ze(`getRenderingIntent - invalid intent: ${e}`)}let l=a&or.PRINT&&r instanceof jf?r:this.annotationStorage;switch(t){case bs.DISABLE:a+=or.ANNOTATIONS_DISABLE;break;case bs.ENABLE:break;case bs.ENABLE_FORMS:a+=or.ANNOTATIONS_FORMS;break;case bs.ENABLE_STORAGE:a+=or.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ze(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=or.IS_EDITING),s&&(a+=or.OPLIST);let{ids:u,hash:c}=l.modifiedIds,d=[a,o.hash,c];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let r of this.#t.values())e.push(r._destroy());this.#t.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),hc.cleanup(),this._networkStream?.cancelAllRequests(new Wi("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{rn(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}rn(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",r=>ee(this,null,function*(){yield this._fullReader.headersReady;let{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}})),e.on("GetRangeReader",(r,i)=>{rn(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){i.close();return}rn(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new a_(r,this))}),e.on("DocException",function(r){let i;switch(r.name){case"PasswordException":i=new sc(r.message,r.code);break;case"InvalidPDFException":i=new Nf(r.message);break;case"MissingPDFException":i=new $i(r.message);break;case"UnexpectedResponseException":i=new So(r.message,r.status);break;case"UnknownErrorException":i=new ac(r.message,r.details);break;default:Ct("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",r=>{if(this.#i=Promise.withResolvers(),t.onPassword){let i=s=>{s instanceof Error?this.#i.reject(s):this.#i.resolve({password:s})};try{t.onPassword(i,r.code)}catch(s){this.#i.reject(s)}}else this.#i.reject(new sc(r.message,r.code));return this.#i.promise}),e.on("DataLoaded",r=>{t.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;this.#t.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":let{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in s){let f=s.error;ze(`Error during font loading: ${f}`),this.commonObjs.resolve(r,f);break}let u=l&&globalThis.FontInspector?.enabled?(f,h)=>globalThis.FontInspector.fontAdded(f,h):null,c=new kv(s,{disableFontFace:a,inspectFont:u});this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!o&&c.data&&(c.data=null),this.commonObjs.resolve(r,c)});break;case"CopyLocalImage":let{imageRef:d}=s;rn(d,"The imageRef must be defined.");for(let f of this.#t.values())for(let[,h]of f.objs)if(h?.ref===d)return h.dataLen?(this.commonObjs.resolve(r,structuredClone(h)),h.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,a])=>{if(this.destroyed)return;let o=this.#t.get(i);if(!o.objs.has(r)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":o.objs.resolve(r,a),a?.dataLen>z3&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{this.destroyed||t.onProgress?.({loaded:r.loaded,total:r.total})}),e.on("FetchBuiltInCMap",r=>ee(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)})),e.on("FetchStandardFontData",r=>ee(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,r=this.#n.get(t);if(r)return r;let i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#r.set(s.refStr,e);let a=new o_(t,s,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#n.set(t,i),i}getPageIndex(e){return eS(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new Wv(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#e.get(e);if(t)return t;let r=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new Hv(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return ee(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),hc.cleanup()}})}cachedPageNumber(e){if(!eS(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}},If=Symbol("INITIAL_DATA"),Zf=class{#e=Object.create(null);#t(e){return this.#e[e]||=Ke(ce({},Promise.withResolvers()),{data:If})}get(e,t=null){if(t){let i=this.#t(e);return i.promise.then(()=>t(i.data)),null}let r=this.#e[e];if(!r||r.data===If)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){let t=this.#e[e];return!!t&&t.data!==If}resolve(e,t=null){let r=this.#t(e);r.data=t,r.resolve()}clear(){for(let e in this.#e){let{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(let e in this.#e){let{data:t}=this.#e[e];t!==If&&(yield[e,t])}}},u_=class{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}},d_=class n{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:c=!1,pdfBug:d=!1,pageColors:f=null}){this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=c===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new u_(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(n.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");n.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:r,viewport:i,transform:s,background:a}=this.params;this.gfx=new Ao(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),n.#t.delete(this._canvas),this.callback(e||new lc(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return ee(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),n.#t.delete(this._canvas),this.callback())))})}},BB="4.8.69",VB="3634dab10";function tS(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function nc(n){return Math.max(0,Math.min(255,255*n))}var Jf=class{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=nc(e),[e,e,e]}static G_HTML([e]){let t=tS(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(nc)}static RGB_HTML(e){return`#${e.map(tS).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[nc(1-Math.min(1,e+i)),nc(1-Math.min(1,r+i)),nc(1-Math.min(1,t+i))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){let i=1-e,s=1-t,a=1-r,o=Math.min(i,s,a);return["CMYK",i,s,a,o]}},f_=class{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ct("Abstract method `_createSVG` called.")}},gc=class extends f_{_createSVG(e){return document.createElementNS(Ui,e)}},eh=class{static setupStorage(e,t,r,i,s){let a=i.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(let o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{let l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:s}){let{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(let[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){let t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});let o=s!=="richText",l=e.div;if(l.append(a),e.viewport){let d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");let u=[];if(i.children.length===0){if(i.value){let d=document.createTextNode(i.value);a.append(d),o&&pc.shouldBuildText(i.name)&&u.push(d)}return{textDivs:u}}let c=[[i,-1,a]];for(;c.length>0;){let[d,f,h]=c.at(-1);if(f+1===d.children.length){c.pop();continue}let p=d.children[++c.at(-1)[1]];if(p===null)continue;let{name:g}=p;if(g==="#text"){let v=document.createTextNode(p.value);u.push(v),h.append(v);continue}let m=p?.attributes?.xmlns?document.createElementNS(p.attributes.xmlns,g):document.createElement(g);if(h.append(m),p.attributes&&this.setAttributes({html:m,element:p,storage:t,intent:s,linkService:r}),p.children?.length>0)c.push([p,-1,m]);else if(p.value){let v=document.createTextNode(p.value);o&&pc.shouldBuildText(g)&&u.push(v),m.append(v)}}for(let d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},xc=1e3,jB=9,fa=new WeakSet;function Hi(n){return{width:n[2]-n[0],height:n[3]-n[1]}}var h_=class{static create(e){switch(e.data.annotationType){case nn.LINK:return new th(e);case nn.TEXT:return new p_(e);case nn.WIDGET:switch(e.data.fieldType){case"Tx":return new g_(e);case"Btn":return e.data.radioButton?new nh(e):e.data.checkBox?new v_(e):new __(e);case"Ch":return new x_(e);case"Sig":return new m_(e)}return new zi(e);case nn.POPUP:return new mc(e);case nn.FREETEXT:return new rh(e);case nn.LINE:return new w_(e);case nn.SQUARE:return new b_(e);case nn.CIRCLE:return new E_(e);case nn.POLYLINE:return new ih(e);case nn.CARET:return new C_(e);case nn.INK:return new vc(e);case nn.POLYGON:return new A_(e);case nn.HIGHLIGHT:return new sh(e);case nn.UNDERLINE:return new S_(e);case nn.SQUIGGLY:return new T_(e);case nn.STRIKEOUT:return new D_(e);case nn.STAMP:return new ah(e);case nn.FILEATTACHMENT:return new I_(e);default:return new Ut(e)}}},Ut=class n{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e?.str||t?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return n._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#r(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#r(e){let{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r?.splice(0,4,...e);let{width:u,height:c}=Hi(e);t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*u/s}%`,t.height=`${100*c/a}%`):this.setRotation(i)}_createContainer(e){let{data:t,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof zi||(s.tabIndex=xc);let{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof mc){let{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,s),s}let{width:o,height:l}=Hi(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;let g=t.borderStyle.horizontalCornerRadius,m=t.borderStyle.verticalCornerRadius;if(g>0||m>0){let x=`calc(${g}px * var(--scale-factor)) / calc(${m}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof nh){let x=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=x}switch(t.borderStyle.style){case ec.SOLID:a.borderStyle="solid";break;case ec.DASHED:a.borderStyle="dashed";break;case ec.BEVELED:ze("Unimplemented border style: beveled");break;case ec.INSET:ze("Unimplemented border style: inset");break;case ec.UNDERLINE:a.borderBottomStyle="solid";break;default:break}let v=t.borderColor||null;v?(this.#t=!0,a.borderColor=Ae.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}let u=Ae.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:c,pageHeight:d,pageX:f,pageY:h}=i.rawDims;a.left=`${100*(u[0]-f)/c}%`,a.top=`${100*(u[1]-h)/d}%`;let{rotation:p}=t;return t.hasOwnCanvas||p===0?(a.width=`${100*o/c}%`,a.height=`${100*l/d}%`):this.setRotation(p,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims,{width:s,height:a}=Hi(this.data.rect),o,l;e%180===0?(o=100*s/r,l=100*a/i):(o=100*a/r,l=100*s/i),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,r,i)=>{let s=i.detail[t],a=s[0],o=s.slice(1);i.target.style[r]=Jf[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:Jf[`${a}_rgb`](o)})};return Je(this,"_commonActions",{display:t=>{let{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){let r=this._commonActions;for(let i of Object.keys(t.detail))(e[i]||r[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let r=this._commonActions;for(let[i,s]of Object.entries(t)){let a=r[i];if(a){let o={detail:{[i]:s},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,r,i,s]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){let[g,m,v,x]=e.subarray(2,6);if(i===g&&s===m&&t===v&&r===x)return}let{style:a}=this.container,o;if(this.#t){let{borderColor:g,borderWidth:m}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${m}">`],this.container.classList.add("hasBorder")}let l=i-t,u=s-r,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);let f=c.createElement("defs");d.append(f);let h=c.createElement("clipPath"),p=`clippath_${this.data.id}`;h.setAttribute("id",p),h.setAttribute("clipPathUnits","objectBoundingBox"),f.append(h);for(let g=2,m=e.length;g<m;g+=8){let v=e[g],x=e[g+1],_=e[g+2],b=e[g+3],D=c.createElement("rect"),A=(_-t)/l,w=(s-x)/u,T=(v-_)/l,E=(x-b)/u;D.setAttribute("x",A),D.setAttribute("y",w),D.setAttribute("width",T),D.setAttribute("height",E),h.append(D),o?.push(`<rect vector-effect="non-scaling-stroke" x="${A}" y="${w}" width="${T}" height="${E}"/>`)}this.#t&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){let{data:e}=this,t=this.#n=new mc({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Ct("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let r=[];if(this._fieldObjects){let i=this._fieldObjects[e];if(i)for(let{page:s,id:a,exportValues:o}of i){if(s===-1||a===t)continue;let l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!fa.has(u)){ze(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:u})}return r}for(let i of document.getElementsByName(e)){let{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==t&&fa.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},th=class extends Ut{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,r=document.createElement("a");r.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(r,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(r,e.action),i=!0):e.attachment?(this.#t(r,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#n(r,e.setOCGState),i=!0):e.dest?(this._bindLink(r,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,e),i=!0),e.resetForm?(this._bindResetFormAction(r,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,r=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let i of Object.keys(t.actions)){let s=r.get(i);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){let r=e.onclick;if(r||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(e.onclick=()=>!1);return}e.onclick=()=>{r?.();let{fields:i,refs:s,include:a}=t,o=[];if(i.length!==0||s.length!==0){let c=new Set(s);for(let d of i){let f=this._fieldObjects[d]||[];for(let{id:h}of f)c.add(h)}for(let d of Object.values(this._fieldObjects))for(let f of d)c.has(f.id)===a&&o.push(f)}else for(let c of Object.values(this._fieldObjects))o.push(...c);let l=this.annotationStorage,u=[];for(let c of o){let{id:d}=c;switch(u.push(d),c.type){case"text":{let h=c.defaultValue||"";l.setValue(d,{value:h});break}case"checkbox":case"radiobutton":{let h=c.defaultValue===c.exportValues;l.setValue(d,{value:h});break}case"combobox":case"listbox":{let h=c.defaultValue||"";l.setValue(d,{value:h});break}default:continue}let f=document.querySelector(`[data-element-id="${d}"]`);if(f){if(!fa.has(f)){ze(`_bindResetFormAction - element not allowed: ${d}`);continue}}else continue;f.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}}),!1}}},p_=class extends Ut{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},zi=class extends Ut{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return mn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,s){r.includes("mouse")?e.addEventListener(r,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}})})}_setEventListeners(e,t,r,i){for(let[s,a]of r)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,a,i),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ae.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||jB,s=e.style,a,o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){let u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),c=Math.round(u/(Mf*i))||1,d=u/c;a=Math.min(i,l(d/Mf))}else{let u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(u/Mf))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=Ae.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},g_=class extends zi{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){let s=this.annotationStorage;for(let a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),s.setValue(a.id,{[i]:r})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){let i=e.getValue(t,{value:this.data.fieldValue}),s=i.value||"",a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let o=i.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));let l={userValue:s,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=o??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",o??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),fa.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=xc,this._setRequired(r,this.data.required),a&&(r.maxLength=a),r.addEventListener("input",c=>{e.setValue(t,{value:c.target.value}),this.setPropertyOnSiblings(r,"value",c.target.value,"value"),l.formattedValue=null}),r.addEventListener("resetform",c=>{let d=this.data.defaultFieldValue??"";r.value=l.userValue=d,l.formattedValue=null});let u=c=>{let{formattedValue:d}=l;d!=null&&(c.target.value=d),c.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",d=>{if(l.focused)return;let{target:f}=d;l.userValue&&(f.value=l.userValue),l.lastCommittedValue=f.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),r.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);let f={value(h){l.userValue=h.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),h.target.value=l.userValue},formattedValue(h){let{formattedValue:p}=h.detail;l.formattedValue=p,p!=null&&h.target!==document.activeElement&&(h.target.value=p),e.setValue(t,{formattedValue:p})},selRange(h){h.target.setSelectionRange(...h.detail.selRange)},charLimit:h=>{let{charLimit:p}=h.detail,{target:g}=h;if(p===0){g.removeAttribute("maxLength");return}g.setAttribute("maxLength",p);let m=l.userValue;!m||m.length<=p||(m=m.slice(0,p),g.value=l.userValue=m,e.setValue(t,{value:m}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:1,selStart:g.selectionStart,selEnd:g.selectionEnd}}))}};this._dispatchEventFromSandbox(f,d)}),r.addEventListener("keydown",d=>{l.commitKey=1;let f=-1;if(d.key==="Escape"?f=0:d.key==="Enter"&&!this.data.multiLine?f=2:d.key==="Tab"&&(l.commitKey=3),f===-1)return;let{value:h}=d.target;l.lastCommittedValue!==h&&(l.lastCommittedValue=h,l.userValue=h,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,willCommit:!0,commitKey:f,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});let c=u;u=null,r.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);let{value:f}=d.target;l.userValue=f,l.lastCommittedValue!==f&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),c(d)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;let{data:f,target:h}=d,{value:p,selectionStart:g,selectionEnd:m}=h,v=g,x=m;switch(d.inputType){case"deleteWordBackward":{let _=p.substring(0,g).match(/\w*[^\w]*$/);_&&(v-=_[0].length);break}case"deleteWordForward":{let _=p.substring(g).match(/^[^\w]*\w*/);_&&(x+=_[0].length);break}case"deleteContentBackward":g===m&&(v-=1);break;case"deleteContentForward":g===m&&(x+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:p,change:f||"",willCommit:!1,selStart:v,selEnd:x}})}),this._setEventListeners(r,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(u&&r.addEventListener("blur",u),this.data.comb){let d=(this.data.rect[2]-this.data.rect[0])/a;r.classList.add("comb"),r.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},m_=class extends zi{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},v_=class extends zi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,r=t.id,i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let s=document.createElement("input");return fa.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=xc,s.addEventListener("change",a=>{let{name:o,checked:l}=a.target;for(let u of this._getElementsByName(o,r)){let c=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=c),e.setValue(u.id,{value:c})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{let o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{let o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},nh=class extends zi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,r=t.id,i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(let a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});let s=document.createElement("input");if(fa.add(s),s.setAttribute("data-element-id",r),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=xc,s.addEventListener("change",a=>{let{name:o,checked:l}=a.target;for(let u of this._getElementsByName(o,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{let o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){let a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{let l={value:u=>{let c=a===u.detail.value;for(let d of this._getElementsByName(u.target.name)){let f=c&&d.id===r;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},__=class extends th{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}},x_=class extends zi{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");fa.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=xc;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",c=>{let d=this.data.defaultFieldValue;for(let f of i.options)f.selected=f.value===d});for(let c of this.data.options){let d=document.createElement("option");d.textContent=c.displayValue,d.value=c.exportValue,r.value.includes(c.exportValue)&&(d.setAttribute("selected",!0),s=!1),i.append(d)}let a=null;if(s){let c=document.createElement("option");c.value=" ",c.setAttribute("hidden",!0),c.setAttribute("selected",!0),i.prepend(c),a=()=>{c.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}let o=c=>{let d=c?"value":"textContent",{options:f,multiple:h}=i;return h?Array.prototype.filter.call(f,p=>p.selected).map(p=>p[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]},l=o(!1),u=c=>{let d=c.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",c=>{let d={value(f){a?.();let h=f.detail.value,p=new Set(Array.isArray(h)?h:[h]);for(let g of i.options)g.selected=p.has(g.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){i.multiple=!0},remove(f){let h=i.options,p=f.detail.remove;h[p].selected=!1,i.remove(p),h.length>0&&Array.prototype.findIndex.call(h,m=>m.selected)===-1&&(h[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){let{index:h,displayValue:p,exportValue:g}=f.detail.insert,m=i.children[h],v=document.createElement("option");v.textContent=p,v.value=g,m?m.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},items(f){let{items:h}=f.detail;for(;i.length!==0;)i.remove(0);for(let p of h){let{displayValue:g,exportValue:m}=p,v=document.createElement("option");v.textContent=g,v.value=m,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},indices(f){let h=new Set(f.detail.indices);for(let p of f.target.options)p.selected=h.has(p.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,c)}),i.addEventListener("input",c=>{let d=o(!0),f=o(!1);e.setValue(t,{value:d}),c.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],c=>c.target.value)):i.addEventListener("input",function(c){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},mc=class extends Ut{constructor(e){let{data:t,elements:r}=e;super(e,{isRenderable:Ut._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new y_({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${B_}${r}`).join(",")),this.container}},y_=class{#e=this.#k.bind(this);#t=this.#S.bind(this);#n=this.#D.bind(this);#r=this.#A.bind(this);#i=null;#s=null;#l=null;#c=null;#u=null;#o=null;#d=null;#a=!1;#f=null;#p=null;#h=null;#g=null;#v=null;#m=null;#_=!1;constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:u,parentRect:c,open:d}){this.#s=e,this.#v=i,this.#l=a,this.#g=o,this.#o=l,this.#i=t,this.#h=u,this.#d=c,this.#u=r,this.#c=Lf.toDateObject(s),this.trigger=r.flatMap(f=>f.getElementsToTriggerPopup());for(let f of this.trigger)f.addEventListener("click",this.#r),f.addEventListener("mouseenter",this.#n),f.addEventListener("mouseleave",this.#t),f.classList.add("popupTriggerArea");for(let f of r)f.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,d&&this.#A()}render(){if(this.#f)return;let e=this.#f=document.createElement("div");if(e.className="popup",this.#i){let s=e.style.outlineColor=Ae.makeHexColor(...this.#i);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=Ae.makeHexColor(...this.#i.map(o=>Math.floor(.7*(255-o)+o)))}let t=document.createElement("span");t.className="header";let r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=this.#v,e.append(t),this.#c){let s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),t.append(s)}let i=this.#y;if(i)eh.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let s=this._formatContents(this.#l);e.append(s)}this.#s.append(e)}get#y(){let e=this.#g,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#E(){return this.#y?.attributes?.style?.fontSize||0}get#w(){return this.#y?.attributes?.style?.color||null}#b(e){let t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#w,fontSize:this.#E?`calc(${this.#E}px * var(--scale-factor))`:""}};for(let s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return r}_formatContents({str:e,dir:t}){let r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;let i=e.split(/(?:\r\n?|\n)/);for(let s=0,a=i.length;s<a;++s){let o=i[s];r.append(document.createTextNode(o)),s<a-1&&r.append(document.createElement("br"))}return r}#k(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#a)&&this.#A()}updateEdited({rect:e,popupContent:t}){this.#m||={contentsObj:this.#l,richText:this.#g},e&&(this.#p=null),t&&(this.#g=this.#b(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#m&&({contentsObj:this.#l,richText:this.#g}=this.#m,this.#m=null,this.#f?.remove(),this.#f=null,this.#p=null)}#T(){if(this.#p!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:s}}}=this.#o,a=!!this.#d,o=a?this.#d:this.#h;for(let p of this.#u)if(!o||Ae.intersect(p.data.rect,o)!==null){o=p.data.rect,a=!0;break}let l=Ae.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=a?o[2]-o[0]+5:0,d=l[0]+c,f=l[1];this.#p=[100*(d-i)/t,100*(f-s)/r];let{style:h}=this.#s;h.left=`${this.#p[0]}%`,h.top=`${this.#p[1]}%`}#A(){this.#a=!this.#a,this.#a?(this.#D(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#S(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#D(){this.#f||this.render(),this.isVisible?this.#a&&this.#s.classList.add("focused"):(this.#T(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#S(){this.#s.classList.remove("focused"),!(this.#a||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#s.hidden=!0)}maybeShow(){this.#_&&(this.#f||this.#D(),this.#_=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}},rh=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=He.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},w_=class extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:r}=Hi(e.rect),i=this.svgFactory.create(t,r,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},b_=class extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:r}=Hi(e.rect),i=this.svgFactory.create(t,r,!0),s=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",t-s),a.setAttribute("height",r-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},E_=class extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:r}=Hi(e.rect),i=this.svgFactory.create(t,r,!0),s=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",r/2),a.setAttribute("rx",t/2-s/2),a.setAttribute("ry",r/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},ih=class extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:r,popupRef:i}}=this;if(!t)return this.container;let{width:s,height:a}=Hi(e),o=this.svgFactory.create(s,a,!0),l=[];for(let c=0,d=t.length;c<d;c+=2){let f=t[c]-e[0],h=e[3]-t[c+1];l.push(`${f},${h}`)}l=l.join(" ");let u=this.#e=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",l),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),o.append(u),this.container.append(o),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},A_=class extends ih{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},C_=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},vc=class extends Ut{#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?He.HIGHLIGHT:He.INK}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,inkLists:t,borderStyle:r,popupRef:i}}=this,{width:s,height:a}=Hi(e),o=this.svgFactory.create(s,a,!0);for(let l of t){let u=[];for(let d=0,f=l.length;d<f;d+=2){let h=l[d]-e[0],p=e[3]-l[d+1];u.push(`${h},${p}`)}u=u.join(" ");let c=this.svgFactory.createElement(this.svgElementName);this.#e.push(c),c.setAttribute("points",u),c.setAttribute("stroke-width",r.width||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),o.append(c)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(o),this._editOnDoubleClick(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},sh=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=He.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},S_=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},T_=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},D_=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},ah=class extends Ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=He.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},I_=class extends Ut{#e=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",ce({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,r;t.hasAppearance||t.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),r.addEventListener("dblclick",this.#t.bind(this)),this.#e=r;let{isMac:i}=mn.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),e.append(r),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},k_=class{#e=null;#t=null;#n=new Map;#r=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:o}){this.div=e,this.#e=t,this.#t=r,this.#r=o||null,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}#i(e,t){return ee(this,null,function*(){let r=e.firstChild||e,i=r.id=`${B_}${t}`,s=yield this.#r?.getAriaAttributes(i);if(s)for(let[a,o]of s)r.setAttribute(a,o);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,r,!1)})}render(e){return ee(this,null,function*(){let{annotations:t}=e,r=this.div;ua(r,this.viewport);let i=new Map,s={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new gc,annotationStorage:e.annotationStorage||new dc,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let a of t){if(a.noHTML)continue;let o=a.annotationType===nn.POPUP;if(o){let c=i.get(a.id);if(!c)continue;s.elements=c}else{let{width:c,height:d}=Hi(a.rect);if(c<=0||d<=0)continue}s.data=a;let l=h_.create(s);if(!l.isRenderable)continue;if(!o&&a.popupRef){let c=i.get(a.popupRef);c?c.push(l):i.set(a.popupRef,[l])}let u=l.render();a.hidden&&(u.style.visibility="hidden"),yield this.#i(u,a.id),l._isEditable&&(this.#n.set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}this.#s()})}update({viewport:e}){let t=this.div;this.viewport=e,ua(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;let e=this.div;for(let[t,r]of this.#t){let i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;r.className="annotationContent";let{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):i.append(r)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}},kf=/\r\n?|\n/g,M_=class n extends pt{#e;#t="";#n=`${this.id}-editor`;#r=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=n.prototype,t=s=>s.isEmpty(),r=uc.TRANSLATE_SMALL,i=uc.TRANSLATE_BIG;return Je(this,"_keyboardManager",new da([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=He.FREETEXT;constructor(e){super(Ke(ce({},e),{name:"freeTextEditor"})),this.#e=e.color||n._defaultColor||pt._defaultLineColor,this.#i=e.fontSize||n._defaultFontSize}static initialize(e,t){pt.initialize(e,t);let r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Pe.FREETEXT_SIZE:n._defaultFontSize=t;break;case Pe.FREETEXT_COLOR:n._defaultColor=t;break}}updateParams(e,t){switch(e){case Pe.FREETEXT_SIZE:this.#s(t);break;case Pe.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Pe.FREETEXT_SIZE,n._defaultFontSize],[Pe.FREETEXT_COLOR,n._defaultColor||pt._defaultLineColor]]}get propertiesToUpdate(){return[[Pe.FREETEXT_SIZE,this.#i],[Pe.FREETEXT_COLOR,this.#e]]}#s(e){let t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-this.#i)*this.parentScale),this.#i=i,this.#u()},r=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){let t=i=>{this.#e=this.editorDiv.style.color=i},r=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-n._internalPadding*e,-(n._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(He.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;let e=this._uiManager.combinedSignal(this.#r);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#c(){let e=[];this.editorDiv.normalize();let t=null;for(let r of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(n.#o(r)),t=r);return e.join(`
`)}#u(){let[e,t]=this.parentDimensions,r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{let{currentLayer:i,div:s}=this,a=s.style.display,o=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),r=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=r.width/e,this.height=r.height/t):(this.width=r.height/e,this.height=r.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#t,t=this.#t=this.#c().trimEnd();if(e===t)return;let r=i=>{if(this.#t=i,!i){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{r(t)},undo:()=>{r(e)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){n._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#i}px * var(--scale-factor))`,r.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Bf(this,this.div,["dblclick","keydown"]),this.width){let[i,s]=this.parentDimensions;if(this.annotationElementId){let{position:a}=this._initialData,[o,l]=this.getInitialTranslation();[o,l]=this.pageTranslationToScreen(o,l);let[u,c]=this.pageDimensions,[d,f]=this.pageTranslation,h,p;switch(this.rotation){case 0:h=e+(a[0]-d)/u,p=t+this.height-(a[1]-f)/c;break;case 90:h=e+(a[0]-d)/u,p=t-(a[1]-f)/c,[o,l]=[l,-o];break;case 180:h=e-this.width+(a[0]-d)/u,p=t-(a[1]-f)/c,[o,l]=[-o,-l];break;case 270:h=e+(a[0]-d-this.height*c)/u,p=t+(a[1]-f-this.width*u)/c,[o,l]=[-l,o];break}this.setAt(h*i,p*s,o,l)}else this.setAt(e*i,t*s,this.width*i,this.height*s);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#o(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(kf,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:r}=t;if(r.length===1&&r[0]==="text/plain")return;e.preventDefault();let i=n.#f(t.getData("text")||"").replaceAll(kf,`
`);if(!i)return;let s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();let a=s.getRangeAt(0);if(!i.includes(`
`)){a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}let{startContainer:o,startOffset:l}=a,u=[],c=[];if(o.nodeType===Node.TEXT_NODE){let h=o.parentElement;if(c.push(o.nodeValue.slice(l).replaceAll(kf,"")),h!==this.editorDiv){let p=u;for(let g of this.editorDiv.childNodes){if(g===h){p=c;continue}p.push(n.#o(g))}}u.push(o.nodeValue.slice(0,l).replaceAll(kf,""))}else if(o===this.editorDiv){let h=u,p=0;for(let g of this.editorDiv.childNodes)p++===l&&(h=c),h.push(n.#o(g))}this.#t=`${u.join(`
`)}${i}${c.join(`
`)}`,this.#d();let d=new Range,f=u.reduce((h,p)=>h+p.length,0);for(let{firstChild:h}of this.editorDiv.childNodes)if(h.nodeType===Node.TEXT_NODE){let p=h.nodeValue.length;if(f<=p){d.setStart(h,f),d.setEnd(h,f);break}f-=p}s.removeAllRanges(),s.addRange(d)}#d(){if(this.editorDiv.replaceChildren(),!!this.#t)for(let e of this.#t.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#a(){return this.#t.replaceAll("\xA0"," ")}static#f(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static deserialize(e,t,r){return ee(this,null,function*(){let i=null;if(e instanceof rh){let{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:l,rotation:u,id:c,popupRef:d},textContent:f,textPosition:h,parent:{page:{pageNumber:p}}}=e;if(!f||f.length===0)return null;i=e={annotationType:He.FREETEXT,color:Array.from(o),fontSize:a,value:f.join(`
`),position:h,pageIndex:p-1,rect:l.slice(0),rotation:u,id:c,deleted:!1,popupRef:d}}let s=yield ka(n,this,"deserialize").call(this,e,t,r);return s.#i=e.fontSize,s.#e=Ae.makeHexColor(...e.color),s.#t=n.#f(e.value),s.annotationElementId=e.id||null,s._initialData=i,s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=n._internalPadding*this.parentScale,r=this.getRect(t,t),i=pt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),s={annotationType:He.FREETEXT,color:i,fontSize:this.#i,value:this.#a(),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?s:this.annotationElementId&&!this.#p(s)?null:(s.id=this.annotationElementId,s)}#p(e){let{value:t,fontSize:r,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==r||e.color.some((a,o)=>a!==i[o])||e.pageIndex!==s}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:r}=t;r.fontSize=`calc(${this.#i}px * var(--scale-factor))`,r.color=this.#e,t.replaceChildren();for(let s of this.#t.split(`
`)){let a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),t.append(a)}let i=n._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},oh=class{toSVGPath(){Ct("Abstract method `toSVGPath` must be implemented.")}get box(){Ct("Abstract getter `box` must be implemented.")}serialize(e,t){Ct("Abstract method `serialize` must be implemented.")}get classNamesForDrawing(){Ct("Abstract getter `classNamesForDrawing` must be implemented.")}get classNamesForOutlining(){Ct("Abstract getter `classNamesForOutlining` must be implemented.")}get mustRemoveSelfIntersections(){return!1}},lh=class n{#e;#t=[];#n;#r;#i=[];#s=new Float64Array(18);#l;#c;#u;#o;#d;#a;#f=[];static#p=8;static#h=2;static#g=n.#p+n.#h;constructor({x:e,y:t},r,i,s,a,o=0){this.#e=r,this.#a=s*i,this.#r=a,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=o,this.#o=n.#p*i,this.#u=n.#g*i,this.#d=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#v(){let e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[r,i,s,a]=this.#e;return[(this.#l+(e[0]-t[0])/2-r)/s,(this.#c+(e[1]-t[1])/2-i)/a,(this.#l+(t[0]-e[0])/2-r)/s,(this.#c+(t[1]-e[1])/2-i)/a]}add({x:e,y:t}){this.#l=e,this.#c=t;let[r,i,s,a]=this.#e,[o,l,u,c]=this.#s.subarray(8,12),d=e-u,f=t-c,h=Math.hypot(d,f);if(h<this.#u)return!1;let p=h-this.#o,g=p/h,m=g*d,v=g*f,x=o,_=l;o=u,l=c,u+=m,c+=v,this.#f?.push(e,t);let b=-v/p,D=m/p,A=b*this.#a,w=D*this.#a;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([u+A,c+w],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([u-A,c-w],16),isNaN(this.#s[6])?(this.#i.length===0&&(this.#s.set([o+A,l+w],2),this.#i.push(NaN,NaN,NaN,NaN,(o+A-r)/s,(l+w-i)/a),this.#s.set([o-A,l-w],14),this.#t.push(NaN,NaN,NaN,NaN,(o-A-r)/s,(l-w-i)/a)),this.#s.set([x,_,o,l,u,c],6),!this.isEmpty()):(this.#s.set([x,_,o,l,u,c],6),Math.abs(Math.atan2(_-l,x-o)-Math.atan2(v,m))<Math.PI/2?([o,l,u,c]=this.#s.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((o+u)/2-r)/s,((l+c)/2-i)/a),[o,l,x,_]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((x+o)/2-r)/s,((_+l)/2-i)/a),!0):([x,_,o,l,u,c]=this.#s.subarray(0,6),this.#i.push(((x+5*o)/6-r)/s,((_+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),[u,c,o,l,x,_]=this.#s.subarray(12,18),this.#t.push(((x+5*o)/6-r)/s,((_+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+c)/6-i)/a,((o+u)/2-r)/s,((l+c)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#i,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#m();let r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#y(r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#_(r),r.join(" ")}#m(){let[e,t,r,i]=this.#e,[s,a,o,l]=this.#v();return`M${(this.#s[2]-e)/r} ${(this.#s[3]-t)/i} L${(this.#s[4]-e)/r} ${(this.#s[5]-t)/i} L${s} ${a} L${o} ${l} L${(this.#s[16]-e)/r} ${(this.#s[17]-t)/i} L${(this.#s[14]-e)/r} ${(this.#s[15]-t)/i} Z`}#_(e){let t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#y(e){let[t,r,i,s]=this.#e,a=this.#s.subarray(4,6),o=this.#s.subarray(16,18),[l,u,c,d]=this.#v();e.push(`L${(a[0]-t)/i} ${(a[1]-r)/s} L${l} ${u} L${c} ${d} L${(o[0]-t)/i} ${(o[1]-r)/s}`)}newFreeDrawOutline(e,t,r,i,s,a){return new ch(e,t,r,i,s,a)}getOutlines(){let e=this.#i,t=this.#t,r=this.#s,[i,s,a,o]=this.#e,l=new Float64Array((this.#f?.length??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(this.#f[d]-i)/a,l[d+1]=(this.#f[d+1]-s)/o;if(l[l.length-2]=(this.#l-i)/a,l[l.length-1]=(this.#c-s)/o,isNaN(r[6])&&!this.isEmpty())return this.#E(l);let u=new Float64Array(this.#i.length+24+this.#t.length),c=e.length;for(let d=0;d<c;d+=2){if(isNaN(e[d])){u[d]=u[d+1]=NaN;continue}u[d]=e[d],u[d+1]=e[d+1]}c=this.#b(u,c);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){u[c]=u[c+1]=NaN,c+=2;continue}u[c]=t[d+f],u[c+1]=t[d+f+1],c+=2}return this.#w(u,c),this.newFreeDrawOutline(u,l,this.#e,this.#d,this.#n,this.#r)}#E(e){let t=this.#s,[r,i,s,a]=this.#e,[o,l,u,c]=this.#v(),d=new Float64Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-r)/s,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-r)/s,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,(t[16]-r)/s,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-r)/s,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,this.#e,this.#d,this.#n,this.#r)}#w(e,t){let r=this.#t;return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6}#b(e,t){let r=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[s,a,o,l]=this.#e,[u,c,d,f]=this.#v();return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,u,c,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l],t),t+=24}},ch=class extends oh{#e;#t=null;#n;#r;#i;#s;#l;constructor(e,t,r,i,s,a){super(),this.#l=e,this.#i=t,this.#e=r,this.#s=i,this.#n=s,this.#r=a,this.#o(a);let{x:o,y:l,width:u,height:c}=this.#t;for(let d=0,f=e.length;d<f;d+=2)e[d]=(e[d]-o)/u,e[d+1]=(e[d+1]-l)/c;for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-o)/u,t[d+1]=(t[d+1]-l)/c}toSVGPath(){let e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,r=this.#l.length;t<r;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,r,i],s){let a=r-e,o=i-t,l,u;switch(s){case 0:l=this.#c(this.#l,e,i,a,-o),u=this.#c(this.#i,e,i,a,-o);break;case 90:l=this.#u(this.#l,e,t,a,o),u=this.#u(this.#i,e,t,a,o);break;case 180:l=this.#c(this.#l,r,t,-a,o),u=this.#c(this.#i,r,t,-a,o);break;case 270:l=this.#u(this.#l,r,i,-a,-o),u=this.#u(this.#i,r,i,-a,-o);break}return{outline:Array.from(l),points:[Array.from(u)]}}#c(e,t,r,i,s){let a=new Float64Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=r+e[o+1]*s;return a}#u(e,t,r,i,s){let a=new Float64Array(e.length);for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=r+e[o]*s;return a}#o(e){let t=this.#l,r=t[4],i=t[5],s=r,a=i,o=r,l=i,u=r,c=i,d=e?Math.max:Math.min;for(let m=6,v=t.length;m<v;m+=6){if(isNaN(t[m]))s=Math.min(s,t[m+4]),a=Math.min(a,t[m+5]),o=Math.max(o,t[m+4]),l=Math.max(l,t[m+5]),c<t[m+5]?(u=t[m+4],c=t[m+5]):c===t[m+5]&&(u=d(u,t[m+4]));else{let x=Ae.bezierBoundingBox(r,i,...t.slice(m,m+6));s=Math.min(s,x[0]),a=Math.min(a,x[1]),o=Math.max(o,x[2]),l=Math.max(l,x[3]),c<x[3]?(u=x[2],c=x[3]):c===x[3]&&(u=d(u,x[2]))}r=t[m+4],i=t[m+5]}let f=s-this.#n,h=a-this.#n,p=o-s+2*this.#n,g=l-a+2*this.#n;this.#t={x:f,y:h,width:p,height:g,lastPoint:[u,c]}}get box(){return this.#t}newOutliner(e,t,r,i,s,a=0){return new lh(e,t,r,i,s,a)}getNewOutline(e,t){let{x:r,y:i,width:s,height:a}=this.#t,[o,l,u,c]=this.#e,d=s*u,f=a*c,h=r*u+o,p=i*c+l,g=this.newOutliner({x:this.#i[0]*d+h,y:this.#i[1]*f+p},this.#e,this.#s,e,this.#r,t??this.#n);for(let m=2;m<this.#i.length;m+=2)g.add({x:this.#i[m]*d+h,y:this.#i[m+1]*f+p});return g.getOutlines()}get mustRemoveSelfIntersections(){return!0}},uh=class{#e;#t=[];#n=[];constructor(e,t=0,r=0,i=!0){let s=1/0,a=-1/0,o=1/0,l=-1/0,c=10**-4;for(let{x:v,y:x,width:_,height:b}of e){let D=Math.floor((v-t)/c)*c,A=Math.ceil((v+_+t)/c)*c,w=Math.floor((x-t)/c)*c,T=Math.ceil((x+b+t)/c)*c,E=[D,w,T,!0],P=[A,w,T,!1];this.#t.push(E,P),s=Math.min(s,D),a=Math.max(a,A),o=Math.min(o,w),l=Math.max(l,T)}let d=a-s+2*r,f=l-o+2*r,h=s-r,p=o-r,g=this.#t.at(i?-1:-2),m=[g[0],g[2]];for(let v of this.#t){let[x,_,b]=v;v[0]=(x-h)/d,v[1]=(_-p)/f,v[2]=(b-p)/f}this.#e={x:h,y:p,width:d,height:f,lastPoint:m}}getOutlines(){this.#t.sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);let e=[];for(let t of this.#t)t[3]?(e.push(...this.#c(t)),this.#s(t)):(this.#l(t),e.push(...this.#c(t)));return this.#r(e)}#r(e){let t=[],r=new Set;for(let a of e){let[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){let l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}let i=[],s;for(;r.size>0;){let a=r.values().next().value,[o,l,u,c,d]=a;r.delete(a);let f=o,h=l;for(s=[o,u],i.push(s);;){let p;if(r.has(c))p=c;else if(r.has(d))p=d;else break;r.delete(p),[o,l,u,c,d]=p,f!==o&&(s.push(f,h,o,h===l?l:u),f=o),h=h===l?u:l}s.push(f,h)}return new F_(i,this.#e)}#i(e){let t=this.#n,r=0,i=t.length-1;for(;r<=i;){let s=r+i>>1,a=t[s][0];if(a===e)return s;a<e?r=s+1:i=s-1}return i+1}#s([,e,t]){let r=this.#i(e);this.#n.splice(r,0,[e,t])}#l([,e,t]){let r=this.#i(e);for(let i=r;i<this.#n.length;i++){let[s,a]=this.#n[i];if(s!==e)break;if(s===e&&a===t){this.#n.splice(i,1);return}}for(let i=r-1;i>=0;i--){let[s,a]=this.#n[i];if(s!==e)break;if(s===e&&a===t){this.#n.splice(i,1);return}}}#c(e){let[t,r,i]=e,s=[[t,r,i]],a=this.#i(i);for(let o=0;o<a;o++){let[l,u]=this.#n[o];for(let c=0,d=s.length;c<d;c++){let[,f,h]=s[c];if(!(u<=f||h<=l)){if(f>=l){if(h>u)s[c][1]=u;else{if(d===1)return[];s.splice(c,1),c--,d--}continue}s[c][2]=l,h>u&&s.push([t,u,h])}}}return s}},F_=class extends oh{#e;#t;constructor(e,t){super(),this.#t=e,this.#e=t}toSVGPath(){let e=[];for(let t of this.#t){let[r,i]=t;e.push(`M${r} ${i}`);for(let s=2;s<t.length;s+=2){let a=t[s],o=t[s+1];a===r?(e.push(`V${o}`),i=o):o===i&&(e.push(`H${a}`),r=a)}e.push("Z")}return e.join(" ")}serialize([e,t,r,i],s){let a=[],o=r-e,l=i-t;for(let u of this.#t){let c=new Array(u.length);for(let d=0;d<u.length;d+=2)c[d]=e+u[d]*o,c[d+1]=i-u[d+1]*l;a.push(c)}return a}get box(){return this.#e}get classNamesForDrawing(){return["highlight"]}get classNamesForOutlining(){return["highlightOutline"]}},_c=class extends lh{newFreeDrawOutline(e,t,r,i,s,a){return new P_(e,t,r,i,s,a)}get classNamesForDrawing(){return["highlight","free"]}},P_=class extends ch{get classNamesForDrawing(){return["highlight","free"]}get classNamesForOutlining(){return["highlightOutline","free"]}newOutliner(e,t,r,i,s,a=0){return new _c(e,t,r,i,s,a)}},dh=class n{#e=null;#t=null;#n;#r=null;#i=!1;#s=!1;#l=null;#c;#u=null;#o=null;#d;static#a=null;static get _keyboardManager(){return Je(this,"_keyboardManager",new da([[["Escape","mac+Escape"],n.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],n.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],n.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],n.prototype._moveToPrevious],[["Home","mac+Home"],n.prototype._moveToBeginning],[["End","mac+End"],n.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#d=Pe.HIGHLIGHT_COLOR,this.#l=e):(this.#s=!0,this.#d=Pe.HIGHLIGHT_DEFAULT_COLOR),this.#o=e?._uiManager||t,this.#c=this.#o._eventBus,this.#n=e?.color||this.#o?.highlightColors.values().next().value||"#FFFF98",n.#a||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){let e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#o._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#h.bind(this),{signal:t});let r=this.#t=document.createElement("span");return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=this.#n,e.append(r),e}renderMainDropdown(){let e=this.#r=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){let e=document.createElement("div"),t=this.#o._signal;e.addEventListener("contextmenu",xr,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[r,i]of this.#o.highlightColors){let s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",n.#a[r]);let a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.setAttribute("aria-selected",i===this.#n),s.addEventListener("click",this.#p.bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#h.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#c.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}let t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#m){this.#g(e);return}if(e.target===this.#e){this.#r.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstChild||e.target===this.#e){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#m){this.#g(e);return}this.#r.firstChild?.focus()}_moveToEnd(e){if(!this.#m){this.#g(e);return}this.#r.lastChild?.focus()}#h(e){n._keyboardManager.exec(this,e)}#g(e){if(this.#m){this.hideDropdown();return}if(this.#i=e.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#v.bind(this),{signal:this.#o.combinedSignal(this.#u)})),this.#r){this.#r.classList.remove("hidden");return}let t=this.#r=this.#f();this.#e.append(t)}#v(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#m(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#m){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;let t=this.#o.highlightColors.values();for(let r of this.#r.children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}},fh=class n extends pt{#e=null;#t=0;#n;#r=null;#i=null;#s=null;#l=null;#c=0;#u=null;#o=null;#d=null;#a=!1;#f=null;#p;#h=null;#g="";#v;#m="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=He.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=n.prototype;return Je(this,"_keyboardManager",new da([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(Ke(ce({},e),{name:"highlightEditor"})),this.color=e.color||n._defaultColor,this.#v=e.thickness||n._defaultThickness,this.#p=e.opacity||n._defaultOpacity,this.#n=e.boxes||null,this.#m=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#a=!0,this.#y(e),this.#T()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#c=e.focusOffset,this.#_(),this.#T(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#a?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#v,methodOfCreation:this.#m}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){let e=new uh(this.#n,.001);this.#o=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#o.box;let t=new uh(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();let{lastPoint:r}=this.#s.box;this.#f=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:e,highlightId:t,clipPathId:r}){this.#o=e;let i=1.5;if(this.#s=e.getNewOutline(this.#v/2+i,.0025),t>=0)this.#d=t,this.#r=r,this.parent.drawLayer.finalizeLine(t,e),this.#h=this.parent.drawLayer.drawOutline(this.#s);else if(this.parent){let c=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#d,e),this.parent.drawLayer.updateBox(this.#d,n.#A(this.#o.box,(c-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#h,this.#s),this.parent.drawLayer.updateBox(this.#h,n.#A(this.#s.box,c))}let{x:s,y:a,width:o,height:l}=e.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=o,this.height=l;break;case 90:{let[c,d]=this.parentDimensions;this.x=a,this.y=1-s,this.width=o*d/c,this.height=l*c/d;break}case 180:this.x=1-s,this.y=1-a,this.width=o,this.height=l;break;case 270:{let[c,d]=this.parentDimensions;this.x=1-a,this.y=s,this.width=o*d/c,this.height=l*c/d;break}}let{lastPoint:u}=this.#s.box;this.#f=[(u[0]-s)/o,(u[1]-a)/l]}static initialize(e,t){pt.initialize(e,t),n._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Pe.HIGHLIGHT_DEFAULT_COLOR:n._defaultColor=t;break;case Pe.HIGHLIGHT_THICKNESS:n._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case Pe.HIGHLIGHT_COLOR:this.#E(t);break;case Pe.HIGHLIGHT_THICKNESS:this.#w(t);break}}static get defaultPropertiesToUpdate(){return[[Pe.HIGHLIGHT_DEFAULT_COLOR,n._defaultColor],[Pe.HIGHLIGHT_THICKNESS,n._defaultThickness]]}get propertiesToUpdate(){return[[Pe.HIGHLIGHT_COLOR,this.color||n._defaultColor],[Pe.HIGHLIGHT_THICKNESS,this.#v||n._defaultThickness],[Pe.HIGHLIGHT_FREE,this.#a]]}#E(e){let t=(s,a)=>{this.color=s,this.parent?.drawLayer.changeColor(this.#d,s),this.#i?.updateColor(s),this.#p=a,this.parent?.drawLayer.changeOpacity(this.#d,a)},r=this.color,i=this.#p;this.addCommands({cmd:t.bind(this,e,n._defaultOpacity),undo:t.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#w(e){let t=this.#v,r=i=>{this.#v=i,this.#b(i)};this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}addEditToolbar(){return ee(this,null,function*(){let e=yield ka(n.prototype,this,"addEditToolbar").call(this);return e?(this._uiManager.highlightColors&&(this.#i=new dh({editor:this}),e.addColorPicker(this.#i)),e):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#M())}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#T(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#T(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#b(e){if(!this.#a)return;this.#y({highlightOutlines:this.#o.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,r]=this.parentDimensions;this.setDims(this.width*t,this.height*r)}#k(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#h),this.#h=null)}#T(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#r}=e.drawLayer.draw(this.#o,this.color,this.#p),this.#h=e.drawLayer.drawOutline(this.#s),this.#u&&(this.#u.style.clipPath=this.#r))}static#A({x:e,y:t,width:r,height:i},s){switch(s){case 90:return{x:1-t-i,y:e,width:i,height:r};case 180:return{x:1-e-r,y:1-t-i,width:r,height:i};case 270:return{x:t,y:1-e-r,width:i,height:r}}return{x:e,y:t,width:r,height:i}}rotate(e){let{drawLayer:t}=this.parent,r;this.#a?(e=(e-this.rotation+360)%360,r=n.#A(this.#o.box,e)):r=n.#A(this,e),t.rotate(this.#d,e),t.rotate(this.#h,e),t.updateBox(this.#d,r),t.updateBox(this.#h,n.#A(this.#s.box,e))}render(){if(this.div)return this.div;let e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#a?e.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});let t=this.#u=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r;let[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),Bf(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent.drawLayer.addClass(this.#h,"hovered")}pointerleave(){this.isSelected||this.parent.drawLayer.removeClass(this.#h,"hovered")}#D(e){n._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#S(!0);break;case 1:case 3:this.#S(!1);break}}#S(e){if(!this.#e)return;let t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#c)}select(){super.select(),this.#h&&(this.parent?.drawLayer.removeClass(this.#h,"hovered"),this.parent?.drawLayer.addClass(this.#h,"selected"))}unselect(){super.unselect(),this.#h&&(this.parent?.drawLayer.removeClass(this.#h,"selected"),this.#a||this.#S(!1))}get _mustFixPosition(){return!this.#a}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(this.#d,e),this.parent.drawLayer.show(this.#h,e))}#M(){return this.#a?this.rotation:0}#P(){if(this.#a)return null;let[e,t]=this.pageDimensions,[r,i]=this.pageTranslation,s=this.#n,a=new Float32Array(s.length*8),o=0;for(let{x:l,y:u,width:c,height:d}of s){let f=l*e+r,h=(1-u-d)*t+i;a[o]=a[o+4]=f,a[o+1]=a[o+3]=h,a[o+2]=a[o+6]=f+c*e,a[o+5]=a[o+7]=h+d*t,o+=8}return a}#C(e){return this.#o.serialize(e,this.#M())}static startHighlighting(e,t,{target:r,x:i,y:s}){let{x:a,y:o,width:l,height:u}=r.getBoundingClientRect(),c=new AbortController,d=e.combinedSignal(c),f=p=>{p.preventDefault(),p.stopPropagation()},h=p=>{c.abort(),this.#I(e,p)};window.addEventListener("blur",h,{signal:d}),window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("pointerdown",f,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",xr,{signal:d}),r.addEventListener("pointermove",this.#x.bind(this,e),{signal:d}),this._freeHighlight=new _c({x:i,y:s},[a,o,l,u],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static#x(e,t){this._freeHighlight.add(t)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#I(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,r){return ee(this,null,function*(){let i=null;if(e instanceof sh){let{data:{quadPoints:p,rect:g,rotation:m,id:v,color:x,opacity:_,popupRef:b},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:He.HIGHLIGHT,color:Array.from(x),opacity:_,quadPoints:p,boxes:null,pageIndex:D-1,rect:g.slice(0),rotation:m,id:v,deleted:!1,popupRef:b}}else if(e instanceof vc){let{data:{inkLists:p,rect:g,rotation:m,id:v,color:x,borderStyle:{rawWidth:_},popupRef:b},parent:{page:{pageNumber:D}}}=e;i=e={annotationType:He.HIGHLIGHT,color:Array.from(x),thickness:_,inkLists:p,boxes:null,pageIndex:D-1,rect:g.slice(0),rotation:m,id:v,deleted:!1,popupRef:b}}let{color:s,quadPoints:a,inkLists:o,opacity:l}=e,u=yield ka(n,this,"deserialize").call(this,e,t,r);u.color=Ae.makeHexColor(...s),u.#p=l||1,o&&(u.#v=e.thickness),u.annotationElementId=e.id||null,u._initialData=i;let[c,d]=u.pageDimensions,[f,h]=u.pageTranslation;if(a){let p=u.#n=[];for(let g=0;g<a.length;g+=8)p.push({x:(a[g]-f)/c,y:1-(a[g+1]-h)/d,width:(a[g+2]-a[g])/c,height:(a[g+1]-a[g+5])/d});u.#_(),u.#T(),u.rotate(u.rotation)}else if(o){u.#a=!0;let p=o[0],g={x:p[0]-f,y:d-(p[1]-h)},m=new _c(g,[0,0,c,d],1,u.#v/2,!0,.001);for(let _=0,b=p.length;_<b;_+=2)g.x=p[_]-f,g.y=d-(p[_+1]-h),m.add(g);let{id:v,clipPathId:x}=t.drawLayer.draw(m,u.color,u._defaultOpacity,!0);u.#y({highlightOutlines:m.getOutlines(),highlightId:v,clipPathId:x}),u.#T()}return u})}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=this.getRect(0,0),r=pt._colorManager.convert(this.color),i={annotationType:He.HIGHLIGHT,color:r,opacity:this.#p,thickness:this.#v,quadPoints:this.#P(),outlines:this.#C(t),pageIndex:this.pageIndex,rect:t,rotation:this.#M(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#F(i)?null:(i.id=this.annotationElementId,i)}#F(e){let{color:t}=this._initialData;return e.color.some((r,i)=>r!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},R_=class n extends pt{#e=0;#t=0;#n=null;#r=new Path2D;#i=!1;#s=null;#l=!1;#c=!1;#u=null;#o=null;#d=0;#a=0;#f=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=He.INK;constructor(e){super(Ke(ce({},e),{name:"inkEditor"})),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,t){pt.initialize(e,t)}static updateDefaultParams(e,t){switch(e){case Pe.INK_THICKNESS:n._defaultThickness=t;break;case Pe.INK_COLOR:n._defaultColor=t;break;case Pe.INK_OPACITY:n._defaultOpacity=t/100;break}}updateParams(e,t){switch(e){case Pe.INK_THICKNESS:this.#p(t);break;case Pe.INK_COLOR:this.#h(t);break;case Pe.INK_OPACITY:this.#g(t);break}}static get defaultPropertiesToUpdate(){return[[Pe.INK_THICKNESS,n._defaultThickness],[Pe.INK_COLOR,n._defaultColor||pt._defaultLineColor],[Pe.INK_OPACITY,Math.round(n._defaultOpacity*100)]]}get propertiesToUpdate(){return[[Pe.INK_THICKNESS,this.thickness||n._defaultThickness],[Pe.INK_COLOR,this.color||n._defaultColor||pt._defaultLineColor],[Pe.INK_OPACITY,Math.round(100*(this.opacity??n._defaultOpacity))]]}#p(e){let t=i=>{this.thickness=i,this.#R()},r=this.thickness;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#h(e){let t=i=>{this.color=i,this.#A()},r=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(e){let t=i=>{this.opacity=i,this.#A()};e/=100;let r=this.opacity;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#P(),this.#C()),this.isAttachedToDOM||(this.parent.add(this),this.#x()),this.#R()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#n&&(clearTimeout(this.#n),this.#n=null),this.#u?.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){let[e,t]=this.parentDimensions,r=this.width*e,i=this.height*t;this.setDimensions(r,i)}enableEditMode(){this.#i||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.#D())}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.#S())}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#v(){let{parentRotation:e,parentDimensions:[t,r]}=this;switch(e){case 90:return[0,r,r,t];case 180:return[t,r,t,r];case 270:return[t,0,r,t];default:return[0,0,t,r]}}#m(){let{ctx:e,color:t,opacity:r,thickness:i,parentScale:s,scaleFactor:a}=this;e.lineWidth=i*s/a,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${dB(r)}`}#_(e,t){this.canvas.addEventListener("contextmenu",xr,{signal:this._uiManager._signal}),this.#S(),this.#s=new AbortController;let r=this._uiManager.combinedSignal(this.#s);this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:r}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:r}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:r}),this.isEditing=!0,this.#c||(this.#c=!0,this.#x(),this.thickness||=n._defaultThickness,this.color||=n._defaultColor||pt._defaultLineColor,this.opacity??=n._defaultOpacity),this.currentPath.push([e,t]),this.#l=!1,this.#m(),this.#f=()=>{this.#b(),this.#f&&window.requestAnimationFrame(this.#f)},window.requestAnimationFrame(this.#f)}#y(e,t){let[r,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===r&&t===i)return;let s=this.currentPath,a=this.#r;if(s.push([e,t]),this.#l=!0,s.length<=2){a.moveTo(...s[0]),a.lineTo(e,t);return}s.length===3&&(this.#r=a=new Path2D,a.moveTo(...s[0])),this.#k(a,...s.at(-3),...s.at(-2),e,t)}#E(){if(this.currentPath.length===0)return;let e=this.currentPath.at(-1);this.#r.lineTo(...e)}#w(e,t){this.#f=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#y(e,t),this.#E();let r;if(this.currentPath.length!==1)r=this.#T();else{let l=[e,t];r=[[l,l.slice(),l.slice(),l]]}let i=this.#r,s=this.currentPath;this.currentPath=[],this.#r=new Path2D;let a=()=>{this.allRawPaths.push(s),this.paths.push(r),this.bezierPath2D.push(i),this._uiManager.rebuild(this)},o=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#P(),this.#C()),this.#R())};this.addCommands({cmd:a,undo:o,mustExec:!0})}#b(){if(!this.#l)return;this.#l=!1;let e=Math.ceil(this.thickness*this.parentScale),t=this.currentPath.slice(-3),r=t.map(c=>c[0]),i=t.map(c=>c[1]),s=Math.min(...r)-e,a=Math.max(...r)+e,o=Math.min(...i)-e,l=Math.max(...i)+e,{ctx:u}=this;u.save(),u.clearRect(0,0,this.canvas.width,this.canvas.height);for(let c of this.bezierPath2D)u.stroke(c);u.stroke(this.#r),u.restore()}#k(e,t,r,i,s,a,o){let l=(t+i)/2,u=(r+s)/2,c=(i+a)/2,d=(s+o)/2;e.bezierCurveTo(l+2*(i-l)/3,u+2*(s-u)/3,c+2*(i-c)/3,d+2*(s-d)/3,c,d)}#T(){let e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];let t=[],r,[i,s]=e[0];for(r=1;r<e.length-2;r++){let[f,h]=e[r],[p,g]=e[r+1],m=(f+p)/2,v=(h+g)/2,x=[i+2*(f-i)/3,s+2*(h-s)/3],_=[m+2*(f-m)/3,v+2*(h-v)/3];t.push([[i,s],x,_,[m,v]]),[i,s]=[m,v]}let[a,o]=e[r],[l,u]=e[r+1],c=[i+2*(a-i)/3,s+2*(o-s)/3],d=[l+2*(a-l)/3,u+2*(o-u)/3];return t.push([[i,s],c,d,[l,u]]),t}#A(){if(this.isEmpty()){this.#F();return}this.#m();let{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#F();for(let r of this.bezierPath2D)t.stroke(r)}commit(){this.#i||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#i=!0,this.div.classList.add("disabled"),this.#R(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}#D(){if(this.#o)return;this.#o=new AbortController;let e=this._uiManager.combinedSignal(this.#o);this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})}#S(){this.pointerdownAC?.abort(),this.pointerdownAC=null}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#i||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#_(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#y(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#M(e)}canvasPointerleave(e){this.#M(e)}#M(e){this.#s?.abort(),this.#s=null,this.#D(),this.#n&&clearTimeout(this.#n),this.#n=setTimeout(()=>{this.#n=null,this.canvas.removeEventListener("contextmenu",xr)},10),this.#w(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#P(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#C(){this.#u=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),this.#u.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#u?.disconnect(),this.#u=null},{once:!0})}get isResizable(){return!this.isEmpty()&&this.#i}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");let[r,i,s,a]=this.#v();if(this.setAt(r,i,0,0),this.setDims(s,a),this.#P(),this.width){let[o,l]=this.parentDimensions;this.setAspectRatio(this.width*o,this.height*l),this.setAt(e*o,t*l,this.width*o,this.height*l),this.#c=!0,this.#x(),this.setDims(this.width*o,this.height*l),this.#A(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#C(),this.div}#x(){if(!this.#c)return;let[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#F()}setDimensions(e,t){let r=Math.round(e),i=Math.round(t);if(this.#d===r&&this.#a===i)return;this.#d=r,this.#a=i,this.canvas.style.visibility="hidden";let[s,a]=this.parentDimensions;this.width=e/s,this.height=t/a,this.fixAndSetPosition(),this.#i&&this.#I(e,t),this.#x(),this.#A(),this.canvas.style.visibility="visible",this.fixDims()}#I(e,t){let r=this.#V(),i=(e-r)/this.#t,s=(t-r)/this.#e;this.scaleFactor=Math.min(i,s)}#F(){let e=this.#V()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#L(e){let t=new Path2D;for(let r=0,i=e.length;r<i;r++){let[s,a,o,l]=e[r];r===0&&t.moveTo(...s),t.bezierCurveTo(a[0],a[1],o[0],o[1],l[0],l[1])}return t}static#U(e,t,r){let[i,s,a,o]=t;switch(r){case 0:for(let l=0,u=e.length;l<u;l+=2)e[l]+=i,e[l+1]=o-e[l+1];break;case 90:for(let l=0,u=e.length;l<u;l+=2){let c=e[l];e[l]=e[l+1]+i,e[l+1]=c+s}break;case 180:for(let l=0,u=e.length;l<u;l+=2)e[l]=a-e[l],e[l+1]+=s;break;case 270:for(let l=0,u=e.length;l<u;l+=2){let c=e[l];e[l]=a-e[l+1],e[l+1]=o-c}break;default:throw new Error("Invalid rotation")}return e}static#j(e,t,r){let[i,s,a,o]=t;switch(r){case 0:for(let l=0,u=e.length;l<u;l+=2)e[l]-=i,e[l+1]=o-e[l+1];break;case 90:for(let l=0,u=e.length;l<u;l+=2){let c=e[l];e[l]=e[l+1]-s,e[l+1]=c-i}break;case 180:for(let l=0,u=e.length;l<u;l+=2)e[l]=a-e[l],e[l+1]-=s;break;case 270:for(let l=0,u=e.length;l<u;l+=2){let c=e[l];e[l]=o-e[l+1],e[l+1]=a-c}break;default:throw new Error("Invalid rotation")}return e}#O(e,t,r,i){let s=[],a=this.thickness/2,o=e*t+a,l=e*r+a;for(let u of this.paths){let c=[],d=[];for(let f=0,h=u.length;f<h;f++){let[p,g,m,v]=u[f];if(p[0]===v[0]&&p[1]===v[1]&&h===1){let P=e*p[0]+o,N=e*p[1]+l;c.push(P,N),d.push(P,N);break}let x=e*p[0]+o,_=e*p[1]+l,b=e*g[0]+o,D=e*g[1]+l,A=e*m[0]+o,w=e*m[1]+l,T=e*v[0]+o,E=e*v[1]+l;f===0&&(c.push(x,_),d.push(x,_)),c.push(b,D,A,w,T,E),d.push(b,D),f===h-1&&d.push(T,E)}s.push({bezier:n.#U(c,i,this.rotation),points:n.#U(d,i,this.rotation)})}return s}#B(){let e=1/0,t=-1/0,r=1/0,i=-1/0;for(let s of this.paths)for(let[a,o,l,u]of s){let c=Ae.bezierBoundingBox(...a,...o,...l,...u);e=Math.min(e,c[0]),r=Math.min(r,c[1]),t=Math.max(t,c[2]),i=Math.max(i,c[3])}return[e,r,t,i]}#V(){return this.#i?Math.ceil(this.thickness*this.parentScale):0}#R(e=!1){if(this.isEmpty())return;if(!this.#i){this.#A();return}let t=this.#B(),r=this.#V();this.#t=Math.max(pt.MIN_SIZE,t[2]-t[0]),this.#e=Math.max(pt.MIN_SIZE,t[3]-t[1]);let i=Math.ceil(r+this.#t*this.scaleFactor),s=Math.ceil(r+this.#e*this.scaleFactor),[a,o]=this.parentDimensions;this.width=i/a,this.height=s/o,this.setAspectRatio(i,s);let l=this.translationX,u=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#x(),this.#A(),this.#d=i,this.#a=s,this.setDims(i,s);let c=e?r/this.scaleFactor/2:0;this.translate(l-this.translationX-c,u-this.translationY-c)}static deserialize(e,t,r){return ee(this,null,function*(){if(e instanceof vc)return null;let i=yield ka(n,this,"deserialize").call(this,e,t,r);i.thickness=e.thickness,i.color=Ae.makeHexColor(...e.color),i.opacity=e.opacity;let[s,a]=i.pageDimensions,o=i.width*s,l=i.height*a,u=i.parentScale,c=e.thickness/2;i.#i=!0,i.#d=Math.round(o),i.#a=Math.round(l);let{paths:d,rect:f,rotation:h}=e;for(let{bezier:g}of d){g=n.#j(g,f,h);let m=[];i.paths.push(m);let v=u*(g[0]-c),x=u*(g[1]-c);for(let b=2,D=g.length;b<D;b+=6){let A=u*(g[b]-c),w=u*(g[b+1]-c),T=u*(g[b+2]-c),E=u*(g[b+3]-c),P=u*(g[b+4]-c),N=u*(g[b+5]-c);m.push([[v,x],[A,w],[T,E],[P,N]]),v=P,x=N}let _=this.#L(m);i.bezierPath2D.push(_)}let p=i.#B();return i.#t=Math.max(pt.MIN_SIZE,p[2]-p[0]),i.#e=Math.max(pt.MIN_SIZE,p[3]-p[1]),i.#I(o,l),i})}serialize(){if(this.isEmpty())return null;let e=this.getRect(0,0),t=pt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:He.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#O(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}},N_=class n extends pt{#e=null;#t=null;#n=null;#r=null;#i=null;#s="";#l=null;#c=null;#u=null;#o=!1;#d=!1;static _type="stamp";static _editorType=He.STAMP;constructor(e){super(Ke(ce({},e),{name:"stampEditor"})),this.#r=e.bitmapUrl,this.#i=e.bitmapFile}static initialize(e,t){pt.initialize(e,t)}static get supportedTypes(){return Je(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Je(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(He.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#a(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#o=e.isSvg),e.file&&(this.#s=e.file.name),this.#h()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}mlGuessAltText(e=null,t=!0){return ee(this,null,function*(){if(this.hasAltTextData())return null;let{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!(yield r.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");let{data:i,width:s,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=yield r.guess({name:"altText",request:{data:i,width:s,height:a,channels:i.length/(s*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");let l=o.output;return yield this.setGuessedAltText(l),t&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l})}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(r=>this.#a(r,!0)).finally(()=>this.#f());return}if(this.#r){let r=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(r).then(i=>this.#a(i)).finally(()=>this.#f());return}if(this.#i){let r=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(r).then(i=>this.#a(i)).finally(()=>this.#f());return}let e=document.createElement("input");e.type="file",e.accept=n.supportedTypesStr;let t=this._uiManager._signal;this.#n=new Promise(r=>{e.addEventListener("change",()=>ee(this,null,function*(){if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let i=yield this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#a(i)}r()}),{signal:t}),e.addEventListener("cancel",()=>{this.remove(),r()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#c?.disconnect(),this.#c=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#i||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#h():this.#p(),this.width&&!this.annotationElementId){let[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i)}return this.div}#h(){let{div:e}=this,{width:t,height:r}=this.#e,[i,s]=this.pageDimensions,a=.75;if(this.width)t=this.width*i,r=this.height*s;else if(t>a*i||r>a*s){let c=Math.min(a*i/t,a*s/r);t*=c,r*=c}let[o,l]=this.parentDimensions;this.setDims(t*o/i,r*l/s),this._uiManager.enableWaiting(!1);let u=this.#l=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(t,r),this.#y(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&u.setAttribute("aria-label",this.#s)}copyCanvas(e,t,r=!1){e||(e=224);let{width:i,height:s}=this.#e,a=new cc,o=this.#e,l=i,u=s,c=null;if(t){if(i>t||s>t){let A=Math.min(t/i,t/s);l=Math.floor(i*A),u=Math.floor(s*A)}c=document.createElement("canvas");let f=c.width=Math.ceil(l*a.sx),h=c.height=Math.ceil(u*a.sy);this.#o||(o=this.#v(f,h));let p=c.getContext("2d");p.filter=this._uiManager.hcmFilter;let g="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(g="#8f8f9d",m="#42414d");let v=15,x=v*a.sx,_=v*a.sy,b=new OffscreenCanvas(x*2,_*2),D=b.getContext("2d");D.fillStyle=g,D.fillRect(0,0,x*2,_*2),D.fillStyle=m,D.fillRect(0,0,x,_),D.fillRect(x,_,x,_),p.fillStyle=p.createPattern(b,"repeat"),p.fillRect(0,0,f,h),p.drawImage(o,0,0,o.width,o.height,0,0,f,h)}let d=null;if(r){let f,h;if(a.symmetric&&o.width<e&&o.height<e)f=o.width,h=o.height;else if(o=this.#e,i>e||s>e){let m=Math.min(e/i,e/s);f=Math.floor(i*m),h=Math.floor(s*m),this.#o||(o=this.#v(f,h))}let g=new OffscreenCanvas(f,h).getContext("2d",{willReadFrequently:!0});g.drawImage(o,0,0,o.width,o.height,0,0,f,h),d={width:f,height:h,data:g.getImageData(0,0,f,h).data}}return{canvas:c,width:l,height:u,imageData:d}}#g(e,t){let[r,i]=this.parentDimensions;this.width=e/r,this.height=t/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#u!==null&&clearTimeout(this.#u);let s=200;this.#u=setTimeout(()=>{this.#u=null,this.#m(e,t)},s)}#v(e,t){let{width:r,height:i}=this.#e,s=r,a=i,o=this.#e;for(;s>2*e||a>2*t;){let l=s,u=a;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));let c=new OffscreenCanvas(s,a);c.getContext("2d").drawImage(o,0,0,l,u,0,0,s,a),o=c.transferToImageBitmap()}return o}#m(e,t){let r=new cc,i=Math.ceil(e*r.sx),s=Math.ceil(t*r.sy),a=this.#l;if(!a||a.width===i&&a.height===s)return;a.width=i,a.height=s;let o=this.#o?this.#e:this.#v(i,s),l=a.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(o,0,0,o.width,o.height,0,0,i,s)}getImageForAltText(){return this.#l}#_(e){if(e){if(this.#o){let i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#o){let[t,r]=this.pageDimensions,i=Math.round(this.width*t*Es.PDF_TO_CSS_UNITS),s=Math.round(this.height*r*Es.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,s);return a.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,s),a.transferToImageBitmap()}return structuredClone(this.#e)}#y(){this._uiManager._signal&&(this.#c=new ResizeObserver(e=>{let t=e[0].contentRect;t.width&&t.height&&this.#g(t.width,t.height)}),this.#c.observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{this.#c?.disconnect(),this.#c=null},{once:!0}))}static deserialize(e,t,r){return ee(this,null,function*(){let i=null;if(e instanceof ah){let{data:{rect:p,rotation:g,id:m,structParent:v,popupRef:x},container:_,parent:{page:{pageNumber:b}}}=e,D=_.querySelector("canvas"),A=r.imageManager.getFromCanvas(_.id,D);D.remove();let w=(yield t._structTree.getAriaAttributes(`${B_}${m}`))?.get("aria-label")||"";i=e={annotationType:He.STAMP,bitmapId:A.id,bitmap:A.bitmap,pageIndex:b-1,rect:p.slice(0),rotation:g,id:m,deleted:!1,accessibilityData:{decorative:!1,altText:w},isSvg:!1,structParent:v,popupRef:x}}let s=yield ka(n,this,"deserialize").call(this,e,t,r),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:u,isSvg:c,accessibilityData:d}=e;u&&r.imageManager.isValidId(u)?(s.#t=u,o&&(s.#e=o)):s.#r=l,s.#o=c;let[f,h]=s.pageDimensions;return s.width=(a[2]-a[0])/f,s.height=(a[3]-a[1])/h,s.annotationElementId=e.id||null,d&&(s.altTextData=d),s._initialData=i,s.#d=!!i,s})}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let r={annotationType:He.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#o,structTreeParentId:this._structTreeParentId};if(e)return r.bitmapUrl=this.#_(!0),r.accessibilityData=this.serializeAltText(!0),r;let{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(r.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){let o=this.#E(r);if(o.isSame)return null;o.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,t===null)return r;t.stamps||=new Map;let a=this.#o?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:a,serialized:r}),r.bitmap=this.#_(!1);else if(this.#o){let o=t.stamps.get(this.#t);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#_(!1))}return r}#E(e){let{rect:t,pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=e.rect.every((l,u)=>Math.abs(l-t[u])<1),a=e.pageIndex===r,o=(e.accessibilityData?.alt||"")===i;return{isSame:s&&a&&o,isSameAltText:o}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},UB=(()=>{class n{#e;#t=!1;#n=null;#r=null;#i=null;#s=new Map;#l=!1;#c=!1;#u=!1;#o=null;#d=null;#a;static _initialized=!1;static#f=new Map([M_,R_,N_,fh].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:r,div:i,structTreeLayer:s,accessibilityManager:a,annotationLayer:o,drawLayer:l,textLayer:u,viewport:c,l10n:d}){let f=[...n.#f.values()];if(!n._initialized){n._initialized=!0;for(let h of f)h.initialize(d,t)}t.registerEditorTypes(f),this.#a=t,this.pageIndex=r,this.div=i,this.#e=a,this.#n=o,this.viewport=c,this.#o=u,this.drawLayer=l,this._structTree=s,this.#a.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===He.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#m(),t){case He.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case He.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case He.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:r}=this.div;for(let i of n.#f.values())r.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#o?.div}addInkEditorIfNeeded(t){if(this.#a.getMode()!==He.INK)return;if(!t){for(let i of this.#s.values())if(i.isEmpty()){i.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}enable(){return ee(this,null,function*(){this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let i of this.#s.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#n)return;let r=this.#n.getEditableAnnotations();for(let i of r){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;let s=yield this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}})}disable(){this.#u=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,r=new Map;for(let s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else r.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){let s=this.#n.getEditableAnnotations();for(let a of s){let{id:o}=a.data;if(this.#a.isDeletedAnnotationElement(o))continue;let l=r.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=t.get(o),l&&(this.#a.addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}this.#m(),this.isEmpty&&(this.div.hidden=!0);let{classList:i}=this.div;for(let s of n.#f.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#u=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#o?.div&&!this.#d){this.#d=new AbortController;let t=this.#a.combinedSignal(this.#d);this.#o.div.addEventListener("pointerdown",this.#p.bind(this),{signal:t}),this.#o.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#o?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#o.div.classList.remove("highlighting"))}#p(t){this.#a.unselectAll();let{target:r}=t;if(r===this.#o.div||(r.getAttribute("role")==="img"||r.classList.contains("endOfContent"))&&this.#o.div.contains(r)){let{isMac:i}=mn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#o.div.classList.add("free"),this.toggleDrawing(),fh.startHighlighting(this,this.#a.direction==="ltr",{target:this.#o.div,x:t.x,y:t.y}),this.#o.div.addEventListener("pointerup",()=>{this.#o.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;let t=this.#a.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){this.#r?.abort(),this.#r=null}attach(t){this.#s.set(t.id,t);let{annotationElementId:r}=t;r&&this.#a.isDeletedAnnotationElement(r)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#e?.removePointerInTextLayer(t.contentDiv),!this.#u&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#c||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),pt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){let r=t.render();this.div.append(r),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:r}=document;t.div.contains(r)&&!this.#i&&(t._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),r.focus())},0)),t._structTreeParentId=this.#e?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let r=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:r,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#h(){return n.#f.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#g(t){let r=this.#h;return r?new r.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#h?.canCreateNewEmptyEditor()}pasteEditor(t,r){this.#a.updateToolbar(t),this.#a.updateMode(t);let{offsetX:i,offsetY:s}=this.#v(),a=this.getNextId(),o=this.#g(ce({parent:this,id:a,x:i,y:s,uiManager:this.#a,isCentered:!0},r));o&&this.add(o)}deserialize(t){return ee(this,null,function*(){return(yield n.#f.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a))||null})}createAndAddNewEditor(t,r,i={}){let s=this.getNextId(),a=this.#g(ce({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:r},i));return a&&this.add(a),a}#v(){let{x:t,y:r,width:i,height:s}=this.div.getBoundingClientRect(),a=Math.max(0,t),o=Math.max(0,r),l=Math.min(window.innerWidth,t+i),u=Math.min(window.innerHeight,r+s),c=(a+l)/2-t,d=(o+u)/2-r,[f,h]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:f,offsetY:h}}addNewEditor(){this.createAndAddNewEditor(this.#v(),!0)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){let{isMac:r}=mn.platform;if(!(t.button!==0||t.ctrlKey&&r)&&t.target===this.div&&this.#l){if(this.#l=!1,!this.#t){this.#t=!0;return}if(this.#a.getMode()===He.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#a.getMode()===He.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}let{isMac:r}=mn.platform;if(t.button!==0||t.ctrlKey&&r||t.target!==this.div)return;this.#l=!0;let i=this.#a.getActive();this.#t=!i||i.isEmpty()}findNewParent(t,r,i){let s=this.#a.findParent(r,i);return s===null||s===this?!1:(s.changeParent(t),!0)}destroy(){this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(let t of this.#s.values())this.#e?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#a.removeLayer(this)}#m(){this.#c=!0;for(let t of this.#s.values())t.isEmpty()&&t.remove();this.#c=!1}render({viewport:t}){this.viewport=t,ua(this.div,t);for(let r of this.#a.getEditors(this.pageIndex))this.add(r),r.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#m();let r=this.viewport.rotation,i=t.rotation;if(this.viewport=t,ua(this.div,{rotation:i}),r!==i)for(let s of this.#s.values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){let{pageWidth:t,pageHeight:r}=this.viewport.rawDims;return[t,r]}get scale(){return this.#a.viewParameters.realScale}}return n})(),O_=class n{#e=null;#t=0;#n=new Map;#r=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#n.size>0)for(let t of this.#n.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Je(this,"_svgFactory",new gc)}static#i(e,{x:t=0,y:r=0,width:i=1,height:s=1}={}){let{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*s}%`}#s(e){let t=n._svgFactory.create(1,1,!0);return this.#e.append(t),t.setAttribute("aria-hidden",!0),n.#i(t,e),t}#l(e,t){let r=n._svgFactory.createElement("clipPath");e.append(r);let i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");let s=n._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i}draw(e,t,r,i=!1){let s=this.#t++,a=this.#s(e.box);a.classList.add(...e.classNamesForDrawing);let o=n._svgFactory.createElement("defs");a.append(o);let l=n._svgFactory.createElement("path");o.append(l);let u=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",u),l.setAttribute("d",e.toSVGPath()),i&&this.#r.set(s,l);let c=this.#l(o,u),d=n._svgFactory.createElement("use");return a.append(d),a.setAttribute("fill",t),a.setAttribute("fill-opacity",r),d.setAttribute("href",`#${u}`),this.#n.set(s,a),{id:s,clipPathId:`url(#${c})`}}drawOutline(e){let t=this.#t++,r=this.#s(e.box);r.classList.add(...e.classNamesForOutlining);let i=n._svgFactory.createElement("defs");r.append(i);let s=n._svgFactory.createElement("path");i.append(s);let a=`path_p${this.pageIndex}_${t}`;s.setAttribute("id",a),s.setAttribute("d",e.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke");let o;if(e.mustRemoveSelfIntersections){let c=n._svgFactory.createElement("mask");i.append(c),o=`mask_p${this.pageIndex}_${t}`,c.setAttribute("id",o),c.setAttribute("maskUnits","objectBoundingBox");let d=n._svgFactory.createElement("rect");c.append(d),d.setAttribute("width","1"),d.setAttribute("height","1"),d.setAttribute("fill","white");let f=n._svgFactory.createElement("use");c.append(f),f.setAttribute("href",`#${a}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}let l=n._svgFactory.createElement("use");r.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);let u=l.cloneNode();return r.append(u),l.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.#n.set(t,r),t}finalizeLine(e,t){let r=this.#r.get(e);this.#r.delete(e),this.updateBox(e,t.box),r.setAttribute("d",t.toSVGPath())}updateLine(e,t){this.#n.get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}updatePath(e,t){this.#r.get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){n.#i(this.#n.get(e),t)}show(e,t){this.#n.get(e).classList.toggle("hidden",!t)}rotate(e,t){this.#n.get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){this.#n.get(e).setAttribute("fill",t)}changeOpacity(e,t){this.#n.get(e).setAttribute("fill-opacity",t)}addClass(e,t){this.#n.get(e).classList.add(t)}removeClass(e,t){this.#n.get(e).classList.remove(t)}getSVGRoot(e){return this.#n.get(e)}remove(e){this.#r.delete(e),this.#e!==null&&(this.#n.get(e).remove(),this.#n.delete(e))}destroy(){this.#e=null;for(let e of this.#n.values())e.remove();this.#n.clear(),this.#r.clear()}};var HB=Le.AbortException,$B=Le.AnnotationEditorLayer,WB=Le.AnnotationEditorParamsType,W_=Le.AnnotationEditorType,zB=Le.AnnotationEditorUIManager,GB=Le.AnnotationLayer,qB=Le.AnnotationMode,XB=Le.ColorPicker,YB=Le.DOMSVGFactory,KB=Le.DrawLayer,QB=Le.FeatureTest,z_=Le.GlobalWorkerOptions,ZB=Le.ImageKind,JB=Le.InvalidPDFException,e8=Le.MissingPDFException,t8=Le.OPS,n8=Le.OutputScale,r8=Le.PDFDataRangeTransport,i8=Le.PDFDateString,s8=Le.PDFWorker,a8=Le.PasswordResponses,o8=Le.PermissionFlag,l8=Le.PixelsPerInch,c8=Le.RenderingCancelledException,u8=Le.TextLayer,d8=Le.UnexpectedResponseException,f8=Le.Util,G_=Le.VerbosityLevel,h8=Le.XfaLayer,p8=Le.build,g8=Le.createValidAbsoluteUrl,m8=Le.fetchData,q_=Le.getDocument,v8=Le.getFilenameFromUrl,_8=Le.getPdfFilenameFromUrl,x8=Le.getXfaPageViewport,y8=Le.isDataScheme,w8=Le.isPdfFile,b8=Le.noContextMenu,E8=Le.normalizeUnicode,A8=Le.setLayerDimensions,C8=Le.shadow,yc=Le.version;var Nx={};z1(Nx,{AnnotationLayerBuilder:()=>f6,DownloadManager:()=>h6,EventBus:()=>p6,FindState:()=>g6,GenericL10n:()=>kx,LinkTarget:()=>ma,PDFFindController:()=>Mx,PDFHistory:()=>m6,PDFLinkService:()=>Fx,PDFPageView:()=>v6,PDFScriptingManager:()=>_6,PDFSinglePageViewer:()=>Px,PDFViewer:()=>Rx,ProgressBar:()=>x6,RenderingStates:()=>y6,ScrollMode:()=>w6,SimpleLinkService:()=>b6,SpreadMode:()=>E6,StructTreeLayerBuilder:()=>A6,TextLayerBuilder:()=>C6,XfaLayerBuilder:()=>S6,parseQueryString:()=>T6});var bc={};bc.d=(n,e)=>{for(var t in e)bc.o(e,t)&&!bc.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};bc.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Mt=globalThis.pdfjsViewer={};bc.d(Mt,{AnnotationLayerBuilder:()=>Ih,DownloadManager:()=>ax,EventBus:()=>kh,FindState:()=>Cs,GenericL10n:()=>Mo,LinkTarget:()=>ha,PDFFindController:()=>ix,PDFHistory:()=>vx,PDFLinkService:()=>Th,PDFPageView:()=>Oh,PDFScriptingManager:()=>Sx,PDFSinglePageViewer:()=>Ix,PDFViewer:()=>Lh,ProgressBar:()=>rx,RenderingStates:()=>Rt,ScrollMode:()=>rt,SimpleLinkService:()=>Cc,SpreadMode:()=>bn,StructTreeLayerBuilder:()=>Ph,TextLayerBuilder:()=>Rh,XfaLayerBuilder:()=>Nh,parseQueryString:()=>Bh});var S8="auto",HS=1,cS=1.1,T8=.1,D8=10,X_=0,I8=1.25,uS=40,dS=5,Rt={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Do={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};var di={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},rt={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},bn={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function $S(n,e,t=!1){let r=n.offsetParent;if(!r){console.error("offsetParent is not set -- cannot scroll");return}let i=n.offsetTop+n.clientTop,s=n.offsetLeft+n.clientLeft;for(;r.clientHeight===r.scrollHeight&&r.clientWidth===r.scrollWidth||t&&(r.classList.contains("markedContent")||getComputedStyle(r).overflow==="hidden");)if(i+=r.offsetTop,s+=r.offsetLeft,r=r.offsetParent,!r)return;e&&(e.top!==void 0&&(i+=e.top),e.left!==void 0&&(s+=e.left,r.scrollLeft=s)),r.scrollTop=i}function k8(n,e,t=void 0){let r=function(a){s||(s=window.requestAnimationFrame(function(){s=null;let l=n.scrollLeft,u=i.lastX;l!==u&&(i.right=l>u),i.lastX=l;let c=n.scrollTop,d=i.lastY;c!==d&&(i.down=c>d),i.lastY=c,e(i)}))},i={right:!0,down:!0,lastX:n.scrollLeft,lastY:n.scrollTop,_eventHandler:r},s=null;return n.addEventListener("scroll",r,{useCapture:!0,signal:t}),t?.addEventListener("abort",()=>window.cancelAnimationFrame(s),{once:!0}),i}function Bh(n){let e=new Map;for(let[t,r]of new URLSearchParams(n))e.set(t.toLowerCase(),r);return e}var fS=/[\x00-\x1F]/g;function Ec(n,e=!1){return fS.test(n)?e?n.replaceAll(fS,t=>t==="\0"?"":" "):n.replaceAll("\0",""):n}function Ac(n,e,t=0){let r=t,i=n.length-1;if(i<0||!e(n[i]))return n.length;if(e(n[r]))return r;for(;r<i;){let s=r+i>>1,a=n[s];e(a)?i=s:r=s+1}return r}function hS(n){if(Math.floor(n)===n)return[n,1];let e=1/n,t=8;if(e>t)return[1,t];if(Math.floor(e)===e)return[1,e];let r=n>1?e:n,i=0,s=1,a=1,o=1;for(;;){let u=i+a,c=s+o;if(c>t)break;r<=u/c?(a=u,o=c):(i=u,s=c)}let l;return r-i/s<a/o-r?l=r===n?[i,s]:[s,i]:l=r===n?[a,o]:[o,a],l}function yh(n,e){return n-n%e}function M8(n,e,t){if(n<2)return n;let r=e[n].div,i=r.offsetTop+r.clientTop;i>=t&&(r=e[n-1].div,i=r.offsetTop+r.clientTop);for(let s=n-2;s>=0&&(r=e[s].div,!(r.offsetTop+r.clientTop+r.clientHeight<=i));--s)n=s;return n}function F8({scrollEl:n,views:e,sortByVisibility:t=!1,horizontal:r=!1,rtl:i=!1}){let s=n.scrollTop,a=s+n.clientHeight,o=n.scrollLeft,l=o+n.clientWidth;function u(x){let _=x.div;return _.offsetTop+_.clientTop+_.clientHeight>s}function c(x){let _=x.div,b=_.offsetLeft+_.clientLeft,D=b+_.clientWidth;return i?b<l:D>o}let d=[],f=new Set,h=e.length,p=Ac(e,r?c:u);p>0&&p<h&&!r&&(p=M8(p,e,s));let g=r?l:-1;for(let x=p;x<h;x++){let _=e[x],b=_.div,D=b.offsetLeft+b.clientLeft,A=b.offsetTop+b.clientTop,w=b.clientWidth,T=b.clientHeight,E=D+w,P=A+T;if(g===-1)P>=a&&(g=P);else if((r?D:A)>g)break;if(P<=s||A>=a||E<=o||D>=l)continue;let N=Math.max(0,s-A)+Math.max(0,P-a),O=Math.max(0,o-D)+Math.max(0,E-l),Y=(T-N)/T,se=(w-O)/w,ie=Y*se*100|0;d.push({id:_.id,x:D,y:A,view:_,percent:ie,widthPercent:se*100|0}),f.add(_.id)}let m=d[0],v=d.at(-1);return t&&d.sort(function(x,_){let b=x.percent-_.percent;return Math.abs(b)>.001?-b:x.id-_.id}),{first:m,last:v,views:d,ids:f}}function WS(n){return Number.isInteger(n)&&n%90===0}function P8(n){return Number.isInteger(n)&&Object.values(rt).includes(n)&&n!==rt.UNKNOWN}function R8(n){return Number.isInteger(n)&&Object.values(bn).includes(n)&&n!==bn.UNKNOWN}function pS(n){return n.width<=n.height}var dee=new Promise(function(n){window.requestAnimationFrame(n)}),N8=document.documentElement.style;function O8(n,e,t){return Math.min(Math.max(n,e),t)}var rx=class{#e=null;#t=null;#n=0;#r=null;#i=!0;constructor(e){this.#e=e.classList,this.#r=e.style}get percent(){return this.#n}set percent(e){if(this.#n=O8(e,0,100),isNaN(e)){this.#e.add("indeterminate");return}this.#e.remove("indeterminate"),this.#r.setProperty("--progressBar-percent",`${this.#n}%`)}setWidth(e){if(!e)return;let r=e.parentNode.offsetWidth-e.offsetWidth;r>0&&this.#r.setProperty("--progressBar-end-offset",`${r}px`)}setDisableAutoFetch(e=5e3){this.#n===100||isNaN(this.#n)||(this.#t&&clearTimeout(this.#t),this.show(),this.#t=setTimeout(()=>{this.#t=null,this.hide()},e))}hide(){this.#i&&(this.#i=!1,this.#e.add("hidden"))}show(){this.#i||(this.#i=!0,this.#e.remove("hidden"))}};function L8(n){let e=rt.VERTICAL,t=bn.NONE;switch(n){case"SinglePage":e=rt.PAGE;break;case"OneColumn":break;case"TwoPageLeft":e=rt.PAGE;case"TwoColumnLeft":t=bn.ODD;break;case"TwoPageRight":e=rt.PAGE;case"TwoColumnRight":t=bn.EVEN;break}return{scrollMode:e,spreadMode:t}}var wh=function(){let n=document.createElement("div");return n.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",n.style.width==="calc(1320px)"?Math.fround:e=>e}(),Br={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function B8(n){return n<11904}function V8(n){return(n&65408)===0}function j8(n){return n>=97&&n<=122||n>=65&&n<=90}function U8(n){return n>=48&&n<=57}function H8(n){return n===32||n===9||n===13||n===10}function $8(n){return n>=13312&&n<=40959||n>=63744&&n<=64255}function W8(n){return n>=12448&&n<=12543}function z8(n){return n>=12352&&n<=12447}function G8(n){return n>=65376&&n<=65439}function q8(n){return(n&65408)===3584}function bh(n){return B8(n)?V8(n)?H8(n)?Br.SPACE:j8(n)||U8(n)||n===95?Br.ALPHA_LETTER:Br.PUNCT:q8(n)?Br.THAI_LETTER:n===160?Br.SPACE:Br.ALPHA_LETTER:$8(n)?Br.HAN_LETTER:W8(n)?Br.KATAKANA_LETTER:z8(n)?Br.HIRAGANA_LETTER:G8(n)?Br.HALFWIDTH_KATAKANA_LETTER:Br.ALPHA_LETTER}var gS;function X8(){return gS||="\xA0\xA8\xAA\xAF\xB2-\xB5\xB8-\xBA\xBC-\xBE\u0132-\u0133\u013F-\u0140\u0149\u017F\u01C4-\u01CC\u01F1-\u01F3\u02B0-\u02B8\u02D8-\u02DD\u02E0-\u02E4\u0374\u037A\u037E\u0384-\u0385\u0387\u03D0-\u03D6\u03F0-\u03F2\u03F4-\u03F5\u03F9\u0587\u0675-\u0678\u0958-\u095F\u09DC-\u09DD\u09DF\u0A33\u0A36\u0A59-\u0A5B\u0A5E\u0B5C-\u0B5D\u0E33\u0EB3\u0EDC-\u0EDD\u0F0C\u0F43\u0F4D\u0F52\u0F57\u0F5C\u0F69\u10FC\u1D2C-\u1D2E\u1D30-\u1D3A\u1D3C-\u1D4D\u1D4F-\u1D6A\u1D78\u1D9B-\u1DBF\u1E9A-\u1E9B\u1F71\u1F73\u1F75\u1F77\u1F79\u1F7B\u1F7D\u1FBB\u1FBD-\u1FC1\u1FC9\u1FCB\u1FCD-\u1FCF\u1FD3\u1FDB\u1FDD-\u1FDF\u1FE3\u1FEB\u1FED-\u1FEF\u1FF9\u1FFB\u1FFD-\u1FFE\u2000-\u200A\u2011\u2017\u2024-\u2026\u202F\u2033-\u2034\u2036-\u2037\u203C\u203E\u2047-\u2049\u2057\u205F\u2070-\u2071\u2074-\u208E\u2090-\u209C\u20A8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211D\u2120-\u2122\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213B-\u2140\u2145-\u2149\u2150-\u217F\u2189\u222C-\u222D\u222F-\u2230\u2329-\u232A\u2460-\u24EA\u2A0C\u2A74-\u2A76\u2ADC\u2C7C-\u2C7D\u2D6F\u2E9F\u2EF3\u2F00-\u2FD5\u3000\u3036\u3038-\u303A\u309B-\u309C\u309F\u30FF\u3131-\u318E\u3192-\u319F\u3200-\u321E\u3220-\u3247\u3250-\u327E\u3280-\u33FF\uA69C-\uA69D\uA770\uA7F2-\uA7F4\uA7F8-\uA7F9\uAB5C-\uAB5F\uAB69\uF900-\uFA0D\uFA10\uFA12\uFA15-\uFA1E\uFA20\uFA22\uFA25-\uFA26\uFA2A-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE10-\uFE19\uFE30-\uFE44\uFE47-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFE70-\uFE72\uFE74\uFE76-\uFEFC\uFF01-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\uFFE0-\uFFE6",gS}var Cs={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},Y8=250,K8=-50,Q8=-400,mS={"\u2010":"-","\u2018":"'","\u2019":"'","\u201A":"'","\u201B":"'","\u201C":'"',"\u201D":'"',"\u201E":'"',"\u201F":'"',"\xBC":"1/4","\xBD":"1/2","\xBE":"3/4"},vS=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),_S,Z8=new RegExp("\\p{M}+","gu"),J8=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),eV=new RegExp("([^\\p{M}])\\p{M}*$","u"),tV=new RegExp("^\\p{M}*([^\\p{M}])","u"),nV=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,xS=new Map,rV="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",yS=new Map,Y_=null,K_=null;function Q_(n){let e=[],t;for(;(t=nV.exec(n))!==null;){let{index:h}=t;for(let p of t[0]){let g=xS.get(p);g||(g=p.normalize("NFD").length,xS.set(p,g)),e.push([g,h++])}}let r;if(e.length===0&&Y_)r=Y_;else if(e.length>0&&K_)r=K_;else{let h=Object.keys(mS).join(""),p=X8(),x=`([${h}])|([${p}])|((?:\u3099|\u309A)\\n)|(\\p{M}+(?:-\\n)?)|(\\p{Ll}-\\n\\p{Lu})|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30FF])\\n)|(\\n)`;e.length===0?r=Y_=new RegExp(x+"|(\\u0000)","gum"):r=K_=new RegExp(x+`|(${rV})`,"gum")}let i=[];for(;(t=Z8.exec(n))!==null;)i.push([t[0].length,t.index]);let s=n.normalize("NFD"),a=[[0,0]],o=0,l=0,u=0,c=0,d=0,f=!1;return s=s.replace(r,(h,p,g,m,v,x,_,b,D,A,w)=>{if(w-=c,p){let T=mS[p],E=T.length;for(let P=1;P<E;P++)a.push([w-u+P,u-P]);return u-=E-1,T}if(g){let T=yS.get(g);T||(T=g.normalize("NFKC"),yS.set(g,T));let E=T.length;for(let P=1;P<E;P++)a.push([w-u+P,u-P]);return u-=E-1,T}if(m)return f=!0,w+d===i[o]?.[1]?++o:(a.push([w-1-u+1,u-1]),u-=1,c+=1),a.push([w-u+1,u]),c+=1,d+=1,m.charAt(0);if(v){let T=v.endsWith(`
`),E=T?v.length-2:v.length;f=!0;let P=E;w+d===i[o]?.[1]&&(P-=i[o][0],++o);for(let N=1;N<=P;N++)a.push([w-1-u+N,u-N]);return u-=P,c+=P,T?(w+=E-1,a.push([w-u+1,1+u]),u+=1,c+=1,d+=1,v.slice(0,E)):v}if(x)return a.push([w-u+3,1+u]),u+=1,c+=1,d+=1,x.replace(`
`,"");if(_){let T=_.length-2;return a.push([w-u+T,1+u]),u+=1,c+=1,d+=1,_.slice(0,-2)}if(b){let T=b.length-1;return a.push([w-u+T,u]),c+=1,d+=1,b.slice(0,-1)}if(D)return a.push([w-u+1,u-1]),u-=1,c+=1,d+=1," ";if(w+d===e[l]?.[1]){let T=e[l][0]-1;++l;for(let E=1;E<=T;E++)a.push([w-(u-E),u-E]);u-=T,c+=T}return A}),a.push([s.length,u]),[s,a,f]}function iV(n,e,t){if(!n)return[e,t];let r=e,i=e+t-1,s=Ac(n,c=>c[0]>=r);n[s][0]>r&&--s;let a=Ac(n,c=>c[0]>=i,s);n[a][0]>i&&--a;let o=r+n[s][1],u=i+n[a][1]+1-o;return[o,u]}var ix=class{#e=null;#t=!0;#n=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:r=!0}){this._linkService=e,this._eventBus=t,this.#t=r,this.onIsPageVisible=null,this.#i(),t._on("find",this.#r.bind(this)),t._on("findbarclose",this.#_.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#e}setDocument(e){this._pdfDocument&&this.#i(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#r(e){if(!e)return;let t=this._pdfDocument,{type:r}=e;(this.#e===null||this.#l(e))&&(this._dirtyMatch=!0),this.#e=e,r!=="highlightallchange"&&this.#w(Cs.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#d();let i=!this._highlightMatches,s=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),r?this._dirtyMatch?this.#p():r==="again"?(this.#p(),i&&this.#e.highlightAll&&this.#f()):r==="highlightallchange"?(s?this.#p():this._highlightMatches=!0,this.#f()):this.#p():this._findTimeout=setTimeout(()=>{this.#p(),this._findTimeout=null},Y8)})}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:r=-1,matchIndex:i=-1}){if(!this._scrollMatches||!e)return;if(i===-1||i!==this._selected.matchIdx)return;if(r===-1||r!==this._selected.pageIdx)return;this._scrollMatches=!1;let s={top:K8,left:t+Q8};$S(e,s,!0)}#i(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#n=0,this.#e=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#s(){let{query:e}=this.#e;return typeof e=="string"?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=Q_(e)),this._normalizedQuery):(e||[]).filter(t=>!!t).map(t=>Q_(t)[0])}#l(e){let t=e.query,r=this.#e.query,i=typeof t;if(i!==typeof r)return!0;if(i==="string"){if(t!==r)return!0}else if(JSON.stringify(t)!==JSON.stringify(r))return!0;switch(e.type){case"again":let a=this._selected.pageIdx+1,o=this._linkService;return a>=1&&a<=o.pagesCount&&a!==o.page&&!(this.onIsPageVisible?.(a)??!0);case"highlightallchange":return!1}return!0}#c(e,t,r){let i=e.slice(0,t).match(eV);if(i){let s=e.charCodeAt(t),a=i[1].charCodeAt(0);if(bh(s)===bh(a))return!1}if(i=e.slice(t+r).match(tV),i){let s=e.charCodeAt(t+r-1),a=i[1].charCodeAt(0);if(bh(s)===bh(a))return!1}return!0}#u(e,t){let{matchDiacritics:r}=this.#e,i=!1;e=e.replaceAll(J8,(a,o,l,u,c,d)=>o?`[ ]*\\${o}[ ]*`:l?`[ ]*${l}[ ]*`:u?"[ ]+":r?c||d:c?vS.has(c.charCodeAt(0))?c:"":t?(i=!0,`${d}\\p{M}*`):d);let s="[ ]*";return e.endsWith(s)&&(e=e.slice(0,e.length-s.length)),r&&t&&(_S||=String.fromCharCode(...vS),i=!0,e=`${e}(?=[${_S}]|[^\\p{M}]|$)`),[i,e]}#o(e){let t=this.#s;if(t.length===0)return;let r=this._pageContents[e],i=this.match(t,r,e),s=this._pageMatches[e]=[],a=this._pageMatchesLength[e]=[],o=this._pageDiffs[e];i?.forEach(({index:u,length:c})=>{let[d,f]=iV(o,u,c);f&&(s.push(d),a.push(f))}),this.#e.highlightAll&&this.#a(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#g());let l=s.length;this._matchesCountTotal+=l,this.#t?l>0&&this.#E():++this.#n===this._linkService.pagesCount&&this.#E()}match(e,t,r){let i=this._hasDiacritics[r],s=!1;if(typeof e=="string"?[s,e]=this.#u(e,i):e=e.sort().reverse().map(d=>{let[f,h]=this.#u(d,i);return s||=f,`(${h})`}).join("|"),!e)return;let{caseSensitive:a,entireWord:o}=this.#e,l=`g${s?"u":""}${a?"":"i"}`;e=new RegExp(e,l);let u=[],c;for(;(c=e.exec(t))!==null;)o&&!this.#c(t,c.index,c[0].length)||u.push({index:c.index,length:c[0].length});return u}#d(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve(),t={disableNormalization:!0};for(let r=0,i=this._linkService.pagesCount;r<i;r++){let{promise:s,resolve:a}=Promise.withResolvers();this._extractTextPromises[r]=s,e=e.then(()=>this._pdfDocument.getPage(r+1).then(o=>o.getTextContent(t)).then(o=>{let l=[];for(let u of o.items)l.push(u.str),u.hasEOL&&l.push(`
`);[this._pageContents[r],this._pageDiffs[r],this._hasDiacritics[r]]=Q_(l.join("")),a()},o=>{console.error(`Unable to get text content for page ${r+1}`,o),this._pageContents[r]="",this._pageDiffs[r]=null,this._hasDiacritics[r]=!1,a()}))}}#a(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#f(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#p(){let e=this.#e.findPrevious,t=this._linkService.page-1,r=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#n=0,this._matchesCountTotal=0,this.#f();for(let a=0;a<r;a++)this._pendingFindMatches.has(a)||(this._pendingFindMatches.add(a),this._extractTextPromises[a].then(()=>{this._pendingFindMatches.delete(a),this.#o(a)}))}if(this.#s.length===0){this.#w(Cs.FOUND);return}if(this._resumePageIdx)return;let s=this._offset;if(this._pagesToSearch=r,s.matchIdx!==null){let a=this._pageMatches[s.pageIdx].length;if(!e&&s.matchIdx+1<a||e&&s.matchIdx>0){s.matchIdx=e?s.matchIdx-1:s.matchIdx+1,this.#m(!0);return}this.#v(e)}this.#g()}#h(e){let t=this._offset,r=e.length,i=this.#e.findPrevious;return r?(t.matchIdx=i?r-1:0,this.#m(!0),!0):(this.#v(i),t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0)?(this.#m(!1),!0):!1)}#g(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let e=null;do{let t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#h(e))}#v(e){let t=this._offset,r=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=r||t.pageIdx<0)&&(t.pageIdx=e?r-1:0,t.wrapped=!0)}#m(e=!1){let t=Cs.NOT_FOUND,r=this._offset.wrapped;if(this._offset.wrapped=!1,e){let i=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=r?Cs.WRAPPED:Cs.FOUND,i!==-1&&i!==this._selected.pageIdx&&this.#a(i)}this.#w(t,this.#e.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#a(this._selected.pageIdx))}#_(e){let t=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#w(Cs.FOUND),this._highlightMatches=!1,this.#f())})}#y(){let{pageIdx:e,matchIdx:t}=this._selected,r=0,i=this._matchesCountTotal;if(t!==-1){for(let s=0;s<e;s++)r+=this._pageMatches[s]?.length||0;r+=t+1}return(r<1||r>i)&&(r=i=0),{current:r,total:i}}#E(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#y()})}#w(e,t=!1){!this.#t&&(this.#n!==this._linkService.pagesCount||e===Cs.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,entireWord:this.#e?.entireWord??null,matchesCount:this.#y(),rawQuery:this.#e?.query??null})}},sV="noopener noreferrer nofollow",ha={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},Th=class n{externalLinkEnabled=!0;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:r=null,ignoreDestinationZoom:i=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=r,this._ignoreDestinationZoom=i,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(e){this.pdfDocument&&(this.pdfViewer.currentPageNumber=e)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(e){this.pdfDocument&&(this.pdfViewer.pagesRotation=e)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}goToDestination(e){return ee(this,null,function*(){if(!this.pdfDocument)return;let t,r,i;if(typeof e=="string"?(t=e,r=yield this.pdfDocument.getDestination(e)):(t=null,r=yield e),!Array.isArray(r)){console.error(`goToDestination: "${r}" is not a valid destination array, for dest="${e}".`);return}let[s]=r;if(s&&typeof s=="object"){if(i=this.pdfDocument.cachedPageNumber(s),!i)try{i=(yield this.pdfDocument.getPageIndex(s))+1}catch{console.error(`goToDestination: "${s}" is not a valid page reference, for dest="${e}".`);return}}else Number.isInteger(s)&&(i=s+1);if(!i||i<1||i>this.pagesCount){console.error(`goToDestination: "${i}" is not a valid page number, for dest="${e}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:r,pageNumber:i})),this.pdfViewer.scrollPageIntoView({pageNumber:i,destArray:r,ignoreDestinationZoom:this._ignoreDestinationZoom})})}goToPage(e){if(!this.pdfDocument)return;let t=typeof e=="string"&&this.pdfViewer.pageLabelToPageNumber(e)||e|0;if(!(Number.isInteger(t)&&t>0&&t<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})}addLinkAttributes(e,t,r=!1){if(!t||typeof t!="string")throw new Error('A valid "url" parameter must provided.');let i=r?ha.BLANK:this.externalLinkTarget,s=this.externalLinkRel;this.externalLinkEnabled?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let a="";switch(i){case ha.NONE:break;case ha.SELF:a="_self";break;case ha.BLANK:a="_blank";break;case ha.PARENT:a="_parent";break;case ha.TOP:a="_top";break}e.target=a,e.rel=typeof s=="string"?s:sV}getDestinationHash(e){if(typeof e=="string"){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){let t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,r;if(e.includes("=")){let i=Bh(e);if(i.has("search")){let s=i.get("search").replaceAll('"',""),a=i.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:a?s:s.match(/\S+/g)})}if(i.has("page")&&(t=i.get("page")|0||1),i.has("zoom")){let s=i.get("zoom").split(","),a=s[0],o=parseFloat(a);a.includes("Fit")?a==="Fit"||a==="FitB"?r=[null,{name:a}]:a==="FitH"||a==="FitBH"||a==="FitV"||a==="FitBV"?r=[null,{name:a},s.length>1?s[1]|0:null]:a==="FitR"?s.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):r=[null,{name:a},s[1]|0,s[2]|0,s[3]|0,s[4]|0]:console.error(`PDFLinkService.setHash: "${a}" is not a valid zoom value.`):r=[null,{name:"XYZ"},s.length>1?s[1]|0:null,s.length>2?s[2]|0:null,o?o/100:a]}r?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:r,allowNegativeOffset:!0}):t&&(this.page=t),i.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:i.get("pagemode")}),i.has("nameddest")&&this.goToDestination(i.get("nameddest"));return}r=unescape(e);try{r=JSON.parse(r),Array.isArray(r)||(r=r.toString())}catch{}if(typeof r=="string"||n.#e(r)){this.goToDestination(r);return}console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}executeNamedAction(e){if(this.pdfDocument){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break;default:break}this.eventBus.dispatch("namedaction",{source:this,action:e})}}executeSetOCGState(e){return ee(this,null,function*(){if(!this.pdfDocument)return;let t=this.pdfDocument,r=yield this.pdfViewer.optionalContentConfigPromise;t===this.pdfDocument&&(r.setOCGState(e),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(r))})}static#e(e){if(!Array.isArray(e)||e.length<2)return!1;let[t,r,...i]=e;if(!(typeof t=="object"&&Number.isInteger(t?.num)&&Number.isInteger(t?.gen))&&!Number.isInteger(t)||!(typeof r=="object"&&typeof r?.name=="string"))return!1;let s=i.length,a=!0;switch(r.name){case"XYZ":if(s<2||s>3)return!1;break;case"Fit":case"FitB":return s===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(s>1)return!1;break;case"FitR":if(s!==4)return!1;a=!1;break;default:return!1}for(let o of i)if(!(typeof o=="number"||a&&o===null))return!1;return!0}},Cc=class extends Th{setDocument(e,t=null){}},{AbortException:aV,AnnotationEditorLayer:oV,AnnotationEditorParamsType:fee,AnnotationEditorType:lr,AnnotationEditorUIManager:lV,AnnotationLayer:cV,AnnotationMode:qi,build:hee,ColorPicker:pee,createValidAbsoluteUrl:uV,DOMSVGFactory:gee,DrawLayer:dV,FeatureTest:mee,fetchData:wS,getDocument:vee,getFilenameFromUrl:_ee,getPdfFilenameFromUrl:fV,getXfaPageViewport:xee,GlobalWorkerOptions:yee,ImageKind:wee,InvalidPDFException:bee,isDataScheme:Eee,isPdfFile:hV,MissingPDFException:Aee,noContextMenu:Cee,normalizeUnicode:pV,OPS:See,OutputScale:gV,PasswordResponses:Tee,PDFDataRangeTransport:Dee,PDFDateString:Iee,PDFWorker:kee,PermissionFlag:Eh,PixelsPerInch:Gi,RenderingCancelledException:sx,setLayerDimensions:mV,shadow:Dh,TextLayer:vV,UnexpectedResponseException:Mee,Util:Fee,VerbosityLevel:Pee,version:bS,XfaLayer:Z_}=globalThis.pdfjsLib,Ih=class{#e=null;#t=null;constructor({pdfPage:e,linkService:t,downloadManager:r,annotationStorage:i=null,imageResourcesPath:s="",renderForms:a=!0,enableScripting:o=!1,hasJSActionsPromise:l=null,fieldObjectsPromise:u=null,annotationCanvasMap:c=null,accessibilityManager:d=null,annotationEditorUIManager:f=null,onAppend:h=null}){this.pdfPage=e,this.linkService=t,this.downloadManager=r,this.imageResourcesPath=s,this.renderForms=a,this.annotationStorage=i,this.enableScripting=o,this._hasJSActionsPromise=l||Promise.resolve(!1),this._fieldObjectsPromise=u||Promise.resolve(null),this._annotationCanvasMap=c,this._accessibilityManager=d,this._annotationEditorUIManager=f,this.#e=h,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=t.eventBus}render(e,t,r="display"){return ee(this,null,function*(){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:e.clone({dontFlip:!0})});return}let[i,s,a]=yield Promise.all([this.pdfPage.getAnnotations({intent:r}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;let o=this.div=document.createElement("div");if(o.className="annotationLayer",this.#e?.(o),i.length===0){this.hide();return}this.annotationLayer=new cV({div:o,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:e.clone({dontFlip:!0}),structTreeLayer:t?.structTreeLayer||null}),yield this.annotationLayer.render({annotations:i,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:s,fieldObjects:a}),this.linkService.isInPresentationMode&&this.#n(Do.FULLSCREEN),this.#t||(this.#t=new AbortController,this._eventBus?._on("presentationmodechanged",l=>{this.#n(l.state)},{signal:this.#t.signal}))})}cancel(){this._cancelled=!0,this.#t?.abort(),this.#t=null}hide(){this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}#n(e){if(!this.div)return;let t=!1;switch(e){case Do.FULLSCREEN:t=!0;break;case Do.NORMAL:break;default:return}for(let r of this.div.childNodes)r.hasAttribute("data-internal-link")||(r.inert=t)}};function ES(n,e){let t=document.createElement("a");if(!t.click)throw new Error('DownloadManager: "a.click()" is not supported.');t.href=n,t.target="_parent","download"in t&&(t.download=e),(document.body||document.documentElement).append(t),t.click(),t.remove()}var ax=class{#e=new WeakMap;downloadData(e,t,r){let i=URL.createObjectURL(new Blob([e],{type:r}));ES(i,t)}openOrDownloadData(e,t,r=null){let s=hV(t)?"application/pdf":"";return this.downloadData(e,t,s),!1}download(e,t,r){let i;if(e)i=URL.createObjectURL(new Blob([e],{type:"application/pdf"}));else{if(!uV(t,"http://example.com")){console.error(`download - not a valid URL: ${t}`);return}i=t+"#pdfjs.action=download"}ES(i,r)}},AS={EVENT:"event",TIMEOUT:"timeout"};function _V(r){return ee(this,arguments,function*({target:n,name:e,delay:t=0}){if(typeof n!="object"||!(e&&typeof e=="string")||!(Number.isInteger(t)&&t>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");let{promise:i,resolve:s}=Promise.withResolvers(),a=new AbortController;function o(c){a.abort(),clearTimeout(u),s(c)}let l=n instanceof kh?"_on":"addEventListener";n[l](e,o.bind(null,AS.EVENT),{signal:a.signal});let u=setTimeout(o.bind(null,AS.TIMEOUT),t);return i})}var kh=class{#e=Object.create(null);on(e,t,r=null){this._on(e,t,{external:!0,once:r?.once,signal:r?.signal})}off(e,t,r=null){this._off(e,t)}dispatch(e,t){let r=this.#e[e];if(!r||r.length===0)return;let i;for(let{listener:s,external:a,once:o}of r.slice(0)){if(o&&this._off(e,s),a){(i||=[]).push(s);continue}s(t)}if(i){for(let s of i)s(t);i=null}}_on(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){let{signal:a}=r;if(a.aborted){console.error("Cannot use an `aborted` signal.");return}let o=()=>this._off(e,t);i=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}(this.#e[e]||=[]).push({listener:t,external:r?.external===!0,once:r?.once===!0,rmAbort:i})}_off(e,t,r=null){let i=this.#e[e];if(i)for(let s=0,a=i.length;s<a;s++){let o=i[s];if(o.listener===t){o.rmAbort?.(),i.splice(s,1);return}}}};var Io=class{constructor(e){this.value=e}valueOf(){return this.value}},Nt=class extends Io{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Vr=class extends Io{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),this.value.toString(10)}}},ga=class extends Io{constructor(e,t={}){super(e),this.opts=t}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(t){return e.reportError(t),new Date(this.value).toISOString()}}},CS=100,xV="\u2068",yV="\u2069";function wV(n,e,t){if(t===e||t instanceof Vr&&e instanceof Vr&&t.value===e.value)return!0;if(e instanceof Vr&&typeof t=="string"){let r=n.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(t===r)return!0}return!1}function SS(n,e,t){return e[t]?ko(n,e[t].value):(n.reportError(new RangeError("No default")),new Nt)}function ox(n,e){let t=[],r=Object.create(null);for(let i of e)i.type==="narg"?r[i.name]=Sc(n,i.value):t.push(Sc(n,i));return{positional:t,named:r}}function Sc(n,e){switch(e.type){case"str":return e.value;case"num":return new Vr(e.value,{minimumFractionDigits:e.precision});case"var":return bV(n,e);case"mesg":return EV(n,e);case"term":return AV(n,e);case"func":return CV(n,e);case"select":return SV(n,e);default:return new Nt}}function bV(n,{name:e}){let t;if(n.params)if(Object.prototype.hasOwnProperty.call(n.params,e))t=n.params[e];else return new Nt(`$${e}`);else if(n.args&&Object.prototype.hasOwnProperty.call(n.args,e))t=n.args[e];else return n.reportError(new ReferenceError(`Unknown variable: $${e}`)),new Nt(`$${e}`);if(t instanceof Io)return t;switch(typeof t){case"string":return t;case"number":return new Vr(t);case"object":if(t instanceof Date)return new ga(t.getTime());default:return n.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof t}`)),new Nt(`$${e}`)}}function EV(n,{name:e,attr:t}){let r=n.bundle._messages.get(e);if(!r)return n.reportError(new ReferenceError(`Unknown message: ${e}`)),new Nt(e);if(t){let i=r.attributes[t];return i?ko(n,i):(n.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Nt(`${e}.${t}`))}return r.value?ko(n,r.value):(n.reportError(new ReferenceError(`No value: ${e}`)),new Nt(e))}function AV(n,{name:e,attr:t,args:r}){let i=`-${e}`,s=n.bundle._terms.get(i);if(!s)return n.reportError(new ReferenceError(`Unknown term: ${i}`)),new Nt(i);if(t){let o=s.attributes[t];if(o){n.params=ox(n,r).named;let l=ko(n,o);return n.params=null,l}return n.reportError(new ReferenceError(`Unknown attribute: ${t}`)),new Nt(`${i}.${t}`)}n.params=ox(n,r).named;let a=ko(n,s.value);return n.params=null,a}function CV(n,{name:e,args:t}){let r=n.bundle._functions[e];if(!r)return n.reportError(new ReferenceError(`Unknown function: ${e}()`)),new Nt(`${e}()`);if(typeof r!="function")return n.reportError(new TypeError(`Function ${e}() is not callable`)),new Nt(`${e}()`);try{let i=ox(n,t);return r(i.positional,i.named)}catch(i){return n.reportError(i),new Nt(`${e}()`)}}function SV(n,{selector:e,variants:t,star:r}){let i=Sc(n,e);if(i instanceof Nt)return SS(n,t,r);for(let s of t){let a=Sc(n,s.key);if(wV(n,i,a))return ko(n,s.value)}return SS(n,t,r)}function zS(n,e){if(n.dirty.has(e))return n.reportError(new RangeError("Cyclic reference")),new Nt;n.dirty.add(e);let t=[],r=n.bundle._useIsolating&&e.length>1;for(let i of e){if(typeof i=="string"){t.push(n.bundle._transform(i));continue}if(n.placeables++,n.placeables>CS)throw n.dirty.delete(e),new RangeError(`Too many placeables expanded: ${n.placeables}, max allowed is ${CS}`);r&&t.push(xV),t.push(Sc(n,i).toString(n)),r&&t.push(yV)}return n.dirty.delete(e),t.join("")}function ko(n,e){return typeof e=="string"?n.bundle._transform(e):zS(n,e)}var lx=class{constructor(e,t,r){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=t,this.args=r}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,t){let r=this.bundle._intls.get(e);r||(r={},this.bundle._intls.set(e,r));let i=JSON.stringify(t);return r[i]||(r[i]=new e(this.bundle.locales,t)),r[i]}};function Mh(n,e){let t=Object.create(null);for(let[r,i]of Object.entries(n))e.includes(r)&&(t[r]=i.valueOf());return t}var TS=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function TV(n,e){let t=n[0];if(t instanceof Nt)return new Nt(`NUMBER(${t.valueOf()})`);if(t instanceof Vr)return new Vr(t.valueOf(),ce(ce({},t.opts),Mh(e,TS)));if(t instanceof ga)return new Vr(t.valueOf(),ce({},Mh(e,TS)));throw new TypeError("Invalid argument to NUMBER")}var DS=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function DV(n,e){let t=n[0];if(t instanceof Nt)return new Nt(`DATETIME(${t.valueOf()})`);if(t instanceof ga)return new ga(t.valueOf(),ce(ce({},t.opts),Mh(e,DS)));if(t instanceof Vr)return new ga(t.valueOf(),ce({},Mh(e,DS)));throw new TypeError("Invalid argument to DATETIME")}var IS=new Map;function IV(n){let e=Array.isArray(n)?n.join(" "):n,t=IS.get(e);return t===void 0&&(t=new Map,IS.set(e,t)),t}var cx=class{constructor(e,{functions:t,useIsolating:r=!0,transform:i=s=>s}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions=ce({NUMBER:TV,DATETIME:DV},t),this._useIsolating=r,this._transform=i,this._intls=IV(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:t=!1}={}){let r=[];for(let i=0;i<e.body.length;i++){let s=e.body[i];if(s.id.startsWith("-")){if(t===!1&&this._terms.has(s.id)){r.push(new Error(`Attempt to override an existing term: "${s.id}"`));continue}this._terms.set(s.id,s)}else{if(t===!1&&this._messages.has(s.id)){r.push(new Error(`Attempt to override an existing message: "${s.id}"`));continue}this._messages.set(s.id,s)}}return r}formatPattern(e,t=null,r=null){if(typeof e=="string")return this._transform(e);let i=new lx(this,r,t);try{return zS(i,e).toString(i)}catch(s){if(i.errors&&s instanceof Error)return i.errors.push(s),new Nt().toString(i);throw s}}},J_=/^(-?[a-zA-Z][\w-]*) *= */gm,kS=/\.([a-zA-Z][\w-]*) *= */y,kV=/\*?\[/y,ex=/(-?[0-9]+(?:\.([0-9]+))?)/y,MV=/([a-zA-Z][\w-]*)/y,MS=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,FV=/^[A-Z][A-Z0-9_-]*$/,Ah=/([^{}\n\r]+)/y,PV=/([^\\"\n\r]*)/y,FS=/\\([\\"])/y,PS=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,RV=/^\n+/,RS=/ +$/,NV=/ *\r?\n/g,OV=/( *)$/,LV=/{\s*/y,NS=/\s*}/y,BV=/\[\s*/y,VV=/\s*] */y,jV=/\s*\(\s*/y,UV=/\s*->\s*/y,HV=/\s*:\s*/y,$V=/\s*,?\s*/y,WV=/\s+/y,ux=class{constructor(e){this.body=[],J_.lastIndex=0;let t=0;for(;;){let E=J_.exec(e);if(E===null)break;t=J_.lastIndex;try{this.body.push(l(E[1]))}catch(P){if(P instanceof SyntaxError)continue;throw P}}function r(E){return E.lastIndex=t,E.test(e)}function i(E,P){if(e[t]===E)return t++,!0;if(P)throw new P(`Expected ${E}`);return!1}function s(E,P){if(r(E))return t=E.lastIndex,!0;if(P)throw new P(`Expected ${E.toString()}`);return!1}function a(E){E.lastIndex=t;let P=E.exec(e);if(P===null)throw new SyntaxError(`Expected ${E.toString()}`);return t=E.lastIndex,P}function o(E){return a(E)[1]}function l(E){let P=c(),N=u();if(P===null&&Object.keys(N).length===0)throw new SyntaxError("Expected message value or attributes");return{id:E,value:P,attributes:N}}function u(){let E=Object.create(null);for(;r(kS);){let P=o(kS),N=c();if(N===null)throw new SyntaxError("Expected attribute value");E[P]=N}return E}function c(){let E;if(r(Ah)&&(E=o(Ah)),e[t]==="{"||e[t]==="}")return d(E?[E]:[],1/0);let P=A();return P?E?d([E,P],P.length):(P.value=w(P.value,RV),d([P],P.length)):E?w(E,RS):null}function d(E=[],P){for(;;){if(r(Ah)){E.push(o(Ah));continue}if(e[t]==="{"){E.push(f());continue}if(e[t]==="}")throw new SyntaxError("Unbalanced closing brace");let se=A();if(se){E.push(se),P=Math.min(P,se.length);continue}break}let N=E.length-1,O=E[N];typeof O=="string"&&(E[N]=w(O,RS));let Y=[];for(let se of E)se instanceof Fh&&(se=se.value.slice(0,se.value.length-P)),se&&Y.push(se);return Y}function f(){s(LV,SyntaxError);let E=h();if(s(NS))return E;if(s(UV)){let P=m();return s(NS,SyntaxError),ce({type:"select",selector:E},P)}throw new SyntaxError("Unclosed placeable")}function h(){if(e[t]==="{")return f();if(r(MS)){let[,E,P,N=null]=a(MS);if(E==="$")return{type:"var",name:P};if(s(jV)){let O=p();if(E==="-")return{type:"term",name:P,attr:N,args:O};if(FV.test(P))return{type:"func",name:P,args:O};throw new SyntaxError("Function names must be all upper-case")}return E==="-"?{type:"term",name:P,attr:N,args:[]}:{type:"mesg",name:P,attr:N}}return x()}function p(){let E=[];for(;;){switch(e[t]){case")":return t++,E;case void 0:throw new SyntaxError("Unclosed argument list")}E.push(g()),s($V)}}function g(){let E=h();return E.type!=="mesg"?E:s(HV)?{type:"narg",name:E.name,value:x()}:E}function m(){let E=[],P=0,N;for(;r(kV);){i("*")&&(N=P);let O=v(),Y=c();if(Y===null)throw new SyntaxError("Expected variant value");E[P++]={key:O,value:Y}}if(P===0)return null;if(N===void 0)throw new SyntaxError("Expected default variant");return{variants:E,star:N}}function v(){s(BV,SyntaxError);let E;return r(ex)?E=_():E={type:"str",value:o(MV)},s(VV,SyntaxError),E}function x(){if(r(ex))return _();if(e[t]==='"')return b();throw new SyntaxError("Invalid expression")}function _(){let[,E,P=""]=a(ex),N=P.length;return{type:"num",value:parseFloat(E),precision:N}}function b(){i('"',SyntaxError);let E="";for(;;){if(E+=o(PV),e[t]==="\\"){E+=D();continue}if(i('"'))return{type:"str",value:E};throw new SyntaxError("Unclosed string literal")}}function D(){if(r(FS))return o(FS);if(r(PS)){let[,E,P]=a(PS),N=parseInt(E||P,16);return N<=55295||57344<=N?String.fromCodePoint(N):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function A(){let E=t;switch(s(WV),e[t]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return T(e.slice(E,t))}return e[t-1]===" "?T(e.slice(E,t)):!1}function w(E,P){return E.replace(P,"")}function T(E){let P=E.replace(NV,`
`),N=OV.exec(E)[1].length;return new Fh(P,N)}}},Fh=class{constructor(e,t){this.value=e,this.length=t}},zV=/<|&#?\w+;/,GV={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},qV={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function XV(n,e){let{value:t}=e;if(typeof t=="string")if(n.localName==="title"&&n.namespaceURI==="http://www.w3.org/1999/xhtml")n.textContent=t;else if(!zV.test(t))n.textContent=t;else{let r=n.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");r.innerHTML=t,YV(r.content,n)}GS(e,n)}function YV(n,e){for(let t of n.childNodes)if(t.nodeType!==t.TEXT_NODE){if(t.hasAttribute("data-l10n-name")){let r=QV(e,t);n.replaceChild(r,t);continue}if(JV(t)){let r=ZV(t);n.replaceChild(r,t);continue}console.warn(`An element of forbidden type "${t.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),n.replaceChild(dx(t),t)}e.textContent="",e.appendChild(n)}function KV(n,e){if(!n)return!1;for(let t of n)if(t.name===e)return!0;return!1}function GS(n,e){let t=e.hasAttribute("data-l10n-attrs")?e.getAttribute("data-l10n-attrs").split(",").map(r=>r.trim()):null;for(let r of Array.from(e.attributes))OS(r.name,e,t)&&!KV(n.attributes,r.name)&&e.removeAttribute(r.name);if(n.attributes)for(let r of Array.from(n.attributes))OS(r.name,e,t)&&e.getAttribute(r.name)!==r.value&&e.setAttribute(r.name,r.value)}function QV(n,e){let t=e.getAttribute("data-l10n-name"),r=n.querySelector(`[data-l10n-name="${t}"]`);if(!r)return console.warn(`An element named "${t}" wasn't found in the source.`),dx(e);if(r.localName!==e.localName)return console.warn(`An element named "${t}" was found in the translation but its type ${e.localName} didn't match the element found in the source (${r.localName}).`),dx(e);n.removeChild(r);let i=r.cloneNode(!1);return qS(e,i)}function ZV(n){let e=n.ownerDocument.createElement(n.localName);return qS(n,e)}function dx(n){return n.ownerDocument.createTextNode(n.textContent)}function JV(n){let e=GV[n.namespaceURI];return e&&e.includes(n.localName)}function OS(n,e,t=null){if(t&&t.includes(n))return!0;let r=qV[e.namespaceURI];if(!r)return!1;let i=n.toLowerCase(),s=e.localName;if(r.global.includes(i))return!0;if(!r[s])return!1;if(r[s].includes(i))return!0;if(e.namespaceURI==="http://www.w3.org/1999/xhtml"&&s==="input"&&i==="value"){let a=e.type.toLowerCase();if(a==="submit"||a==="button"||a==="reset")return!0}return!1}function qS(n,e){return e.textContent=n.textContent,GS(n,e),e}var fx=class extends Array{static from(e){return e instanceof this?e:new this(e)}};var hx=class extends fx{constructor(e){if(super(),Symbol.asyncIterator in Object(e))this.iterator=e[Symbol.asyncIterator]();else if(Symbol.iterator in Object(e))this.iterator=e[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){let e=this,t=0;return{next(){return ee(this,null,function*(){return e.length<=t&&e.push(e.iterator.next()),e[t++]})}}}touchNext(e=1){return ee(this,null,function*(){let t=0;for(;t++<e;){let r=this[this.length-1];if(r&&(yield r).done)break;this.push(this.iterator.next())}return this[this.length-1]})}},px=class{constructor(e=[],t){this.resourceIds=e,this.generateBundles=t,this.onChange(!0)}addResourceIds(e,t=!1){return this.resourceIds.push(...e),this.onChange(t),this.resourceIds.length}removeResourceIds(e){return this.resourceIds=this.resourceIds.filter(t=>!e.includes(t)),this.onChange(),this.resourceIds.length}formatWithFallback(e,t){return ee(this,null,function*(){let r=[],i=!1;try{for(var s=q1(this.bundles),a,o,l;a=!(o=yield s.next()).done;a=!1){let u=o.value;i=!0;let c=n6(t,u,e,r);if(c.size===0)break;if(typeof console<"u"){let d=u.locales[0],f=Array.from(c).join(", ");console.warn(`[fluent] Missing translations in ${d}: ${f}`)}}}catch{l=[o]}finally{try{a&&(o=s.return)&&(yield o.call(s))}finally{if(l)throw l[0]}}return!i&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(e)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),r})}formatMessages(e){return this.formatWithFallback(e,t6)}formatValues(e){return this.formatWithFallback(e,e6)}formatValue(e,t){return ee(this,null,function*(){let[r]=yield this.formatValues([{id:e,args:t}]);return r})}handleEvent(){this.onChange()}onChange(e=!1){this.bundles=hx.from(this.generateBundles(this.resourceIds)),e&&this.bundles.touchNext(2)}};function e6(n,e,t,r){return t.value?n.formatPattern(t.value,r,e):null}function t6(n,e,t,r){let i={value:null,attributes:null};t.value&&(i.value=n.formatPattern(t.value,r,e));let s=Object.keys(t.attributes);if(s.length>0){i.attributes=new Array(s.length);for(let[a,o]of s.entries()){let l=n.formatPattern(t.attributes[o],r,e);i.attributes[a]={name:o,value:l}}}return i}function n6(n,e,t,r){let i=[],s=new Set;return t.forEach(({id:a,args:o},l)=>{if(r[l]!==void 0)return;let u=e.getMessage(a);if(u){if(i.length=0,r[l]=n(e,i,u,o),i.length>0&&typeof console<"u"){let c=e.locales[0],d=i.join(", ");console.warn(`[fluent][resolver] errors in ${c}/${a}: ${d}.`)}}else s.add(a)}),s}var pa="data-l10n-id",wc="data-l10n-args",r6=`[${pa}]`,gx=class extends px{constructor(e,t){super(e,t),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[pa,wc]}}onChange(e=!1){super.onChange(e),this.roots&&this.translateRoots()}setAttributes(e,t,r){return e.setAttribute(pa,t),r?e.setAttribute(wc,JSON.stringify(r)):e.removeAttribute(wc),e}getAttributes(e){return{id:e.getAttribute(pa),args:JSON.parse(e.getAttribute(wc)||null)}}connectRoot(e){for(let t of this.roots)if(t===e||t.contains(e)||e.contains(t))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==e.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=e.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(t=>this.translateMutations(t));this.roots.add(e),this.mutationObserver.observe(e,this.observerConfig)}disconnectRoot(e){return this.roots.delete(e),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){let e=Array.from(this.roots);return Promise.all(e.map(t=>this.translateFragment(t)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(let e of this.roots)this.mutationObserver.observe(e,this.observerConfig)}translateMutations(e){for(let t of e)switch(t.type){case"attributes":t.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(t.target);break;case"childList":for(let r of t.addedNodes)if(r.nodeType===r.ELEMENT_NODE)if(r.childElementCount)for(let i of this.getTranslatables(r))this.pendingElements.add(i);else r.hasAttribute(pa)&&this.pendingElements.add(r);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(e){return this.translateElements(this.getTranslatables(e))}translateElements(e){return ee(this,null,function*(){if(!e.length)return;let t=e.map(this.getKeysForElement),r=yield this.formatMessages(t);return this.applyTranslations(e,r)})}applyTranslations(e,t){this.pauseObserving();for(let r=0;r<e.length;r++)t[r]!==void 0&&XV(e[r],t[r]);this.resumeObserving()}getTranslatables(e){let t=Array.from(e.querySelectorAll(r6));return typeof e.hasAttribute=="function"&&e.hasAttribute(pa)&&t.push(e),t}getKeysForElement(e){return{id:e.getAttribute(pa),args:JSON.parse(e.getAttribute(wc)||null)}}},mx=class n{#e;#t;#n;#r;constructor({lang:e,isRTL:t},r=null){this.#n=n.#i(e),this.#r=r,this.#e=t??n.#s(this.#n)?"rtl":"ltr"}_setL10n(e){this.#r=e}getLanguage(){return this.#n}getDirection(){return this.#e}get(e,t=null,r){return ee(this,null,function*(){return Array.isArray(e)?(e=e.map(a=>({id:a})),(yield this.#r.formatMessages(e)).map(a=>a.value)):(yield this.#r.formatMessages([{id:e,args:t}]))[0]?.value||r})}translate(e){return ee(this,null,function*(){(this.#t||=new Set).add(e);try{this.#r.connectRoot(e),yield this.#r.translateRoots()}catch{}})}translateOnce(e){return ee(this,null,function*(){try{yield this.#r.translateElements([e])}catch(t){console.error(`translateOnce: "${t}".`)}})}destroy(){return ee(this,null,function*(){if(this.#t){for(let e of this.#t)this.#r.disconnectRoot(e);this.#t.clear(),this.#t=null}this.#r.pauseObserving()})}pause(){this.#r.pauseObserving()}resume(){this.#r.resumeObserving()}static#i(e){return e=e?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[e]||e}static#s(e){let t=e.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(t)}};function LS(n,e){let t=new ux(e),r=new cx(n),i=r.addResource(t);return i.length&&console.error("L10n errors",i),r}var Mo=class n extends mx{constructor(e){super({lang:e});let t=e?n.#e.bind(n,"en-us",this.getLanguage()):n.#r.bind(n,this.getLanguage());this._setL10n(new gx([],t))}static#e(e,t){return pp(this,null,function*(){let{baseURL:r,paths:i}=yield new ru(this.#n()),s=[t];if(e!==t){let a=t.split("-",1)[0];a!==t&&s.push(a),s.push(e)}for(let a of s){let o=yield new ru(this.#t(a,r,i));o?yield o:a==="en-us"&&(yield this.#i(a))}})}static#t(e,t,r){return ee(this,null,function*(){let i=r[e];if(!i)return null;let s=new URL(i,t),a=yield wS(s,"text");return LS(e,a)})}static#n(){return ee(this,null,function*(){try{let{href:e}=document.querySelector('link[type="application/l10n"]'),t=yield wS(e,"json");return{baseURL:e.replace(/[^/]*$/,"")||"./",paths:t}}catch{}return{baseURL:"./",paths:Object.create(null)}})}static#r(e){return pp(this,null,function*(){yield this.#i(e)})}static#i(e){return ee(this,null,function*(){return LS(e,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties\u2026
pdfjs-document-properties-button-label = Document Properties\u2026
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } \xD7 { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } \xD7 { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing\u2026
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document\u2026
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing\u2026
pdfjs-ink =
    .aria-label = Draw Editor
pdfjs-ink-canvas =
    .aria-label = User-created image
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, \u201CA young man sits down at a table to eat a meal\u201D
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner \u2014 resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle \u2014 resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner \u2014 resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right \u2014 resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner \u2014 resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle \u2014 resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner \u2014 resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left \u2014 resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here\u2026
pdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close`)})}},i6=1e3,tx=50,BS=1e3;function nx(){return document.location.hash}var vx=class{#e=null;constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",r=>{this._isPagesLoaded=!!r.pagesCount},{once:!0})})}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:r=!1}){if(!e||typeof e!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();let i=this._fingerprint!==""&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=r===!0,this._initialized=!0,this.#d();let s=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=nx(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#i(s,!0)||t){let{hash:o,page:l,rotation:u}=this.#l(!0);if(!o||i||t){this.#t(null,!0);return}this.#t({hash:o,page:l,rotation:u},!0);return}let a=s.destination;this.#s(a,s.uid,!0),a.rotation!==void 0&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(this.#o(),this._initialized=!1,this.#a()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:r}){if(!this._initialized)return;if(e&&typeof e!="string"){console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);return}else if(Array.isArray(t)){if(!this.#r(r)&&(r!==null||this._destination)){console.error(`PDFHistory.push: "${r}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);return}let i=e||JSON.stringify(t);if(!i)return;let s=!1;if(this._destination&&(s6(this._destination.hash,i)||a6(this._destination.dest,t))){if(this._destination.page)return;s=!0}this._popStateInProgress&&!s||(this.#t({dest:t,hash:i,page:r,rotation:this.linkService.rotation},s),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(e){if(this._initialized){if(!this.#r(e)){console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`);return}this._destination?.page!==e&&(this._popStateInProgress||(this.#t({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#n()}back(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#i(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;let e=window.history.state;this.#i(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#t(e,t=!1){let r=t||!this._destination,i={fingerprint:this._fingerprint,uid:r?this._uid:this._uid+1,destination:e};this.#s(e,i.uid);let s;if(this._updateUrl&&e?.hash){let a=document.location.href.split("#",1)[0];a.startsWith("file://")||(s=`${a}#${e.hash}`)}r?window.history.replaceState(i,"",s):window.history.pushState(i,"",s)}#n(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination){this.#t(t);return}if(this._destination.temporary){this.#t(t,!0);return}if(this._destination.hash===t.hash||!this._destination.page&&(tx<=0||this._numPositionUpdates<=tx))return;let r=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(this._destination.dest!==void 0||!this._destination.first)return;r=!0}this.#t(t,r)}#r(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}#i(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint)if(t){if(typeof e.fingerprint!="string"||e.fingerprint.length!==this._fingerprint.length)return!1;let[r]=performance.getEntriesByType("navigation");if(r?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(e.uid)||e.uid<0||e.destination===null||typeof e.destination!="object")}#s(e,t,r=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),r&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}#l(e=!1){let t=unescape(nx()).substring(1),r=Bh(t),i=r.get("nameddest")||"",s=r.get("page")|0;return(!this.#r(s)||e&&i.length>0)&&(s=null),{hash:t,page:s,rotation:this.linkService.rotation}}#c({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},!this._popStateInProgress&&(tx>0&&this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,BS>0&&(this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#n(!0),this._updateViewareaTimeout=null},BS)))}#u({state:e}){let t=nx(),r=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;let{hash:s,page:a,rotation:o}=this.#l();this.#t({hash:s,page:a,rotation:o},!0);return}if(!this.#i(e))return;this._popStateInProgress=!0,r&&(this._blockHashChange++,_V({target:window,name:"hashchange",delay:i6}).then(()=>{this._blockHashChange--}));let i=e.destination;this.#s(i,e.uid,!0),WS(i.rotation)&&(this.linkService.rotation=i.rotation),i.dest?this.linkService.goToDestination(i.dest):i.hash?this.linkService.setHash(i.hash):i.page&&(this.linkService.page=i.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#o(){(!this._destination||this._destination.temporary)&&this.#n()}#d(){if(this.#e)return;this.#e=new AbortController;let{signal:e}=this.#e;this.eventBus._on("updateviewarea",this.#c.bind(this),{signal:e}),window.addEventListener("popstate",this.#u.bind(this),{signal:e}),window.addEventListener("pagehide",this.#o.bind(this),{signal:e})}#a(){this.#e?.abort(),this.#e=null}};function s6(n,e){return typeof n!="string"||typeof e!="string"?!1:n===e||Bh(n).get("nameddest")===e}function a6(n,e){function t(r,i){if(typeof r!=typeof i||Array.isArray(r)||Array.isArray(i))return!1;if(r!==null&&typeof r=="object"&&i!==null){if(Object.keys(r).length!==Object.keys(i).length)return!1;for(let s in r)if(!t(r[s],i[s]))return!1;return!0}return r===i||Number.isNaN(r)&&Number.isNaN(i)}if(!(Array.isArray(n)&&Array.isArray(e))||n.length!==e.length)return!1;for(let r=0,i=n.length;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}var _x=class{#e=null;#t=null;#n=null;#r=null;#i=null;#s;constructor(e){this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n,this.l10n||=new Mo,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#s=e.uiManager,this.#e=e.annotationLayer||null,this.#i=e.textLayer||null,this.#t=e.drawLayer||null,this.#n=e.onAppend||null,this.#r=e.structTreeLayer||null}render(e,t="display"){return ee(this,null,function*(){if(t!=="display"||this._cancelled)return;let r=e.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:r}),this.show();return}let i=this.div=document.createElement("div");i.className="annotationEditorLayer",i.hidden=!0,i.dir=this.#s.direction,this.#n?.(i),this.annotationEditorLayer=new oV({uiManager:this.#s,div:i,structTreeLayer:this.#r,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:r,annotationLayer:this.#e,textLayer:this.#i,drawLayer:this.#t});let s={viewport:r,div:i,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()})}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}};{Sh=new Map;let n=navigator.userAgent||"",e=navigator.platform||"",t=navigator.maxTouchPoints||1,r=/Android/.test(n),i=/\b(iPad|iPhone|iPod)(?=;)/.test(n)||e==="MacIntel"&&t>1;(function(){(i||r)&&Sh.set("maxCanvasPixels",5242880)})(),function(){r&&Sh.set("useSystemFonts",!1)}()}var Sh,te={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},xx={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},fi={allowedGlobalEvents:{value:null,kind:te.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:te.BROWSER+te.API},isInAutomation:{value:!1,kind:te.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:te.BROWSER},nimbusDataStr:{value:"",kind:te.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:te.BROWSER},supportsDocumentFonts:{value:!0,kind:te.BROWSER},supportsIntegratedFind:{value:!1,kind:te.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:te.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:te.BROWSER},supportsPinchToZoom:{value:!0,kind:te.BROWSER},toolbarDensity:{value:0,kind:te.BROWSER+te.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:te.VIEWER+te.PREFERENCE},annotationEditorMode:{value:0,kind:te.VIEWER+te.PREFERENCE},annotationMode:{value:2,kind:te.VIEWER+te.PREFERENCE},cursorToolOnLoad:{value:0,kind:te.VIEWER+te.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:te.VIEWER},defaultZoomDelay:{value:400,kind:te.VIEWER+te.PREFERENCE},defaultZoomValue:{value:"",kind:te.VIEWER+te.PREFERENCE},disableHistory:{value:!1,kind:te.VIEWER},disablePageLabels:{value:!1,kind:te.VIEWER+te.PREFERENCE},enableAltText:{value:!1,kind:te.VIEWER+te.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:te.VIEWER+te.PREFERENCE+te.EVENT_DISPATCH},enableGuessAltText:{value:!0,kind:te.VIEWER+te.PREFERENCE+te.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:te.VIEWER+te.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:te.VIEWER+te.PREFERENCE},enablePermissions:{value:!1,kind:te.VIEWER+te.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:te.VIEWER+te.PREFERENCE},enableScripting:{value:!0,kind:te.VIEWER+te.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:te.VIEWER+te.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:te.VIEWER},externalLinkTarget:{value:0,kind:te.VIEWER+te.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:te.VIEWER+te.PREFERENCE},historyUpdateUrl:{value:!1,kind:te.VIEWER+te.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:te.VIEWER+te.PREFERENCE},imageResourcesPath:{value:"./images/",kind:te.VIEWER},maxCanvasPixels:{value:2**25,kind:te.VIEWER},forcePageColors:{value:!1,kind:te.VIEWER+te.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:te.VIEWER+te.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:te.VIEWER+te.PREFERENCE},pdfBugEnabled:{value:!1,kind:te.VIEWER+te.PREFERENCE},printResolution:{value:150,kind:te.VIEWER},sidebarViewOnLoad:{value:-1,kind:te.VIEWER+te.PREFERENCE},scrollModeOnLoad:{value:-1,kind:te.VIEWER+te.PREFERENCE},spreadModeOnLoad:{value:-1,kind:te.VIEWER+te.PREFERENCE},textLayerMode:{value:1,kind:te.VIEWER+te.PREFERENCE},viewOnLoad:{value:0,kind:te.VIEWER+te.PREFERENCE},cMapPacked:{value:!0,kind:te.API},cMapUrl:{value:"../web/cmaps/",kind:te.API},disableAutoFetch:{value:!1,kind:te.API+te.PREFERENCE},disableFontFace:{value:!1,kind:te.API+te.PREFERENCE},disableRange:{value:!1,kind:te.API+te.PREFERENCE},disableStream:{value:!1,kind:te.API+te.PREFERENCE},docBaseUrl:{value:"",kind:te.API},enableHWA:{value:!0,kind:te.API+te.VIEWER+te.PREFERENCE},enableXfa:{value:!0,kind:te.API+te.PREFERENCE},fontExtraProperties:{value:!1,kind:te.API},isEvalSupported:{value:!0,kind:te.API},isOffscreenCanvasSupported:{value:!0,kind:te.API},maxImageSize:{value:-1,kind:te.API},pdfBug:{value:!1,kind:te.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:te.API},useSystemFonts:{value:void 0,kind:te.API,type:xx.BOOLEAN+xx.UNDEFINED},verbosity:{value:1,kind:te.API},workerPort:{value:null,kind:te.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:te.WORKER}};fi.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:te.VIEWER},fi.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:te.VIEWER},fi.viewerCssTheme={value:0,kind:te.VIEWER+te.PREFERENCE},fi.enableFakeMLManager={value:!0,kind:te.VIEWER};fi.disablePreferences={value:!1,kind:te.VIEWER};var yx=class{static eventBus;static#e=new Map;static{for(let e in fi)this.#e.set(e,fi[e].value);for(let[e,t]of Sh)this.#e.set(e,t);this._hasInvokedSet=!1,this._checkDisablePreferences=()=>this.get("disablePreferences")?!0:(this._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)}static get(e){return this.#e.get(e)}static getAll(e=null,t=!1){let r=Object.create(null);for(let i in fi){let s=fi[i];e&&!(e&s.kind)||(r[i]=t?s.value:this.#e.get(i))}return r}static set(e,t){this.setAll({[e]:t})}static setAll(e,t=!1){this._hasInvokedSet||=!0;let r;for(let i in e){let s=fi[i],a=e[i];if(!s||!(typeof a==typeof s.value||xx[(typeof a).toUpperCase()]&s.type))continue;let{kind:o}=s;t&&!(o&te.BROWSER||o&te.PREFERENCE)||(this.eventBus&&o&te.EVENT_DISPATCH&&(r||=new Map).set(i,a),this.#e.set(i,a))}if(r)for(let[i,s]of r)this.eventBus.dispatch(i.toLowerCase(),{source:this,value:s})}},wx=class{#e=null;constructor(e){this.pageIndex=e.pageIndex}render(e="display"){return ee(this,null,function*(){e!=="display"||this.#e||this._cancelled||(this.#e=new dV({pageIndex:this.pageIndex}))})}cancel(){this._cancelled=!0,this.#e&&(this.#e.destroy(),this.#e=null)}setParent(e){this.#e?.setParent(e)}getDrawLayer(){return this.#e}},VS={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},o6=/^H(\d+)$/,Ph=class{#e;#t=null;#n;#r=new Map;#i;#s=null;constructor(e,t){this.#e=e.getStructTree(),this.#i=t}render(){return ee(this,null,function*(){if(this.#n)return this.#n;let{promise:e,resolve:t,reject:r}=Promise.withResolvers();this.#n=e;try{this.#t=this.#u(yield this.#e)}catch(i){r(i)}return this.#e=null,this.#t?.classList.add("structTree"),t(this.#t),e})}getAriaAttributes(e){return ee(this,null,function*(){try{return yield this.render(),this.#r.get(e)}catch{}return null})}hide(){this.#t&&!this.#t.hidden&&(this.#t.hidden=!0)}show(){this.#t?.hidden&&(this.#t.hidden=!1)}#l(e,t){let{alt:r,id:i,lang:s}=e;if(r!==void 0){let a=!1,o=Ec(r);for(let l of e.children)if(l.type==="annotation"){let u=this.#r.get(l.id);u||(u=new Map,this.#r.set(l.id,u)),u.set("aria-label",o),a=!0}a||t.setAttribute("aria-label",o)}i!==void 0&&t.setAttribute("aria-owns",i),s!==void 0&&t.setAttribute("lang",Ec(s,!0))}#c(e,t){let{alt:r,bbox:i,children:s}=e,a=s?.[0];if(!this.#i||!r||!i||a?.type!=="content")return!1;let{id:o}=a;if(!o)return!1;t.setAttribute("aria-owns",o);let l=document.createElement("span");(this.#s||=new Map).set(o,l),l.setAttribute("role","img"),l.setAttribute("aria-label",Ec(r));let{pageHeight:u,pageX:c,pageY:d}=this.#i,f="calc(var(--scale-factor)*",{style:h}=l;return h.width=`${f}${i[2]-i[0]}px)`,h.height=`${f}${i[3]-i[1]}px)`,h.left=`${f}${i[0]-c}px)`,h.top=`${f}${u-i[3]+d}px)`,!0}addElementsToTextLayer(){if(this.#s){for(let[e,t]of this.#s)document.getElementById(e)?.append(t);this.#s.clear(),this.#s=null}}#u(e){if(!e)return null;let t=document.createElement("span");if("role"in e){let{role:r}=e,i=r.match(o6);if(i?(t.setAttribute("role","heading"),t.setAttribute("aria-level",i[1])):VS[r]&&t.setAttribute("role",VS[r]),r==="Figure"&&this.#c(e,t))return t}if(this.#l(e,t),e.children)if(e.children.length===1&&"id"in e.children[0])this.#l(e.children[0],t);else for(let r of e.children)t.append(this.#u(r));return t}},bx=class n{#e=!1;#t=null;#n=new Map;#r=new Map;setTextMapping(e){this.#t=e}static#i(e,t){let r=e.getBoundingClientRect(),i=t.getBoundingClientRect();if(r.width===0&&r.height===0)return 1;if(i.width===0&&i.height===0)return-1;let s=r.y,a=r.y+r.height,o=r.y+r.height/2,l=i.y,u=i.y+i.height,c=i.y+i.height/2;if(o<=l&&c>=a)return-1;if(c<=s&&o>=u)return 1;let d=r.x+r.width/2,f=i.x+i.width/2;return d-f}enable(){if(this.#e)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#t)throw new Error("Text divs and strings have not been set.");if(this.#e=!0,this.#t=this.#t.slice(),this.#t.sort(n.#i),this.#n.size>0){let e=this.#t;for(let[t,r]of this.#n){if(!document.getElementById(t)){this.#n.delete(t);continue}this.#s(t,e[r])}}for(let[e,t]of this.#r)this.addPointerInTextLayer(e,t);this.#r.clear()}disable(){this.#e&&(this.#r.clear(),this.#t=null,this.#e=!1)}removePointerInTextLayer(e){if(!this.#e){this.#r.delete(e);return}let t=this.#t;if(!t||t.length===0)return;let{id:r}=e,i=this.#n.get(r);if(i===void 0)return;let s=t[i];this.#n.delete(r);let a=s.getAttribute("aria-owns");a?.includes(r)&&(a=a.split(" ").filter(o=>o!==r).join(" "),a?s.setAttribute("aria-owns",a):(s.removeAttribute("aria-owns"),s.setAttribute("role","presentation")))}#s(e,t){let r=t.getAttribute("aria-owns");r?.includes(e)||t.setAttribute("aria-owns",r?`${r} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){let{id:r}=e;if(!r)return null;if(!this.#e)return this.#r.set(e,t),null;t&&this.removePointerInTextLayer(e);let i=this.#t;if(!i||i.length===0)return null;let s=Ac(i,u=>n.#i(e,u)<0),a=Math.max(0,s-1),o=i[a];this.#s(r,o),this.#n.set(r,a);let l=o.parentNode;return l?.classList.contains("markedContent")?l.id:null}moveElementInDOM(e,t,r,i){let s=this.addPointerInTextLayer(r,i);if(!e.hasChildNodes())return e.append(t),s;let a=Array.from(e.childNodes).filter(u=>u!==t);if(a.length===0)return s;let o=r||t,l=Ac(a,u=>n.#i(o,u)<0);return l===0?a[0].before(t):a[l-1].after(t),s}},Ex=class{#e=null;constructor({findController:e,eventBus:t,pageIndex:r}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=r,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#e||(this.#e=new AbortController,this.eventBus._on("updatetextlayermatches",e=>{(e.pageIndex===this.pageIdx||e.pageIndex===-1)&&this._updateMatches()},{signal:this.#e.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#e?.abort(),this.#e=null,this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];let{textContentItemsStr:r}=this,i=0,s=0,a=r.length-1,o=[];for(let l=0,u=e.length;l<u;l++){let c=e[l];for(;i!==a&&c>=s+r[i].length;)s+=r[i].length,i++;i===r.length&&console.error("Could not find a matching mapping");let d={begin:{divIdx:i,offset:c-s}};for(c+=t[l];i!==a&&c>s+r[i].length;)s+=r[i].length,i++;d.end={divIdx:i,offset:c-s},o.push(d)}return o}_renderMatches(e){if(e.length===0)return;let{findController:t,pageIdx:r}=this,{textContentItemsStr:i,textDivs:s}=this,a=r===t.selected.pageIdx,o=t.selected.matchIdx,l=t.state.highlightAll,u=null,c={divIdx:-1,offset:void 0};function d(v,x){let _=v.divIdx;return s[_].textContent="",f(_,0,v.offset,x)}function f(v,x,_,b){let D=s[v];if(D.nodeType===Node.TEXT_NODE){let T=document.createElement("span");D.before(T),T.append(D),s[v]=T,D=T}let A=i[v].substring(x,_),w=document.createTextNode(A);if(b){let T=document.createElement("span");return T.className=`${b} appended`,T.append(w),D.append(T),b.includes("selected")?T.offsetLeft:0}return D.append(w),0}let h=o,p=h+1;if(l)h=0,p=e.length;else if(!a)return;let g=-1,m=-1;for(let v=h;v<p;v++){let x=e[v],_=x.begin;if(_.divIdx===g&&_.offset===m)continue;g=_.divIdx,m=_.offset;let b=x.end,D=a&&v===o,A=D?" selected":"",w=0;if(!u||_.divIdx!==u.divIdx?(u!==null&&f(u.divIdx,u.offset,c.offset),d(_)):f(u.divIdx,u.offset,_.offset),_.divIdx===b.divIdx)w=f(_.divIdx,_.offset,b.offset,"highlight"+A);else{w=f(_.divIdx,_.offset,c.offset,"highlight begin"+A);for(let T=_.divIdx+1,E=b.divIdx;T<E;T++)s[T].className="highlight middle"+A;d(b,"highlight end"+A)}u=b,D&&t.scrollMatchIntoView({element:s[_.divIdx],selectedLeft:w,pageIndex:r,matchIndex:o})}u&&f(u.divIdx,u.offset,c.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;let{findController:t,matches:r,pageIdx:i}=this,{textContentItemsStr:s,textDivs:a}=this,o=-1;for(let c of r){let d=Math.max(o,c.begin.divIdx);for(let f=d,h=c.end.divIdx;f<=h;f++){let p=a[f];p.textContent=s[f],p.className=""}o=c.end.divIdx+1}if(!t?.highlightMatches||e)return;let l=t.pageMatches[i]||null,u=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(l,u),this._renderMatches(this.matches)}},Rh=class n{#e=!1;#t=null;#n=!1;#r=null;static#i=new Map;static#s=null;constructor({pdfPage:e,highlighter:t=null,accessibilityManager:r=null,enablePermissions:i=!1,onAppend:s=null}){this.pdfPage=e,this.highlighter=t,this.accessibilityManager=r,this.#e=i===!0,this.#t=s,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}render(e,t=null){return ee(this,null,function*(){if(this.#n&&this.#r){this.#r.update({viewport:e,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#r=new vV({textContentSource:this.pdfPage.streamTextContent(t||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:e});let{textDivs:r,textContentItemsStr:i}=this.#r;this.highlighter?.setTextMapping(r,i),this.accessibilityManager?.setTextMapping(r),yield this.#r.render(),this.#n=!0;let s=document.createElement("div");s.className="endOfContent",this.div.append(s),this.#l(s),this.#t?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()})}hide(){!this.div.hidden&&this.#n&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#n&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#r?.cancel(),this.#r=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),n.#c(this.div)}#l(e){let{div:t}=this;t.addEventListener("mousedown",()=>{t.classList.add("selecting")}),t.addEventListener("copy",r=>{if(!this.#e){let i=document.getSelection();r.clipboardData.setData("text/plain",Ec(pV(i.toString())))}r.preventDefault(),r.stopPropagation()}),n.#i.set(t,e),n.#u()}static#c(e){this.#i.delete(e),this.#i.size===0&&(this.#s?.abort(),this.#s=null)}static#u(){if(this.#s)return;this.#s=new AbortController;let{signal:e}=this.#s,t=(a,o)=>{o.append(a),a.style.width="",a.style.height="",o.classList.remove("selecting")},r=!1;document.addEventListener("pointerdown",()=>{r=!0},{signal:e}),document.addEventListener("pointerup",()=>{r=!1,this.#i.forEach(t)},{signal:e}),window.addEventListener("blur",()=>{r=!1,this.#i.forEach(t)},{signal:e}),document.addEventListener("keyup",()=>{r||this.#i.forEach(t)},{signal:e});var i,s;document.addEventListener("selectionchange",()=>{let a=document.getSelection();if(a.rangeCount===0){this.#i.forEach(t);return}let o=new Set;for(let h=0;h<a.rangeCount;h++){let p=a.getRangeAt(h);for(let g of this.#i.keys())!o.has(g)&&p.intersectsNode(g)&&o.add(g)}for(let[h,p]of this.#i)o.has(h)?h.classList.add("selecting"):t(p,h);if(i??=getComputedStyle(this.#i.values().next().value).getPropertyValue("-moz-user-select")==="none",i)return;let l=a.getRangeAt(0),u=s&&(l.compareBoundaryPoints(Range.END_TO_END,s)===0||l.compareBoundaryPoints(Range.START_TO_END,s)===0),c=u?l.startContainer:l.endContainer;c.nodeType===Node.TEXT_NODE&&(c=c.parentNode);let d=c.parentElement?.closest(".textLayer"),f=this.#i.get(d);f&&(f.style.width=d.style.width,f.style.height=d.style.height,c.parentElement.insertBefore(f,u?c:c.nextSibling)),s=l.cloneRange()},{signal:e})}},Nh=class{constructor({pdfPage:e,annotationStorage:t=null,linkService:r,xfaHtml:i=null}){this.pdfPage=e,this.annotationStorage=t,this.linkService=r,this.xfaHtml=i,this.div=null,this._cancelled=!1}render(e,t="display"){return ee(this,null,function*(){if(t==="print"){let s={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div=document.createElement("div"),s.div=this.div,Z_.render(s)}let r=yield this.pdfPage.getXfa();if(this._cancelled||!r)return{textDivs:[]};let i={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:r,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?Z_.update(i):(this.div=document.createElement("div"),i.div=this.div,Z_.render(i))})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}},l6={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new Cc}},c6=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]),Oh=class{#e=qi.ENABLE_FORMS;#t=!1;#n=!1;#r=!1;#i=null;#s=null;#l=null;#c=1;#u=1;#o=null;#d=Rt.INITIAL;#a=di.ENABLE;#f={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#p=new WeakMap;#h=[null,null,null,null];constructor(e){let t=e.container,r=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#i=e.layerProperties||l6,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||HS,this.viewport=r,this.pdfPageRotate=r.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#a=e.textLayerMode??di.ENABLE,this.#e=e.annotationMode??qi.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.maxCanvasPixels=e.maxCanvasPixels??yx.get("maxCanvasPixels"),this.pageColors=e.pageColors||null,this.#t=e.enableHWA||!1,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n,this.l10n||=new Mo,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;let i=document.createElement("div");if(i.className="page",i.setAttribute("data-page-number",this.id),i.setAttribute("role","region"),i.setAttribute("data-l10n-id","pdfjs-page-landmark"),i.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=i,this.#v(),t?.append(i),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*Gi.PDF_TO_CSS_UNITS),this.pageColors?.background&&t?.style.setProperty("--page-bg-color",this.pageColors.background);let{optionalContentConfigPromise:s}=e;s&&s.then(a=>{s===this._optionalContentConfigPromise&&(this.#f.initialOptionalContent=a.hasInitialVisibility)}),e.l10n||this.l10n.translate(this.div)}}#g(e,t){let r=c6.get(t),i=this.#h[r];if(this.#h[r]=e,i){i.replaceWith(e);return}for(let s=r-1;s>=0;s--){let a=this.#h[s];if(a){a.after(e);return}}this.div.prepend(e)}get renderingState(){return this.#d}set renderingState(e){if(e!==this.#d)switch(this.#d=e,this.#s&&(clearTimeout(this.#s),this.#s=null),e){case Rt.PAUSED:this.div.classList.remove("loading");break;case Rt.RUNNING:this.div.classList.add("loadingIcon"),this.#s=setTimeout(()=>{this.div.classList.add("loading"),this.#s=null},0);break;case Rt.INITIAL:case Rt.FINISHED:this.div.classList.remove("loadingIcon","loading");break}}#v(){let{viewport:e}=this;if(this.pdfPage){if(this.#l===e.rotation)return;this.#l=e.rotation}mV(this.div,e,!0,!1)}setPdfPage(e){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=e,this.pdfPageRotate=e.rotate;let t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*Gi.PDF_TO_CSS_UNITS,rotation:t}),this.#v(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return Dh(this,"_textHighlighter",new Ex({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#i.findController}))}#m(e,t){this.eventBus.dispatch(e,{source:this,pageNumber:this.id,error:t})}#_(){return ee(this,null,function*(){let e=null;try{yield this.annotationLayer.render(this.viewport,{structTreeLayer:this.structTreeLayer},"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.#m("annotationlayerrendered",e)}})}#y(){return ee(this,null,function*(){let e=null;try{yield this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.#m("annotationeditorlayerrendered",e)}})}#E(){return ee(this,null,function*(){try{yield this.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}})}#w(){return ee(this,null,function*(){let e=null;try{let t=yield this.xfaLayer.render(this.viewport,"display");t?.textDivs&&this._textHighlighter&&this.#T(t.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#g(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#m("xfalayerrendered",e)}})}#b(){return ee(this,null,function*(){if(!this.textLayer)return;let e=null;try{yield this.textLayer.render(this.viewport)}catch(t){if(t instanceof aV)return;console.error(`#renderTextLayer: "${t}".`),e=t}this.#m("textlayerrendered",e),this.#k()})}#k(){return ee(this,null,function*(){if(!this.textLayer)return;let e=yield this.structTreeLayer?.render();e&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&e.parentNode!==this.canvas&&this.canvas.append(e),this.l10n.resume()),this.structTreeLayer?.show()})}#T(e){return ee(this,null,function*(){let t=yield this.pdfPage.getTextContent(),r=[];for(let i of t.items)r.push(i.str);this._textHighlighter.setTextMapping(e,r),this._textHighlighter.enable()})}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;let t=this.zoomLayer.firstChild;this.#p.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:r=!1,keepXfaLayer:i=!1,keepTextLayer:s=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:r,keepXfaLayer:i,keepTextLayer:s}),this.renderingState=Rt.INITIAL;let a=this.div,o=a.childNodes,l=e&&this.zoomLayer||null,u=t&&this.annotationLayer?.div||null,c=r&&this.annotationEditorLayer?.div||null,d=i&&this.xfaLayer?.div||null,f=s&&this.textLayer?.div||null;for(let h=o.length-1;h>=0;h--){let p=o[h];switch(p){case l:case u:case c:case d:case f:continue}p.remove();let g=this.#h.indexOf(p);g>=0&&(this.#h[g]=null)}a.removeAttribute("data-loaded"),u&&this.annotationLayer.hide(),c&&this.annotationEditorLayer.hide(),d&&this.xfaLayer.hide(),f&&this.textLayer.hide(),this.structTreeLayer?.hide(),l||(this.canvas&&(this.#p.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(e){this.hasEditableAnnotations()&&(this.#r=e,this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:r=null,drawingDelay:i=-1}){this.scale=e||this.scale,typeof t=="number"&&(this.rotation=t),r instanceof Promise&&(this._optionalContentConfigPromise=r,r.then(a=>{r===this._optionalContentConfigPromise&&(this.#f.initialOptionalContent=a.hasInitialVisibility)})),this.#f.directDrawing=!0;let s=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*Gi.PDF_TO_CSS_UNITS,rotation:s}),this.#v(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let a=!1;if(this.#n){if(this.maxCanvasPixels===0)a=!0;else if(this.maxCanvasPixels>0){let{width:l,height:u}=this.viewport,{sx:c,sy:d}=this.outputScale;a=(Math.floor(l)*c|0)*(Math.floor(u)*d|0)>this.maxCanvasPixels}}let o=i>=0&&i<1e3;if(o||a){if(o&&!a&&this.renderingState!==Rt.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:i}),this.renderingState=Rt.FINISHED,this.#f.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!o,hideTextLayer:o}),o)return;this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#o});return}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:r=!1,keepTextLayer:i=!1,cancelExtraDelay:s=0}={}){this.renderTask&&(this.renderTask.cancel(s),this.renderTask=null),this.resume=null,this.textLayer&&(!i||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!e||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!t||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!r||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:r=!1,redrawXfaLayer:i=!1,redrawTextLayer:s=!1,hideTextLayer:a=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);let{style:l}=e;l.width=l.height=""}let o=this.#p.get(e);if(this.viewport!==o){let l=this.viewport.rotation-o.rotation,u=Math.abs(l),c=1,d=1;if(u===90||u===270){let{width:f,height:h}=this.viewport;c=h/f,d=f/h}e.style.transform=`rotate(${l}deg) scale(${c}, ${d})`}t&&this.annotationLayer&&this.#_(),r&&this.annotationEditorLayer&&(this.drawLayer&&this.#E(),this.#y()),i&&this.xfaLayer&&this.#w(),this.textLayer&&(a?(this.textLayer.hide(),this.structTreeLayer?.hide()):s&&this.#b())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}#A(e,t=null){return ee(this,null,function*(){if(e===this.renderTask&&(this.renderTask=null),t instanceof sx){this.#o=null;return}if(this.#o=t,this.renderingState=Rt.FINISHED,this._resetZoomLayer(!0),this.#f.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#o}),t)throw t})}draw(){return ee(this,null,function*(){this.renderingState!==Rt.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());let{div:e,l10n:t,pageColors:r,pdfPage:i,viewport:s}=this;if(!i)throw this.renderingState=Rt.FINISHED,new Error("pdfPage is not loaded");this.renderingState=Rt.RUNNING;let a=document.createElement("div");if(a.classList.add("canvasWrapper"),this.#g(a,"canvasWrapper"),!this.textLayer&&this.#a!==di.DISABLE&&!i.isPureXfa&&(this._accessibilityManager||=new bx,this.textLayer=new Rh({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#a===di.ENABLE_PERMISSIONS,onAppend:E=>{this.l10n.pause(),this.#g(E,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#e!==qi.DISABLE){let{annotationStorage:E,annotationEditorUIManager:P,downloadManager:N,enableScripting:O,fieldObjectsPromise:Y,hasJSActionsPromise:se,linkService:ie}=this.#i;this._annotationCanvasMap||=new Map,this.annotationLayer=new Ih({pdfPage:i,annotationStorage:E,imageResourcesPath:this.imageResourcesPath,renderForms:this.#e===qi.ENABLE_FORMS,linkService:ie,downloadManager:N,enableScripting:O,hasJSActionsPromise:se,fieldObjectsPromise:Y,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:P,onAppend:ge=>{this.#g(ge,"annotationLayer")}})}let o=E=>{if(f?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=Rt.PAUSED,this.resume=()=>{this.renderingState=Rt.RUNNING,E()};return}E()},{width:l,height:u}=s,c=document.createElement("canvas");c.setAttribute("role","presentation"),c.hidden=!0;let d=!!(r?.background&&r?.foreground),f=E=>{(!d||E)&&(c.hidden=!1,f=null)};a.append(c),this.canvas=c;let h=c.getContext("2d",{alpha:!1,willReadFrequently:!this.#t}),p=this.outputScale=new gV;if(this.maxCanvasPixels===0){let E=1/this.scale;p.sx*=E,p.sy*=E,this.#n=!0}else if(this.maxCanvasPixels>0){let E=l*u,P=Math.sqrt(this.maxCanvasPixels/E);p.sx>P||p.sy>P?(p.sx=P,p.sy=P,this.#n=!0):this.#n=!1}let g=hS(p.sx),m=hS(p.sy),v=c.width=yh(wh(l*p.sx),g[0]),x=c.height=yh(wh(u*p.sy),m[0]),_=yh(wh(l),g[1]),b=yh(wh(u),m[1]);p.sx=v/_,p.sy=x/b,this.#c!==g[1]&&(e.style.setProperty("--scale-round-x",`${g[1]}px`),this.#c=g[1]),this.#u!==m[1]&&(e.style.setProperty("--scale-round-y",`${m[1]}px`),this.#u=m[1]),this.#p.set(c,s);let D=p.scaled?[p.sx,0,0,p.sy,0,0]:null,A={canvasContext:h,transform:D,viewport:s,annotationMode:this.#e,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:r,isEditing:this.#r},w=this.renderTask=i.render(A);w.onContinue=o;let T=w.promise.then(()=>ee(this,null,function*(){f?.(!0),yield this.#A(w),this.structTreeLayer||=new Ph(i,s.rawDims),this.#b(),this.annotationLayer&&(yield this.#_());let{annotationEditorUIManager:E}=this.#i;E&&(this.drawLayer||=new wx({pageIndex:this.id}),yield this.#E(),this.drawLayer.setParent(a),this.annotationEditorLayer||=new _x({uiManager:E,pdfPage:i,l10n:t,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:P=>{this.#g(P,"annotationEditorLayer")}}),this.#y())}),E=>(E instanceof sx||f?.(!0),this.#A(w,E)));if(i.isPureXfa){if(!this.xfaLayer){let{annotationStorage:E,linkService:P}=this.#i;this.xfaLayer=new Nh({pdfPage:i,annotationStorage:E,linkService:P})}this.#w()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),T})}setPageLabel(e){this.pageLabel=typeof e=="string"?e:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){let{directDrawing:e,initialOptionalContent:t,regularAnnotations:r}=this.#f;return e&&t&&r?this.canvas:null}};function u6(n){return ee(this,null,function*(){let e="",t=e.split("#",1)[0],{info:r,metadata:i,contentDispositionFilename:s,contentLength:a}=yield n.getMetadata();if(!a){let{length:o}=yield n.getDownloadInfo();a=o}return Ke(ce({},r),{baseURL:t,filesize:a,filename:s||fV(e),metadata:i?.getRaw(),authors:i?.get("dc:creator"),numPages:n.numPages,URL:e})})}var Ax=class{constructor(e){this._ready=new Promise((t,r)=>{import(e).then(s=>{t(s.QuickJSSandbox())}).catch(r)})}createSandbox(e){return ee(this,null,function*(){(yield this._ready).create(e)})}dispatchEventInSandbox(e){return ee(this,null,function*(){let t=yield this._ready;setTimeout(()=>t.dispatchEvent(e),0)})}destroySandbox(){return ee(this,null,function*(){(yield this._ready).nukeSandbox()})}},Cx=class{#e=null;#t=null;#n=null;#r=null;#i=null;#s=null;#l=null;#c=null;#u=!1;#o=null;#d=null;constructor({eventBus:e,externalServices:t=null,docProperties:r=null}){this.#i=e,this.#s=t,this.#n=r}setViewer(e){this.#c=e}setDocument(e){return ee(this,null,function*(){if(this.#l&&(yield this.#g()),this.#l=e,!e)return;let[t,r,i]=yield Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(!t&&!i){yield this.#g();return}if(e!==this.#l)return;try{this.#o=this.#h()}catch(o){console.error(`setDocument: "${o.message}".`),yield this.#g();return}let s=this.#i;this.#r=new AbortController;let{signal:a}=this.#r;s._on("updatefromsandbox",o=>{o?.source===window&&this.#a(o.detail)},{signal:a}),s._on("dispatcheventinsandbox",o=>{this.#o?.dispatchEventInSandbox(o.detail)},{signal:a}),s._on("pagechanging",({pageNumber:o,previous:l})=>{o!==l&&(this.#p(l),this.#f(o))},{signal:a}),s._on("pagerendered",({pageNumber:o})=>{this._pageOpenPending.has(o)&&o===this.#c.currentPageNumber&&this.#f(o)},{signal:a}),s._on("pagesdestroy",()=>ee(this,null,function*(){yield this.#p(this.#c.currentPageNumber),yield this.#o?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#e?.resolve()}),{signal:a});try{let o=yield this.#n(e);if(e!==this.#l)return;yield this.#o.createSandbox({objects:t,calculationOrder:r,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:Ke(ce({},o),{actions:i})}),s.dispatch("sandboxcreated",{source:this})}catch(o){console.error(`setDocument: "${o.message}".`),yield this.#g();return}yield this.#o?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield this.#f(this.#c.currentPageNumber,!0),Promise.resolve().then(()=>{e===this.#l&&(this.#u=!0)})})}dispatchWillSave(){return ee(this,null,function*(){return this.#o?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})}dispatchDidSave(){return ee(this,null,function*(){return this.#o?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})}dispatchWillPrint(){return ee(this,null,function*(){if(this.#o){yield this.#d?.promise,this.#d=Promise.withResolvers();try{yield this.#o.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#d.resolve(),this.#d=null,e}yield this.#d.promise}})}dispatchDidPrint(){return ee(this,null,function*(){return this.#o?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})}get destroyPromise(){return this.#t?.promise||null}get ready(){return this.#u}get _pageOpenPending(){return Dh(this,"_pageOpenPending",new Set)}get _visitedPages(){return Dh(this,"_visitedPages",new Map)}#a(e){return ee(this,null,function*(){let t=this.#c,r=t.isInPresentationMode||t.isChangingPresentationMode,{id:i,siblings:s,command:a,value:o}=e;if(!i){switch(a){case"clear":console.clear();break;case"error":console.error(o);break;case"layout":if(!r){let u=L8(o);t.spreadMode=u.spreadMode}break;case"page-num":t.currentPageNumber=o+1;break;case"print":yield t.pagesPromise,this.#i.dispatch("print",{source:this});break;case"println":console.log(o);break;case"zoom":r||(t.currentScaleValue=o);break;case"SaveAs":this.#i.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":r||t.increaseScale();break;case"ZoomViewOut":r||t.decreaseScale();break;case"WillPrintFinished":this.#d?.resolve(),this.#d=null;break}return}if(r&&e.focus)return;delete e.id,delete e.siblings;let l=s?[i,...s]:[i];for(let u of l){let c=document.querySelector(`[data-element-id="${u}"]`);c?c.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#l?.annotationStorage.setValue(u,e)}})}#f(e,t=!1){return ee(this,null,function*(){let r=this.#l,i=this._visitedPages;if(t&&(this.#e=Promise.withResolvers()),!this.#e)return;let s=this.#c.getPageView(e-1);if(s?.renderingState!==Rt.FINISHED){this._pageOpenPending.add(e);return}this._pageOpenPending.delete(e);let a=ee(this,null,function*(){let o=yield i.has(e)?null:s.pdfPage?.getJSActions();r===this.#l&&(yield this.#o?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:o}))});i.set(e,a)})}#p(e){return ee(this,null,function*(){let t=this.#l,r=this._visitedPages;if(!this.#e||this._pageOpenPending.has(e))return;let i=r.get(e);i&&(r.set(e,null),yield i,t===this.#l&&(yield this.#o?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})))})}#h(){if(this.#t=Promise.withResolvers(),this.#o)throw new Error("#initScripting: Scripting already exists.");return this.#s.createScripting()}#g(){return ee(this,null,function*(){if(!this.#o){this.#l=null,this.#t?.resolve();return}this.#e&&(yield Promise.race([this.#e.promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),this.#e=null),this.#l=null;try{yield this.#o.destroySandbox()}catch{}this.#d?.reject(new Error("Scripting destroyed.")),this.#d=null,this.#r?.abort(),this.#r=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#o=null,this.#u=!1,this.#t?.resolve()})}},Sx=class extends Cx{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})}),e.externalServices||={createScripting:()=>new Ax(e.sandboxBundleSrc)},e.docProperties||=t=>u6(t),super(e)}},d6=3e4,Tx=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(e)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),d6)))}getHighestPriority(e,t,r,i=!1){let s=e.views,a=s.length;if(a===0)return null;for(let d=0;d<a;d++){let f=s[d].view;if(!this.isViewFinished(f))return f}let o=e.first.id,l=e.last.id;if(l-o+1>a){let d=e.ids;for(let f=1,h=l-o;f<h;f++){let p=r?o+f:l-f;if(d.has(p))continue;let g=t[p-1];if(!this.isViewFinished(g))return g}}let u=r?l:o-2,c=t[u];return c&&!this.isViewFinished(c)||i&&(u+=r?1:-1,c=t[u],c&&!this.isViewFinished(c))?c:null}isViewFinished(e){return e.renderingState===Rt.FINISHED}renderView(e){switch(e.renderingState){case Rt.FINISHED:return!1;case Rt.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case Rt.RUNNING:this.highestPriorityPage=e.renderingId;break;case Rt.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally(()=>{this.renderHighestPriority()}).catch(t=>{t instanceof sx||console.error(`renderView: "${t}"`)});break}return!0}},jS=10,Ch={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function US(n){return Object.values(lr).includes(n)&&n!==lr.DISABLE}var Dx=class{#e=new Set;#t=0;constructor(e){this.#t=e}push(e){let t=this.#e;t.has(e)&&t.delete(e),t.add(e),t.size>this.#t&&this.#n()}resize(e,t=null){this.#t=e;let r=this.#e;if(t){let i=r.size,s=1;for(let a of r)if(t.has(a.id)&&(r.delete(a),r.add(a)),++s>i)break}for(;r.size>this.#t;)this.#n()}has(e){return this.#e.has(e)}[Symbol.iterator](){return this.#e.keys()}#n(){let e=this.#e.keys().next().value;e?.destroy(),this.#e.delete(e)}},Lh=class{#e=null;#t=null;#n=null;#r=lr.NONE;#i=null;#s=qi.ENABLE_FORMS;#l=null;#c=!1;#u=!1;#o=!1;#d=!1;#a=!1;#f=null;#p=null;#h=null;#g=null;#v=!1;#m=null;#_=!1;#y=0;#E=new ResizeObserver(this.#B.bind(this));#w=null;#b=null;#k=di.ENABLE;constructor(e){let t="4.8.69";if(bS!==t)throw new Error(`The API version "${bS}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#E.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new Cc,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#t=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=i=>this._getVisiblePages().ids.has(i)),this._scriptingManager=e.scriptingManager||null,this.#k=e.textLayerMode??di.ENABLE,this.#s=e.annotationMode??qi.ENABLE_FORMS,this.#r=e.annotationEditorMode??lr.NONE,this.#n=e.annotationEditorHighlightColors||null,this.#u=e.enableHighlightFloatingButton===!0,this.#d=e.enableUpdatedAddImage===!0,this.#a=e.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n,this.l10n||=new Mo,this.#o=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.#p=e.mlManager||null,this.#c=e.enableHWA||!1,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new Tx,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue;let{abortSignal:r}=e;r?.addEventListener("abort",()=>{this.#E.disconnect(),this.#E=null},{once:!0}),this.scroll=k8(this.container,this._scrollUpdate.bind(this),r),this.presentationModeState=Do.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#O(),this.eventBus._on("thumbnailrendered",({pageNumber:i,pdfPage:s})=>{let a=this._pages[i-1];this.#e.has(a)||s?.cleanup()}),e.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#e)}get pageViewsReady(){return this._pages.every(e=>e?.pdfPage)}get renderForms(){return this.#s===qi.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#F(),!0;if(!(0<e&&e<=this.pagesCount))return!1;let r=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:r}),t&&this.#F(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=e|0;if(this._pageLabels){let r=this._pageLabels.indexOf(e);r>=0&&(t=r+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==X_?this._currentScale:HS}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#I(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#I(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!WS(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(e%=360,e<0&&(e+=360),this._pagesRotation===e))return;this._pagesRotation=e;let t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#I(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){let e=this;return Dh(this,"_layerProperties",{get annotationEditorUIManager(){return e.#i},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}})}#T(e){let t={annotationEditorMode:this.#r,annotationMode:this.#s,textLayerMode:this.#k};return e&&(!e.includes(Eh.COPY)&&this.#k===di.ENABLE&&(t.textLayerMode=di.ENABLE_PERMISSIONS),e.includes(Eh.MODIFY_CONTENTS)||(t.annotationEditorMode=lr.DISABLE),!e.includes(Eh.MODIFY_ANNOTATIONS)&&!e.includes(Eh.FILL_INTERACTIVE_FORMS)&&this.#s===qi.ENABLE_FORMS&&(t.annotationMode=qi.ENABLE)),t}#A(e){return ee(this,null,function*(){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;let t=Promise.withResolvers(),r=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&t.resolve()},{signal:typeof AbortSignal.any=="function"?AbortSignal.any([e,r.signal]):e}),yield Promise.race([this._onePageRenderedCapability.promise,t.promise]),r.abort()})}getAllText(){return ee(this,null,function*(){let e=[],t=[];for(let r=1,i=this.pdfDocument.numPages;r<=i;++r){if(this.#_)return null;t.length=0;let s=yield this.pdfDocument.getPage(r),{items:a}=yield s.getTextContent();for(let o of a)o.str&&t.push(o.str),o.hasEOL&&t.push(`
`);e.push(Ec(t.join("")))}return e.join(`
`)})}#D(e,t){let r=document.getSelection(),{focusNode:i,anchorNode:s}=r;if(s&&i&&r.containsNode(this.#m)){if(this.#v||e===di.ENABLE_PERMISSIONS){t.preventDefault(),t.stopPropagation();return}this.#v=!0;let{classList:a}=this.viewer;a.add("copyAll");let o=new AbortController;window.addEventListener("keydown",l=>this.#_=l.key==="Escape",{signal:o.signal}),this.getAllText().then(l=>ee(this,null,function*(){l!==null&&(yield navigator.clipboard.writeText(l))})).catch(l=>{console.warn(`Something goes wrong when extracting the text: ${l.message}`)}).finally(()=>{this.#v=!1,this.#_=!1,o.abort(),a.remove("copyAll")}),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#i?.destroy(),this.#i=null),this.pdfDocument=e,!e)return;let t=e.numPages,r=e.getPage(1),i=e.getOptionalContentConfig({intent:"display"}),s=this.#o?e.getPermissions():Promise.resolve(),{eventBus:a,pageColors:o,viewer:l}=this;this.#f=new AbortController;let{signal:u}=this.#f;if(t>Ch.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");let f=this._scrollMode=rt.PAGE;a.dispatch("scrollmodechanged",{source:this,mode:f})}this._pagesCapability.promise.then(()=>{a.dispatch("pagesloaded",{source:this,pagesCount:t})},()=>{});let c=f=>{let h=this._pages[f.pageNumber-1];h&&this.#e.push(h)};a._on("pagerender",c,{signal:u});let d=f=>{f.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:f.timestamp}),a._off("pagerendered",d))};a._on("pagerendered",d,{signal:u}),Promise.all([r,s]).then(([f,h])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(f),this._optionalContentConfigPromise=i;let{annotationEditorMode:p,annotationMode:g,textLayerMode:m}=this.#T(h);if(m!==di.DISABLE){let b=this.#m=document.createElement("div");b.id="hiddenCopyElement",l.before(b)}if(typeof AbortSignal.any=="function"&&p!==lr.DISABLE){let b=p;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):US(b)?(this.#i=new lV(this.container,l,this.#t,a,e,o,this.#n,this.#u,this.#d,this.#a,this.#p),a.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#i}),b!==lr.NONE&&(b===lr.STAMP&&this.#p?.loadModel("altText"),this.#i.updateMode(b))):console.error(`Invalid AnnotationEditor mode: ${b}`)}let v=this._scrollMode===rt.PAGE?null:l,x=this.currentScale,_=f.getViewport({scale:x*Gi.PDF_TO_CSS_UNITS});l.style.setProperty("--scale-factor",_.scale),o?.background&&l.style.setProperty("--page-bg-color",o.background),(o?.foreground==="CanvasText"||o?.background==="Canvas")&&(l.style.setProperty("--hcm-highlight-filter",e.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),l.style.setProperty("--hcm-highlight-selected-filter",e.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let b=1;b<=t;++b){let D=new Oh({container:v,eventBus:a,id:b,scale:x,defaultViewport:_.clone(),optionalContentConfigPromise:i,renderingQueue:this.renderingQueue,textLayerMode:m,annotationMode:g,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:o,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#c});this._pages.push(D)}this._pages[0]?.setPdfPage(f),this._scrollMode===rt.PAGE?this.#S():this._spreadMode!==bn.NONE&&this._updateSpreadMode(),this.#A(u).then(()=>ee(this,null,function*(){if(e!==this.pdfDocument)return;if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#m&&document.addEventListener("copy",this.#D.bind(this,m),{signal:u}),this.#i&&a.dispatch("annotationeditormodechanged",{source:this,mode:this.#r}),e.loadingParams.disableAutoFetch||t>Ch.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let b=t-1;if(b<=0){this._pagesCapability.resolve();return}for(let D=2;D<=t;++D){let A=e.getPage(D).then(w=>{let T=this._pages[D-1];T.pdfPage||T.setPdfPage(w),--b===0&&this._pagesCapability.resolve()},w=>{console.error(`Unable to get page ${D} to initialize viewer`,w),--b===0&&this._pagesCapability.resolve()});D%Ch.PAUSE_EAGER_PAGE_INIT===0&&(yield A)}})),a.dispatch("pagesinit",{source:this}),e.getMetadata().then(({info:b})=>{e===this.pdfDocument&&b.Language&&(l.lang=b.Language)}),this.defaultRenderingQueue&&this.update()}).catch(f=>{console.error("Unable to initialize viewer",f),this._pagesCapability.reject(f)})}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let t=0,r=this._pages.length;t<r;t++)this._pages[t].setPageLabel(this._pageLabels?.[t]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=X_,this._currentScaleValue=null,this._pageLabels=null,this.#e=new Dx(jS),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=rt.VERTICAL,this._previousScrollMode=rt.UNKNOWN,this._spreadMode=bn.NONE,this.#w={previousPageNumber:1,scrollDown:!0,pages:[]},this.#f?.abort(),this.#f=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#m?.remove(),this.#m=null,this.#V()}#S(){if(this._scrollMode!==rt.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");let e=this._currentPageNumber,t=this.#w,r=this.viewer;if(r.textContent="",t.pages.length=0,this._spreadMode===bn.NONE&&!this.isInPresentationMode){let i=this._pages[e-1];r.append(i.div),t.pages.push(i)}else{let i=new Set,s=this._spreadMode-1;s===-1?i.add(e-1):e%2!==s?(i.add(e-1),i.add(e)):(i.add(e-2),i.add(e-1));let a=document.createElement("div");if(a.className="spread",this.isInPresentationMode){let o=document.createElement("div");o.className="dummyPage",a.append(o)}for(let o of i){let l=this._pages[o];l&&(a.append(l.div),t.pages.push(l))}r.append(a)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){this.pagesCount!==0&&this.update()}#M(e,t=null){let{div:r,id:i}=e;if(this._currentPageNumber!==i&&this._setCurrentPageNumber(i),this._scrollMode===rt.PAGE&&(this.#S(),this.update()),!t&&!this.isInPresentationMode){let s=r.offsetLeft+r.clientLeft,a=s+r.clientWidth,{scrollLeft:o,clientWidth:l}=this.container;(this._scrollMode===rt.HORIZONTAL||s<o||a>o+l)&&(t={left:0,top:0})}$S(r,t),!this._currentScaleValue&&this._location&&(this._location=null)}#P(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#C(e,t,{noScroll:r=!1,preset:i=!1,drawingDelay:s=-1,origin:a=null}){if(this._currentScaleValue=t.toString(),this.#P(e)){i&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t});return}this.viewer.style.setProperty("--scale-factor",e*Gi.PDF_TO_CSS_UNITS);let o=s>=0&&s<1e3;this.refresh(!0,{scale:e,drawingDelay:o?s:-1}),o&&(this.#b=setTimeout(()=>{this.#b=null,this.refresh()},s));let l=this._currentScale;if(this._currentScale=e,!r){let u=this._currentPageNumber,c;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(u=this._location.pageNumber,c=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:u,destArray:c,allowNegativeOffset:!0}),Array.isArray(a)){let d=e/l-1,[f,h]=this.containerTopLeft;this.container.scrollLeft+=(a[0]-h)*d,this.container.scrollTop+=(a[1]-f)*d}}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:i?t:void 0}),this.defaultRenderingQueue&&this.update()}get#x(){return this._spreadMode!==bn.NONE&&this._scrollMode!==rt.HORIZONTAL?2:1}#I(e,t){let r=parseFloat(e);if(r>0)t.preset=!1,this.#C(r,e,t);else{let i=this._pages[this._currentPageNumber-1];if(!i)return;let s=uS,a=dS;this.isInPresentationMode?(s=a=4,this._spreadMode!==bn.NONE&&(s*=2)):this.removePageBorders?s=a=0:this._scrollMode===rt.HORIZONTAL&&([s,a]=[a,s]);let o=(this.container.clientWidth-s)/i.width*i.scale/this.#x,l=(this.container.clientHeight-a)/i.height*i.scale;switch(e){case"page-actual":r=1;break;case"page-width":r=o;break;case"page-height":r=l;break;case"page-fit":r=Math.min(o,l);break;case"auto":let u=pS(i)?o:Math.min(l,o);r=Math.min(I8,u);break;default:console.error(`#setScale: "${e}" is an unknown zoom value.`);return}t.preset=!0,this.#C(r,e,t)}}#F(){let e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#I(this._currentScaleValue,{noScroll:!0}),this.#M(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;let t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:r=!1,ignoreDestinationZoom:i=!1}){if(!this.pdfDocument)return;let s=Number.isInteger(e)&&this._pages[e-1];if(!s){console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!t){this._setCurrentPageNumber(e,!0);return}let a=0,o=0,l=0,u=0,c,d,f=s.rotation%180!==0,h=(f?s.height:s.width)/s.scale/Gi.PDF_TO_CSS_UNITS,p=(f?s.width:s.height)/s.scale/Gi.PDF_TO_CSS_UNITS,g=0;switch(t[1].name){case"XYZ":a=t[2],o=t[3],g=t[4],a=a!==null?a:0,o=o!==null?o:p;break;case"Fit":case"FitB":g="page-fit";break;case"FitH":case"FitBH":o=t[2],g="page-width",o===null&&this._location?(a=this._location.left,o=this._location.top):(typeof o!="number"||o<0)&&(o=p);break;case"FitV":case"FitBV":a=t[2],l=h,u=p,g="page-height";break;case"FitR":a=t[2],o=t[3],l=t[4]-a,u=t[5]-o;let _=uS,b=dS;this.removePageBorders&&(_=b=0),c=(this.container.clientWidth-_)/l/Gi.PDF_TO_CSS_UNITS,d=(this.container.clientHeight-b)/u/Gi.PDF_TO_CSS_UNITS,g=Math.min(Math.abs(c),Math.abs(d));break;default:console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`);return}if(i||(g&&g!==this._currentScale?this.currentScaleValue=g:this._currentScale===X_&&(this.currentScaleValue=S8)),g==="page-fit"&&!t[4]){this.#M(s);return}let m=[s.viewport.convertToViewportPoint(a,o),s.viewport.convertToViewportPoint(a+l,o+u)],v=Math.min(m[0][0],m[1][0]),x=Math.min(m[0][1],m[1][1]);r||(v=Math.max(v,0),x=Math.max(x,0)),this.#M(s,{left:v,top:x})}_updateLocation(e){let t=this._currentScale,r=this._currentScaleValue,i=parseFloat(r)===t?Math.round(t*1e4)/100:r,s=e.id,a=this._pages[s-1],o=this.container,l=a.getPagePoint(o.scrollLeft-e.x,o.scrollTop-e.y),u=Math.round(l[0]),c=Math.round(l[1]),d=`#page=${s}`;this.isInPresentationMode||(d+=`&zoom=${i},${u},${c}`),this._location={pageNumber:s,scale:i,top:c,left:u,rotation:this._pagesRotation,pdfOpenParams:d}}update(){let e=this._getVisiblePages(),t=e.views,r=t.length;if(r===0)return;let i=Math.max(jS,2*r+1);this.#e.resize(i,e.ids),this.renderingQueue.renderHighestPriority(e);let s=this._spreadMode===bn.NONE&&(this._scrollMode===rt.PAGE||this._scrollMode===rt.VERTICAL),a=this._currentPageNumber,o=!1;for(let l of t){if(l.percent<100)break;if(l.id===a&&s){o=!0;break}}this._setCurrentPageNumber(o?a:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#L(){let e=this._getVisiblePages(),t=[],{ids:r,views:i}=e;for(let s of i){let{view:a}=s;if(!a.hasEditableAnnotations()){r.delete(a.id);continue}t.push(s)}return t.length===0?null:(this.renderingQueue.renderHighestPriority({first:t[0],last:t.at(-1),views:t,ids:r}),r)}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===Do.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===Do.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){let e=this._scrollMode===rt.PAGE?this.#w.pages:this._pages,t=this._scrollMode===rt.HORIZONTAL,r=t&&this._isContainerRtl;return F8({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:r})}cleanup(){for(let e of this._pages)e.renderingState!==Rt.FINISHED&&e.reset()}_cancelRendering(){for(let e of this._pages)e.cancelRendering()}#U(e){return ee(this,null,function*(){if(e.pdfPage)return e.pdfPage;try{let t=yield this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),t}catch(t){return console.error("Unable to get page for page view",t),null}})}#j(e){if(e.first?.id===1)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case rt.PAGE:return this.#w.scrollDown;case rt.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){let t=e||this._getVisiblePages(),r=this.#j(t),i=this._spreadMode!==bn.NONE&&this._scrollMode!==rt.HORIZONTAL,s=this.renderingQueue.getHighestPriority(t,this._pages,r,i);return s?(this.#U(s).then(()=>{this.renderingQueue.renderView(s)}),!0):!1}get hasEqualPageSizes(){let e=this._pages[0];for(let t=1,r=this._pages.length;t<r;++t){let i=this._pages[t];if(i.width!==e.width||i.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map(t=>{let r=t.pdfPage.getViewport({scale:1}),i=pS(r);if(e===void 0)e=i;else if(this.enablePrintAutoRotate&&i!==e)return{width:r.height,height:r.width,rotation:(r.rotation-90)%360};return{width:r.width,height:r.height,rotation:r.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!P8(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>Ch.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){let t=this._scrollMode,r=this.viewer;r.classList.toggle("scrollHorizontal",t===rt.HORIZONTAL),r.classList.toggle("scrollWrapped",t===rt.WRAPPED),!(!this.pdfDocument||!e)&&(t===rt.PAGE?this.#S():this._previousScrollMode===rt.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!R8(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;let t=this.viewer,r=this._pages;if(this._scrollMode===rt.PAGE)this.#S();else if(t.textContent="",this._spreadMode===bn.NONE)for(let i of this._pages)t.append(i.div);else{let i=this._spreadMode-1,s=null;for(let a=0,o=r.length;a<o;++a)s===null?(s=document.createElement("div"),s.className="spread",t.append(s)):a%2===i&&(s=s.cloneNode(!1),t.append(s)),s.append(r[a].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case rt.WRAPPED:{let{views:r}=this._getVisiblePages(),i=new Map;for(let{id:s,y:a,percent:o,widthPercent:l}of r){if(o===0||l<100)continue;let u=i.get(a);u||i.set(a,u||=[]),u.push(s)}for(let s of i.values()){let a=s.indexOf(e);if(a===-1)continue;let o=s.length;if(o===1)break;if(t)for(let l=a-1,u=0;l>=u;l--){let c=s[l],d=s[l+1]-1;if(c<d)return e-d}else for(let l=a+1,u=o;l<u;l++){let c=s[l],d=s[l-1]+1;if(c>d)return d-e}if(t){let l=s[0];if(l<e)return e-l+1}else{let l=s[o-1];if(l>e)return l-e+1}break}break}case rt.HORIZONTAL:break;case rt.PAGE:case rt.VERTICAL:{if(this._spreadMode===bn.NONE)break;let r=this._spreadMode-1;if(t&&e%2!==r)break;if(!t&&e%2===r)break;let{views:i}=this._getVisiblePages(),s=t?e-1:e+1;for(let{id:a,percent:o,widthPercent:l}of i)if(a===s){if(o>0&&l===100)return 2;break}break}}return 1}nextPage(){let e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;let r=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+r,t),!0}previousPage(){let e=this._currentPageNumber;if(e<=1)return!1;let t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}updateScale({drawingDelay:e,scaleFactor:t=null,steps:r=null,origin:i}){if(r===null&&t===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let s=this._currentScale;if(t>0&&t!==1)s=Math.round(s*t*100)/100;else if(r){let a=r>0?cS:1/cS,o=r>0?Math.ceil:Math.floor;r=Math.abs(r);do s=o((s*a).toFixed(2)*10)/10;while(--r>0)}s=Math.max(T8,Math.min(D8,s)),this.#I(s,{noScroll:!1,drawingDelay:e,origin:i})}increaseScale(e={}){this.updateScale(Ke(ce({},e),{steps:e.steps??1}))}decreaseScale(e={}){this.updateScale(Ke(ce({},e),{steps:-(e.steps??1)}))}#O(e=this.container.clientHeight){e!==this.#y&&(this.#y=e,N8.setProperty("--viewer-container-height",`${e}px`))}#B(e){for(let t of e)if(t.target===this.container){this.#O(Math.floor(t.borderBoxSize[0].blockSize)),this.#l=null;break}}get containerTopLeft(){return this.#l||=[this.container.offsetTop,this.container.offsetLeft]}#V(){this.#h?.abort(),this.#h=null,this.#g!==null&&(clearTimeout(this.#g),this.#g=null)}get annotationEditorMode(){return this.#i?this.#r:lr.DISABLE}set annotationEditorMode({mode:e,editId:t=null,isFromKeyboard:r=!1}){if(!this.#i)throw new Error("The AnnotationEditor is not enabled.");if(this.#r===e)return;if(!US(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);if(!this.pdfDocument)return;e===lr.STAMP&&this.#p?.loadModel("altText");let{eventBus:i}=this,s=()=>{this.#V(),this.#r=e,this.#i.updateMode(e,t,r),i.dispatch("annotationeditormodechanged",{source:this,mode:e})};if(e===lr.NONE||this.#r===lr.NONE){let a=e!==lr.NONE;a||this.pdfDocument.annotationStorage.resetModifiedIds();for(let l of this._pages)l.toggleEditingMode(a);let o=this.#L();if(a&&o){this.#V(),this.#h=new AbortController;let l=AbortSignal.any([this.#f.signal,this.#h.signal]);i._on("pagerendered",({pageNumber:u})=>{o.delete(u),o.size===0&&(this.#g=setTimeout(s,0))},{signal:l});return}}s()}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(let r of this._pages)r.update(t);this.#b!==null&&(clearTimeout(this.#b),this.#b=null),e||this.update()}}},Ix=class extends Lh{_resetView(){super._resetView(),this._scrollMode=rt.PAGE,this._spreadMode=bn.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}};var f6=Mt.AnnotationLayerBuilder,h6=Mt.DownloadManager,p6=Mt.EventBus,g6=Mt.FindState,kx=Mt.GenericL10n,ma=Mt.LinkTarget,Mx=Mt.PDFFindController,m6=Mt.PDFHistory,Fx=Mt.PDFLinkService,v6=Mt.PDFPageView,_6=Mt.PDFScriptingManager,Px=Mt.PDFSinglePageViewer,Rx=Mt.PDFViewer,x6=Mt.ProgressBar,y6=Mt.RenderingStates,w6=Mt.ScrollMode,b6=Mt.SimpleLinkService,E6=Mt.SpreadMode,A6=Mt.StructTreeLayerBuilder,C6=Mt.TextLayerBuilder,S6=Mt.XfaLayerBuilder,T6=Mt.parseQueryString;var D6=["pdfViewerContainer"];function I6(n,e){let t=new n.EventBus;return k6(t,e),t}function k6(n,e){St(n,"documentload").pipe(xt(e)).subscribe(()=>{let t=document.createEvent("CustomEvent");t.initCustomEvent("documentload",!0,!0,{}),window.dispatchEvent(t)}),St(n,"pagerendered").pipe(xt(e)).subscribe(({pageNumber:t,cssTransform:r,source:i})=>{let s=document.createEvent("CustomEvent");s.initCustomEvent("pagerendered",!0,!0,{pageNumber:t,cssTransform:r}),i.div.dispatchEvent(s)}),St(n,"textlayerrendered").pipe(xt(e)).subscribe(({pageNumber:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("textlayerrendered",!0,!0,{pageNumber:t}),r.textLayerDiv?.dispatchEvent(i)}),St(n,"pagechanging").pipe(xt(e)).subscribe(({pageNumber:t,source:r})=>{let i=document.createEvent("UIEvents");i.initEvent("pagechanging",!0,!0),i.pageNumber=t,r.container.dispatchEvent(i)}),St(n,"pagesinit").pipe(xt(e)).subscribe(({source:t})=>{let r=document.createEvent("CustomEvent");r.initCustomEvent("pagesinit",!0,!0,null),t.container.dispatchEvent(r)}),St(n,"pagesloaded").pipe(xt(e)).subscribe(({pagesCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("pagesloaded",!0,!0,{pagesCount:t}),r.container.dispatchEvent(i)}),St(n,"scalechange").pipe(xt(e)).subscribe(({scale:t,presetValue:r,source:i})=>{let s=document.createEvent("UIEvents");s.initEvent("scalechange",!0,!0),s.scale=t,s.presetValue=r,i.container.dispatchEvent(s)}),St(n,"updateviewarea").pipe(xt(e)).subscribe(({location:t,source:r})=>{let i=document.createEvent("UIEvents");i.initEvent("updateviewarea",!0,!0),i.location=t,r.container.dispatchEvent(i)}),St(n,"find").pipe(xt(e)).subscribe(({source:t,type:r,query:i,phraseSearch:s,caseSensitive:a,highlightAll:o,findPrevious:l})=>{if(t===window)return;let u=document.createEvent("CustomEvent");u.initCustomEvent("find"+r,!0,!0,{query:i,phraseSearch:s,caseSensitive:a,highlightAll:o,findPrevious:l}),window.dispatchEvent(u)}),St(n,"attachmentsloaded").pipe(xt(e)).subscribe(({attachmentsCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("attachmentsloaded",!0,!0,{attachmentsCount:t}),r.container.dispatchEvent(i)}),St(n,"sidebarviewchanged").pipe(xt(e)).subscribe(({view:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("sidebarviewchanged",!0,!0,{view:t}),r.outerContainer.dispatchEvent(i)}),St(n,"pagemode").pipe(xt(e)).subscribe(({mode:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("pagemode",!0,!0,{mode:t}),r.pdfViewer.container.dispatchEvent(i)}),St(n,"namedaction").pipe(xt(e)).subscribe(({action:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("namedaction",!0,!0,{action:t}),r.pdfViewer.container.dispatchEvent(i)}),St(n,"presentationmodechanged").pipe(xt(e)).subscribe(({active:t,switchInProgress:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("presentationmodechanged",!0,!0,{active:t,switchInProgress:r}),window.dispatchEvent(i)}),St(n,"outlineloaded").pipe(xt(e)).subscribe(({outlineCount:t,source:r})=>{let i=document.createEvent("CustomEvent");i.initCustomEvent("outlineloaded",!0,!0,{outlineCount:t}),r.container.dispatchEvent(i)})}function Ox(n,e,t){n[e]=t}function Tc(){return typeof window>"u"}Tc()||Ox(To,"verbosity",G_.INFOS);typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let n,e;return{promise:new Promise((r,i)=>{n=r,e=i}),resolve:n,reject:e}});var Lx=function(n){return n[n.DISABLED=0]="DISABLED",n[n.ENABLED=1]="ENABLED",n[n.ENHANCED=2]="ENHANCED",n}(Lx||{}),qt=(()=>{class n{element;ngZone;static CSS_UNITS=96/72;static BORDER_WIDTH=9;pdfViewerContainer;eventBus;pdfLinkService;pdfFindController;pdfViewer;isVisible=!1;_cMapsUrl=typeof To<"u"?`https://unpkg.com/pdfjs-dist@${yc}/cmaps/`:null;_imageResourcesPath=typeof To<"u"?`https://unpkg.com/pdfjs-dist@${yc}/web/images/`:void 0;_renderText=!0;_renderTextMode=Lx.ENABLED;_stickToPage=!1;_originalSize=!0;_pdf;_page=1;_zoom=1;_zoomScale="page-width";_rotation=0;_showAll=!0;_canAutoResize=!0;_fitToPage=!1;_externalLinkTarget="blank";_showBorders=!1;lastLoaded;_latestScrolledPage;pageScrollTimeout=null;isInitialized=!1;loadingTask;destroy$=new on;afterLoadComplete=new Et;pageRendered=new Et;pageInitialized=new Et;textLayerRendered=new Et;onError=new Et;onProgress=new Et;pageChange=new Et(!0);src;set cMapsUrl(t){this._cMapsUrl=t}set page(t){t=parseInt(t,10)||1;let r=t;this._pdf&&(t=this.getValidPageNumber(t)),this._page=t,r!==t&&this.pageChange.emit(t)}set renderText(t){this._renderText=t}set renderTextMode(t){this._renderTextMode=t}set originalSize(t){this._originalSize=t}set showAll(t){this._showAll=t}set stickToPage(t){this._stickToPage=t}set zoom(t){t<=0||(this._zoom=t)}get zoom(){return this._zoom}set zoomScale(t){this._zoomScale=t}get zoomScale(){return this._zoomScale}set rotation(t){if(!(typeof t=="number"&&t%90===0)){console.warn("Invalid pages rotation angle.");return}this._rotation=t}set externalLinkTarget(t){this._externalLinkTarget=t}set autoresize(t){this._canAutoResize=!!t}set fitToPage(t){this._fitToPage=!!t}set showBorders(t){this._showBorders=!!t}static getLinkTarget(t){switch(t){case"blank":return ma.BLANK;case"none":return ma.NONE;case"self":return ma.SELF;case"parent":return ma.PARENT;case"top":return ma.TOP}return null}constructor(t,r){if(this.element=t,this.ngZone=r,Tc())return;let i,s=yc,a=window[`pdfWorkerSrc${s}`];a?i=a:window.hasOwnProperty("pdfWorkerSrc")&&typeof window.pdfWorkerSrc=="string"&&window.pdfWorkerSrc?i=window.pdfWorkerSrc:i=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${s}/legacy/build/pdf.worker.min.mjs`,Ox(z_,"workerSrc",i)}ngAfterViewChecked(){if(this.isInitialized)return;let t=this.pdfViewerContainer.nativeElement.offsetParent;if(this.isVisible===!0&&t==null){this.isVisible=!1;return}this.isVisible===!1&&t!=null&&(this.isVisible=!0,setTimeout(()=>{this.initialize(),this.ngOnChanges({src:this.src})}))}ngOnInit(){this.initialize(),this.setupResizeListener()}ngOnDestroy(){this.clear(),this.destroy$.next(),this.loadingTask=null}ngOnChanges(t){if(!(Tc()||!this.isVisible)){if("src"in t)this.loadPDF();else if(this._pdf){if(("renderText"in t||"showAll"in t)&&(this.setupViewer(),this.resetPdfDocument()),"page"in t){let{page:r}=t;if(r.currentValue===this._latestScrolledPage)return;this.pdfViewer.scrollPageIntoView({pageNumber:this._page})}this.update()}}}updateSize(){_t(this._pdf.getPage(this.pdfViewer.currentPageNumber)).pipe(xt(this.destroy$)).subscribe({next:t=>{let r=this._rotation+t.rotate,i=t.getViewport({scale:this._zoom,rotation:r}).width*n.CSS_UNITS,s=this._zoom,a=!0;if(!this._originalSize||this._fitToPage&&i>this.pdfViewerContainer.nativeElement.clientWidth){let o=t.getViewport({scale:1,rotation:r});s=this.getScale(o.width,o.height),a=!this._stickToPage}this.pdfViewer.currentScale=s,a&&this.pdfViewer.scrollPageIntoView({pageNumber:t.pageNumber,ignoreDestinationZoom:!0})}})}clear(){this.loadingTask&&!this.loadingTask.destroyed&&this.loadingTask.destroy(),this._pdf&&(this._latestScrolledPage=0,this._pdf.destroy(),this._pdf=void 0),this.pdfViewer&&this.pdfViewer.setDocument(null),this.pdfLinkService&&this.pdfLinkService.setDocument(null,null),this.pdfFindController&&this.pdfFindController.setDocument(null)}getPDFLinkServiceConfig(){let t=n.getLinkTarget(this._externalLinkTarget);return t?{externalLinkTarget:t}:{}}initEventBus(){this.eventBus=I6(Nx,this.destroy$),St(this.eventBus,"pagerendered").pipe(xt(this.destroy$)).subscribe(t=>{this.pageRendered.emit(t)}),St(this.eventBus,"pagesinit").pipe(xt(this.destroy$)).subscribe(t=>{this.pageInitialized.emit(t)}),St(this.eventBus,"pagechanging").pipe(xt(this.destroy$)).subscribe(({pageNumber:t})=>{this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.pageScrollTimeout=window.setTimeout(()=>{this._latestScrolledPage=t,this.pageChange.emit(t)},100)}),St(this.eventBus,"textlayerrendered").pipe(xt(this.destroy$)).subscribe(t=>{this.textLayerRendered.emit(t)})}initPDFServices(){this.pdfLinkService=new Fx(ce({eventBus:this.eventBus},this.getPDFLinkServiceConfig())),this.pdfFindController=new Mx({eventBus:this.eventBus,linkService:this.pdfLinkService})}getPDFOptions(){return{eventBus:this.eventBus,container:this.element.nativeElement.querySelector("div"),removePageBorders:!this._showBorders,linkService:this.pdfLinkService,textLayerMode:this._renderText?this._renderTextMode:Lx.DISABLED,findController:this.pdfFindController,l10n:new kx("en"),imageResourcesPath:this._imageResourcesPath,annotationEditorMode:W_.DISABLE}}setupViewer(){this.pdfViewer&&this.pdfViewer.setDocument(null),Ox(To,"disableTextLayer",!this._renderText),this.initPDFServices(),this._showAll?this.pdfViewer=new Rx(this.getPDFOptions()):this.pdfViewer=new Px(this.getPDFOptions()),this.pdfLinkService.setViewer(this.pdfViewer),this.pdfViewer._currentPageNumber=this._page}getValidPageNumber(t){return t<1?1:t>this._pdf.numPages?this._pdf.numPages:t}getDocumentParams(){let t=typeof this.src;if(!this._cMapsUrl)return this.src;let r={cMapUrl:this._cMapsUrl,cMapPacked:!0,enableXfa:!0};return r.isEvalSupported=!1,t==="string"?r.url=this.src:t==="object"&&(this.src.byteLength!==void 0?r.data=this.src:Object.assign(r,this.src)),r}loadPDF(){if(!this.src)return;if(this.lastLoaded===this.src){this.update();return}this.clear(),this.setupViewer(),this.loadingTask=q_(this.getDocumentParams()),this.loadingTask.onProgress=r=>{this.onProgress.emit(r)};let t=this.src;_t(this.loadingTask.promise).pipe(xt(this.destroy$)).subscribe({next:r=>{this._pdf=r,this.lastLoaded=t,this.afterLoadComplete.emit(r),this.resetPdfDocument(),this.update()},error:r=>{this.lastLoaded=null,this.onError.emit(r)}})}update(){this.page=this._page,this.render()}render(){if(this._page=this.getValidPageNumber(this._page),(this._rotation!==0||this.pdfViewer.pagesRotation!==this._rotation)&&this.pdfViewer.firstPagePromise?.then(()=>this.pdfViewer.pagesRotation=this._rotation),this._stickToPage&&setTimeout(()=>{this.pdfViewer.currentPageNumber=this._page}),this.pdfViewer._pages?.length)this.updateSize();else{let t=this.pageInitialized.subscribe(()=>{this.updateSize(),t.unsubscribe()})}}getScale(t,r){let i=this._showBorders?2*n.BORDER_WIDTH:0,s=this.pdfViewerContainer.nativeElement.clientWidth-i,a=this.pdfViewerContainer.nativeElement.clientHeight-i;if(a===0||r===0||s===0||t===0)return 1;let o=1;switch(this._zoomScale){case"page-fit":o=Math.min(a/r,s/t);break;case"page-height":o=a/r;break;case"page-width":default:o=s/t;break}return this._zoom*o/n.CSS_UNITS}resetPdfDocument(){this.pdfLinkService.setDocument(this._pdf,null),this.pdfFindController.setDocument(this._pdf),this.pdfViewer.setDocument(this._pdf)}initialize(){Tc()||!this.isVisible||(this.isInitialized=!0,this.initEventBus(),this.setupViewer())}setupResizeListener(){Tc()||this.ngZone.runOutsideAngular(()=>{St(window,"resize").pipe(Fp(100),Wn(()=>this._canAutoResize&&!!this._pdf),xt(this.destroy$)).subscribe(()=>{this.updateSize()})})}static \u0275fac=function(r){return new(r||n)(Ce(Rn),Ce(At))};static \u0275cmp=Oe({type:n,selectors:[["pdf-viewer"]],viewQuery:function(r,i){if(r&1&&FE(D6,5),r&2){let s;Gg(s=qg())&&(i.pdfViewerContainer=s.first)}},inputs:{src:"src",cMapsUrl:[gt.None,"c-maps-url","cMapsUrl"],page:"page",renderText:[gt.None,"render-text","renderText"],renderTextMode:[gt.None,"render-text-mode","renderTextMode"],originalSize:[gt.None,"original-size","originalSize"],showAll:[gt.None,"show-all","showAll"],stickToPage:[gt.None,"stick-to-page","stickToPage"],zoom:"zoom",zoomScale:[gt.None,"zoom-scale","zoomScale"],rotation:"rotation",externalLinkTarget:[gt.None,"external-link-target","externalLinkTarget"],autoresize:"autoresize",fitToPage:[gt.None,"fit-to-page","fitToPage"],showBorders:[gt.None,"show-borders","showBorders"]},outputs:{afterLoadComplete:"after-load-complete",pageRendered:"page-rendered",pageInitialized:"pages-initialized",textLayerRendered:"text-layer-rendered",onError:"error",onProgress:"on-progress",pageChange:"pageChange"},features:[ii],decls:3,vars:0,consts:[["pdfViewerContainer",""],[1,"ng2-pdf-viewer-container"],[1,"pdfViewer"]],template:function(r,i){r&1&&(B(0,"div",1,0),re(2,"div",2),V())},styles:[`.ng2-pdf-viewer-container[_ngcontent-%COMP%]{overflow-x:auto;position:absolute;height:100%;width:100%;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 0;--page-margin: 1px auto -8px;--page-border: 9px solid transparent;--spreadHorizontalWrapped-margin-LR: -3.5px;--viewer-container-height: 0;--annotation-unfocused-field-background: url("data:image/svg+xml;charset=UTF-8,<svg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'><rect width='100%' height='100%' style='fill:rgba(0, 54, 255, 0.13);'/></svg>");--xfa-unfocused-field-background: var( --annotation-unfocused-field-background );--page-border-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA1ElEQVQ4jbWUWw6EIAxFy2NFs/8NzR4UJhpqLsdi5mOmSSMUOfYWqv3S0gMr4XlYH/64gZa/gN3ANYA7KAXALt4ktoQ5MI9YxqaG8bWmsIysMuT6piSQCa4whZThCu8CM4zP9YJaKci9jicPq3NcBWYoPMGUlhG7ivtkB+gVyFY75wXghOvh8t5mto1Mdim6e+MBqH6XsY+YAwjpq3vGF7weTWQptLEDVCZvPTMl5JZZsdh47FHW6qFMyvLYqjcnmdFfY9Xk/KDOlzCusX2mi/ofM7MPkzBcSp4Q1/wAAAAASUVORK5CYII=) 9 9 repeat;--scale-factor: 1;--focus-outline: solid 2px blue;--hover-outline: dashed 2px blue;--freetext-line-height: 1.35;--freetext-padding: 2px;--editorInk-editing-cursor: pointer}@media screen and (forced-colors: active){[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 9px;--page-margin: 8px auto -1px;--page-border: 1px solid CanvasText;--page-border-image: none;--spreadHorizontalWrapped-margin-LR: 3.5px}}@media (forced-colors: active){[_nghost-%COMP%]    {--focus-outline: solid 3px ButtonText;--hover-outline: dashed 3px ButtonText}}[_nghost-%COMP%]     .textLayer{position:absolute;text-align:initial;inset:0;overflow:hidden;opacity:.2;line-height:1;-webkit-text-size-adjust:none;text-size-adjust:none;forced-color-adjust:none;transform-origin:0 0}[_nghost-%COMP%]     .textLayer span, [_nghost-%COMP%]     .textLayer br{color:transparent;position:absolute;white-space:pre;cursor:text;transform-origin:0% 0%}[_nghost-%COMP%]     .textLayer span.markedContent{top:0;height:0}[_nghost-%COMP%]     .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}[_nghost-%COMP%]     .textLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .textLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .textLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .textLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .textLayer .highlight.selected{background-color:#006400}[_nghost-%COMP%]     .textLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .textLayer br::selection{background:transparent}[_nghost-%COMP%]     .textLayer .endOfContent{display:block;position:absolute;inset:100% 0 0;z-index:-1;cursor:default;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .textLayer .endOfContent.active{top:0}@media (forced-colors: active){[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .annotationLayer{position:absolute;top:0;left:0;pointer-events:none;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer section{position:absolute;text-align:initial;pointer-events:auto;box-sizing:border-box;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>canvas{width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a:hover{opacity:.2;background:rgb(255,255,0);box-shadow:0 2px 10px #ff0}[_nghost-%COMP%]     .annotationLayer .textAnnotation img{position:absolute;cursor:pointer;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{background-image:var(--annotation-unfocused-field-background);border:1px solid transparent;box-sizing:border-box;font:calc(9px * var(--scale-factor)) sans-serif;height:100%;margin:0;vertical-align:top;width:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid red}[_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select option{padding:0}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{border-radius:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea{resize:none}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input[disabled], [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea[disabled], [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input[disabled]{background:none;border:1px solid transparent;cursor:not-allowed}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:hover, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:hover, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:hover{border:1px solid rgb(0,0,0)}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:focus{background:none;border:1px solid transparent}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input :focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea :focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton :focus{background-image:none;background-color:transparent;outline:auto}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{background-color:CanvasText;content:"";display:block;position:absolute}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{height:80%;left:45%;width:1px}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before{transform:rotate(45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{transform:rotate(-45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{border-radius:50%;height:50%;left:30%;top:20%;width:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb{font-family:monospace;padding-left:2px;padding-right:0}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb:focus{width:103%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .annotationLayer .popupTriggerArea{height:100%;width:100%}[_nghost-%COMP%]     .annotationLayer .popupWrapper{position:absolute;font-size:calc(9px * var(--scale-factor));width:100%;min-width:calc(180px * var(--scale-factor));pointer-events:none}[_nghost-%COMP%]     .annotationLayer .popup{position:absolute;max-width:calc(180px * var(--scale-factor));background-color:#ff9;box-shadow:0 calc(2px * var(--scale-factor)) calc(5px * var(--scale-factor)) #888;border-radius:calc(2px * var(--scale-factor));padding:calc(6px * var(--scale-factor));margin-left:calc(5px * var(--scale-factor));cursor:pointer;font:message-box;white-space:normal;word-wrap:break-word;pointer-events:auto}[_nghost-%COMP%]     .annotationLayer .popup>*{font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popup h1{display:inline-block}[_nghost-%COMP%]     .annotationLayer .popupDate{display:inline-block;margin-left:calc(5px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popupContent{border-top:1px solid rgb(51,51,51);margin-top:calc(2px * var(--scale-factor));padding-top:calc(2px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .richText>*{white-space:pre-wrap;font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .highlightAnnotation, [_nghost-%COMP%]     .annotationLayer .underlineAnnotation, [_nghost-%COMP%]     .annotationLayer .squigglyAnnotation, [_nghost-%COMP%]     .annotationLayer .strikeoutAnnotation, [_nghost-%COMP%]     .annotationLayer .freeTextAnnotation, [_nghost-%COMP%]     .annotationLayer .lineAnnotation svg line, [_nghost-%COMP%]     .annotationLayer .squareAnnotation svg rect, [_nghost-%COMP%]     .annotationLayer .circleAnnotation svg ellipse, [_nghost-%COMP%]     .annotationLayer .polylineAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .polygonAnnotation svg polygon, [_nghost-%COMP%]     .annotationLayer .caretAnnotation, [_nghost-%COMP%]     .annotationLayer .inkAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .stampAnnotation, [_nghost-%COMP%]     .annotationLayer .fileAttachmentAnnotation{cursor:pointer}[_nghost-%COMP%]     .annotationLayer section svg{position:absolute;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .annotationTextContent{position:absolute;width:100%;height:100%;opacity:0;color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none}[_nghost-%COMP%]     .annotationLayer .annotationTextContent span{width:100%;display:inline-block}@media (forced-colors: active){[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .xfaLayer .highlight{margin:-1px;padding:1px;background-color:#efcbed;border-radius:4px}[_nghost-%COMP%]     .xfaLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .xfaLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .xfaLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .xfaLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .xfaLayer .highlight.selected{background-color:#cbdfcb}[_nghost-%COMP%]     .xfaLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .xfaPage{overflow:hidden;position:relative}[_nghost-%COMP%]     .xfaContentarea{position:absolute}[_nghost-%COMP%]     .xfaPrintOnly{display:none}[_nghost-%COMP%]     .xfaLayer{position:absolute;text-align:initial;top:0;left:0;transform-origin:0 0;line-height:1.2}[_nghost-%COMP%]     .xfaLayer *{color:inherit;font:inherit;font-style:inherit;font-weight:inherit;font-kerning:inherit;letter-spacing:-.01px;text-align:inherit;text-decoration:inherit;box-sizing:border-box;background-color:transparent;padding:0;margin:0;pointer-events:auto;line-height:inherit}[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid red}[_nghost-%COMP%]     .xfaLayer div{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg *{pointer-events:none}[_nghost-%COMP%]     .xfaLayer a{color:#00f}[_nghost-%COMP%]     .xfaRich li{margin-left:3em}[_nghost-%COMP%]     .xfaFont{color:#000;font-weight:400;font-kerning:none;font-size:10px;font-style:normal;letter-spacing:0;text-decoration:none;vertical-align:0}[_nghost-%COMP%]     .xfaCaption{overflow:hidden;flex:0 0 auto}[_nghost-%COMP%]     .xfaCaptionForCheckButton{overflow:hidden;flex:1 1 auto}[_nghost-%COMP%]     .xfaLabel{height:100%;width:100%}[_nghost-%COMP%]     .xfaLeft{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]     .xfaRight{display:flex;flex-direction:row-reverse;align-items:center}[_nghost-%COMP%]     .xfaLeft>.xfaCaption, [_nghost-%COMP%]     .xfaLeft>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaRight>.xfaCaption, [_nghost-%COMP%]     .xfaRight>.xfaCaptionForCheckButton{max-height:100%}[_nghost-%COMP%]     .xfaTop{display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .xfaBottom{display:flex;flex-direction:column-reverse;align-items:flex-start}[_nghost-%COMP%]     .xfaTop>.xfaCaption, [_nghost-%COMP%]     .xfaTop>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaBottom>.xfaCaption, [_nghost-%COMP%]     .xfaBottom>.xfaCaptionForCheckButton{width:100%}[_nghost-%COMP%]     .xfaBorder{background-color:transparent;position:absolute;pointer-events:none}[_nghost-%COMP%]     .xfaWrapped{width:100%;height:100%}[_nghost-%COMP%]     .xfaTextfield:focus, [_nghost-%COMP%]     .xfaSelect:focus{background-image:none;background-color:transparent;outline:auto;outline-offset:-1px}[_nghost-%COMP%]     .xfaCheckbox:focus, [_nghost-%COMP%]     .xfaRadio:focus{outline:auto}[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{height:100%;width:100%;flex:1 1 auto;border:none;resize:none;background-image:var(--xfa-unfocused-field-background)}[_nghost-%COMP%]     .xfaTop>.xfaTextfield, [_nghost-%COMP%]     .xfaTop>.xfaSelect, [_nghost-%COMP%]     .xfaBottom>.xfaTextfield, [_nghost-%COMP%]     .xfaBottom>.xfaSelect{flex:0 1 auto}[_nghost-%COMP%]     .xfaButton{cursor:pointer;width:100%;height:100%;border:none;text-align:center}[_nghost-%COMP%]     .xfaLink{width:100%;height:100%;position:absolute;top:0;left:0}[_nghost-%COMP%]     .xfaCheckbox, [_nghost-%COMP%]     .xfaRadio{width:100%;height:100%;flex:0 0 auto;border:none}[_nghost-%COMP%]     .xfaRich{white-space:pre-wrap;width:100%;height:100%}[_nghost-%COMP%]     .xfaImage{object-position:left top;object-fit:contain;width:100%;height:100%}[_nghost-%COMP%]     .xfaLrTb, [_nghost-%COMP%]     .xfaRlTb, [_nghost-%COMP%]     .xfaTb{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaLr{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaRl{display:flex;flex-direction:row-reverse;align-items:stretch}[_nghost-%COMP%]     .xfaTb>div{justify-content:left}[_nghost-%COMP%]     .xfaPosition{position:relative}[_nghost-%COMP%]     .xfaArea{position:relative}[_nghost-%COMP%]     .xfaValignMiddle{display:flex;align-items:center}[_nghost-%COMP%]     .xfaTable{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRow{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRlRow{display:flex;flex-direction:row-reverse;align-items:stretch;flex:1}[_nghost-%COMP%]     .xfaTable .xfaRlRow>div{flex:1}[_nghost-%COMP%]     .xfaNonInteractive input, [_nghost-%COMP%]     .xfaNonInteractive textarea, [_nghost-%COMP%]     .xfaDisabled input, [_nghost-%COMP%]     .xfaDisabled textarea, [_nghost-%COMP%]     .xfaReadOnly input, [_nghost-%COMP%]     .xfaReadOnly textarea{background:initial}@media print{[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{background:transparent}[_nghost-%COMP%]     .xfaSelect{-webkit-appearance:none;appearance:none;text-indent:1px;text-overflow:""}}[_nghost-%COMP%]     [data-editor-rotation="90"]{transform:rotate(90deg)}[_nghost-%COMP%]     [data-editor-rotation="180"]{transform:rotate(180deg)}[_nghost-%COMP%]     [data-editor-rotation="270"]{transform:rotate(270deg)}[_nghost-%COMP%]     .annotationEditorLayer{background:transparent;position:absolute;top:0;left:0;font-size:calc(100px * var(--scale-factor));transform-origin:0 0}[_nghost-%COMP%]     .annotationEditorLayer .selectedEditor{outline:var(--focus-outline);resize:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor{position:absolute;background:transparent;border-radius:3px;padding:calc(var(--freetext-padding) * var(--scale-factor));resize:none;width:auto;height:auto;z-index:1;transform-origin:0 0;touch-action:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal{background:transparent;border:none;top:0;left:0;overflow:visible;white-space:nowrap;resize:none;font:10px sans-serif;line-height:var(--freetext-line-height)}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay{position:absolute;display:none;background:transparent;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay.enabled{display:block}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:empty:before{content:attr(default-content);color:gray}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:focus{outline:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled{resize:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled.selectedEditor{resize:horizontal}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor:hover:not(.selectedEditor), [_nghost-%COMP%]     .annotationEditorLayer .inkEditor:hover:not(.selectedEditor){outline:var(--hover-outline)}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor{position:absolute;background:transparent;border-radius:3px;overflow:auto;width:100%;height:100%;z-index:1;transform-origin:0 0;cursor:auto}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.editing{resize:none;cursor:var(--editorInk-editing-cursor),pointer}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor .inkEditorCanvas{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none}[_nghost-%COMP%]     [data-main-rotation="90"]{transform:rotate(90deg) translateY(-100%)}[_nghost-%COMP%]     [data-main-rotation="180"]{transform:rotate(180deg) translate(-100%,-100%)}[_nghost-%COMP%]     [data-main-rotation="270"]{transform:rotate(270deg) translate(-100%)}[_nghost-%COMP%]     .pdfViewer{padding-bottom:var(--pdfViewer-padding-bottom)}[_nghost-%COMP%]     .pdfViewer .canvasWrapper{overflow:hidden}[_nghost-%COMP%]     .pdfViewer .canvasWrapper canvas{width:100%}[_nghost-%COMP%]     .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:var(--page-margin);position:relative;overflow:visible;border:var(--page-border);border-image:var(--page-border-image);background-clip:content-box;background-color:#fff}[_nghost-%COMP%]     .pdfViewer .dummyPage{position:relative;width:0;height:var(--viewer-container-height)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}[_nghost-%COMP%]     .pdfViewer.singlePageView{display:inline-block}[_nghost-%COMP%]     .pdfViewer.singlePageView .page{margin:0;border:none}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .pdfViewer.scrollWrapped, [_nghost-%COMP%]     .spread{margin-left:3.5px;margin-right:3.5px;text-align:center}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .spread{white-space:nowrap}[_nghost-%COMP%]     .pdfViewer.removePageBorders, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{margin-left:0;margin-right:0}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .spread .dummyPage, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{display:inline-block;vertical-align:middle}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page{margin-left:var(--spreadHorizontalWrapped-margin-LR);margin-right:var(--spreadHorizontalWrapped-margin-LR)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .spread .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollWrapped .page{margin-left:5px;margin-right:5px}[_nghost-%COMP%]     .pdfViewer .page canvas{margin:0;display:block}[_nghost-%COMP%]     .pdfViewer .page canvas[hidden]{display:none}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon{position:absolute;display:block;inset:0;background:url(data:image/gif;base64,R0lGODlhGAAYAPQQAM7Ozvr6+uDg4LCwsOjo6I6OjsjIyJycnNjY2KioqMDAwPLy8nZ2doaGhri4uGhoaP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/ilPcHRpbWl6ZWQgd2l0aCBodHRwczovL2V6Z2lmLmNvbS9vcHRpbWl6ZQAh+QQJBwAQACwAAAAAGAAYAAAFmiAkjiTkOGVaBgjZNGSgkgKjjM8zLoI8iy+BKCdiCX8iBeMAhEEIPRXLxViYUE9CbCQoFAzFhHY3zkaT3oPvBz1zE4UBsr1eWZH4vAowOBwGAHk8AoQLfH6Agm0Ed3qOAXWOIgQKiWyFJQgDgJEpdG+WEACNEFNFmKVlVzJQk6qdkwqBoi1mebJ3ALNGeIZHtGSwNDS1RZKueCEAIfkECQcAEAAsAAAAABgAGAAABZcgJI4kpChlWgYCWRQkEKgjURgjw4zOg9CjVwuiEyEeO6CxkBC9nA+HiuUqLEyoBZI0Mx4SAFFgQCDZuguBoGv6Dtg0gvpqdhxQQDkBzuUr/4A1JwMKP39pc2mDhYCIc4GQYn6QCwCMeY91l0p6dBAEJ0OfcFRimZ91Mwt0alxxAIZyRmuAsKxDLKKvZbM1tJxmvGKRpn8hACH5BAkHABAALAAAAAAYABgAAAWhICSOJGQYZVoGAnkcJBKoI3EAY1GMCtPSosSBINKJBIwGkHdwBGGQA0OhYpEGQxNqkYzNIITBACEKKBaxxNfBeOCO4vMy0Hg8nDHFeCktkKtfNAtoS4UqAicKBj9zBAKPC4iKi4aRkISGmWWBmjUIAIyHkCUEAKCVo2WmREecVqoCgZhgP4NHrGWCj7e3szSpuxAsoVWxnp6cVV4kyZW+KSEAIfkECQcAEAAsAAAAABgAGAAABZkgJI4kBABlWgYEOQykEKgjMSDjcYxG0dKi108nEhQKQN4rCIMkCgbawjWYnSCLY2yGVSgEooBhWqsGGwxc0RtNBgoMhmJ1QgETjANYFeBKyUmBKQQIdT9JDmgPDQ6EhoKJD4sOgpWWgiwChyqEBH5hmptSoSOZgJ4kLKWkYTF7C2SaqaM/hEWygay4mYG8t6uffFuzl1iANCEAIfkECQcAEAAsAAAAABgAGAAABZ0gJI4khCBlmhKkopBCoI6LIozDMAIHO4uuBVBnOiR+I4FrCDwAZsKdQnaCLIwwmRUA8JmioprWUCjcwlwUMnAoG0qL03k2KCS8cC0UjOzDCQKBfHQFDAwFU4CCfgqFhy9+kZJWgzSKSAcPZn+BfQENDw8OljGWJAFeDoZPYTBnC1GdSXqnsoBolSulX2GyP6hgvnG0KrS3NJNhuSQhACH5BAkHABAALAAAAAAYABgAAAWaICSOJCQIZZoupGGQRKCOC0CMijIiwz2LABtQZxoMfjQhxAXszWQ7gOwECRhh0MCJJRJARTUoIHFAgbfI6uBwAJS01J/i4PClVYHvfV8lbLlIBmwFbQt+aGmChG18jXeGT4dICQxlb4g/AQUMDER9XjR6BAdiDQwINDBmkAsPDVh4cX4imw53iLKuaVqAcUsPqEiidkt6j4AzIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiREEGWaBiSCtCoZCMsIAKOg1LEo0KKbaKFQ9EYLoOkFuQlirNxzCQkUW9GZ0hQd4nyDAWr4G/esYSbyZFYZwu3jqiuvr8u8I2BwOAwASXh1e31/doeHC3klWnElfAlTd46MfQUGk2stCVEGBQWSdCciDg5VDAVYKoEiDQ0iBwxGcj9RDw8+qHIzebc2DJJQJK6qiKVyIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiS0LGWaBiRBtCoZCKgoCCMB1DF0sz6cCQDo5W62l28XAyZFpyECBv3lnCbhUqHMIo0Qg4Jbmn1jRCa4iV27TzfXGjEecOFWMN1OdvvfPGUuXSoKBw6EXokrAwcHRVU0UAeEBANAAAmUI1gNDyhjJgUHLW0iDg8FIqOnBQZrDA9TELE2rEYIDw4jta2LMpCrqld/YQpgIQAh+QQJBwAQACwAAAAAGAAYAAAFmyAkjiS0LGWaBiRBkKw6BgIqCsJcyyMe4yJajhcEml5H26o1PN2QQd3uFiv2AADlAgflIbDdZLgkABOJgep5LfWty4p4zeU+w+XsvJWXliEKDwdEBgMKYQ4PDw1qK3EDCCMAiQ5BCV0LCj+FSDQkgCgGBiYHAy2MIgoMghAHqw4HAGsNDEMFBTekdgwKI7aRB2MwkL2rVHoQoWchACH5BAkHABAALAAAAAAYABgAAAWWICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkfbqjU83ZBB3e4WK0qrCxyU55peid0qcUwuixyNx6PhILsAcAJazXYj4lvz2MkLiFsHDAlEcABKZwwMBX8pBgoKQxAIigpBA1sLBj+PSDQkB4uSACYDlTMyBgWDEKVnl2QFBUigN61gBQYjtLV5JZ4jtlR6omMhACH5BAkHABAALAAAAAAYABgAAAWaICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkdbidYanm7I4AjwYDh6saJuJ3JUG1mZi9srPA7EcRimJLrfJYWZUVC8TziXnEG3u/E+cIJaPAFrPQl1aQAIbRAGBZGHJQiMUQKRBkEKbQsAPZaEXQcslSYKmjMyAAdXj34ACkNEiUgDA5t+PAQHn6Ogjkuzry2DNwhuIQAh+QQFBwAQACwAAAAAGAAYAAAFnCAkjiS0LGVaBgBJEGSguo8zCsK4CPIsMg+ECCcKEH0ix6MwhJl4KiOp8UCdmrEbo6EoHpxF8A6aBBZ6vhf5dmAkkGr0CoWs21WGQ2FvsI9xC3l7B311fy93iWGKJQQOhHCAJQB6A3IqcWwJLU90i2FkUiMKlhBELEI6MwgDXRAGhQgAYD6tTqRFAJxpA6mvrqazSKJJhUWMpjlIIQA7) center no-repeat}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon.notVisible{background:none}[_nghost-%COMP%]     .pdfViewer.enablePermissions .textLayer span{-webkit-user-select:none!important;user-select:none!important;cursor:not-allowed}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer{padding-bottom:0}[_nghost-%COMP%]     .pdfPresentationMode .spread{margin:0}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer .page{margin:0 auto;border:2px solid transparent}`]})}return n})(),Xt=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ri({type:n});static \u0275inj=ni({})}return n})();var XS=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/Message_pour_Lukala4.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-messages"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var YS=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/LukalaNganguROI1.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-roi"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var KS=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/Projet_de_Statuts1.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-status"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var QS=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-contact"]],standalone:!0,features:[Ve],decls:8,vars:0,consts:[[1,"p-5","text-center","bg-body-tertiary",2,"width","100%","margin","auto","height","100vh"],[1,"mb-3"],[1,"align-middle"],[1,"fw-lighter"],[1,"text-success"],[1,"text-primary"]],template:function(r,i){r&1&&(B(0,"div",0)(1,"h1",1)(2,"span",2)(3,"p",3)(4,"span",4),q(5,"Pour toute demande de renseignements, veuillez vous adresser \xE0 l'adresse email suivante :"),V(),B(6,"span",5),q(7," banabalukala@gmail.com"),V()()()()())}})}}return n})();var tD={};tD.version="0.18.5";var mi=1200,Lo=1252,M6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],s1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},a1=function(n){M6.indexOf(n)!=-1&&(Lo=s1[0]=n)};function F6(){a1(1252)}var $r=function(n){mi=n,a1(n)};function nD(){$r(1200),F6()}function Xx(n){for(var e=[],t=0,r=n.length;t<r;++t)e[t]=n.charCodeAt(t);return e}function P6(n){for(var e=[],t=0;t<n.length>>1;++t)e[t]=String.fromCharCode(n.charCodeAt(2*t)+(n.charCodeAt(2*t+1)<<8));return e.join("")}function rD(n){for(var e=[],t=0;t<n.length>>1;++t)e[t]=String.fromCharCode(n.charCodeAt(2*t+1)+(n.charCodeAt(2*t)<<8));return e.join("")}var Ic=function(n){var e=n.charCodeAt(0),t=n.charCodeAt(1);return e==255&&t==254?P6(n.slice(2)):e==254&&t==255?rD(n.slice(2)):e==65279?n.slice(1):n},Vh=function(e){return String.fromCharCode(e)},ZS=function(e){return String.fromCharCode(e)},ht;var Jt=null,Dc=!0,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function JS(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<n.length;)t=n.charCodeAt(u++),s=t>>2,r=n.charCodeAt(u++),a=(t&3)<<4|r>>4,i=n.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),e+=Ds.charAt(s)+Ds.charAt(a)+Ds.charAt(o)+Ds.charAt(l);return e}function ur(n){var e="",t=0,r=0,i=0,s=0,a=0,o=0,l=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<n.length;)s=Ds.indexOf(n.charAt(u++)),a=Ds.indexOf(n.charAt(u++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Ds.indexOf(n.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),l=Ds.indexOf(n.charAt(u++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Aa=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ms(n){return et?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function eT(n){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Hr=function(e){return et?Aa(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Ca(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function o1(n){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(n instanceof ArrayBuffer)return o1(new Uint8Array(n));for(var e=new Array(n.length),t=0;t<n.length;++t)e[t]=n[t];return e}var Ts=et?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Aa(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)if(i=n[e].length,n[e]instanceof Uint8Array)r.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";r.set(new Uint8Array(n[e]),t)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function R6(n){for(var e=[],t=0,r=n.length+250,i=Ms(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[t++]=a;else if(a<2048)i[t++]=192|a>>6&31,i[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=n.charCodeAt(++s)&1023;i[t++]=240|a>>8&7,i[t++]=128|a>>2&63,i[t++]=128|o>>6&15|(a&3)<<4,i[t++]=128|o&63}else i[t++]=224|a>>12&15,i[t++]=128|a>>6&63,i[t++]=128|a&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Ms(65535),r=65530)}return e.push(i.slice(0,t)),Ts(e)}var Tn=/\u0000/g,kc=/[\u0001-\u0006]/g;function Ro(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Wr(n,e){var t=""+n;return t.length>=e?t:Ot("0",e-t.length)+t}function l1(n,e){var t=""+n;return t.length>=e?t:Ot(" ",e-t.length)+t}function Xh(n,e){var t=""+n;return t.length>=e?t:t+Ot(" ",e-t.length)}function N6(n,e){var t=""+Math.round(n);return t.length>=e?t:Ot("0",e-t.length)+t}function O6(n,e){var t=""+n;return t.length>=e?t:Ot("0",e-t.length)+t}var tT=Math.pow(2,32);function Fo(n,e){if(n>tT||n<-tT)return N6(n,e);var t=Math.round(n);return O6(t,e)}function Yh(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var nT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function L6(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',n}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},rT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},B6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kh(n,e,t){for(var r=n<0?-1:1,i=n*r,s=0,a=1,o=0,l=1,u=0,c=0,d=Math.floor(i);u<e&&(d=Math.floor(i),o=d*a+s,c=d*u+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=u,u=c;if(c>e&&(u>e?(c=l,o=s):(c=u,o=a)),!t)return[0,r*o,c];var f=Math.floor(r*o/c);return[f,r*o-f*c,c]}function _a(n,e,t){if(n>2958465||n<0)return null;var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],o={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),t&&(s=W6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var iD=new Date(1899,11,31,0,0,0),V6=iD.getTime(),j6=new Date(1900,2,1,0,0,0);function sD(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=j6&&(t+=24*60*60*1e3),(t-(V6+(n.getTimezoneOffset()-iD.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function c1(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function U6(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H6(n){var e=n<0?12:11,t=c1(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function $6(n){var e=c1(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function Hc(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=H6(n):e===10?t=n.toFixed(10).substr(0,12):t=$6(n),c1(U6(t.toUpperCase()))}function wa(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Hc(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Er(14,sD(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function W6(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function z6(n,e,t,r){var i="",s=0,a=0,o=t.y,l,u=0;switch(n){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=t.m,u=e.length;break;case 3:return Bx[t.m-1][1];case 5:return Bx[t.m-1][0];default:return Bx[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=t.d,u=e.length;break;case 3:return nT[t.q][0];default:return nT[t.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(t.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=t.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=t.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Wr(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Wr(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=t.D*24+t.H;break;case"[m]":case"[mm]":l=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":l=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Wr(l,u):"";return c}function Is(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var aD=/%/g;function G6(n,e,t){var r=e.replace(aD,""),i=e.length-r.length;return Ki(n,r,t*Math.pow(10,2*i))+Ot("%",i)}function q6(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ki(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function oD(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+oD(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var lD=/# (\?+)( ?)\/( ?)(\d+)/;function X6(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),s=Math.floor(i/r),a=i-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?Ot(" ",n[1].length+1+n[4].length):l1(a,n[1].length)+n[2]+"/"+n[3]+Wr(o,n[4].length))}function Y6(n,e,t){return t+(e===0?"":""+e)+Ot(" ",n[1].length+2+n[4].length)}var cD=/^#*0*\.([0#]+)/,uD=/\).*[0#]/,dD=/\(###\) ###\\?-####/;function Bn(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function iT(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function sT(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function K6(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function Q6(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function wr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(uD)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?wr("n",r,t):"("+wr("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return q6(n,e,t);if(e.indexOf("%")!==-1)return G6(n,e,t);if(e.indexOf("E")!==-1)return oD(e,t);if(e.charCodeAt(0)===36)return"$"+wr(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Fo(l,e.length);if(e.match(/^[#?]+$/))return i=Fo(t,0),i==="0"&&(i=""),i.length>e.length?i:Bn(e.substr(0,e.length-i.length))+i;if(s=e.match(lD))return X6(s,l,u);if(e.match(/^#+0+$/))return u+Fo(l,e.length-e.indexOf("0"));if(s=e.match(cD))return i=iT(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Bn(s[1])).replace(/\.$/,"."+Bn(s[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+Ot("0",Bn(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+iT(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Is(Fo(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+wr(n,e,-t):Is(""+(Math.floor(t)+K6(t,s[1].length)))+"."+Wr(sT(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return wr(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ro(wr(n,e.replace(/[\\-]/g,""),t)),a=0,Ro(Ro(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(dD))return i=wr(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Kh(l,Math.pow(10,a)-1,!1),i=""+u,c=Ki("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Xh(o[2],a),c.length<s[4].length&&(c=Bn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Kh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?l1(o[1],a)+s[2]+"/"+s[3]+Xh(o[2],a):Ot(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Fo(t,0),e.length<=i.length?i:Bn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,f=e.length-i.length-d;return Bn(e.substr(0,d)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=sT(t,s[1].length),t<0?"-"+wr(n,e,-t):Is(Q6(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wr(0,3-p.length):"")+p})+"."+Wr(a,s[1].length);switch(e){case"###,##0.00":return wr(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var h=Is(Fo(l,0));return h!=="0"?u+h:"";case"###,###.00":return wr(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return wr(n,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function Z6(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ki(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function J6(n,e,t){var r=e.replace(aD,""),i=e.length-r.length;return Ki(n,r,t*Math.pow(10,2*i))+Ot("%",i)}function fD(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fD(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),t=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function gi(n,e,t){if(n.charCodeAt(0)===40&&!e.match(uD)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?gi("n",r,t):"("+gi("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return Z6(n,e,t);if(e.indexOf("%")!==-1)return J6(n,e,t);if(e.indexOf("E")!==-1)return fD(e,t);if(e.charCodeAt(0)===36)return"$"+gi(n,e.substr(e.charAt(1)==" "?2:1),t);var i,s,a,o,l=Math.abs(t),u=t<0?"-":"";if(e.match(/^00+$/))return u+Wr(l,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:Bn(e.substr(0,e.length-i.length))+i;if(s=e.match(lD))return Y6(s,l,u);if(e.match(/^#+0+$/))return u+Wr(l,e.length-e.indexOf("0"));if(s=e.match(cD))return i=(""+t).replace(/^([^\.]+)$/,"$1."+Bn(s[1])).replace(/\.$/,"."+Bn(s[1])),i=i.replace(/\.(\d*)$/,function(p,g){return"."+g+Ot("0",Bn(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+Is(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+gi(n,e,-t):Is(""+t)+"."+Ot("0",s[1].length);if(s=e.match(/^#,#*,#0/))return gi(n,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ro(gi(n,e.replace(/[\\-]/g,""),t)),a=0,Ro(Ro(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<i.length?i.charAt(a++):p==="0"?"0":""}));if(e.match(dD))return i=gi(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Kh(l,Math.pow(10,a)-1,!1),i=""+u,c=Ki("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=Xh(o[2],a),c.length<s[4].length&&(c=Bn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Kh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?l1(o[1],a)+s[2]+"/"+s[3]+Xh(o[2],a):Ot(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:Bn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,f=e.length-i.length-d;return Bn(e.substr(0,d)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+gi(n,e,-t):Is(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wr(0,3-p.length):"")+p})+"."+Wr(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var h=Is(""+l);return h!=="0"?u+h:"";default:if(e.match(/\.[0#?]*$/))return gi(n,e.slice(0,e.lastIndexOf(".")),t)+Bn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ki(n,e,t){return(t|0)===t?gi(n,e,t):wr(n,e,t)}function e5(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var hD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jo(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Yh(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(hD))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function t5(n,e,t,r){for(var i=[],s="",a=0,o="",l="t",u,c,d,f="H";a<n.length;)switch(o=n.charAt(a)){case"G":if(!Yh(n,a))throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var h=n.charAt(++a),p=h==="("||h===")"?h:"t";i[i.length]={t:p,v:h},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(u==null&&(u=_a(e,t,n.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=_a(e,t),u==null))return"";for(s=o;++a<n.length&&n.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"\u4E0A":var g={t:o,v:o};if(u==null&&(u=_a(e,t)),n.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",f="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,f="h"):n.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(u!=null&&(g.v=u.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),g.t="T",a+=5,f="h"):(g.t="t",++a),u==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(s=o;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(hD)){if(u==null&&(u=_a(e,t),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",jo(n)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<n.length&&(o=n.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<n.length&&"0#?.,E+-%".indexOf(o=n.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;n.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+n);i[i.length]={t:"t",v:o},++a;break}var m=0,v=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=f,l="h",m<1&&(m=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[a].v.match(/[Hh]/)&&(m=1),m<2&&i[a].v.match(/[Mm]/)&&(m=2),m<3&&i[a].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",b;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=z6(i[a].t.charCodeAt(0),i[a].v,u,v),i[a].t="t";break;case"n":case"?":for(b=a+1;i[b]!=null&&((o=i[b].t)==="?"||o==="D"||(o===" "||o==="t")&&i[b+1]!=null&&(i[b+1].t==="?"||i[b+1].t==="t"&&i[b+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[b].v==="/"||i[b].v===" "&&i[b+1]!=null&&i[b+1].t=="?"));)i[a].v+=i[b].v,i[b]={v:"",t:";"},++b;_+=i[a].v,a=b-1;break;case"G":i[a].t="t",i[a].v=wa(e,t);break}var D="",A,w;if(_.length>0){_.charCodeAt(0)==40?(A=e<0&&_.charCodeAt(0)===45?-e:e,w=Ki("n",_,A)):(A=e<0&&r>1?-e:e,w=Ki("n",_,A),A<0&&i[0]&&i[0].t=="t"&&(w=w.substr(1),i[0].v="-"+i[0].v)),b=w.length-1;var T=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){T=a;break}var E=i.length;if(T===i.length&&w.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(b>=i[a].v.length-1?(b-=i[a].v.length,i[a].v=w.substr(b+1,i[a].v.length)):b<0?i[a].v="":(i[a].v=w.substr(0,b+1),b=-1),i[a].t="t",E=a);b>=0&&E<i.length&&(i[E].v=w.substr(0,b+1)+i[E].v)}else if(T!==i.length&&w.indexOf("E")===-1){for(b=w.indexOf(".")-1,a=T;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")-1:i[a].v.length-1,D=i[a].v.substr(c+1);c>=0;--c)b>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(D=w.charAt(b--)+D);i[a].v=D,i[a].t="t",E=a}for(b>=0&&E<i.length&&(i[E].v=w.substr(0,b+1)+i[E].v),b=w.indexOf(".")+1,a=T;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==T)){for(c=i[a].v.indexOf(".")>-1&&a===T?i[a].v.indexOf(".")+1:0,D=i[a].v.substr(0,c);c<i[a].v.length;++c)b<w.length&&(D+=w.charAt(b++));i[a].v=D,i[a].t="t",E=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(A=r>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Ki(i[a].t,i[a].v,A),i[a].t="t");var P="";for(a=0;a!==i.length;++a)i[a]!=null&&(P+=i[a].v);return P}var aT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oT(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function n5(n,e){var t=e5(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(aT),o=t[1].match(aT);return oT(e,a)?[r,t[0]]:oT(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function Er(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:je)[n],r==null&&(r=t.table&&t.table[rT[n]]||je[rT[n]]),r==null&&(r=B6[n]||"General");break}if(Yh(r,0))return wa(e,t);e instanceof Date&&(e=sD(e,t.date1904));var i=n5(r,e);if(Yh(i[1]))return wa(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return t5(i[1],e,t,i[0])}function xa(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(je[t]==null){e<0&&(e=t);continue}if(je[t]==n){e=t;break}}e<0&&(e=391)}return je[e]=n,e}function pD(){je=L6()}var r5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function i5(n){var e=typeof n=="number"?je[n]:n;return e=e.replace(gD,"(\\d+)"),new RegExp("^"+e+"$")}function s5(n,e,t){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(gD)||[]).forEach(function(d,f){var h=parseInt(t[f+1],10);switch(d.toLowerCase().charAt(0)){case"y":r=h;break;case"d":s=h;break;case"h":a=h;break;case"s":l=h;break;case"m":a>=0?o=h:i=h;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?c:u+"T"+c}var a5=function(){var n={};n.version="1.2.0";function e(){for(var w=0,T=new Array(256),E=0;E!=256;++E)w=E,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,T[E]=w;return typeof Int32Array<"u"?new Int32Array(T):T}var t=e();function r(w){var T=0,E=0,P=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)N[P]=w[P];for(P=0;P!=256;++P)for(E=w[P],T=256+P;T<4096;T+=256)E=N[T]=E>>>8^w[E&255];var O=[];for(P=1;P!=16;++P)O[P-1]=typeof Int32Array<"u"?N.subarray(P*256,P*256+256):N.slice(P*256,P*256+256);return O}var i=r(t),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],c=i[5],d=i[6],f=i[7],h=i[8],p=i[9],g=i[10],m=i[11],v=i[12],x=i[13],_=i[14];function b(w,T){for(var E=T^-1,P=0,N=w.length;P<N;)E=E>>>8^t[(E^w.charCodeAt(P++))&255];return~E}function D(w,T){for(var E=T^-1,P=w.length-15,N=0;N<P;)E=_[w[N++]^E&255]^x[w[N++]^E>>8&255]^v[w[N++]^E>>16&255]^m[w[N++]^E>>>24]^g[w[N++]]^p[w[N++]]^h[w[N++]]^f[w[N++]]^d[w[N++]]^c[w[N++]]^u[w[N++]]^l[w[N++]]^o[w[N++]]^a[w[N++]]^s[w[N++]]^t[w[N++]];for(P+=15;N<P;)E=E>>>8^t[(E^w[N++])&255];return~E}function A(w,T){for(var E=T^-1,P=0,N=w.length,O=0,Y=0;P<N;)O=w.charCodeAt(P++),O<128?E=E>>>8^t[(E^O)&255]:O<2048?(E=E>>>8^t[(E^(192|O>>6&31))&255],E=E>>>8^t[(E^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,Y=w.charCodeAt(P++)&1023,E=E>>>8^t[(E^(240|O>>8&7))&255],E=E>>>8^t[(E^(128|O>>2&63))&255],E=E>>>8^t[(E^(128|Y>>6&15|(O&3)<<4))&255],E=E>>>8^t[(E^(128|Y&63))&255]):(E=E>>>8^t[(E^(224|O>>12&15))&255],E=E>>>8^t[(E^(128|O>>6&63))&255],E=E>>>8^t[(E^(128|O&63))&255]);return~E}return n.table=t,n.bstr=b,n.buf=D,n.str=A,n}(),it=function(){var e={};e.version="1.2.1";function t(y,I){for(var C=y.split("/"),S=I.split("/"),k=0,M=0,H=Math.min(C.length,S.length);k<H;++k){if(M=C[k].length-S[k].length)return M;if(C[k]!=S[k])return C[k]<S[k]?-1:1}return C.length-S.length}function r(y){if(y.charAt(y.length-1)=="/")return y.slice(0,-1).indexOf("/")===-1?y:r(y.slice(0,-1));var I=y.lastIndexOf("/");return I===-1?y:y.slice(0,I+1)}function i(y){if(y.charAt(y.length-1)=="/")return i(y.slice(0,-1));var I=y.lastIndexOf("/");return I===-1?y:y.slice(I+1)}function s(y,I){typeof I=="string"&&(I=new Date(I));var C=I.getHours();C=C<<6|I.getMinutes(),C=C<<5|I.getSeconds()>>>1,y.write_shift(2,C);var S=I.getFullYear()-1980;S=S<<4|I.getMonth()+1,S=S<<5|I.getDate(),y.write_shift(2,S)}function a(y){var I=y.read_shift(2)&65535,C=y.read_shift(2)&65535,S=new Date,k=C&31;C>>>=5;var M=C&15;C>>>=4,S.setMilliseconds(0),S.setFullYear(C+1980),S.setMonth(M-1),S.setDate(k);var H=I&31;I>>>=5;var X=I&63;return I>>>=6,S.setHours(I),S.setMinutes(X),S.setSeconds(H<<1),S}function o(y){vn(y,0);for(var I={},C=0;y.l<=y.length-4;){var S=y.read_shift(2),k=y.read_shift(2),M=y.l+k,H={};switch(S){case 21589:C=y.read_shift(1),C&1&&(H.mtime=y.read_shift(4)),k>5&&(C&2&&(H.atime=y.read_shift(4)),C&4&&(H.ctime=y.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}y.l=M,I[S]=H}return I}var l;function u(){return l||(l={})}function c(y,I){if(y[0]==80&&y[1]==75)return j1(y,I);if((y[0]|32)==109&&(y[1]|32)==105)return YI(y,I);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var C=3,S=512,k=0,M=0,H=0,X=0,z=0,W=[],G=y.slice(0,512);vn(G,0);var le=d(G);switch(C=le[0],C){case 3:S=512;break;case 4:S=4096;break;case 0:if(le[1]==0)return j1(y,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}S!==512&&(G=y.slice(0,S),vn(G,28));var fe=y.slice(0,S);f(G,C);var we=G.read_shift(4,"i");if(C===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);G.l+=4,H=G.read_shift(4,"i"),G.l+=4,G.chk("00100000","Mini Stream Cutoff Size: "),X=G.read_shift(4,"i"),k=G.read_shift(4,"i"),z=G.read_shift(4,"i"),M=G.read_shift(4,"i");for(var he=-1,pe=0;pe<109&&(he=G.read_shift(4,"i"),!(he<0));++pe)W[pe]=he;var Re=h(y,S);m(z,M,Re,S,W);var bt=x(Re,H,W,S);bt[H].name="!Directory",k>0&&X!==Y&&(bt[X].name="!MiniFAT"),bt[W[0]].name="!FAT",bt.fat_addrs=W,bt.ssz=S;var Hn={},$t=[],Zn=[],Go=[];_(H,bt,Re,$t,k,Hn,Zn,X),p(Zn,Go,$t),$t.shift();var qo={FileIndex:Zn,FullPaths:Go};return I&&I.raw&&(qo.raw={header:fe,sectors:Re}),qo}function d(y){if(y[y.l]==80&&y[y.l+1]==75)return[0,0];y.chk(se,"Header Signature: "),y.l+=16;var I=y.read_shift(2,"u");return[y.read_shift(2,"u"),I]}function f(y,I){var C=9;switch(y.l+=2,C=y.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}function h(y,I){for(var C=Math.ceil(y.length/I)-1,S=[],k=1;k<C;++k)S[k-1]=y.slice(k*I,(k+1)*I);return S[C-1]=y.slice(C*I),S}function p(y,I,C){for(var S=0,k=0,M=0,H=0,X=0,z=C.length,W=[],G=[];S<z;++S)W[S]=G[S]=S,I[S]=C[S];for(;X<G.length;++X)S=G[X],k=y[S].L,M=y[S].R,H=y[S].C,W[S]===S&&(k!==-1&&W[k]!==k&&(W[S]=W[k]),M!==-1&&W[M]!==M&&(W[S]=W[M])),H!==-1&&(W[H]=S),k!==-1&&S!=W[S]&&(W[k]=W[S],G.lastIndexOf(k)<X&&G.push(k)),M!==-1&&S!=W[S]&&(W[M]=W[S],G.lastIndexOf(M)<X&&G.push(M));for(S=1;S<z;++S)W[S]===S&&(M!==-1&&W[M]!==M?W[S]=W[M]:k!==-1&&W[k]!==k&&(W[S]=W[k]));for(S=1;S<z;++S)if(y[S].type!==0){if(X=S,X!=W[X])do X=W[X],I[S]=I[X]+"/"+I[S];while(X!==0&&W[X]!==-1&&X!=W[X]);W[S]=-1}for(I[0]+="/",S=1;S<z;++S)y[S].type!==2&&(I[S]+="/")}function g(y,I,C){for(var S=y.start,k=y.size,M=[],H=S;C&&k>0&&H>=0;)M.push(I.slice(H*O,H*O+O)),k-=O,H=va(C,H*4);return M.length===0?Zt(0):Ts(M).slice(0,y.size)}function m(y,I,C,S,k){var M=Y;if(y===Y){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(y!==-1){var H=C[y],X=(S>>>2)-1;if(!H)return;for(var z=0;z<X&&(M=va(H,z*4))!==Y;++z)k.push(M);m(va(H,S-4),I-1,C,S,k)}}function v(y,I,C,S,k){var M=[],H=[];k||(k=[]);var X=S-1,z=0,W=0;for(z=I;z>=0;){k[z]=!0,M[M.length]=z,H.push(y[z]);var G=C[Math.floor(z*4/S)];if(W=z*4&X,S<4+W)throw new Error("FAT boundary crossed: "+z+" 4 "+S);if(!y[G])break;z=va(y[G],W)}return{nodes:M,data:_T([H])}}function x(y,I,C,S){var k=y.length,M=[],H=[],X=[],z=[],W=S-1,G=0,le=0,fe=0,we=0;for(G=0;G<k;++G)if(X=[],fe=G+I,fe>=k&&(fe-=k),!H[fe]){z=[];var he=[];for(le=fe;le>=0;){he[le]=!0,H[le]=!0,X[X.length]=le,z.push(y[le]);var pe=C[Math.floor(le*4/S)];if(we=le*4&W,S<4+we)throw new Error("FAT boundary crossed: "+le+" 4 "+S);if(!y[pe]||(le=va(y[pe],we),he[le]))break}M[fe]={nodes:X,data:_T([z])}}return M}function _(y,I,C,S,k,M,H,X){for(var z=0,W=S.length?2:0,G=I[y].data,le=0,fe=0,we;le<G.length;le+=128){var he=G.slice(le,le+128);vn(he,64),fe=he.read_shift(2),we=op(he,0,fe-W),S.push(we);var pe={name:we,type:he.read_shift(1),color:he.read_shift(1),L:he.read_shift(4,"i"),R:he.read_shift(4,"i"),C:he.read_shift(4,"i"),clsid:he.read_shift(16),state:he.read_shift(4,"i"),start:0,size:0},Re=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);Re!==0&&(pe.ct=b(he,he.l-8));var bt=he.read_shift(2)+he.read_shift(2)+he.read_shift(2)+he.read_shift(2);bt!==0&&(pe.mt=b(he,he.l-8)),pe.start=he.read_shift(4,"i"),pe.size=he.read_shift(4,"i"),pe.size<0&&pe.start<0&&(pe.size=pe.type=0,pe.start=Y,pe.name=""),pe.type===5?(z=pe.start,k>0&&z!==Y&&(I[z].name="!StreamData")):pe.size>=4096?(pe.storage="fat",I[pe.start]===void 0&&(I[pe.start]=v(C,pe.start,I.fat_addrs,I.ssz)),I[pe.start].name=pe.name,pe.content=I[pe.start].data.slice(0,pe.size)):(pe.storage="minifat",pe.size<0?pe.size=0:z!==Y&&pe.start!==Y&&I[z]&&(pe.content=g(pe,I[z].data,(I[X]||{}).data))),pe.content&&vn(pe.content,0),M[we]=pe,H.push(pe)}}function b(y,I){return new Date((un(y,I+4)/1e7*Math.pow(2,32)+un(y,I)/1e7-11644473600)*1e3)}function D(y,I){return u(),c(l.readFileSync(y),I)}function A(y,I){var C=I&&I.type;switch(C||et&&Buffer.isBuffer(y)&&(C="buffer"),C||"base64"){case"file":return D(y,I);case"base64":return c(Hr(ur(y)),I);case"binary":return c(Hr(y),I)}return c(y,I)}function w(y,I){var C=I||{},S=C.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");y.FullPaths.length===0&&(y.FullPaths[0]=S+"/",y.FileIndex[0]={name:S,type:5}),C.CLSID&&(y.FileIndex[0].clsid=C.CLSID),T(y)}function T(y){var I="Sh33tJ5";if(!it.find(y,"/"+I)){var C=Zt(4);C[0]=55,C[1]=C[3]=50,C[2]=54,y.FileIndex.push({name:I,type:2,content:C,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+I),E(y)}}function E(y,I){w(y);for(var C=!1,S=!1,k=y.FullPaths.length-1;k>=0;--k){var M=y.FileIndex[k];switch(M.type){case 0:S?C=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(M.R*M.L*M.C)&&(C=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!I)){var H=new Date(1987,1,19),X=0,z=Object.create?Object.create(null):{},W=[];for(k=0;k<y.FullPaths.length;++k)z[y.FullPaths[k]]=!0,y.FileIndex[k].type!==0&&W.push([y.FullPaths[k],y.FileIndex[k]]);for(k=0;k<W.length;++k){var G=r(W[k][0]);S=z[G],S||(W.push([G,{name:i(G).replace("/",""),type:1,clsid:ge,ct:H,mt:H,content:null}]),z[G]=!0)}for(W.sort(function(we,he){return t(we[0],he[0])}),y.FullPaths=[],y.FileIndex=[],k=0;k<W.length;++k)y.FullPaths[k]=W[k][0],y.FileIndex[k]=W[k][1];for(k=0;k<W.length;++k){var le=y.FileIndex[k],fe=y.FullPaths[k];if(le.name=i(fe).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||ge,k===0)le.C=W.length>1?1:-1,le.size=0,le.type=5;else if(fe.slice(-1)=="/"){for(X=k+1;X<W.length&&r(y.FullPaths[X])!=fe;++X);for(le.C=X>=W.length?-1:X,X=k+1;X<W.length&&r(y.FullPaths[X])!=r(fe);++X);le.R=X>=W.length?-1:X,le.type=1}else r(y.FullPaths[k+1]||"")==r(fe)&&(le.R=k+1),le.type=2}}}function P(y,I){var C=I||{};if(C.fileType=="mad")return KI(y,C);switch(E(y),C.fileType){case"zip":return $I(y,C)}var S=function(we){for(var he=0,pe=0,Re=0;Re<we.FileIndex.length;++Re){var bt=we.FileIndex[Re];if(bt.content){var Hn=bt.content.length;Hn>0&&(Hn<4096?he+=Hn+63>>6:pe+=Hn+511>>9)}}for(var $t=we.FullPaths.length+3>>2,Zn=he+7>>3,Go=he+127>>7,qo=Zn+pe+$t+Go,Ns=qo+127>>7,fp=Ns<=109?0:Math.ceil((Ns-109)/127);qo+Ns+fp+127>>7>Ns;)fp=++Ns<=109?0:Math.ceil((Ns-109)/127);var bi=[1,fp,Ns,Go,$t,pe,he,0];return we.FileIndex[0].size=he<<6,bi[7]=(we.FileIndex[0].start=bi[0]+bi[1]+bi[2]+bi[3]+bi[4]+bi[5])+(bi[6]+7>>3),bi}(y),k=Zt(S[7]<<9),M=0,H=0;{for(M=0;M<8;++M)k.write_shift(1,ie[M]);for(M=0;M<8;++M)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),M=0;M<3;++M)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,S[2]),k.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:Y),k.write_shift(4,S[3]),k.write_shift(-4,S[1]?S[0]-1:Y),k.write_shift(4,S[1]),M=0;M<109;++M)k.write_shift(-4,M<S[2]?S[1]+M:-1)}if(S[1])for(H=0;H<S[1];++H){for(;M<236+H*127;++M)k.write_shift(-4,M<S[2]?S[1]+M:-1);k.write_shift(-4,H===S[1]-1?Y:H+1)}var X=function(we){for(H+=we;M<H-1;++M)k.write_shift(-4,M+1);we&&(++M,k.write_shift(-4,Y))};for(H=M=0,H+=S[1];M<H;++M)k.write_shift(-4,J.DIFSECT);for(H+=S[2];M<H;++M)k.write_shift(-4,J.FATSECT);X(S[3]),X(S[4]);for(var z=0,W=0,G=y.FileIndex[0];z<y.FileIndex.length;++z)G=y.FileIndex[z],G.content&&(W=G.content.length,!(W<4096)&&(G.start=H,X(W+511>>9)));for(X(S[6]+7>>3);k.l&511;)k.write_shift(-4,J.ENDOFCHAIN);for(H=M=0,z=0;z<y.FileIndex.length;++z)G=y.FileIndex[z],G.content&&(W=G.content.length,!(!W||W>=4096)&&(G.start=H,X(W+63>>6)));for(;k.l&511;)k.write_shift(-4,J.ENDOFCHAIN);for(M=0;M<S[4]<<2;++M){var le=y.FullPaths[M];if(!le||le.length===0){for(z=0;z<17;++z)k.write_shift(4,0);for(z=0;z<3;++z)k.write_shift(4,-1);for(z=0;z<12;++z)k.write_shift(4,0);continue}G=y.FileIndex[M],M===0&&(G.start=G.size?G.start-1:Y);var fe=M===0&&C.root||G.name;if(W=2*(fe.length+1),k.write_shift(64,fe,"utf16le"),k.write_shift(2,W),k.write_shift(1,G.type),k.write_shift(1,G.color),k.write_shift(-4,G.L),k.write_shift(-4,G.R),k.write_shift(-4,G.C),G.clsid)k.write_shift(16,G.clsid,"hex");else for(z=0;z<4;++z)k.write_shift(4,0);k.write_shift(4,G.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,G.start),k.write_shift(4,G.size),k.write_shift(4,0)}for(M=1;M<y.FileIndex.length;++M)if(G=y.FileIndex[M],G.size>=4096)if(k.l=G.start+1<<9,et&&Buffer.isBuffer(G.content))G.content.copy(k,k.l,0,G.size),k.l+=G.size+511&-512;else{for(z=0;z<G.size;++z)k.write_shift(1,G.content[z]);for(;z&511;++z)k.write_shift(1,0)}for(M=1;M<y.FileIndex.length;++M)if(G=y.FileIndex[M],G.size>0&&G.size<4096)if(et&&Buffer.isBuffer(G.content))G.content.copy(k,k.l,0,G.size),k.l+=G.size+63&-64;else{for(z=0;z<G.size;++z)k.write_shift(1,G.content[z]);for(;z&63;++z)k.write_shift(1,0)}if(et)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function N(y,I){var C=y.FullPaths.map(function(z){return z.toUpperCase()}),S=C.map(function(z){var W=z.split("/");return W[W.length-(z.slice(-1)=="/"?2:1)]}),k=!1;I.charCodeAt(0)===47?(k=!0,I=C[0].slice(0,-1)+I):k=I.indexOf("/")!==-1;var M=I.toUpperCase(),H=k===!0?C.indexOf(M):S.indexOf(M);if(H!==-1)return y.FileIndex[H];var X=!M.match(kc);for(M=M.replace(Tn,""),X&&(M=M.replace(kc,"!")),H=0;H<C.length;++H)if((X?C[H].replace(kc,"!"):C[H]).replace(Tn,"")==M||(X?S[H].replace(kc,"!"):S[H]).replace(Tn,"")==M)return y.FileIndex[H];return null}var O=64,Y=-2,se="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],ge="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ge,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(y,I,C){u();var S=P(y,C);l.writeFileSync(I,S)}function de(y){for(var I=new Array(y.length),C=0;C<y.length;++C)I[C]=String.fromCharCode(y[C]);return I.join("")}function ye(y,I){var C=P(y,I);switch(I&&I.type||"buffer"){case"file":return u(),l.writeFileSync(I.filename,C),C;case"binary":return typeof C=="string"?C:de(C);case"base64":return JS(typeof C=="string"?C:de(C));case"buffer":if(et)return Buffer.isBuffer(C)?C:Aa(C);case"array":return typeof C=="string"?Hr(C):C}return C}var K;function F(y){try{var I=y.InflateRaw,C=new I;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)K=y;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function U(y,I){if(!K)return B1(y,I);var C=K.InflateRaw,S=new C,k=S._processChunk(y.slice(y.l),S._finishFlushFlag);return y.l+=S.bytesRead,k}function j(y){return K?K.deflateRawSync(y):Ge(y)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(y){var I=(y<<1|y<<11)&139536|(y<<5|y<<15)&558144;return(I>>16|I>>8|I)&255}for(var me=typeof Uint8Array<"u",ae=me?new Uint8Array(256):[],tt=0;tt<256;++tt)ae[tt]=ue(tt);function R(y,I){var C=ae[y&255];return I<=8?C>>>8-I:(C=C<<8|ae[y>>8&255],I<=16?C>>>16-I:(C=C<<8|ae[y>>16&255],C>>>24-I))}function It(y,I){var C=I&7,S=I>>>3;return(y[S]|(C<=6?0:y[S+1]<<8))>>>C&3}function at(y,I){var C=I&7,S=I>>>3;return(y[S]|(C<=5?0:y[S+1]<<8))>>>C&7}function mt(y,I){var C=I&7,S=I>>>3;return(y[S]|(C<=4?0:y[S+1]<<8))>>>C&15}function Ye(y,I){var C=I&7,S=I>>>3;return(y[S]|(C<=3?0:y[S+1]<<8))>>>C&31}function xe(y,I){var C=I&7,S=I>>>3;return(y[S]|(C<=1?0:y[S+1]<<8))>>>C&127}function Bt(y,I,C){var S=I&7,k=I>>>3,M=(1<<C)-1,H=y[k]>>>S;return C<8-S||(H|=y[k+1]<<8-S,C<16-S)||(H|=y[k+2]<<16-S,C<24-S)||(H|=y[k+3]<<24-S),H&M}function dr(y,I,C){var S=I&7,k=I>>>3;return S<=5?y[k]|=(C&7)<<S:(y[k]|=C<<S&255,y[k+1]=(C&7)>>8-S),I+3}function Gr(y,I,C){var S=I&7,k=I>>>3;return C=(C&1)<<S,y[k]|=C,I+1}function yi(y,I,C){var S=I&7,k=I>>>3;return C<<=S,y[k]|=C&255,C>>>=8,y[k+1]=C,I+8}function Wo(y,I,C){var S=I&7,k=I>>>3;return C<<=S,y[k]|=C&255,C>>>=8,y[k+1]=C&255,y[k+2]=C>>>8,I+16}function es(y,I){var C=y.length,S=2*C>I?2*C:I+5,k=0;if(C>=I)return y;if(et){var M=eT(S);if(y.copy)y.copy(M);else for(;k<y.length;++k)M[k]=y[k];return M}else if(me){var H=new Uint8Array(S);if(H.set)H.set(y);else for(;k<C;++k)H[k]=y[k];return H}return y.length=S,y}function Qn(y){for(var I=new Array(y),C=0;C<y;++C)I[C]=0;return I}function wi(y,I,C){var S=1,k=0,M=0,H=0,X=0,z=y.length,W=me?new Uint16Array(32):Qn(32);for(M=0;M<32;++M)W[M]=0;for(M=z;M<C;++M)y[M]=0;z=y.length;var G=me?new Uint16Array(z):Qn(z);for(M=0;M<z;++M)W[k=y[M]]++,S<k&&(S=k),G[M]=0;for(W[0]=0,M=1;M<=S;++M)W[M+16]=X=X+W[M-1]<<1;for(M=0;M<z;++M)X=y[M],X!=0&&(G[M]=W[X+16]++);var le=0;for(M=0;M<z;++M)if(le=y[M],le!=0)for(X=R(G[M],S)>>S-le,H=(1<<S+4-le)-1;H>=0;--H)I[X|H<<le]=le&15|M<<4;return S}var ts=me?new Uint16Array(512):Qn(512),zo=me?new Uint16Array(32):Qn(32);if(!me){for(var Mn=0;Mn<512;++Mn)ts[Mn]=0;for(Mn=0;Mn<32;++Mn)zo[Mn]=0}(function(){for(var y=[],I=0;I<32;I++)y.push(5);wi(y,zo,32);var C=[];for(I=0;I<=143;I++)C.push(8);for(;I<=255;I++)C.push(9);for(;I<=279;I++)C.push(7);for(;I<=287;I++)C.push(8);wi(C,ts,288)})();var qr=function(){for(var I=me?new Uint8Array(32768):[],C=0,S=0;C<oe.length-1;++C)for(;S<oe[C+1];++S)I[S]=C;for(;S<32768;++S)I[S]=29;var k=me?new Uint8Array(259):[];for(C=0,S=0;C<Q.length-1;++C)for(;S<Q[C+1];++S)k[S]=C;function M(X,z){for(var W=0;W<X.length;){var G=Math.min(65535,X.length-W),le=W+G==X.length;for(z.write_shift(1,+le),z.write_shift(2,G),z.write_shift(2,~G&65535);G-- >0;)z[z.l++]=X[W++]}return z.l}function H(X,z){for(var W=0,G=0,le=me?new Uint16Array(32768):[];G<X.length;){var fe=Math.min(65535,X.length-G);if(fe<10){for(W=dr(z,W,+(G+fe==X.length)),W&7&&(W+=8-(W&7)),z.l=W/8|0,z.write_shift(2,fe),z.write_shift(2,~fe&65535);fe-- >0;)z[z.l++]=X[G++];W=z.l*8;continue}W=dr(z,W,+(G+fe==X.length)+2);for(var we=0;fe-- >0;){var he=X[G];we=(we<<5^he)&32767;var pe=-1,Re=0;if((pe=le[we])&&(pe|=G&-32768,pe>G&&(pe-=32768),pe<G))for(;X[pe+Re]==X[G+Re]&&Re<250;)++Re;if(Re>2){he=k[Re],he<=22?W=yi(z,W,ae[he+1]>>1)-1:(yi(z,W,3),W+=5,yi(z,W,ae[he-23]>>5),W+=3);var bt=he<8?0:he-4>>2;bt>0&&(Wo(z,W,Re-Q[he]),W+=bt),he=I[G-pe],W=yi(z,W,ae[he]>>3),W-=3;var Hn=he<4?0:he-2>>1;Hn>0&&(Wo(z,W,G-pe-oe[he]),W+=Hn);for(var $t=0;$t<Re;++$t)le[we]=G&32767,we=(we<<5^X[G])&32767,++G;fe-=Re-1}else he<=143?he=he+48:W=Gr(z,W,1),W=yi(z,W,ae[he]),le[we]=G&32767,++G}W=yi(z,W,0)-1}return z.l=(W+7)/8|0,z.l}return function(z,W){return z.length<8?M(z,W):H(z,W)}}();function Ge(y){var I=Zt(50+Math.floor(y.length*1.1)),C=qr(y,I);return I.slice(0,C)}var Vt=me?new Uint16Array(32768):Qn(32768),fr=me?new Uint16Array(32768):Qn(32768),en=me?new Uint16Array(128):Qn(128),Rs=1,L1=1;function jI(y,I){var C=Ye(y,I)+257;I+=5;var S=Ye(y,I)+1;I+=5;var k=mt(y,I)+4;I+=4;for(var M=0,H=me?new Uint8Array(19):Qn(19),X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,W=me?new Uint8Array(8):Qn(8),G=me?new Uint8Array(8):Qn(8),le=H.length,fe=0;fe<k;++fe)H[L[fe]]=M=at(y,I),z<M&&(z=M),W[M]++,I+=3;var we=0;for(W[0]=0,fe=1;fe<=z;++fe)G[fe]=we=we+W[fe-1]<<1;for(fe=0;fe<le;++fe)(we=H[fe])!=0&&(X[fe]=G[we]++);var he=0;for(fe=0;fe<le;++fe)if(he=H[fe],he!=0){we=ae[X[fe]]>>8-he;for(var pe=(1<<7-he)-1;pe>=0;--pe)en[we|pe<<he]=he&7|fe<<3}var Re=[];for(z=1;Re.length<C+S;)switch(we=en[xe(y,I)],I+=we&7,we>>>=3){case 16:for(M=3+It(y,I),I+=2,we=Re[Re.length-1];M-- >0;)Re.push(we);break;case 17:for(M=3+at(y,I),I+=3;M-- >0;)Re.push(0);break;case 18:for(M=11+xe(y,I),I+=7;M-- >0;)Re.push(0);break;default:Re.push(we),z<we&&(z=we);break}var bt=Re.slice(0,C),Hn=Re.slice(C);for(fe=C;fe<286;++fe)bt[fe]=0;for(fe=S;fe<30;++fe)Hn[fe]=0;return Rs=wi(bt,Vt,286),L1=wi(Hn,fr,30),I}function UI(y,I){if(y[0]==3&&!(y[1]&3))return[Ms(I),2];for(var C=0,S=0,k=eT(I||1<<18),M=0,H=k.length>>>0,X=0,z=0;!(S&1);){if(S=at(y,C),C+=3,S>>>1)S>>1==1?(X=9,z=5):(C=jI(y,C),X=Rs,z=L1);else{C&7&&(C+=8-(C&7));var W=y[C>>>3]|y[(C>>>3)+1]<<8;if(C+=32,W>0)for(!I&&H<M+W&&(k=es(k,M+W),H=k.length);W-- >0;)k[M++]=y[C>>>3],C+=8;continue}for(;;){!I&&H<M+32767&&(k=es(k,M+32767),H=k.length);var G=Bt(y,C,X),le=S>>>1==1?ts[G]:Vt[G];if(C+=le&15,le>>>=4,!(le>>>8&255))k[M++]=le;else{if(le==256)break;le-=257;var fe=le<8?0:le-4>>2;fe>5&&(fe=0);var we=M+Q[le];fe>0&&(we+=Bt(y,C,fe),C+=fe),G=Bt(y,C,z),le=S>>>1==1?zo[G]:fr[G],C+=le&15,le>>>=4;var he=le<4?0:le-2>>1,pe=oe[le];for(he>0&&(pe+=Bt(y,C,he),C+=he),!I&&H<we&&(k=es(k,we+100),H=k.length);M<we;)k[M]=k[M-pe],++M}}}return I?[k,C+7>>>3]:[k.slice(0,M),C+7>>>3]}function B1(y,I){var C=y.slice(y.l||0),S=UI(C,I);return y.l+=S[1],S[0]}function V1(y,I){if(y)typeof console<"u"&&console.error(I);else throw new Error(I)}function j1(y,I){var C=y;vn(C,0);var S=[],k=[],M={FileIndex:S,FullPaths:k};w(M,{root:I.root});for(var H=C.length-4;(C[H]!=80||C[H+1]!=75||C[H+2]!=5||C[H+3]!=6)&&H>=0;)--H;C.l=H+4,C.l+=4;var X=C.read_shift(2);C.l+=6;var z=C.read_shift(4);for(C.l=z,H=0;H<X;++H){C.l+=20;var W=C.read_shift(4),G=C.read_shift(4),le=C.read_shift(2),fe=C.read_shift(2),we=C.read_shift(2);C.l+=8;var he=C.read_shift(4),pe=o(C.slice(C.l+le,C.l+le+fe));C.l+=le+fe+we;var Re=C.l;C.l=he+4,HI(C,W,G,M,pe),C.l=Re}return M}function HI(y,I,C,S,k){y.l+=2;var M=y.read_shift(2),H=y.read_shift(2),X=a(y);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var z=y.read_shift(4),W=y.read_shift(4),G=y.read_shift(4),le=y.read_shift(2),fe=y.read_shift(2),we="",he=0;he<le;++he)we+=String.fromCharCode(y[y.l++]);if(fe){var pe=o(y.slice(y.l,y.l+fe));(pe[21589]||{}).mt&&(X=pe[21589].mt),((k||{})[21589]||{}).mt&&(X=k[21589].mt)}y.l+=fe;var Re=y.slice(y.l,y.l+W);switch(H){case 8:Re=U(y,G);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var bt=!1;M&8&&(z=y.read_shift(4),z==134695760&&(z=y.read_shift(4),bt=!0),W=y.read_shift(4),G=y.read_shift(4)),W!=I&&V1(bt,"Bad compressed size: "+I+" != "+W),G!=C&&V1(bt,"Bad uncompressed size: "+C+" != "+G),dp(S,we,Re,{unsafe:!0,mt:X})}function $I(y,I){var C=I||{},S=[],k=[],M=Zt(1),H=C.compression?8:0,X=0,z=!1;z&&(X|=8);var W=0,G=0,le=0,fe=0,we=y.FullPaths[0],he=we,pe=y.FileIndex[0],Re=[],bt=0;for(W=1;W<y.FullPaths.length;++W)if(he=y.FullPaths[W].slice(we.length),pe=y.FileIndex[W],!(!pe.size||!pe.content||he=="Sh33tJ5")){var Hn=le,$t=Zt(he.length);for(G=0;G<he.length;++G)$t.write_shift(1,he.charCodeAt(G)&127);$t=$t.slice(0,$t.l),Re[fe]=a5.buf(pe.content,0);var Zn=pe.content;H==8&&(Zn=j(Zn)),M=Zt(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,X),M.write_shift(2,H),pe.mt?s(M,pe.mt):M.write_shift(4,0),M.write_shift(-4,X&8?0:Re[fe]),M.write_shift(4,X&8?0:Zn.length),M.write_shift(4,X&8?0:pe.content.length),M.write_shift(2,$t.length),M.write_shift(2,0),le+=M.length,S.push(M),le+=$t.length,S.push($t),le+=Zn.length,S.push(Zn),X&8&&(M=Zt(12),M.write_shift(-4,Re[fe]),M.write_shift(4,Zn.length),M.write_shift(4,pe.content.length),le+=M.l,S.push(M)),M=Zt(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,X),M.write_shift(2,H),M.write_shift(4,0),M.write_shift(-4,Re[fe]),M.write_shift(4,Zn.length),M.write_shift(4,pe.content.length),M.write_shift(2,$t.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Hn),bt+=M.l,k.push(M),bt+=$t.length,k.push($t),++fe}return M=Zt(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,fe),M.write_shift(2,fe),M.write_shift(4,bt),M.write_shift(4,le),M.write_shift(2,0),Ts([Ts(S),Ts(k),M])}var tu={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function WI(y,I){if(y.ctype)return y.ctype;var C=y.name||"",S=C.match(/\.([^\.]+)$/);return S&&tu[S[1]]||I&&(S=(C=I).match(/[\.\\]([^\.\\])+$/),S&&tu[S[1]])?tu[S[1]]:"application/octet-stream"}function zI(y){for(var I=JS(y),C=[],S=0;S<I.length;S+=76)C.push(I.slice(S,S+76));return C.join(`\r
`)+`\r
`}function GI(y){var I=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var G=W.charCodeAt(0).toString(16).toUpperCase();return"="+(G.length==1?"0"+G:G)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],S=I.split(`\r
`),k=0;k<S.length;++k){var M=S[k];if(M.length==0){C.push("");continue}for(var H=0;H<M.length;){var X=76,z=M.slice(H,H+X);z.charAt(X-1)=="="?X--:z.charAt(X-2)=="="?X-=2:z.charAt(X-3)=="="&&(X-=3),z=M.slice(H,H+X),H+=X,H<M.length&&(z+="="),C.push(z)}}return C.join(`\r
`)}function qI(y){for(var I=[],C=0;C<y.length;++C){for(var S=y[C];C<=y.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+y[++C];I.push(S)}for(var k=0;k<I.length;++k)I[k]=I[k].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Hr(I.join(`\r
`))}function XI(y,I,C){for(var S="",k="",M="",H,X=0;X<10;++X){var z=I[X];if(!z||z.match(/^\s*$/))break;var W=z.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":S=W[2].trim();break;case"content-type":M=W[2].trim();break;case"content-transfer-encoding":k=W[2].trim();break}}switch(++X,k.toLowerCase()){case"base64":H=Hr(ur(I.slice(X).join("")));break;case"quoted-printable":H=qI(I.slice(X));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var G=dp(y,S.slice(C.length),H,{unsafe:!0});M&&(G.ctype=M)}function YI(y,I){if(de(y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=I&&I.root||"",S=(et&&Buffer.isBuffer(y)?y.toString("binary"):de(y)).split(`\r
`),k=0,M="";for(k=0;k<S.length;++k)if(M=S[k],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),C||(C=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),M.slice(0,C.length)!=C););var H=(S[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var X="--"+(H[1]||""),z=[],W=[],G={FileIndex:z,FullPaths:W};w(G);var le,fe=0;for(k=0;k<S.length;++k){var we=S[k];we!==X&&we!==X+"--"||(fe++&&XI(G,S.slice(le,k),C),le=k)}return G}function KI(y,I){var C=I||{},S=C.boundary||"SheetJS";S="------="+S;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],M=y.FullPaths[0],H=M,X=y.FileIndex[0],z=1;z<y.FullPaths.length;++z)if(H=y.FullPaths[z].slice(M.length),X=y.FileIndex[z],!(!X.size||!X.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var W=X.content,G=et&&Buffer.isBuffer(W)?W.toString("binary"):de(W),le=0,fe=Math.min(1024,G.length),we=0,he=0;he<=fe;++he)(we=G.charCodeAt(he))>=32&&we<128&&++le;var pe=le>=fe*4/5;k.push(S),k.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+H),k.push("Content-Transfer-Encoding: "+(pe?"quoted-printable":"base64")),k.push("Content-Type: "+WI(X,H)),k.push(""),k.push(pe?GI(G):zI(G))}return k.push(S+`--\r
`),k.join(`\r
`)}function QI(y){var I={};return w(I,y),I}function dp(y,I,C,S){var k=S&&S.unsafe;k||w(y);var M=!k&&it.find(y,I);if(!M){var H=y.FullPaths[0];I.slice(0,H.length)==H?H=I:(H.slice(-1)!="/"&&(H+="/"),H=(H+I).replace("//","/")),M={name:i(I),type:2},y.FileIndex.push(M),y.FullPaths.push(H),k||it.utils.cfb_gc(y)}return M.content=C,M.size=C?C.length:0,S&&(S.CLSID&&(M.clsid=S.CLSID),S.mt&&(M.mt=S.mt),S.ct&&(M.ct=S.ct)),M}function ZI(y,I){w(y);var C=it.find(y,I);if(C){for(var S=0;S<y.FileIndex.length;++S)if(y.FileIndex[S]==C)return y.FileIndex.splice(S,1),y.FullPaths.splice(S,1),!0}return!1}function JI(y,I,C){w(y);var S=it.find(y,I);if(S){for(var k=0;k<y.FileIndex.length;++k)if(y.FileIndex[k]==S)return y.FileIndex[k].name=i(C),y.FullPaths[k]=C,!0}return!1}function ek(y){E(y,!0)}return e.find=N,e.read=A,e.parse=c,e.write=ye,e.writeFile=_e,e.utils={cfb_new:QI,cfb_add:dp,cfb_del:ZI,cfb_mov:JI,cfb_gc:ek,ReadShift:Pc,CheckField:PD,prep_blob:vn,bconcat:Ts,use_zlib:F,_deflateRaw:Ge,_inflateRaw:B1,consts:J},e}(),lT;function o5(n){if(typeof lT<"u")return lT.readFileSync(n);if(typeof Deno<"u")return Deno.readFileSync(n);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(n);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+n)}function vi(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function u1(n){for(var e=[],t=vi(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}var Qh=new Date(1899,11,30,0,0,0);function Un(n,e){var t=n.getTime();e&&(t-=1462*24*60*60*1e3);var r=Qh.getTime()+(n.getTimezoneOffset()-Qh.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var mD=new Date,l5=Qh.getTime()+(mD.getTimezoneOffset()-Qh.getTimezoneOffset())*6e4,cT=mD.getTimezoneOffset();function ap(n){var e=new Date;return e.setTime(n*24*60*60*1e3+l5),e.getTimezoneOffset()!==cT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-cT)*6e4),e}function c5(n){var e=0,t=0,r=!1,i=n.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+n+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(r=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}e+=t*parseInt(i[s],10)}return e}var uT=new Date("2017-02-19T19:06:09.000Z"),vD=isNaN(uT.getFullYear())?new Date("2/19/17"):uT,u5=vD.getFullYear()==2017;function dn(n,e){var t=new Date(n);if(u5)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(vD.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return n.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ba(n,e){if(et&&Buffer.isBuffer(n)){if(e){if(n[0]==255&&n[1]==254)return Fc(n.slice(2).toString("utf16le"));if(n[1]==254&&n[2]==255)return Fc(rD(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(n[0]==255&&n[1]==254)return Fc(new TextDecoder("utf-16le").decode(n.slice(2)));if(n[0]==254&&n[1]==255)return Fc(new TextDecoder("utf-16be").decode(n.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],i=0;i!=n.length;++i)r.push(String.fromCharCode(n[i]));return r.join("")}function _n(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=_n(n[t]));return e}function Ot(n,e){for(var t="";t.length<e;)t+=n;return t}function zr(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var d5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bo(n){var e=new Date(n),t=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=n.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&d5.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||s>1)&&r!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}var f5=function(){var n="abacaba".split(/(:?b)/i).length==5;return function(t,r,i){if(n||typeof r=="string")return t.split(r);for(var s=t.split(r),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function _D(n){return n?n.content&&n.type?ba(n.content,!0):n.data?Ic(n.data):n.asNodeBuffer&&et?Ic(n.asNodeBuffer().toString("binary")):n.asBinary?Ic(n.asBinary()):n._data&&n._data.getContent?Ic(ba(Array.prototype.slice.call(n._data.getContent(),0))):null:null}function xD(n){if(!n)return null;if(n.data)return Xx(n.data);if(n.asNodeBuffer&&et)return n.asNodeBuffer();if(n._data&&n._data.getContent){var e=n._data.getContent();return typeof e=="string"?Xx(e):Array.prototype.slice.call(e)}return n.content&&n.type?n.content:null}function h5(n){return n&&n.name.slice(-4)===".bin"?xD(n):_D(n)}function br(n,e){for(var t=n.FullPaths||vi(n.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==a||i==a)return n.files?n.files[t[s]]:n.FileIndex[s]}return null}function d1(n,e){var t=br(n,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Kt(n,e,t){if(!t)return h5(d1(n,e));if(!e)return null;try{return Kt(n,e)}catch{return null}}function cr(n,e,t){if(!t)return _D(d1(n,e));if(!e)return null;try{return cr(n,e)}catch{return null}}function yD(n,e,t){if(!t)return xD(d1(n,e));if(!e)return null;try{return yD(n,e)}catch{return null}}function dT(n){for(var e=n.FullPaths||vi(n.files),t=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&t.push(e[r].replace(/^Root Entry[\/]/,""));return t.sort()}function p5(n,e,t){if(n.FullPaths){if(typeof t=="string"){var r;return et?r=Aa(t):r=R6(t),it.utils.cfb_add(n,e,r)}it.utils.cfb_add(n,e,t)}else n.file(e,t)}function wD(n,e){switch(e.type){case"base64":return it.read(n,{type:"base64"});case"binary":return it.read(n,{type:"binary"});case"buffer":case"array":return it.read(n,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Mc(n,e){if(n.charAt(0)=="/")return n.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var r=n.split("/");r.length!==0;){var i=r.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var bD=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,g5=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,fT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,m5=/<[^>]*>/g,kn=bD.match(fT)?fT:m5,v5=/<\w*:/,_5=/<(\/?)\w+:/;function ke(n,e,t){for(var r={},i=0,s=0;i!==n.length&&!((s=n.charCodeAt(i))===32||s===10||s===13);++i);if(e||(r[0]=n.slice(0,i)),i===n.length)return r;var a=n.match(g5),o=0,l="",u=0,c="",d="",f=1;if(a)for(u=0;u!=a.length;++u){for(d=a[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(c=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(f=(i=d.charCodeAt(s+1))==34||i==39?1:0,l=d.slice(s+1+f,d.length-f),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),r[c]=l,t||(r[c.toLowerCase()]=l);else{var h=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(r[h]&&c.slice(o-3,o)=="ext")continue;r[h]=l,t||(r[h.toLowerCase()]=l)}}return r}function _i(n){return n.replace(_5,"<$1")}var ED={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},x5=u1(ED),lt=function(){var n=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(r){var i=r+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(n,function(o,l){return ED[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,a)+t(i.slice(a+3))}}(),y5=/[&<>'"]/g;var w5=/[\u0000-\u001f]/g;function f1(n){var e=n+"";return e.replace(y5,function(t){return x5[t]}).replace(/\n/g,"<br/>").replace(w5,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var hT=function(){var n=/&#(\d+);/g;function e(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(n,e)}}();function Dt(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Vx(n){for(var e="",t=0,r=0,i=0,s=0,a=0,o=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(t++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function pT(n){var e=Ms(2*n.length),t,r,i=1,s=0,a=0,o;for(r=0;r<n.length;r+=i)i=1,(o=n.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(n.charCodeAt(r+1)&63),i=2):o<240?(t=(o&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(o&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function gT(n){return Aa(n,"binary").toString("utf8")}var jh="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",wt=et&&(gT(jh)==Vx(jh)&&gT||pT(jh)==Vx(jh)&&pT)||Vx,Fc=et?function(n){return Aa(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},$c=function(){var n={};return function(t,r){var i=t+"|"+(r||"");return n[i]?n[i]:n[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),AD=function(){var n=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),b5=function(){var n={};return function(t){return n[t]!==void 0?n[t]:n[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),E5=/<\/?(?:vt:)?variant>/g,A5=/<(?:vt:)([^>]*)>([\s\S]*)</;function mT(n,e){var t=ke(n),r=n.match(b5(t.baseType))||[],i=[];if(r.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return i}return r.forEach(function(s){var a=s.replace(E5,"").match(A5);a&&i.push({v:wt(a[2]),t:a[1]})}),i}var C5=/(^\s|\s$|\n)/;function S5(n){return vi(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function T5(n,e,t){return"<"+n+(t!=null?S5(t):"")+(e!=null?(e.match(C5)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function h1(n){if(et&&Buffer.isBuffer(n))return n.toString("utf8");if(typeof n=="string")return n;if(typeof Uint8Array<"u"&&n instanceof Uint8Array)return wt(Ca(o1(n)));throw new Error("Bad input format: expected Buffer or string")}var Wc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,D5={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},I5=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function k5(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,s=5;s>=0;--s)i=i*256+n[e+s];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function M5(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=r?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)n[t+o]=s&255;n[t+6]=(i&15)<<4|s&15,n[t+7]=i>>4|r}var vT=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},_T=et?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Aa(e)})):vT(n)}:vT,xT=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(Yi(n,i)));return r.join("").replace(Tn,"")},op=et?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Tn,""):xT(n,e,t)}:xT,yT=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},CD=et?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):yT(n,e,t)}:yT,wT=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Po(n,i)));return r.join("")},Uo=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):wT(e,t,r)}:wT,SD=function(n,e){var t=un(n,e);return t>0?Uo(n,e+4,e+4+t-1):""},p1=SD,TD=function(n,e){var t=un(n,e);return t>0?Uo(n,e+4,e+4+t-1):""},g1=TD,DD=function(n,e){var t=2*un(n,e);return t>0?Uo(n,e+4,e+4+t-1):""},m1=DD,ID=function(e,t){var r=un(e,t);return r>0?op(e,t+4,t+4+r):""},v1=ID,kD=function(n,e){var t=un(n,e);return t>0?Uo(n,e+4,e+4+t):""},_1=kD,MD=function(n,e){return k5(n,e)},Zh=MD,FD=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};et&&(p1=function(e,t){if(!Buffer.isBuffer(e))return SD(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},g1=function(e,t){if(!Buffer.isBuffer(e))return TD(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},m1=function(e,t){if(!Buffer.isBuffer(e))return DD(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},v1=function(e,t){if(!Buffer.isBuffer(e))return ID(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},_1=function(e,t){if(!Buffer.isBuffer(e))return kD(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Zh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):MD(e,t)},FD=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function F5(){op=function(n,e,t){return ht.utils.decode(1200,n.slice(e,t)).replace(Tn,"")},Uo=function(n,e,t){return ht.utils.decode(65001,n.slice(e,t))},p1=function(n,e){var t=un(n,e);return t>0?ht.utils.decode(Lo,n.slice(e+4,e+4+t-1)):""},g1=function(n,e){var t=un(n,e);return t>0?ht.utils.decode(mi,n.slice(e+4,e+4+t-1)):""},m1=function(n,e){var t=2*un(n,e);return t>0?ht.utils.decode(1200,n.slice(e+4,e+4+t-1)):""},v1=function(n,e){var t=un(n,e);return t>0?ht.utils.decode(1200,n.slice(e+4,e+4+t)):""},_1=function(n,e){var t=un(n,e);return t>0?ht.utils.decode(65001,n.slice(e+4,e+4+t)):""}}typeof ht<"u"&&F5();var Po=function(n,e){return n[e]},Yi=function(n,e){return n[e+1]*256+n[e]},P5=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},un=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},va=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},R5=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Pc(n,e){var t="",r,i,s=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,et&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(l=0;l<n;++l)t+=String.fromCharCode(Yi(this,u)),u+=2;n*=2;break;case"utf8":t=Uo(this,this.l,this.l+n);break;case"utf16le":n*=2,t=op(this,this.l,this.l+n);break;case"wstr":if(typeof ht<"u")t=ht.utils.decode(mi,this.slice(this.l,this.l+2*n));else return Pc.call(this,n,"dbcs");n=2*n;break;case"lpstr-ansi":t=p1(this,this.l),n=4+un(this,this.l);break;case"lpstr-cp":t=g1(this,this.l),n=4+un(this,this.l);break;case"lpwstr":t=m1(this,this.l),n=4+2*un(this,this.l);break;case"lpp4":n=4+un(this,this.l),t=v1(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+un(this,this.l),t=_1(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(a=Po(this,this.l+n++))!==0;)s.push(Vh(a));t=s.join("");break;case"_wstr":for(n=0,t="";(a=Yi(this,this.l+n))!==0;)s.push(Vh(a)),n+=2;n+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,l=0;l<n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Po(this,u),this.l=u+1,o=Pc.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Vh(Yi(this,u))),u+=2}t=s.join(""),n*=2;break;case"cpstr":if(typeof ht<"u"){t=ht.utils.decode(mi,this.slice(this.l,this.l+n));break}case"sbcs-cont":for(t="",u=this.l,l=0;l!=n;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Po(this,u),this.l=u+1,o=Pc.call(this,n-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Vh(Po(this,u))),u+=1}t=s.join("");break;default:switch(n){case 1:return r=Po(this,this.l),this.l++,r;case 2:return r=(e==="i"?P5:Yi)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(n>0?va:R5)(this,this.l),this.l+=4,r):(i=un(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=Zh(this,this.l):i=Zh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=CD(this,this.l,n);break}}return this.l+=n,t}var N5=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},O5=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},L5=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function B5(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)L5(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"){if(typeof ht<"u"&&Lo==874)for(i=0;i!=e.length;++i){var s=ht.utils.encode(Lo,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,N5(this,e,this.l);break;case 8:if(r=8,t==="f"){M5(this,e,this.l);break}case 16:break;case-4:r=4,O5(this,e,this.l);break}return this.l+=r,this}function PD(n,e){var t=CD(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function vn(n,e){n.l=e,n.read_shift=Pc,n.chk=PD,n.write_shift=B5}function In(n,e){n.l+=e}function Zt(n){var e=Ms(n);return vn(e,0),e}function Ji(n,e,t){if(n){var r,i,s;vn(n,n.l||0);for(var a=n.length,o=0,l=0;n.l<a;){o=n.read_shift(1),o&128&&(o=(o&127)+((n.read_shift(1)&127)<<7));var u=ip[o]||ip[65535];for(r=n.read_shift(1),s=r&127,i=1;i<4&&r&128;++i)s+=((r=n.read_shift(1))&127)<<7*i;l=n.l+s;var c=u.f&&u.f(n,s,t);if(n.l=l,e(c,u,o))return}}}function Yx(){var n=[],e=et?256:2048,t=function(u){var c=Zt(u);return vn(c,0),c},r=t(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=t(Math.max(u+1,e)))},a=function(){return i(),Ts(n)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:n}}function Rc(n,e,t){var r=_n(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function bT(n,e,t){var r=_n(n);return r.s=Rc(r.s,e.s,t),r.e=Rc(r.e,e.s,t),r}function Nc(n,e){if(n.cRel&&n.c<0)for(n=_n(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=_n(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Be(n);return!n.cRel&&n.cRel!=null&&(t=U5(t)),!n.rRel&&n.rRel!=null&&(t=V5(t)),t}function jx(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+sn(n.s.c)+":"+(n.e.cRel?"":"$")+sn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+xn(n.s.r)+":"+(n.e.rRel?"":"$")+xn(n.e.r):Nc(n.s,e.biff)+":"+Nc(n.e,e.biff)}function x1(n){return parseInt(j5(n),10)-1}function xn(n){return""+(n+1)}function V5(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function j5(n){return n.replace(/\$(\d+)$/,"$1")}function y1(n){for(var e=H5(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function sn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function U5(n){return n.replace(/^([A-Z])/,"$$$1")}function H5(n){return n.replace(/^\$([A-Z])/,"$1")}function $5(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jn(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Be(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Ho(n){var e=n.indexOf(":");return e==-1?{s:jn(n),e:jn(n)}:{s:jn(n.slice(0,e)),e:jn(n.slice(e+1))}}function st(n,e){return typeof e>"u"||typeof e=="number"?st(n.s,n.e):(typeof n!="string"&&(n=Be(n)),typeof e!="string"&&(e=Be(e)),n==e?n:n+":"+e)}function Lt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,s=n.length;for(t=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function ET(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Er(n.z,t?Un(e):e)}catch{}try{return n.w=Er((n.XF||{}).numFmtId||(t?14:0),t?Un(e):e)}catch{return""+e}}function Zi(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?Da[n.v]||n.v:e==null?ET(n,n.v):ET(n,e))}function Ps(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function RD(n,e,t){var r=t||{},i=n?Array.isArray(n):r.dense;Jt!=null&&i==null&&(i=Jt);var s=n||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?jn(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=Lt(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),a==-1&&(u.e.r=a=c.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[d].length;++f)if(!(typeof e[d][f]>"u")){var h={v:e[d][f]},p=a+d,g=o+f;if(u.s.r>p&&(u.s.r=p),u.s.c>g&&(u.s.c=g),u.e.r<p&&(u.e.r=p),u.e.c<g&&(u.e.c=g),e[d][f]&&typeof e[d][f]=="object"&&!Array.isArray(e[d][f])&&!(e[d][f]instanceof Date))h=e[d][f];else if(Array.isArray(h.v)&&(h.f=e[d][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(r.nullError)h.t="e",h.v=0;else if(r.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=r.dateNF||je[14],r.cellDates?(h.t="d",h.w=Er(h.z,Un(h.v))):(h.t="n",h.v=Un(h.v),h.w=Er(h.z,h.v))):h.t="s";if(i)s[p]||(s[p]=[]),s[p][g]&&s[p][g].z&&(h.z=s[p][g].z),s[p][g]=h;else{var m=Be({c:g,r:p});s[m]&&s[m].z&&(h.z=s[m].z),s[m]=h}}}return u.s.c<1e7&&(s["!ref"]=st(u)),s}function $o(n,e){return RD(null,n,e)}function W5(n){return n.read_shift(4,"i")}function Dn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function z5(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function w1(n,e){var t=n.l,r=n.read_shift(1),i=Dn(n),s=[],a={t:i,h:i};if(r&1){for(var o=n.read_shift(4),l=0;l!=o;++l)s.push(z5(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=t+e,a}var G5=w1;function Ar(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Sa(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}var q5=Dn;function b1(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}var X5=Dn,Kx=b1;function E1(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?Zh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):va(e,0)>>2;return t?i/100:i}function ND(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}var Ta=ND;function Cn(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Y5(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),o=n.read_shift(1),l=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var u=ya[i];u&&(e.rgb=Gc(u));break;case 2:e.rgb=Gc([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function K5(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function OD(n,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=n.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[n.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return n.l-=4,n.read_shift(0,e==1?"lpstr":"lpwstr")}function Q5(n){return OD(n,1)}function Z5(n){return OD(n,2)}var A1=2,Kn=3,Uh=11,AT=12,Jh=19;var Hh=64,J5=65,ej=71;var tj=4108,nj=4126,cn=80,LD=81,rj=[cn,LD],ij={1:{n:"CodePage",t:A1},2:{n:"Category",t:cn},3:{n:"PresentationFormat",t:cn},4:{n:"ByteCount",t:Kn},5:{n:"LineCount",t:Kn},6:{n:"ParagraphCount",t:Kn},7:{n:"SlideCount",t:Kn},8:{n:"NoteCount",t:Kn},9:{n:"HiddenCount",t:Kn},10:{n:"MultimediaClipCount",t:Kn},11:{n:"ScaleCrop",t:Uh},12:{n:"HeadingPairs",t:tj},13:{n:"TitlesOfParts",t:nj},14:{n:"Manager",t:cn},15:{n:"Company",t:cn},16:{n:"LinksUpToDate",t:Uh},17:{n:"CharacterCount",t:Kn},19:{n:"SharedDoc",t:Uh},22:{n:"HyperlinksChanged",t:Uh},23:{n:"AppVersion",t:Kn,p:"version"},24:{n:"DigSig",t:J5},26:{n:"ContentType",t:cn},27:{n:"ContentStatus",t:cn},28:{n:"Language",t:cn},29:{n:"Version",t:cn},255:{},2147483648:{n:"Locale",t:Jh},2147483651:{n:"Behavior",t:Jh},1919054434:{}},sj={1:{n:"CodePage",t:A1},2:{n:"Title",t:cn},3:{n:"Subject",t:cn},4:{n:"Author",t:cn},5:{n:"Keywords",t:cn},6:{n:"Comments",t:cn},7:{n:"Template",t:cn},8:{n:"LastAuthor",t:cn},9:{n:"RevNumber",t:cn},10:{n:"EditTime",t:Hh},11:{n:"LastPrinted",t:Hh},12:{n:"CreatedDate",t:Hh},13:{n:"ModifiedDate",t:Hh},14:{n:"PageCount",t:Kn},15:{n:"WordCount",t:Kn},16:{n:"CharCount",t:Kn},17:{n:"Thumbnail",t:ej},18:{n:"Application",t:cn},19:{n:"DocSecurity",t:Kn},255:{},2147483648:{n:"Locale",t:Jh},2147483651:{n:"Behavior",t:Jh},1919054434:{}},CT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function oj(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var lj=oj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ya=_n(lj),Da={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},BD={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ST={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function cj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function uj(n){var e=cj();if(!n||!n.match)return e;var t={};if((n.match(kn)||[]).forEach(function(r){var i=ke(r);switch(i[0].replace(v5,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":e[ST[i.ContentType]]!==void 0&&e[ST[i.ContentType]].push(i.PartName);break}}),e.xmlns!==D5.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var Xi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Qx(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Oc(n,e){var t={"!id":{}};if(!n)return t;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(n.match(kn)||[]).forEach(function(i){var s=ke(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Mc(s.Target,e);t[o]=a,r[s.Id]=a}}),t["!id"]=r,t}var dj="application/vnd.oasis.opendocument.spreadsheet";function fj(n,e){for(var t=h1(n),r,i;r=Wc.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(i=ke(r[0],!1),i.path=="/"&&i.type!==dj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var Lc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hj=function(){for(var n=new Array(Lc.length),e=0;e<Lc.length;++e){var t=Lc[e],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);n[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return n}();function VD(n){var e={};n=wt(n);for(var t=0;t<Lc.length;++t){var r=Lc[t],i=n.match(hj[t]);i!=null&&i.length>0&&(e[r[1]]=lt(i[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=dn(e[r[1]]))}return e}var pj=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function jD(n,e,t,r){var i=[];if(typeof n=="string")i=mT(n,r);else for(var s=0;s<n.length;++s)i=i.concat(n[s].map(function(c){return{v:c}}));var a=typeof e=="string"?mT(e,r).map(function(c){return c.v}):e,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l);break}o+=l}}function gj(n,e,t){var r={};return e||(e={}),n=wt(n),pj.forEach(function(i){var s=(n.match($c(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=lt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=n.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(r[i[1]]=a[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&jD(r.HeadingPairs,r.TitlesOfParts,e,t),e}var mj=/<[^>]+>[^<]*/g;function vj(n,e){var t={},r="",i=n.match(mj);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=ke(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":r=lt(o.name);break;case"</property>":r=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),c=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":t[r]=lt(c);break;case"bool":t[r]=Dt(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(c,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(c);break;case"filetime":case"date":t[r]=dn(c);break;case"cy":case"error":t[r]=lt(c);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}var _j={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ux;function xj(n,e,t){Ux||(Ux=u1(_j)),e=Ux[e]||e,n[e]=t}function C1(n){var e=n.read_shift(4),t=n.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function UD(n,e,t){var r=n.l,i=n.read_shift(0,"lpstr-cp");if(t)for(;n.l-r&3;)++n.l;return i}function HD(n,e,t){var r=n.read_shift(0,"lpwstr");return t&&(n.l+=4-(r.length+1&3)&3),r}function $D(n,e,t){return e===31?HD(n):UD(n,e,t)}function Zx(n,e,t){return $D(n,e,t===!1?0:4)}function yj(n,e){if(!e)throw new Error("VtUnalignedString must have positive length");return $D(n,e,0)}function wj(n){for(var e=n.read_shift(4),t=[],r=0;r!=e;++r){var i=n.l;t[r]=n.read_shift(0,"lpwstr").replace(Tn,""),n.l-i&2&&(n.l+=2)}return t}function bj(n){for(var e=n.read_shift(4),t=[],r=0;r!=e;++r)t[r]=n.read_shift(0,"lpstr-cp").replace(Tn,"");return t}function Ej(n){var e=n.l,t=ep(n,LD);n[n.l]==0&&n[n.l+1]==0&&n.l-e&2&&(n.l+=2);var r=ep(n,Kn);return[t,r]}function Aj(n){for(var e=n.read_shift(4),t=[],r=0;r<e/2;++r)t.push(Ej(n));return t}function TT(n,e){for(var t=n.read_shift(4),r={},i=0;i!=t;++i){var s=n.read_shift(4),a=n.read_shift(4);r[s]=n.read_shift(a,e===1200?"utf16le":"utf8").replace(Tn,"").replace(kc,"!"),e===1200&&a%2&&(n.l+=2)}return n.l&3&&(n.l=n.l>>3<<2),r}function WD(n){var e=n.read_shift(4),t=n.slice(n.l,n.l+e);return n.l+=e,(e&3)>0&&(n.l+=4-(e&3)&3),t}function Cj(n){var e={};return e.Size=n.read_shift(4),n.l+=e.Size+3-(e.Size-1)%4,e}function ep(n,e,t){var r=n.read_shift(2),i,s=t||{};if(n.l+=2,e!==AT&&r!==e&&rj.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===AT?r:e){case 2:return i=n.read_shift(2,"i"),s.raw||(n.l+=2),i;case 3:return i=n.read_shift(4,"i"),i;case 11:return n.read_shift(4)!==0;case 19:return i=n.read_shift(4),i;case 30:return UD(n,r,4).replace(Tn,"");case 31:return HD(n);case 64:return C1(n);case 65:return WD(n);case 71:return Cj(n);case 80:return Zx(n,r,!s.raw).replace(Tn,"");case 81:return yj(n,r).replace(Tn,"");case 4108:return Aj(n);case 4126:case 4127:return r==4127?wj(n):bj(n);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function DT(n,e){var t=n.l,r=n.read_shift(4),i=n.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var c=n.read_shift(4),d=n.read_shift(4);s[a]=[c,d+t]}s.sort(function(x,_){return x[1]-_[1]});var f={};for(a=0;a!=i;++a){if(n.l!==s[a][1]){var h=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:n.l+2===s[a][1]&&(n.l+=2,h=!1);break;case 80:n.l<=s[a][1]&&(n.l=s[a][1],h=!1);break;case 4108:n.l<=s[a][1]&&(n.l=s[a][1],h=!1);break}if((!e||a==0)&&n.l<=s[a][1]&&(h=!1,n.l=s[a][1]),h)throw new Error("Read Error: Expected address "+s[a][1]+" at "+n.l+" :"+a)}if(e){var p=e[s[a][0]];if(f[p.n]=ep(n,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$r(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(s[a][0]===1){if(o=f.CodePage=ep(n,A1),$r(o),l!==-1){var g=n.l;n.l=s[l][1],u=TT(n,o),n.l=g}}else if(s[a][0]===0){if(o===0){l=a,n.l=s[a+1][1];continue}u=TT(n,o)}else{var m=u[s[a][0]],v;switch(n[n.l]){case 65:n.l+=4,v=WD(n);break;case 30:n.l+=4,v=Zx(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 31:n.l+=4,v=Zx(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 3:n.l+=4,v=n.read_shift(4,"i");break;case 19:n.l+=4,v=n.read_shift(4);break;case 5:n.l+=4,v=n.read_shift(8,"f");break;case 11:n.l+=4,v=Ht(n,4);break;case 64:n.l+=4,v=dn(C1(n));break;default:throw new Error("unparsed value: "+n[n.l])}f[m]=v}}return n.l=t+r,f}function IT(n,e,t){var r=n.content;if(!r)return{};vn(r,0);var i,s,a,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var u=r.read_shift(4),c=r.read_shift(16);if(c!==it.utils.consts.HEADER_CLSID&&c!==t)throw new Error("Bad PropertySet CLSID "+c);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=r.read_shift(16),o=r.read_shift(4),i===1&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);i===2&&(a=r.read_shift(16),l=r.read_shift(4));var d=DT(r,e),f={SystemIdentifier:u};for(var h in d)f[h]=d[h];if(f.FMTID=s,i===1)return f;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);var p;try{p=DT(r,null)}catch{}for(h in p)f[h]=p[h];return f.FMTID=[s,a],f}function Ss(n,e){return n.read_shift(e),null}function Sj(n,e,t){for(var r=[],i=n.l+e;n.l<i;)r.push(t(n,i-n.l));if(i!==n.l)throw new Error("Slurp error");return r}function Ht(n,e){return n.read_shift(e)===1}function Qt(n){return n.read_shift(2,"u")}function zD(n,e){return Sj(n,e,Qt)}function Tj(n){var e=n.read_shift(1),t=n.read_shift(1);return t===1?e:e===1}function Kc(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=mi;if(t&&t.biff>=8&&(mi=1200),!t||t.biff==8){var a=n.read_shift(1);a&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var o=r?n.read_shift(r,i):"";return mi=s,o}function Dj(n){var e=mi;mi=1200;var t=n.read_shift(2),r=n.read_shift(1),i=r&4,s=r&8,a=1+(r&1),o=0,l,u={};s&&(o=n.read_shift(2)),i&&(l=n.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":n.read_shift(t,c);return s&&(n.l+=4*o),i&&(n.l+=l),u.t=d,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),mi=e,u}function Ea(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function Qc(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):Ea(n,r,t)}function Ia(n,e,t){if(t.biff>5)return Qc(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function Ij(n){var e=n.read_shift(1);n.l++;var t=n.read_shift(2);return n.l+=2,[e,t]}function kj(n){var e=n.read_shift(4),t=n.l,r=!1;e>24&&(n.l+=e-24,n.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),n.l=t);var i=n.read_shift((r?e-24:e)>>1,"utf16le").replace(Tn,"");return r&&(n.l+=24),i}function Mj(n){for(var e=n.read_shift(2),t="";e-- >0;)t+="../";var r=n.read_shift(0,"lpstr-ansi");if(n.l+=2,n.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=n.read_shift(4);if(i===0)return t+r.replace(/\\/g,"/");var s=n.read_shift(4);if(n.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=n.read_shift(s>>1,"utf16le").replace(Tn,"");return t+a}function Fj(n,e){var t=n.read_shift(16);switch(e-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return kj(n,e);case"0303000000000000c000000000000046":return Mj(n,e);default:throw new Error("Unsupported Moniker "+t)}}function $h(n){var e=n.read_shift(4),t=e>0?n.read_shift(e,"utf16le").replace(Tn,""):"";return t}function Pj(n,e){var t=n.l+e,r=n.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=n.read_shift(2);n.l+=2;var s,a,o,l,u="",c,d;i&16&&(s=$h(n,t-n.l)),i&128&&(a=$h(n,t-n.l)),(i&257)===257&&(o=$h(n,t-n.l)),(i&257)===1&&(l=Fj(n,t-n.l)),i&8&&(u=$h(n,t-n.l)),i&32&&(c=n.read_shift(16)),i&64&&(d=C1(n)),n.l=t;var f=a||o||l||"";f&&u&&(f+="#"+u),f||(f="#"+u),i&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return c&&(h.guid=c),d&&(h.time=d),s&&(h.Tooltip=s),h}function GD(n){var e=n.read_shift(1),t=n.read_shift(1),r=n.read_shift(1),i=n.read_shift(1);return[e,t,r,i]}function qD(n,e){var t=GD(n,e);return t[3]=0,t}function xi(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2);return{r:e,c:t,ixfe:r}}function Rj(n){var e=n.read_shift(2),t=n.read_shift(2);return n.l+=8,{type:e,flags:t}}function Nj(n,e,t){return e===0?"":Ia(n,e,t)}function Oj(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function XD(n){var e=n.read_shift(2),t=E1(n);return[e,t]}function Lj(n,e,t){n.l+=4,e-=4;var r=n.l+e,i=Kc(n,e,t),s=n.read_shift(2);if(r-=n.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return n.l+=s,i}function lp(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function YD(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(1),i=n.read_shift(1);return{s:{c:r,r:e},e:{c:i,r:t}}}var Bj=YD;function KD(n){n.l+=4;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2);return n.l+=12,[t,e,r]}function Vj(n){var e={};return n.l+=4,n.l+=16,e.fSharedNote=n.read_shift(2),n.l+=4,e}function jj(n){var e={};return n.l+=4,n.cf=n.read_shift(2),e}function En(n){n.l+=2,n.l+=n.read_shift(2)}var Uj={0:En,4:En,5:En,6:En,7:jj,8:En,9:En,10:En,11:En,12:En,13:Vj,14:En,15:En,16:En,17:En,18:En,19:En,20:En,21:KD};function Hj(n,e){for(var t=n.l+e,r=[];n.l<t;){var i=n.read_shift(2);n.l-=2;try{r.push(Uj[i](n,t-n.l))}catch{return n.l=t,r}}return n.l!=t&&(n.l=t),r}function Wh(n,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=n.read_shift(2),e-=2,e>=2&&(t.dt=n.read_shift(2),n.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return n.read_shift(e),t}function $j(n,e){return e===0||n.read_shift(2),1200}function Wj(n,e,t){if(t.enc)return n.l+=e,"";var r=n.l,i=Ia(n,0,t);return n.read_shift(e+r-n.l),i}function zj(n,e,t){var r=t&&t.biff==8||e==2?n.read_shift(2):(n.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function Gj(n,e,t){var r=n.read_shift(4),i=n.read_shift(1)&3,s=n.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Kc(n,0,t);return a.length===0&&(a="Sheet1"),{pos:r,hs:i,dt:s,name:a}}function qj(n,e){for(var t=n.l+e,r=n.read_shift(4),i=n.read_shift(4),s=[],a=0;a!=i&&n.l<t;++a)s.push(Dj(n));return s.Count=r,s.Unique=i,s}function Xj(n,e){var t={};return t.dsst=n.read_shift(2),n.l+=e-2,t}function Yj(n){var e={};e.r=n.read_shift(2),e.c=n.read_shift(2),e.cnt=n.read_shift(2)-e.c;var t=n.read_shift(2);n.l+=4;var r=n.read_shift(1);return n.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=t/20),e}function Kj(n){var e=Rj(n);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=n.read_shift(4);return t!==0}function Qj(n){return n.read_shift(2),n.read_shift(4)}function kT(n,e,t){var r=0;t&&t.biff==2||(r=n.read_shift(2));var i=n.read_shift(2);t&&t.biff==2&&(r=1-(i>>15),i&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,i]}function Zj(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2),s=n.read_shift(2),a=n.read_shift(2),o=n.read_shift(2),l=n.read_shift(2),u=n.read_shift(2);return{Pos:[e,t],Dim:[r,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function Jj(n,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=n.read_shift(2);return{RTL:r&64}}function eU(){}function tU(n,e,t){var r={dyHeight:n.read_shift(2),fl:n.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:n.l+=2;break;default:n.l+=10;break}return r.name=Kc(n,0,t),r}function nU(n){var e=xi(n);return e.isst=n.read_shift(4),e}function rU(n,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=n.l+e,i=xi(n,6);t.biff==2&&n.l++;var s=Qc(n,r-n.l,t);return i.val=s,i}function iU(n,e,t){var r=n.read_shift(2),i=Ia(n,0,t);return[r,i]}var sU=Ia;function MT(n,e,t){var r=n.l+e,i=t.biff==8||!t.biff?4:2,s=n.read_shift(i),a=n.read_shift(i),o=n.read_shift(2),l=n.read_shift(2);return n.l=r,{s:{r:s,c:o},e:{r:a,c:l}}}function aU(n){var e=n.read_shift(2),t=n.read_shift(2),r=XD(n);return{r:e,c:t,ixfe:r[0],rknum:r[1]}}function oU(n,e){for(var t=n.l+e-2,r=n.read_shift(2),i=n.read_shift(2),s=[];n.l<t;)s.push(XD(n));if(n.l!==t)throw new Error("MulRK read error");var a=n.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:a,rkrec:s}}function lU(n,e){for(var t=n.l+e-2,r=n.read_shift(2),i=n.read_shift(2),s=[];n.l<t;)s.push(n.read_shift(2));if(n.l!==t)throw new Error("MulBlank read error");var a=n.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:a,ixfe:s}}function cU(n,e,t,r){var i={},s=n.read_shift(4),a=n.read_shift(4),o=n.read_shift(4),l=n.read_shift(2);return i.patternType=aj[o>>26],r.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function uU(n,e,t){var r={};return r.ifnt=n.read_shift(2),r.numFmtId=n.read_shift(2),r.flags=n.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=cU(n,e,r.fStyle,t),r}function dU(n){n.l+=4;var e=[n.read_shift(2),n.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function FT(n,e,t){var r=xi(n,6);(t.biff==2||e==9)&&++n.l;var i=Tj(n,2);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function fU(n,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=xi(n,6),i=Cn(n,8);return r.val=i,r}var PT=Nj;function hU(n,e,t){var r=n.l+e,i=n.read_shift(2),s=n.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ea(n,s),o=[];r>n.l;)o.push(Qc(n));return[s,i,a,o]}function RT(n,e,t){var r=n.read_shift(2),i,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(i=Lj(n,e-2,t)),s.body=i||n.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var pU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function NT(n,e,t){var r=n.l+e,i=n.read_shift(2),s=n.read_shift(1),a=n.read_shift(1),o=n.read_shift(t&&t.biff==2?1:2),l=0;(!t||t.biff>=5)&&(t.biff!=5&&(n.l+=2),l=n.read_shift(2),t.biff==5&&(n.l+=2),n.l+=4);var u=Ea(n,a,t);i&32&&(u=pU[u.charCodeAt(0)]);var c=r-n.l;t&&t.biff==2&&--c;var d=r==n.l||o===0||!(c>0)?[]:Y$(n,c,t,o);return{chKey:s,Name:u,itab:l,rgce:d}}function QD(n,e,t){if(t.biff<8)return gU(n,e,t);for(var r=[],i=n.l+e,s=n.read_shift(t.biff>8?4:2);s--!==0;)r.push(Oj(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function gU(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=Kc(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function mU(n,e,t){if(t.biff<8){n.l+=e;return}var r=n.read_shift(2),i=n.read_shift(2),s=Ea(n,r,t),a=Ea(n,i,t);return[s,a]}function vU(n,e,t){var r=YD(n,6);n.l++;var i=n.read_shift(1);return e-=8,[K$(n,e,t),i,r]}function OT(n,e,t){var r=Bj(n,6);switch(t.biff){case 2:n.l++,e-=7;break;case 3:case 4:n.l+=2,e-=8;break;default:n.l+=6,e-=12}return[r,q$(n,e,t,r)]}function _U(n){var e=n.read_shift(4)!==0,t=n.read_shift(4)!==0,r=n.read_shift(4);return[e,t,r]}function xU(n,e,t){if(!(t.biff<8)){var r=n.read_shift(2),i=n.read_shift(2),s=n.read_shift(2),a=n.read_shift(2),o=Ia(n,0,t);return t.biff<8&&n.read_shift(1),[{r,c:i},o,a,s]}}function yU(n,e,t){return xU(n,e,t)}function wU(n,e){for(var t=[],r=n.read_shift(2);r--;)t.push(lp(n,e));return t}function bU(n,e,t){if(t&&t.biff<8)return AU(n,e,t);var r=KD(n,22),i=Hj(n,e-22,r[1]);return{cmo:r,ft:i}}var EU={8:function(n,e){var t=n.l+e;n.l+=10;var r=n.read_shift(2);n.l+=4,n.l+=2,n.l+=2,n.l+=2,n.l+=4;var i=n.read_shift(1);return n.l+=i,n.l=t,{fmt:r}}};function AU(n,e,t){n.l+=4;var r=n.read_shift(2),i=n.read_shift(2),s=n.read_shift(2);n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=6,e-=36;var a=[];return a.push((EU[r]||In)(n,e,t)),{cmo:[i,r,s],ft:a}}function CU(n,e,t){var r=n.l,i="";try{n.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?n.l+=6:a=Ij(n,6,t);var o=n.read_shift(2);n.read_shift(2),Qt(n,2);var l=n.read_shift(2);n.l+=l;for(var u=1;u<n.lens.length-1;++u){if(n.l-r!=n.lens[u])throw new Error("TxO: bad continue record");var c=n[n.l],d=Ea(n,n.lens[u+1]-n.lens[u]-1);if(i+=d,i.length>=(c?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return n.l=r+e,{t:i}}catch{return n.l=r+e,{t:i}}}function SU(n,e){var t=lp(n,8);n.l+=16;var r=Pj(n,e-24);return[t,r]}function TU(n,e){n.read_shift(2);var t=lp(n,8),r=n.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(Tn,""),[t,r]}function DU(n){var e=[0,0],t;return t=n.read_shift(2),e[0]=CT[t]||t,t=n.read_shift(2),e[1]=CT[t]||t,e}function IU(n){for(var e=n.read_shift(2),t=[];e-- >0;)t.push(qD(n,8));return t}function kU(n){for(var e=n.read_shift(2),t=[];e-- >0;)t.push(qD(n,8));return t}function MU(n){n.l+=2;var e={cxfs:0,crc:0};return e.cxfs=n.read_shift(2),e.crc=n.read_shift(4),e}function ZD(n,e,t){if(!t.cellStyles)return In(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(2);r==2&&(n.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(u.level=l>>8&7),u}function FU(n,e){var t={};return e<32||(n.l+=16,t.header=Cn(n,8),t.footer=Cn(n,8),n.l+=2),t}function PU(n,e,t){var r={area:!1};if(t.biff!=5)return n.l+=e,r;var i=n.read_shift(1);return n.l+=3,i&16&&(r.area=!0),r}var RU=xi,NU=zD,OU=Qc;function LU(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i={fmt:e,env:t,len:r,data:n.slice(n.l,n.l+r)};return n.l+=r,i}function BU(n,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=xi(n,6);++n.l;var i=Ia(n,e-7,t);return r.t="str",r.val=i,r}function VU(n){var e=xi(n,6);++n.l;var t=Cn(n,8);return e.t="n",e.val=t,e}function jU(n){var e=xi(n,6);++n.l;var t=n.read_shift(2);return e.t="n",e.val=t,e}function UU(n){var e=n.read_shift(1);return e===0?(n.l++,""):n.read_shift(e,"sbcs-cont")}function HU(n,e){n.l+=6,n.l+=2,n.l+=1,n.l+=3,n.l+=1,n.l+=e-13}function $U(n,e,t){var r=n.l+e,i=xi(n,6),s=n.read_shift(2),a=Ea(n,s,t);return n.l=r,i.t="str",i.val=a,i}var WU=[2,3,48,49,131,139,140,245],LT=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=u1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,l){var u=[],c=Ms(1);switch(l.type){case"base64":c=Hr(ur(o));break;case"binary":c=Hr(o);break;case"buffer":case"array":c=o;break}vn(c,0);var d=c.read_shift(1),f=!!(d&136),h=!1,p=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,m=521;d==2&&(g=c.read_shift(2)),c.l+=3,d!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(m=c.read_shift(2));var v=c.read_shift(2),x=l.codepage||1252;d!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(x=n[c[c.l]]),c.l+=1,c.l+=2),p&&(c.l+=36);for(var _=[],b={},D=Math.min(c.length,d==2?521:m-10-(h?264:0)),A=p?32:11;c.l<D&&c[c.l]!=13;)switch(b={},b.name=ht.utils.decode(x,c.slice(c.l,c.l+A)).replace(/[\u0000\r\n].*$/g,""),c.l+=A,b.type=String.fromCharCode(c.read_shift(1)),d!=2&&!p&&(b.offset=c.read_shift(4)),b.len=c.read_shift(1),d==2&&(b.offset=c.read_shift(2)),b.dec=c.read_shift(1),b.name.length&&_.push(b),d!=2&&(c.l+=p?13:14),b.type){case"B":(!h||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(c[c.l]!==13&&(c.l=m-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=m;var w=0,T=0;for(u[0]=[],T=0;T!=_.length;++T)u[0][T]=_[T].name;for(;g-- >0;){if(c[c.l]===42){c.l+=v;continue}for(++c.l,u[++w]=[],T=0,T=0;T!=_.length;++T){var E=c.slice(c.l,c.l+_[T].len);c.l+=_[T].len,vn(E,0);var P=ht.utils.decode(x,E);switch(_[T].type){case"C":P.trim().length&&(u[w][T]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[w][T]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[w][T]=P;break;case"F":u[w][T]=parseFloat(P.trim());break;case"+":case"I":u[w][T]=p?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[w][T]=!0;break;case"N":case"F":u[w][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[w][T]="##MEMO##"+(p?parseInt(P.trim(),10):E.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[w][T]=+P||0);break;case"@":u[w][T]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[w][T]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[w][T]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[w][T]=-E.read_shift(-8,"f");break;case"B":if(h&&_[T].len==8){u[w][T]=E.read_shift(8,"f");break}case"G":case"P":E.l+=_[T].len;break;case"0":if(_[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[T].type)}}}if(d!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=_,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=$o(t(o,u),u);return c["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,c}function i(o,l){try{return Ps(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&$r(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Yx(),d=i1(o,{header:1,raw:!0,cellDates:!0}),f=d[0],h=d.slice(1),p=o["!cols"]||[],g=0,m=0,v=0,x=1;for(g=0;g<f.length;++g){if(((p[g]||{}).DBF||{}).name){f[g]=p[g].DBF.name,++v;continue}if(f[g]!=null){if(++v,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(m=0;m<1024;++m)if(f.indexOf(f[g]+"_"+m)==-1){f[g]+="_"+m;break}}}}var _=Lt(o["!ref"]),b=[],D=[],A=[];for(g=0;g<=_.e.c-_.s.c;++g){var w="",T="",E=0,P=[];for(m=0;m<h.length;++m)h[m][g]!=null&&P.push(h[m][g]);if(P.length==0||f[g]==null){b[g]="?";continue}for(m=0;m<P.length;++m){switch(typeof P[m]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=P[m]instanceof Date?"D":"C";break;default:T="C"}E=Math.max(E,String(P[m]).length),w=w&&w!=T?"C":T}E>250&&(E=250),T=((p[g]||{}).DBF||{}).type,T=="C"&&p[g].DBF.len>E&&(E=p[g].DBF.len),w=="B"&&T=="N"&&(w="N",A[g]=p[g].DBF.dec,E=p[g].DBF.len),D[g]=w=="C"||T=="N"?E:s[w]||0,x+=D[g],b[g]=w}var N=c.next(32);for(N.write_shift(4,318902576),N.write_shift(4,h.length),N.write_shift(2,296+32*v),N.write_shift(2,x),g=0;g<4;++g)N.write_shift(4,0);for(N.write_shift(4,0|(+e[Lo]||3)<<8),g=0,m=0;g<f.length;++g)if(f[g]!=null){var O=c.next(32),Y=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,Y,"sbcs"),O.write_shift(1,b[g]=="?"?"C":b[g],"sbcs"),O.write_shift(4,m),O.write_shift(1,D[g]||s[b[g]]||0),O.write_shift(1,A[g]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),m+=D[g]||s[b[g]]||0}var se=c.next(264);for(se.write_shift(4,13),g=0;g<65;++g)se.write_shift(4,0);for(g=0;g<h.length;++g){var ie=c.next(x);for(ie.write_shift(1,0),m=0;m<f.length;++m)if(f[m]!=null)switch(b[m]){case"L":ie.write_shift(1,h[g][m]==null?63:h[g][m]?84:70);break;case"B":ie.write_shift(8,h[g][m]||0,"f");break;case"N":var ge="0";for(typeof h[g][m]=="number"&&(ge=h[g][m].toFixed(A[m]||0)),v=0;v<D[m]-ge.length;++v)ie.write_shift(1,32);ie.write_shift(1,ge,"sbcs");break;case"D":h[g][m]?(ie.write_shift(4,("0000"+h[g][m].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(h[g][m].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+h[g][m].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var J=String(h[g][m]!=null?h[g][m]:"").slice(0,D[m]);for(ie.write_shift(1,J,"sbcs"),v=0;v<D[m]-J.length;++v)ie.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}}(),zU=function(){var n={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+vi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(f,h){var p=n[h];return typeof p=="number"?ZS(p):p},r=function(f,h,p){var g=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?f:ZS(g)};n["|"]=254;function i(f,h){switch(h.type){case"base64":return s(ur(f),h);case"binary":return s(f,h);case"buffer":return s(et&&Buffer.isBuffer(f)?f.toString("binary"):Ca(f),h);case"array":return s(ba(f),h)}throw new Error("Unrecognized type "+h.type)}function s(f,h){var p=f.split(/[\n\r]+/),g=-1,m=-1,v=0,x=0,_=[],b=[],D=null,A={},w=[],T=[],E=[],P=0,N;for(+h.codepage>=0&&$r(+h.codepage);v!==p.length;++v){P=0;var O=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),Y=O.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),se=Y[0],ie;if(O.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&b.push(O.slice(3).replace(/;;/g,";"));break;case"C":var ge=!1,J=!1,_e=!1,de=!1,ye=-1,K=-1;for(x=1;x<Y.length;++x)switch(Y[x].charAt(0)){case"A":break;case"X":m=parseInt(Y[x].slice(1))-1,J=!0;break;case"Y":for(g=parseInt(Y[x].slice(1))-1,J||(m=0),N=_.length;N<=g;++N)_[N]=[];break;case"K":ie=Y[x].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(zr(ie))?isNaN(Bo(ie).getDate())||(ie=dn(ie)):(ie=zr(ie),D!==null&&jo(D)&&(ie=ap(ie))),typeof ht<"u"&&typeof ie=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(ie=ht.utils.decode(h.codepage,ie)),ge=!0;break;case"E":de=!0;var F=No(Y[x].slice(1),{r:g,c:m});_[g][m]=[_[g][m],F];break;case"S":_e=!0,_[g][m]=[_[g][m],"S5S"];break;case"G":break;case"R":ye=parseInt(Y[x].slice(1))-1;break;case"C":K=parseInt(Y[x].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}if(ge&&(_[g][m]&&_[g][m].length==2?_[g][m][0]=ie:_[g][m]=ie,D=null),_e){if(de)throw new Error("SYLK shared formula cannot have own formula");var U=ye>-1&&_[ye][K];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");_[g][m][1]=lI(U[1],{r:g-ye,c:m-K})}break;case"F":var j=0;for(x=1;x<Y.length;++x)switch(Y[x].charAt(0)){case"X":m=parseInt(Y[x].slice(1))-1,++j;break;case"Y":for(g=parseInt(Y[x].slice(1))-1,N=_.length;N<=g;++N)_[N]=[];break;case"M":P=parseInt(Y[x].slice(1))/20;break;case"F":break;case"G":break;case"P":D=b[parseInt(Y[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=Y[x].slice(1).split(" "),N=parseInt(E[0],10);N<=parseInt(E[1],10);++N)P=parseInt(E[2],10),T[N-1]=P===0?{hidden:!0}:{wch:P},Vo(T[N-1]);break;case"C":m=parseInt(Y[x].slice(1))-1,T[m]||(T[m]={});break;case"R":g=parseInt(Y[x].slice(1))-1,w[g]||(w[g]={}),P>0?(w[g].hpt=P,w[g].hpx=qc(P)):P===0&&(w[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}j<1&&(D=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+O)}}return w.length>0&&(A["!rows"]=w),T.length>0&&(A["!cols"]=T),h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),[_,A]}function a(f,h){var p=i(f,h),g=p[0],m=p[1],v=$o(g,h);return vi(m).forEach(function(x){v[x]=m[x]}),v}function o(f,h){return Ps(a(f,h),h)}function l(f,h,p,g){var m="C;Y"+(p+1)+";X"+(g+1)+";K";switch(f.t){case"n":m+=f.v||0,f.f&&!f.F&&(m+=";E"+M9(f.f,{r:p,c:g}));break;case"b":m+=f.v?"TRUE":"FALSE";break;case"e":m+=f.w||f.v;break;case"d":m+='"'+(f.w||f.v)+'"';break;case"s":m+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function u(f,h){h.forEach(function(p,g){var m="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=np(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=rp(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&f.push(m)})}function c(f,h){h.forEach(function(p,g){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*sI(p.hpx)+";"),m.length>2&&f.push(m+"R"+(g+1))})}function d(f,h){var p=["ID;PWXL;N;E"],g=[],m=Lt(f["!ref"]),v,x=Array.isArray(f),_=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&u(p,f["!cols"]),f["!rows"]&&c(p,f["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var b=m.s.r;b<=m.e.r;++b)for(var D=m.s.c;D<=m.e.c;++D){var A=Be({r:b,c:D});v=x?(f[b]||[])[D]:f[A],!(!v||v.v==null&&(!v.f||v.F))&&g.push(l(v,f,b,D,h))}return p.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),GU=function(){function n(s,a){switch(a.type){case"base64":return e(ur(s),a);case"binary":return e(s,a);case"buffer":return e(et&&Buffer.isBuffer(s)?s.toString("binary"):Ca(s),a);case"array":return e(ba(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,u=-1,c=0,d=[];c!==o.length;++c){if(o[c].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var f=o[c].trim().split(","),h=f[0],p=f[1];++c;for(var g=o[c]||"";(g.match(/["]/g)||[]).length&1&&c<o.length-1;)g+=`
`+o[++c];switch(g=g.trim(),+h){case-1:if(g==="BOT"){d[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][u]=!0:g==="FALSE"?d[l][u]=!1:isNaN(zr(p))?isNaN(Bo(p).getDate())?d[l][u]=p:d[l][u]=dn(p):d[l][u]=zr(p),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),Dc&&g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function t(s,a){return $o(n(s,a),a)}function r(s,a){return Ps(t(s,a),a)}var i=function(){var s=function(l,u,c,d,f){l.push(u),l.push(c+","+d),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,u,c,d){l.push(u+","+c),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],c=Lt(l["!ref"]),d,f=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var h=c.s.r;h<=c.e.r;++h){a(u,-1,0,"BOT");for(var p=c.s.c;p<=c.e.c;++p){var g=Be({r:h,c:p});if(d=f?(l[h]||[])[p]:l[g],!d){a(u,1,0,"");continue}switch(d.t){case"n":var m=Dc?d.w:d.v;!m&&d.v!=null&&(m=d.v),m==null?Dc&&d.f&&!d.F?a(u,1,0,"="+d.f):a(u,1,0,""):a(u,0,m,"V");break;case"b":a(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(u,1,0,!Dc||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Er(d.z||je[14],Un(dn(d.v)))),Dc?a(u,0,d.w,"V"):a(u,1,0,d.w);break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var v=`\r
`,x=u.join(v);return x}}();return{to_workbook:r,to_sheet:t,from_sheet:i}}(),qU=function(){function n(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(d,f){for(var h=d.split(`
`),p=-1,g=-1,m=0,v=[];m!==h.length;++m){var x=h[m].trim().split(":");if(x[0]==="cell"){var _=jn(x[1]);if(v.length<=_.r)for(p=v.length;p<=_.r;++p)v[p]||(v[p]=[]);switch(p=_.r,g=_.c,x[2]){case"t":v[p][g]=n(x[3]);break;case"v":v[p][g]=+x[3];break;case"vtf":var b=x[x.length-1];case"vtc":switch(x[3]){case"nl":v[p][g]=!!+x[4];break;default:v[p][g]=+x[4];break}x[2]=="vtf"&&(v[p][g]=[v[p][g],b])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function r(d,f){return $o(t(d,f),f)}function i(d,f){return Ps(r(d,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var f=[],h=[],p,g="",m=Ho(d["!ref"]),v=Array.isArray(d),x=m.s.r;x<=m.e.r;++x)for(var _=m.s.c;_<=m.e.c;++_)if(g=Be({r:x,c:_}),p=v?(d[x]||[])[_]:d[g],!(!p||p.v==null||p.t==="z")){switch(h=["cell",g,"t"],p.t){case"s":case"str":h.push(e(p.v));break;case"n":p.f?(h[2]="vtf",h[3]="n",h[4]=p.v,h[5]=e(p.f)):(h[2]="v",h[3]=p.v);break;case"b":h[2]="vt"+(p.f?"f":"c"),h[3]="nl",h[4]=p.v?"1":"0",h[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=Un(dn(p.v));h[2]="vtc",h[3]="nd",h[4]=""+b,h[5]=p.w||Er(p.z||je[14],b);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function c(d){return[s,a,o,a,u(d),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:c}}(),zc=function(){function n(c,d,f,h,p){p.raw?d[f][h]=c:c===""||(c==="TRUE"?d[f][h]=!0:c==="FALSE"?d[f][h]=!1:isNaN(zr(c))?isNaN(Bo(c).getDate())?d[f][h]=c:d[f][h]=dn(c):d[f][h]=zr(c))}function e(c,d){var f=d||{},h=[];if(!c||c.length===0)return h;for(var p=c.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var m=10,v=0,x=0;x<=g;++x)v=p[x].indexOf(" "),v==-1?v=p[x].length:v++,m=Math.max(m,v);for(x=0;x<=g;++x){h[x]=[];var _=0;for(n(p[x].slice(0,m).trim(),h,x,_,f),_=1;_<=(p[x].length-m)/10+1;++_)n(p[x].slice(m+(_-1)*10,m+_*10).trim(),h,x,_,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(c){for(var d={},f=!1,h=0,p=0;h<c.length;++h)(p=c.charCodeAt(h))==34?f=!f:!f&&p in t&&(d[p]=(d[p]||0)+1);p=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&p.push([d[h],h]);if(!p.length){d=r;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&p.push([d[h],h])}return p.sort(function(g,m){return g[0]-m[0]||r[g[1]]-r[m[1]]}),t[p.pop()[1]]||44}function s(c,d){var f=d||{},h="";Jt!=null&&f.dense==null&&(f.dense=Jt);var p=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(h=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(h=c.charAt(4),c=c.slice(6)):h=i(c.slice(0,1024)):f&&f.FS?h=f.FS:h=i(c.slice(0,1024));var m=0,v=0,x=0,_=0,b=0,D=h.charCodeAt(0),A=!1,w=0,T=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var E=f.dateNF!=null?i5(f.dateNF):null;function P(){var N=c.slice(_,b),O={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)O.t="z";else if(f.raw)O.t="s",O.v=N;else if(N.trim().length===0)O.t="s",O.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(O.t="s",O.v=N.slice(2,-1).replace(/""/g,'"')):P9(N)?(O.t="n",O.f=N.slice(1)):(O.t="s",O.v=N);else if(N=="TRUE")O.t="b",O.v=!0;else if(N=="FALSE")O.t="b",O.v=!1;else if(!isNaN(x=zr(N)))O.t="n",f.cellText!==!1&&(O.w=N),O.v=x;else if(!isNaN(Bo(N).getDate())||E&&N.match(E)){O.z=f.dateNF||je[14];var Y=0;E&&N.match(E)&&(N=s5(N,f.dateNF,N.match(E)||[]),Y=1),f.cellDates?(O.t="d",O.v=dn(N,Y)):(O.t="n",O.v=Un(dn(N,Y))),f.cellText!==!1&&(O.w=Er(O.z,O.v instanceof Date?Un(O.v):O.v)),f.cellNF||delete O.z}else O.t="s",O.v=N;if(O.t=="z"||(f.dense?(p[m]||(p[m]=[]),p[m][v]=O):p[Be({c:v,r:m})]=O),_=b+1,T=c.charCodeAt(_),g.e.c<v&&(g.e.c=v),g.e.r<m&&(g.e.r=m),w==D)++v;else if(v=0,++m,f.sheetRows&&f.sheetRows<=m)return!0}e:for(;b<c.length;++b)switch(w=c.charCodeAt(b)){case 34:T===34&&(A=!A);break;case D:case 10:case 13:if(!A&&P())break e;break;default:break}return b-_>0&&P(),p["!ref"]=st(g),p}function a(c,d){return!(d&&d.PRN)||d.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,d):$o(e(c,d),d)}function o(c,d){var f="",h=d.type=="string"?[0,0,0,0]:P1(c,d);switch(d.type){case"base64":f=ur(c);break;case"binary":f=c;break;case"buffer":d.codepage==65001?f=c.toString("utf8"):d.codepage&&typeof ht<"u"?f=ht.utils.decode(d.codepage,c):f=et&&Buffer.isBuffer(c)?c.toString("binary"):Ca(c);break;case"array":f=ba(c);break;case"string":f=c;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=wt(f.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?f=wt(f):d.type=="binary"&&typeof ht<"u"&&d.codepage&&(f=ht.utils.decode(d.codepage,ht.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?qU.to_sheet(d.type=="string"?f:wt(f),d):a(f,d)}function l(c,d){return Ps(o(c,d),d)}function u(c){for(var d=[],f=Lt(c["!ref"]),h,p=Array.isArray(c),g=f.s.r;g<=f.e.r;++g){for(var m=[],v=f.s.c;v<=f.e.c;++v){var x=Be({r:g,c:v});if(h=p?(c[g]||[])[v]:c[x],!h||h.v==null){m.push("          ");continue}for(var _=(h.w||(Zi(h),h.w)||"").slice(0,10);_.length<10;)_+=" ";m.push(_+(v===0?" ":""))}d.push(m.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function XU(n,e){var t=e||{},r=!!t.WTF;t.WTF=!0;try{var i=zU.to_workbook(n,t);return t.WTF=r,i}catch(s){if(t.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return zc.to_workbook(n,e)}}var Bc=function(){function n(F,U,j){if(F){vn(F,F.l||0);for(var L=j.Enum||ye;F.l<F.length;){var Q=F.read_shift(2),oe=L[Q]||L[65535],ue=F.read_shift(2),me=F.l+ue,ae=oe.f&&oe.f(F,ue,j);if(F.l=me,U(ae,oe,Q))return}}}function e(F,U){switch(U.type){case"base64":return t(Hr(ur(F)),U);case"binary":return t(Hr(F),U);case"buffer":case"array":return t(F,U)}throw"Unsupported type "+U.type}function t(F,U){if(!F)return F;var j=U||{};Jt!=null&&j.dense==null&&(j.dense=Jt);var L=j.dense?[]:{},Q="Sheet1",oe="",ue=0,me={},ae=[],tt=[],R={s:{r:0,c:0},e:{r:0,c:0}},It=j.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)j.Enum=ye,n(F,function(xe,Bt,dr){switch(dr){case 0:j.vers=xe,xe>=4096&&(j.qpro=!0);break;case 6:R=xe;break;case 204:xe&&(oe=xe);break;case 222:oe=xe;break;case 15:case 51:j.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:dr==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=j.dateNF||je[14],j.cellDates&&(xe[1].t="d",xe[1].v=ap(xe[1].v))),j.qpro&&xe[3]>ue&&(L["!ref"]=st(R),me[Q]=L,ae.push(Q),L=j.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},ue=xe[3],Q=oe||"Sheet"+(ue+1),oe="");var Gr=j.dense?(L[xe[0].r]||[])[xe[0].c]:L[Be(xe[0])];if(Gr){Gr.t=xe[1].t,Gr.v=xe[1].v,xe[1].z!=null&&(Gr.z=xe[1].z),xe[1].f!=null&&(Gr.f=xe[1].f);break}j.dense?(L[xe[0].r]||(L[xe[0].r]=[]),L[xe[0].r][xe[0].c]=xe[1]):L[Be(xe[0])]=xe[1];break;default:}},j);else if(F[2]==26||F[2]==14)j.Enum=K,F[2]==14&&(j.qpro=!0,F.l=0),n(F,function(xe,Bt,dr){switch(dr){case 204:Q=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>ue&&(L["!ref"]=st(R),me[Q]=L,ae.push(Q),L=j.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},ue=xe[3],Q="Sheet"+(ue+1)),It>0&&xe[0].r>=It)break;j.dense?(L[xe[0].r]||(L[xe[0].r]=[]),L[xe[0].r][xe[0].c]=xe[1]):L[Be(xe[0])]=xe[1],R.e.c<xe[0].c&&(R.e.c=xe[0].c),R.e.r<xe[0].r&&(R.e.r=xe[0].r);break;case 27:xe[14e3]&&(tt[xe[14e3][0]]=xe[14e3][1]);break;case 1537:tt[xe[0]]=xe[1],xe[0]==ue&&(Q=xe[1]);break;default:break}},j);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(L["!ref"]=st(R),me[oe||Q]=L,ae.push(oe||Q),!tt.length)return{SheetNames:ae,Sheets:me};for(var at={},mt=[],Ye=0;Ye<tt.length;++Ye)me[ae[Ye]]?(mt.push(tt[Ye]||ae[Ye]),at[tt[Ye]]=me[tt[Ye]]||me[ae[Ye]]):(mt.push(tt[Ye]),at[tt[Ye]]={"!ref":"A1"});return{SheetNames:mt,Sheets:at}}function r(F,U){var j=U||{};if(+j.codepage>=0&&$r(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Yx(),Q=Lt(F["!ref"]),oe=Array.isArray(F),ue=[];Ur(L,0,s(1030)),Ur(L,6,l(Q));for(var me=Math.min(Q.e.r,8191),ae=Q.s.r;ae<=me;++ae)for(var tt=xn(ae),R=Q.s.c;R<=Q.e.c;++R){ae===Q.s.r&&(ue[R]=sn(R));var It=ue[R]+tt,at=oe?(F[ae]||[])[R]:F[It];if(!(!at||at.t=="z"))if(at.t=="n")(at.v|0)==at.v&&at.v>=-32768&&at.v<=32767?Ur(L,13,h(ae,R,at.v)):Ur(L,14,g(ae,R,at.v));else{var mt=Zi(at);Ur(L,15,d(ae,R,mt.slice(0,239)))}}return Ur(L,1),L.end()}function i(F,U){var j=U||{};if(+j.codepage>=0&&$r(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Yx();Ur(L,0,a(F));for(var Q=0,oe=0;Q<F.SheetNames.length;++Q)(F.Sheets[F.SheetNames[Q]]||{})["!ref"]&&Ur(L,27,de(F.SheetNames[Q],oe++));var ue=0;for(Q=0;Q<F.SheetNames.length;++Q){var me=F.Sheets[F.SheetNames[Q]];if(!(!me||!me["!ref"])){for(var ae=Lt(me["!ref"]),tt=Array.isArray(me),R=[],It=Math.min(ae.e.r,8191),at=ae.s.r;at<=It;++at)for(var mt=xn(at),Ye=ae.s.c;Ye<=ae.e.c;++Ye){at===ae.s.r&&(R[Ye]=sn(Ye));var xe=R[Ye]+mt,Bt=tt?(me[at]||[])[Ye]:me[xe];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")Ur(L,23,P(at,Ye,ue,Bt.v));else{var dr=Zi(Bt);Ur(L,22,w(at,Ye,ue,dr.slice(0,239)))}}++ue}}return Ur(L,1),L.end()}function s(F){var U=Zt(2);return U.write_shift(2,F),U}function a(F){var U=Zt(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var j=0,L=0,Q=0,oe=0;oe<F.SheetNames.length;++oe){var ue=F.SheetNames[oe],me=F.Sheets[ue];if(!(!me||!me["!ref"])){++Q;var ae=Ho(me["!ref"]);j<ae.e.r&&(j=ae.e.r),L<ae.e.c&&(L=ae.e.c)}}return j>8191&&(j=8191),U.write_shift(2,j),U.write_shift(1,Q),U.write_shift(1,L),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(F,U,j){var L={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&j.qpro?(L.s.c=F.read_shift(1),F.l++,L.s.r=F.read_shift(2),L.e.c=F.read_shift(1),F.l++,L.e.r=F.read_shift(2),L):(L.s.c=F.read_shift(2),L.s.r=F.read_shift(2),U==12&&j.qpro&&(F.l+=2),L.e.c=F.read_shift(2),L.e.r=F.read_shift(2),U==12&&j.qpro&&(F.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(F){var U=Zt(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function u(F,U,j){var L=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(L[0].c=F.read_shift(1),L[3]=F.read_shift(1),L[0].r=F.read_shift(2),F.l+=2):(L[2]=F.read_shift(1),L[0].c=F.read_shift(2),L[0].r=F.read_shift(2)),L}function c(F,U,j){var L=F.l+U,Q=u(F,U,j);if(Q[1].t="s",j.vers==20768){F.l++;var oe=F.read_shift(1);return Q[1].v=F.read_shift(oe,"utf8"),Q}return j.qpro&&F.l++,Q[1].v=F.read_shift(L-F.l,"cstr"),Q}function d(F,U,j){var L=Zt(7+j.length);L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,F),L.write_shift(1,39);for(var Q=0;Q<L.length;++Q){var oe=j.charCodeAt(Q);L.write_shift(1,oe>=128?95:oe)}return L.write_shift(1,0),L}function f(F,U,j){var L=u(F,U,j);return L[1].v=F.read_shift(2,"i"),L}function h(F,U,j){var L=Zt(7);return L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,F),L.write_shift(2,j,"i"),L}function p(F,U,j){var L=u(F,U,j);return L[1].v=F.read_shift(8,"f"),L}function g(F,U,j){var L=Zt(13);return L.write_shift(1,255),L.write_shift(2,U),L.write_shift(2,F),L.write_shift(8,j,"f"),L}function m(F,U,j){var L=F.l+U,Q=u(F,U,j);if(Q[1].v=F.read_shift(8,"f"),j.qpro)F.l=L;else{var oe=F.read_shift(2);b(F.slice(F.l,F.l+oe),Q),F.l+=oe}return Q}function v(F,U,j){var L=U&32768;return U&=-32769,U=(L?F:0)+(U>=8192?U-16384:U),(L?"":"$")+(j?sn(U):xn(U))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(F,U){vn(F,0);for(var j=[],L=0,Q="",oe="",ue="",me="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:j.push(F.read_shift(8,"f"));break;case 1:oe=v(U[0].c,F.read_shift(2),!0),Q=v(U[0].r,F.read_shift(2),!1),j.push(oe+Q);break;case 2:{var tt=v(U[0].c,F.read_shift(2),!0),R=v(U[0].r,F.read_shift(2),!1);oe=v(U[0].c,F.read_shift(2),!0),Q=v(U[0].r,F.read_shift(2),!1),j.push(tt+R+":"+oe+Q)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(F.read_shift(2));break;case 6:{for(var It="";ae=F[F.l++];)It+=String.fromCharCode(ae);j.push('"'+It.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:me=j.pop(),ue=j.pop(),j.push(["AND","OR"][ae-20]+"("+ue+","+me+")");break;default:if(ae<32&&_[ae])me=j.pop(),ue=j.pop(),j.push(ue+_[ae]+me);else if(x[ae]){if(L=x[ae][1],L==69&&(L=F[F.l++]),L>j.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+j.join("|")+"|");return}var at=j.slice(-L);j.length-=L,j.push(x[ae][0]+"("+at.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}j.length==1?U[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function D(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function A(F,U){var j=D(F,U);return j[1].t="s",j[1].v=F.read_shift(U-4,"cstr"),j}function w(F,U,j,L){var Q=Zt(6+L.length);Q.write_shift(2,F),Q.write_shift(1,j),Q.write_shift(1,U),Q.write_shift(1,39);for(var oe=0;oe<L.length;++oe){var ue=L.charCodeAt(oe);Q.write_shift(1,ue>=128?95:ue)}return Q.write_shift(1,0),Q}function T(F,U){var j=D(F,U);j[1].v=F.read_shift(2);var L=j[1].v>>1;if(j[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return j[1].v=L,j}function E(F,U){var j=D(F,U),L=F.read_shift(4),Q=F.read_shift(4),oe=F.read_shift(2);if(oe==65535)return L===0&&Q===3221225472?(j[1].t="e",j[1].v=15):L===0&&Q===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ue=oe&32768;return oe=(oe&32767)-16446,j[1].v=(1-ue*2)*(Q*Math.pow(2,oe+32)+L*Math.pow(2,oe)),j}function P(F,U,j,L){var Q=Zt(14);if(Q.write_shift(2,F),Q.write_shift(1,j),Q.write_shift(1,U),L==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var oe=0,ue=0,me=0,ae=0;return L<0&&(oe=1,L=-L),ue=Math.log2(L)|0,L/=Math.pow(2,ue-31),ae=L>>>0,ae&2147483648||(L/=2,++ue,ae=L>>>0),L-=ae,ae|=2147483648,ae>>>=0,L*=Math.pow(2,32),me=L>>>0,Q.write_shift(4,me),Q.write_shift(4,ae),ue+=16383+(oe?32768:0),Q.write_shift(2,ue),Q}function N(F,U){var j=E(F,14);return F.l+=U-14,j}function O(F,U){var j=D(F,U),L=F.read_shift(4);return j[1].v=L>>6,j}function Y(F,U){var j=D(F,U),L=F.read_shift(8,"f");return j[1].v=L,j}function se(F,U){var j=Y(F,14);return F.l+=U-10,j}function ie(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function ge(F,U){var j=F[F.l++];j>U-1&&(j=U-1);for(var L="";L.length<j;)L+=String.fromCharCode(F[F.l++]);return L}function J(F,U,j){if(!(!j.qpro||U<21)){var L=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Q=F.read_shift(U-21,"cstr");return[L,Q]}}function _e(F,U){for(var j={},L=F.l+U;F.l<L;){var Q=F.read_shift(2);if(Q==14e3){for(j[Q]=[0,""],j[Q][0]=F.read_shift(2);F[F.l];)j[Q][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return j}function de(F,U){var j=Zt(5+F.length);j.write_shift(2,14e3),j.write_shift(2,U);for(var L=0;L<F.length;++L){var Q=F.charCodeAt(L);j[j.l++]=Q>127?95:Q}return j[j.l++]=0,j}var ye={0:{n:"BOF",f:Qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:ge},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:_e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}}();function YU(n){var e={},t=n.match(kn),r=0,i=!1;if(t)for(;r!=t.length;++r){var s=ke(t[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=s1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var KU=function(){var n=$c("t"),e=$c("rPr");function t(s){var a=s.match(n);if(!a)return{t:"s",v:""};var o={t:"s",v:lt(a[1])},l=s.match(e);return l&&(o.s=YU(l[1])),o}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(r,"").split(i).map(t).filter(function(o){return o.v})}}(),QU=function(){var e=/(\r\n|\n)/g;function t(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function r(i){var s=[[],i.v,[]];return i.v?(i.s&&t(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),ZU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,JU=/<(?:\w+:)?r>/,eH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function S1(n,e){var t=e?e.cellHTML:!0,r={};return n?(n.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=lt(wt(n.slice(n.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=wt(n),t&&(r.h=f1(r.t))):n.match(JU)&&(r.r=wt(n),r.t=lt(wt((n.replace(eH,"").match(ZU)||[]).join("").replace(kn,""))),t&&(r.h=QU(KU(r.r)))),r):{t:""}}var tH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nH=/<(?:\w+:)?(?:si|sstItem)>/g,rH=/<\/(?:\w+:)?(?:si|sstItem)>/;function iH(n,e){var t=[],r="";if(!n)return t;var i=n.match(tH);if(i){r=i[2].replace(nH,"").split(rH);for(var s=0;s!=r.length;++s){var a=S1(r[s].trim(),e);a!=null&&(t[t.length]=a)}i=ke(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function sH(n){return[n.read_shift(4),n.read_shift(4)]}function aH(n,e){var t=[],r=!1;return Ji(n,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function JD(n){if(typeof ht<"u")return ht.utils.encode(Lo,n);for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function Qi(n,e){var t={};return t.Major=n.read_shift(2),t.Minor=n.read_shift(2),e>=4&&(n.l+=e-4),t}function oH(n){var e={};return e.id=n.read_shift(0,"lpp4"),e.R=Qi(n,4),e.U=Qi(n,4),e.W=Qi(n,4),e}function lH(n){for(var e=n.read_shift(4),t=n.l+e-4,r={},i=n.read_shift(4),s=[];i-- >0;)s.push({t:n.read_shift(4),v:n.read_shift(0,"lpp4")});if(r.name=n.read_shift(0,"lpp4"),r.comps=s,n.l!=t)throw new Error("Bad DataSpaceMapEntry: "+n.l+" != "+t);return r}function cH(n){var e=[];n.l+=4;for(var t=n.read_shift(4);t-- >0;)e.push(lH(n));return e}function uH(n){var e=[];n.l+=4;for(var t=n.read_shift(4);t-- >0;)e.push(n.read_shift(0,"lpp4"));return e}function dH(n){var e={};return n.read_shift(4),n.l+=4,e.id=n.read_shift(0,"lpp4"),e.name=n.read_shift(0,"lpp4"),e.R=Qi(n,4),e.U=Qi(n,4),e.W=Qi(n,4),e}function fH(n){var e=dH(n);if(e.ename=n.read_shift(0,"8lpp4"),e.blksz=n.read_shift(4),e.cmode=n.read_shift(4),n.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function eI(n,e){var t=n.l+e,r={};r.Flags=n.read_shift(4)&63,n.l+=4,r.AlgID=n.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=n.read_shift(4),r.KeySize=n.read_shift(4),r.ProviderType=n.read_shift(4),n.l+=8,r.CSPName=n.read_shift(t-n.l>>1,"utf16le"),n.l=t,r}function tI(n,e){var t={},r=n.l+e;return n.l+=4,t.Salt=n.slice(n.l,n.l+16),n.l+=16,t.Verifier=n.slice(n.l,n.l+16),n.l+=16,n.read_shift(4),t.VerifierHash=n.slice(n.l,r),n.l=r,t}function hH(n){var e=Qi(n);switch(e.Minor){case 2:return[e.Minor,pH(n,e)];case 3:return[e.Minor,gH(n,e)];case 4:return[e.Minor,mH(n,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function pH(n){var e=n.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=n.read_shift(4),r=eI(n,t),i=tI(n,n.length-n.l);return{t:"Std",h:r,v:i}}function gH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mH(n){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];n.l+=4;var t=n.read_shift(n.length-n.l,"utf8"),r={};return t.replace(kn,function(s){var a=ke(s);switch(_i(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){r[o]=a[o]});break;case"<dataIntegrity":r.encryptedHmacKey=a.encryptedHmacKey,r.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(a);break;default:throw a[0]}}),r}function vH(n,e){var t={},r=t.EncryptionVersionInfo=Qi(n,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=n.read_shift(4),e-=4;var i=n.read_shift(4);return e-=4,t.EncryptionHeader=eI(n,i),e-=i,t.EncryptionVerifier=tI(n,e),t}function _H(n){var e={},t=e.EncryptionVersionInfo=Qi(n,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=n.read_shift(16),e.EncryptedVerifier=n.read_shift(16),e.EncryptedVerifierHash=n.read_shift(16),e}function xH(n){var e=0,t,r=JD(n),i=r.length+1,s,a,o,l,u;for(t=Ms(i),t[0]=r.length,s=1;s!=i;++s)t[s]=r[s-1];for(s=i-1;s>=0;--s)a=t[s],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var nI=function(){var n=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(a){return(a/2|a*128)&255},i=function(a,o){return r(a^o)},s=function(a){for(var o=e[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var c=a[u],d=0;d!=7;++d)c&64&&(o^=t[l]),c*=2,--l;return o};return function(a){for(var o=JD(a),l=s(o),u=o.length,c=Ms(16),d=0;d!=16;++d)c[d]=0;var f,h,p;for((u&1)===1&&(f=l>>8,c[u]=i(n[0],f),--u,f=l&255,h=o[o.length-1],c[u]=i(h,f));u>0;)--u,f=l>>8,c[u]=i(o[u],f),--u,f=l&255,c[u]=i(o[u],f);for(u=15,p=15-o.length;p>0;)f=l>>8,c[u]=i(n[p],f),--u,--p,f=l&255,c[u]=i(o[u],f),--u,--p;return c}}(),yH=function(n,e,t,r,i){i||(i=e),r||(r=nI(n));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=r[t],a=(a>>5|a<<3)&255,i[s]=a,++t;return[i,t,r]},wH=function(n){var e=0,t=nI(n);return function(r){var i=yH("",r,e,t);return e=i[1],i[0]}};function bH(n,e,t,r){var i={key:Qt(n),verificationBytes:Qt(n)};return t.password&&(i.verifier=xH(t.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=wH(t.password)),i}function EH(n,e,t){var r=t||{};return r.Info=n.read_shift(2),n.l-=2,r.Info===1?r.Data=_H(n,e):r.Data=vH(n,e),r}function AH(n,e,t){var r={Type:t.biff>=8?n.read_shift(2):0};return r.Type?EH(n,e-2,r):bH(n,t.biff>=8?e:e-2,t,r),r}var CH=function(){function n(i,s){switch(s.type){case"base64":return e(ur(i),s);case"binary":return e(i,s);case"buffer":return e(et&&Buffer.isBuffer(i)?i.toString("binary"):Ca(i),s);case"array":return e(ba(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,d){Array.isArray(o)&&(o[d]=[]);for(var f=/\\\w+\b/g,h=0,p,g=-1;p=f.exec(c);){switch(p[0]){case"\\cell":var m=c.slice(h,f.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var v={v:m,t:"s"};Array.isArray(o)?o[d][g]=v:o[Be({r:d,c:g})]=v}break}h=f.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=st(u),o}function t(i,s){return Ps(n(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=Lt(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var d=Be({r:u,c});o=l?(i[u]||[])[c]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Zi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:r}}();function SH(n){var e=n.slice(n[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Gc(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}function TH(n){var e=n[0]/255,t=n[1]/255,r=n[2]/255,i=Math.max(e,t,r),s=Math.min(e,t,r),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case e:o=((t-r)/a+6)%6;break;case t:o=(r-e)/a+2;break;case r:o=(e-t)/a+4;break}return[o/6,l,u/2]}function DH(n){var e=n[0],t=n[1],r=n[2],i=t*2*(r<.5?r:1-r),s=r-i/2,a=[s,s,s],o=6*e,l;if(t!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function tp(n,e){if(e===0)return n;var t=TH(SH(n));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Gc(DH(t))}var rI=6,IH=15,kH=1,Vn=rI;function np(n){return Math.floor((n+Math.round(128/Vn)/256)*Vn)}function rp(n){return Math.floor((n-5)/Vn*100+.5)/100}function Jx(n){return Math.round((n*Vn+5)/Vn*256)/256}function Hx(n){return Jx(rp(np(n)))}function T1(n){var e=Math.abs(n-Hx(n)),t=Vn;if(e>.005)for(Vn=kH;Vn<IH;++Vn)Math.abs(n-Hx(n))<=e&&(e=Math.abs(n-Hx(n)),t=Vn);Vn=t}function Vo(n){n.width?(n.wpx=np(n.width),n.wch=rp(n.wpx),n.MDW=Vn):n.wpx?(n.wch=rp(n.wpx),n.width=Jx(n.wch),n.MDW=Vn):typeof n.wch=="number"&&(n.width=Jx(n.wch),n.wpx=np(n.width),n.MDW=Vn),n.customWidth&&delete n.customWidth}var MH=96,iI=MH;function sI(n){return n*96/iI}function qc(n){return n*iI/96}var FH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function PH(n,e,t,r){e.Borders=[];var i={},s=!1;(n[0].match(kn)||[]).forEach(function(a){var o=ke(a);switch(_i(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Dt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Dt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function RH(n,e,t,r){e.Fills=[];var i={},s=!1;(n[0].match(kn)||[]).forEach(function(a){var o=ke(a);switch(_i(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function NH(n,e,t,r){e.Fonts=[];var i={},s=!1;(n[0].match(kn)||[]).forEach(function(a){var o=ke(a);switch(_i(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=wt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Dt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Dt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Dt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Dt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Dt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Dt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Dt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=s1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Dt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=ya[i.color.index];i.color.index==81&&(l=ya[1]),l||(l=ya[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=tp(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function OH(n,e,t){e.NumberFmt=[];for(var r=vi(je),i=0;i<r.length;++i)e.NumberFmt[r[i]]=je[r[i]];var s=n[0].match(kn);if(s)for(i=0;i<s.length;++i){var a=ke(s[i]);switch(_i(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(wt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}xa(o,l)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var zh=["numFmtId","fillId","fontId","borderId","xfId"],Gh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function LH(n,e,t){e.CellXf=[];var r,i=!1;(n[0].match(kn)||[]).forEach(function(s){var a=ke(s),o=0;switch(_i(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=a,delete r[0],o=0;o<zh.length;++o)r[zh[o]]&&(r[zh[o]]=parseInt(r[zh[o]],10));for(o=0;o<Gh.length;++o)r[Gh[o]]&&(r[Gh[o]]=Dt(r[Gh[o]]));if(e.NumberFmt&&r.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[o]){r.numFmtId=o;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Dt(a.wrapText)),r.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var BH=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&OH(d,c,u),(d=o.match(i))&&NH(d,c,l,u),(d=o.match(r))&&RH(d,c,l,u),(d=o.match(s))&&PH(d,c,l,u),(d=o.match(t))&&LH(d,c,u),c}}();function VH(n,e){var t=n.read_shift(2),r=Dn(n,e-2);return[t,r]}function jH(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=K5(n,2,t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var o=n.read_shift(1);o>0&&(r.family=o);var l=n.read_shift(1);switch(l>0&&(r.charset=l),n.l++,r.color=Y5(n,8),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Dn(n,e-21),r}var UH=In;function HH(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}var $H=In;function WH(n,e,t){var r={};r.NumberFmt=[];for(var i in je)r.NumberFmt[i]=je[i];r.CellXf=[],r.Fonts=[];var s=[],a=!1;return Ji(n,function(l,u,c){switch(c){case 44:r.NumberFmt[l[0]]=l[1],xa(l[1],l[0]);break;case 43:r.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=tp(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(c),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(c);else if(u.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}var zH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function GH(n,e,t){e.themeElements.clrScheme=[];var r={};(n[0].match(kn)||[]).forEach(function(i){var s=ke(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[zH.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function qH(){}function XH(){}var YH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,KH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,QH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ZH(n,e,t){e.themeElements={};var r;[["clrScheme",YH,GH],["fontScheme",KH,qH],["fmtScheme",QH,XH]].forEach(function(i){if(!(r=n.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,e,t)})}var JH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function aI(n,e){(!n||n.length===0)&&(n=e9());var t,r={};if(!(t=n.match(JH)))throw new Error("themeElements not found in theme");return ZH(t[0],r,e),r.raw=n,r}function e9(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[bD];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function t9(n,e,t){var r=n.l+e,i=n.read_shift(4);if(i!==124226){if(!t.cellStyles){n.l=r;return}var s=n.slice(n.l);n.l=r;var a;try{a=wD(s,{type:"array"})}catch{return}var o=cr(a,"theme/theme/theme1.xml",!0);if(o)return aI(o,t)}}function n9(n){return n.read_shift(4)}function r9(n){var e={};switch(e.xclrType=n.read_shift(2),e.nTintShade=n.read_shift(2),e.xclrType){case 0:n.l+=4;break;case 1:e.xclrValue=i9(n,4);break;case 2:e.xclrValue=GD(n,4);break;case 3:e.xclrValue=n9(n,4);break;case 4:n.l+=4;break}return n.l+=8,e}function i9(n,e){return In(n,e)}function s9(n,e){return In(n,e)}function a9(n){var e=n.read_shift(2),t=n.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=r9(n,t);break;case 6:r[1]=s9(n,t);break;case 14:case 15:r[1]=n.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return r}function o9(n,e){var t=n.l+e;n.l+=2;var r=n.read_shift(2);n.l+=2;for(var i=n.read_shift(2),s=[];i-- >0;)s.push(a9(n,t-n.l));return{ixfe:r,ext:s}}function l9(n,e){e.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function c9(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Dn(n,e-8)}}function u9(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function d9(n){return n.l+=4,n.read_shift(4)!=0}function f9(n,e,t){var r={Types:[],Cell:[],Value:[]},i=t||{},s=[],a=!1,o=2;return Ji(n,function(l,u,c){switch(c){case 335:r.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?r.Cell.push({type:r.Types[d[0]-1].name,index:d[1]}):o==0&&r.Value.push({type:r.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(c),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function h9(n,e,t){var r={Types:[],Cell:[],Value:[]};if(!n)return r;var i=!1,s=2,a;return n.replace(kn,function(o){var l=ke(o);switch(_i(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<r.Types.length;++u)r.Types[u].name==l.name&&(a=r.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[l.t-1].name,index:+l.v}):s==0&&r.Value.push({type:r.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),r}function p9(n){var e=[];if(!n)return e;var t=1;return(n.match(kn)||[]).forEach(function(r){var i=ke(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,e.push(i);break}}),e}function g9(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Be(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function m9(n,e,t){var r=[],i=!1;return Ji(n,function(a,o,l){switch(l){case 63:r.push(a);break;default:if(!o.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function v9(n,e,t,r){if(!n)return n;var i=r||{},s=!1,a=!1;Ji(n,function(l,u,c){if(!a)switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function _9(n,e){if(!n)return"??";var t=(n.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}function BT(n,e,t,r){var i=Array.isArray(n),s;e.forEach(function(a){var o=jn(a.ref);if(i?(n[o.r]||(n[o.r]=[]),s=n[o.r][o.c]):s=n[a.ref],!s){s={t:"z"},i?n[o.r][o.c]=s:n[a.ref]=s;var l=Lt(n["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=st(l);u!==n["!ref"]&&(n["!ref"]=u)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:t};a.h&&(c.h=a.h);for(var d=s.c.length-1;d>=0;--d){if(!t&&s.c[d].T)return;t&&!s.c[d].T&&s.c.splice(d,1)}if(t&&r){for(d=0;d<r.length;++d)if(c.a==r[d].id){c.a=r[d].name||c.a;break}}s.c.push(c)})}function x9(n,e){if(n.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],i=n.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=n.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ke(o[0]),u={author:l.authorId&&t[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=jn(l.ref);if(!(e.sheetRows&&e.sheetRows<=c.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!d&&!!d[1]&&S1(d[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=f.h),r.push(u)}}}}),r}function y9(n,e){var t=[],r=!1,i={},s=0;return n.replace(kn,function(o,l){var u=ke(o);switch(_i(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=n.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),t}function w9(n,e){var t=[],r=!1;return n.replace(kn,function(s){var a=ke(s);switch(_i(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function b9(n){var e={};e.iauthor=n.read_shift(4);var t=Ta(n,16);return e.rfx=t.s,e.ref=Be(t.s),n.l+=16,e}var E9=Dn;function A9(n,e){var t=[],r=[],i={},s=!1;return Ji(n,function(o,l,u){switch(u){case 632:r.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),t}var C9="application/vnd.ms-office.vbaProject";function S9(n){var e=it.utils.cfb_new({root:"R"});return n.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");it.utils.cfb_add(e,i,n.FileIndex[r].content)}}),it.write(e)}function T9(){return{"!type":"dialog"}}function D9(){return{"!type":"dialog"}}function I9(){return{"!type":"macro"}}function k9(){return{"!type":"macro"}}var No=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=e.c:--c,l?u+=e.r:--u,i+(o?"":"$")+sn(c)+(l?"":"$")+xn(u)}return function(i,s){return e=s,i.replace(n,t)}}(),oI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,M9=function(){return function(e,t){return e.replace(oI,function(r,i,s,a,o,l){var u=y1(a)-(s?0:t.c),c=x1(l)-(o?0:t.r),d=c==0?"":o?c+1:"["+c+"]",f=u==0?"":s?u+1:"["+u+"]";return i+"R"+d+"C"+f})}}();function lI(n,e){return n.replace(oI,function(t,r,i,s,a,o){return r+(i=="$"?i+s:sn(y1(s)+e.c))+(a=="$"?a+o:xn(x1(o)+e.r))})}function F9(n,e,t){var r=Ho(e),i=r.s,s=jn(t),a={r:s.r-i.r,c:s.c-i.c};return lI(n,a)}function P9(n){return n.length!=1}function VT(n){return n.replace(/_xlfn\./g,"")}function Yt(n){n.l+=1}function Fs(n,e){var t=n.read_shift(e==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function cI(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return uI(n,e,t);t.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=Fs(n,2),o=Fs(n,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function uI(n){var e=Fs(n,2),t=Fs(n,2),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function R9(n,e,t){if(t.biff<8)return uI(n,e,t);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),s=Fs(n,2),a=Fs(n,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function dI(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return N9(n,e,t);var r=n.read_shift(t&&t.biff==12?4:2),i=Fs(n,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function N9(n){var e=Fs(n,2),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function O9(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function L9(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return B9(n,e,t);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function B9(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function V9(n,e,t){var r=(n[n.l++]&96)>>5,i=cI(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function j9(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=cI(n,s,t);return[r,i,a]}function U9(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function H9(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(t)switch(t.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function $9(n,e,t){var r=(n[n.l++]&96)>>5,i=R9(n,e-1,t);return[r,i]}function W9(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function jT(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function z9(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function G9(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function q9(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function X9(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function Y9(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function fI(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function K9(n){return n.read_shift(2),fI(n,2)}function Q9(n){return n.read_shift(2),fI(n,2)}function Z9(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=dI(n,0,t);return[r,i]}function J9(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=L9(n,0,t);return[r,i]}function e$(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var s=dI(n,0,t);return[r,i,s]}function t$(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[n7[i],gI[i],r]}function n$(n,e,t){var r=n[n.l++],i=n.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:r$(n);return[i,(s[0]===0?gI:t7)[s[1]]]}function r$(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function i$(n,e,t){n.l+=t&&t.biff==2?3:4}function s$(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function a$(n){return n.l++,Da[n.read_shift(1)]}function o$(n){return n.l++,n.read_shift(2)}function l$(n){return n.l++,n.read_shift(1)!==0}function c$(n){return n.l++,Cn(n,8)}function u$(n,e,t){return n.l++,Kc(n,e-1,t)}function d$(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Ht(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=Da[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Cn(n,8);break;case 2:t[1]=Ia(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function f$(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((t.biff==12?Ta:lp)(n,8));return i}function h$(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=d$(n,t.biff);return a}function p$(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,s=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function g$(n,e,t){if(t.biff==5)return m$(n,e,t);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function m$(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function v$(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function _$(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function x$(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function y$(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var w$=In,b$=In,E$=In;function Zc(n,e,t){return n.l+=2,[O9(n,4,t)]}function D1(n){return n.l+=6,[]}var A$=Zc,C$=D1,S$=D1,T$=Zc;function hI(n){return n.l+=2,[Qt(n),n.read_shift(2)&1]}var D$=Zc,I$=hI,k$=D1,M$=Zc,F$=Zc,P$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function R$(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=P$[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:i,C:s}}function N$(n){return n.l+=2,[n.read_shift(4)]}function O$(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function L$(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function B$(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function V$(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function j$(n){return n.l+=4,[0,0]}var UT={1:{n:"PtgExp",f:s$},2:{n:"PtgTbl",f:E$},3:{n:"PtgAdd",f:Yt},4:{n:"PtgSub",f:Yt},5:{n:"PtgMul",f:Yt},6:{n:"PtgDiv",f:Yt},7:{n:"PtgPower",f:Yt},8:{n:"PtgConcat",f:Yt},9:{n:"PtgLt",f:Yt},10:{n:"PtgLe",f:Yt},11:{n:"PtgEq",f:Yt},12:{n:"PtgGe",f:Yt},13:{n:"PtgGt",f:Yt},14:{n:"PtgNe",f:Yt},15:{n:"PtgIsect",f:Yt},16:{n:"PtgUnion",f:Yt},17:{n:"PtgRange",f:Yt},18:{n:"PtgUplus",f:Yt},19:{n:"PtgUminus",f:Yt},20:{n:"PtgPercent",f:Yt},21:{n:"PtgParen",f:Yt},22:{n:"PtgMissArg",f:Yt},23:{n:"PtgStr",f:u$},26:{n:"PtgSheet",f:O$},27:{n:"PtgEndSheet",f:L$},28:{n:"PtgErr",f:a$},29:{n:"PtgBool",f:l$},30:{n:"PtgInt",f:o$},31:{n:"PtgNum",f:c$},32:{n:"PtgArray",f:W9},33:{n:"PtgFunc",f:t$},34:{n:"PtgFuncVar",f:n$},35:{n:"PtgName",f:p$},36:{n:"PtgRef",f:Z9},37:{n:"PtgArea",f:V9},38:{n:"PtgMemArea",f:v$},39:{n:"PtgMemErr",f:w$},40:{n:"PtgMemNoMem",f:b$},41:{n:"PtgMemFunc",f:_$},42:{n:"PtgRefErr",f:x$},43:{n:"PtgAreaErr",f:U9},44:{n:"PtgRefN",f:J9},45:{n:"PtgAreaN",f:$9},46:{n:"PtgMemAreaN",f:B$},47:{n:"PtgMemNoMemN",f:V$},57:{n:"PtgNameX",f:g$},58:{n:"PtgRef3d",f:e$},59:{n:"PtgArea3d",f:j9},60:{n:"PtgRefErr3d",f:y$},61:{n:"PtgAreaErr3d",f:H9},255:{}},U$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H$={1:{n:"PtgElfLel",f:hI},2:{n:"PtgElfRw",f:M$},3:{n:"PtgElfCol",f:A$},6:{n:"PtgElfRwV",f:F$},7:{n:"PtgElfColV",f:T$},10:{n:"PtgElfRadical",f:D$},11:{n:"PtgElfRadicalS",f:k$},13:{n:"PtgElfColS",f:C$},15:{n:"PtgElfColSV",f:S$},16:{n:"PtgElfRadicalLel",f:I$},25:{n:"PtgList",f:R$},29:{n:"PtgSxName",f:N$},255:{}},$$={0:{n:"PtgAttrNoop",f:j$},1:{n:"PtgAttrSemi",f:Y9},2:{n:"PtgAttrIf",f:q9},4:{n:"PtgAttrChoose",f:z9},8:{n:"PtgAttrGoto",f:G9},16:{n:"PtgAttrSum",f:i$},32:{n:"PtgAttrBaxcel",f:jT},33:{n:"PtgAttrBaxcel",f:jT},64:{n:"PtgAttrSpace",f:K9},65:{n:"PtgAttrSpaceSemi",f:Q9},128:{n:"PtgAttrIfError",f:X9},255:{}};function Jc(n,e,t,r){if(r.biff<8)return In(n,e);for(var i=n.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=h$(n,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=f$(n,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=n.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0];default:break}return e=i-n.l,e!==0&&s.push(In(n,e)),s}function eu(n,e,t){for(var r=n.l+e,i,s,a=[];r!=n.l;)e=r-n.l,s=n[n.l],i=UT[s]||UT[U$[s]],(s===24||s===25)&&(i=(s===24?H$:$$)[n[n.l+1]]),!i||!i.f?In(n,e):a.push([i.n,i.f(n,e,t)]);return a}function W$(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var z$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function G$(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function pI(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function HT(n,e,t){var r=pI(n,e,t);return r=="#REF"?r:G$(r,t)}function An(n,e,t,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,u,c,d=0,f=0,h,p="";if(!n[0]||!n[0][0])return"";for(var g=-1,m="",v=0,x=n[0].length;v<x;++v){var _=n[0][v];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(n[0][g][1][0]){case 0:m=Ot(" ",n[0][g][1][1]);break;case 1:m=Ot("\r",n[0][g][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][g][1][0])}u=u+m,g=-1}o.push(u+z$[_[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Rc(_[1][1],a,i),o.push(Nc(c,s));break;case"PtgRefN":c=t?Rc(_[1][1],t,i):_[1][1],o.push(Nc(c,s));break;case"PtgRef3d":d=_[1][1],c=Rc(_[1][2],a,i),p=HT(r,d,i);var b=p;o.push(p+"!"+Nc(c,s));break;case"PtgFunc":case"PtgFuncVar":var D=_[1][0],A=_[1][1];D||(D=0),D&=127;var w=D==0?[]:o.slice(-D);o.length-=D,A==="User"&&(A=w.shift()),o.push(A+"("+w.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":h=bT(_[1][1],t?{s:t}:a,i),o.push(jx(h,i));break;case"PtgArea":h=bT(_[1][1],a,i),o.push(jx(h,i));break;case"PtgArea3d":d=_[1][1],h=_[1][2],p=HT(r,d,i),o.push(p+"!"+jx(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=_[1][2];var T=(r.names||[])[f-1]||(r[0]||[])[f],E=T?T.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var P=_[1][1];f=_[1][2];var N;if(i.biff<=5)P<0&&(P=-P),r[P]&&(N=r[P][f]);else{var O="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][f]&&r[P][f].itab>0&&(O=r.SheetNames[r[P][f].itab-1]+"!"):O=r.SheetNames[f-1]+"!"),r[P]&&r[P][f])O+=r[P][f].Name;else if(r[0]&&r[0][f])O+=r[0][f].Name;else{var Y=(pI(r,P,i)||"").split(";;");Y[f-1]?O=Y[f-1]:O+="SH33TJSERRX"}o.push(O);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var se="(",ie=")";if(g>=0){switch(m="",n[0][g][1][0]){case 2:se=Ot(" ",n[0][g][1][1])+se;break;case 3:se=Ot("\r",n[0][g][1][1])+se;break;case 4:ie=Ot(" ",n[0][g][1][1])+ie;break;case 5:ie=Ot("\r",n[0][g][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][g][1][0])}g=-1}o.push(se+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:_[1][1],r:_[1][0]};var ge={c:t.c,r:t.r};if(r.sharedf[Be(c)]){var J=r.sharedf[Be(c)];o.push(An(J,a,ge,r,i))}else{var _e=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(An(u[1],a,ge,r,i)),_e=!0;break}_e||o.push(_[1])}break;case"PtgArray":o.push("{"+W$(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&de.indexOf(n[0][v][0])==-1){_=n[0][g];var ye=!0;switch(_[1][0]){case 4:ye=!1;case 0:m=Ot(" ",_[1][1]);break;case 5:ye=!1;case 1:m=Ot("\r",_[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((ye?m:"")+o.pop()+(ye?"":m)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function q$(n,e,t){var r=n.l+e,i=t.biff==2?1:2,s,a=n.read_shift(i);if(a==65535)return[[],In(n,e-2)];var o=eu(n,a,t);return e!==a+i&&(s=Jc(n,e-a-i,o,t)),n.l=r,[o,s]}function X$(n,e,t){var r=n.l+e,i=t.biff==2?1:2,s,a=n.read_shift(i);if(a==65535)return[[],In(n,e-2)];var o=eu(n,a,t);return e!==a+i&&(s=Jc(n,e-a-i,o,t)),n.l=r,[o,s]}function Y$(n,e,t,r){var i=n.l+e,s=eu(n,r,t),a;return i!==n.l&&(a=Jc(n,i-n.l,s,t)),[s,a]}function K$(n,e,t){var r=n.l+e,i,s=n.read_shift(2),a=eu(n,s,t);return s==65535?[[],In(n,e-2)]:(e!==s+2&&(i=Jc(n,r-s-2,a,t)),[a,i])}function Q$(n){var e;if(Yi(n,n.l+6)!==65535)return[Cn(n),"n"];switch(n[n.l]){case 0:return n.l+=8,["String","s"];case 1:return e=n[n.l+2]===1,n.l+=8,[e,"b"];case 2:return e=n[n.l+2],n.l+=8,[e,"e"];case 3:return n.l+=8,["","s"]}return[]}function $x(n,e,t){var r=n.l+e,i=xi(n,6);t.biff==2&&++n.l;var s=Q$(n,8),a=n.read_shift(1);t.biff!=2&&(n.read_shift(1),t.biff>=5&&n.read_shift(4));var o=X$(n,r-n.l,t);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function cp(n,e,t){var r=n.read_shift(4),i=eu(n,r,t),s=n.read_shift(4),a=s>0?Jc(n,s,i,t):null;return[i,a]}var Z$=cp,up=cp,J$=cp,e7=cp,t7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},n7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $T(n){return n.slice(0,3)=="of:"&&(n=n.slice(3)),n.charCodeAt(0)==61&&(n=n.slice(1),n.charCodeAt(0)==61&&(n=n.slice(1))),n=n.replace(/COM\.MICROSOFT\./g,""),n=n.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),n=n.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),n.replace(/[;~]/g,",").replace(/\|/g,";")}function Wx(n){var e=n.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Vc={},Oo={};function jc(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function mI(n,e,t,r,i,s){try{r.cellNF&&(n.z=je[e])}catch(o){if(r.WTF)throw o}if(!(n.t==="z"&&!r.cellStyles)){if(n.t==="d"&&typeof n.v=="string"&&(n.v=dn(n.v)),(!r||r.cellText!==!1)&&n.t!=="z")try{if(je[e]==null&&xa(r5[e]||"General",e),n.t==="e")n.w=n.w||Da[n.v];else if(e===0)if(n.t==="n")(n.v|0)===n.v?n.w=n.v.toString(10):n.w=Hc(n.v);else if(n.t==="d"){var a=Un(n.v);(a|0)===a?n.w=a.toString(10):n.w=Hc(a)}else{if(n.v===void 0)return"";n.w=wa(n.v,Oo)}else n.t==="d"?n.w=Er(e,Un(n.v),Oo):n.w=Er(e,n.v,Oo)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&t!=null)try{n.s=s.Fills[t],n.s.fgColor&&n.s.fgColor.theme&&!n.s.fgColor.rgb&&(n.s.fgColor.rgb=tp(i.themeElements.clrScheme[n.s.fgColor.theme].rgb,n.s.fgColor.tint||0),r.WTF&&(n.s.fgColor.raw_rgb=i.themeElements.clrScheme[n.s.fgColor.theme].rgb)),n.s.bgColor&&n.s.bgColor.theme&&(n.s.bgColor.rgb=tp(i.themeElements.clrScheme[n.s.bgColor.theme].rgb,n.s.bgColor.tint||0),r.WTF&&(n.s.bgColor.raw_rgb=i.themeElements.clrScheme[n.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&s.Fills)throw o}}}function r7(n,e){var t=Lt(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(n["!ref"]=st(t))}var i7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,s7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,a7=/<(?:\w:)?hyperlink [^>]*>/mg,o7=/"(\w*:\w*)"/,l7=/<(?:\w:)?col\b[^>]*[\/]?>/g,c7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,u7=/<(?:\w:)?pageMargins[^>]*\/>/g,vI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,d7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,f7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function h7(n,e,t,r,i,s,a){if(!n)return n;r||(r={"!id":{}}),Jt!=null&&e.dense==null&&(e.dense=Jt);var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",d=n.match(s7);d?(u=n.slice(0,d.index),c=n.slice(d.index+d[0].length)):u=c=n;var f=u.match(vI);f?I1(f[0],o,i,t):(f=u.match(d7))&&p7(f[0],f[1]||"",o,i,t,a,s);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var p=u.slice(h,h+50).match(o7);p&&r7(o,p[1])}var g=u.match(f7);g&&g[1]&&y7(g[1],i);var m=[];if(e.cellStyles){var v=u.match(l7);v&&v7(m,v)}d&&w7(d[1],o,e,l,s,a);var x=c.match(c7);x&&(o["!autofilter"]=_7(x[0]));var _=[],b=c.match(i7);if(b)for(h=0;h!=b.length;++h)_[h]=Lt(b[h].slice(b[h].indexOf('"')+1));var D=c.match(a7);D&&g7(o,D,r);var A=c.match(u7);if(A&&(o["!margins"]=m7(ke(A[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=st(l)),e.sheetRows>0&&o["!ref"]){var w=Lt(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=st(w))}return m.length>0&&(o["!cols"]=m),_.length>0&&(o["!merges"]=_),o}function I1(n,e,t,r){var i=ke(n);t.Sheets[r]||(t.Sheets[r]={}),i.codeName&&(t.Sheets[r].CodeName=lt(wt(i.codeName)))}function p7(n,e,t,r,i){I1(n.slice(0,n.indexOf(">")),t,r,i)}function g7(n,e,t){for(var r=Array.isArray(n),i=0;i!=e.length;++i){var s=ke(wt(e[i]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+lt(s.location))):(s.Target="#"+lt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Lt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var c=Be({c:u,r:l});r?(n[l]||(n[l]=[]),n[l][u]||(n[l][u]={t:"z",v:void 0}),n[l][u].l=s):(n[c]||(n[c]={t:"z",v:void 0}),n[c].l=s)}}}function m7(n){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){n[t]&&(e[t]=parseFloat(n[t]))}),e}function v7(n,e){for(var t=!1,r=0;r!=e.length;++r){var i=ke(e[r],!0);i.hidden&&(i.hidden=Dt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,T1(i.width)),Vo(i);s<=a;)n[s++]=_n(i)}}function _7(n){var e={ref:(n.match(/ref="([^"]*)"/)||[])[1]};return e}var x7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function y7(n,e){e.Views||(e.Views=[{}]),(n.match(x7)||[]).forEach(function(t,r){var i=ke(t);e.Views[r]||(e.Views[r]={}),+i.zoomScale&&(e.Views[r].zoom=+i.zoomScale),Dt(i.rightToLeft)&&(e.Views[r].RTL=!0)})}var w7=function(){var n=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=$c("v"),a=$c("f");return function(l,u,c,d,f,h){for(var p=0,g="",m=[],v=[],x=0,_=0,b=0,D="",A,w,T=0,E=0,P,N,O=0,Y=0,se=Array.isArray(h.CellXf),ie,ge=[],J=[],_e=Array.isArray(u),de=[],ye={},K=!1,F=!!c.sheetStubs,U=l.split(e),j=0,L=U.length;j!=L;++j){g=U[j].trim();var Q=g.length;if(Q!==0){var oe=0;e:for(p=0;p<Q;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(c&&c.cellStyles){if(w=ke(g.slice(oe,p),!0),T=w.r!=null?parseInt(w.r,10):T+1,E=-1,c.sheetRows&&c.sheetRows<T)continue;ye={},K=!1,w.ht&&(K=!0,ye.hpt=parseFloat(w.ht),ye.hpx=qc(ye.hpt)),w.hidden=="1"&&(K=!0,ye.hidden=!0),w.outlineLevel!=null&&(K=!0,ye.level=+w.outlineLevel),K&&(de[T-1]=ye)}break;case"<":oe=p;break}if(oe>=p)break;if(w=ke(g.slice(oe,p),!0),T=w.r!=null?parseInt(w.r,10):T+1,E=-1,!(c.sheetRows&&c.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),c&&c.cellStyles&&(ye={},K=!1,w.ht&&(K=!0,ye.hpt=parseFloat(w.ht),ye.hpx=qc(ye.hpt)),w.hidden=="1"&&(K=!0,ye.hidden=!0),w.outlineLevel!=null&&(K=!0,ye.level=+w.outlineLevel),K&&(de[T-1]=ye)),m=g.slice(p).split(n);for(var ue=0;ue!=m.length&&m[ue].trim().charAt(0)=="<";++ue);for(m=m.slice(ue),p=0;p!=m.length;++p)if(g=m[p].trim(),g.length!==0){if(v=g.match(t),x=p,_=0,b=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(x=0,D=v[1],_=0;_!=D.length&&!((b=D.charCodeAt(_)-64)<1||b>26);++_)x=26*x+b;--x,E=x}else++E;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,w=ke(g.slice(0,_),!0),w.r||(w.r=Be({r:T-1,c:E})),D=g.slice(_),A={t:""},(v=D.match(s))!=null&&v[1]!==""&&(A.v=lt(v[1])),c.cellFormula){if((v=D.match(a))!=null&&v[1]!==""){if(A.f=lt(wt(v[1])).replace(/\r\n/g,`
`),c.xlfn||(A.f=VT(A.f)),v[0].indexOf('t="array"')>-1)A.F=(D.match(i)||[])[1],A.F.indexOf(":")>-1&&ge.push([Lt(A.F),A.F]);else if(v[0].indexOf('t="shared"')>-1){N=ke(v[0]);var me=lt(wt(v[1]));c.xlfn||(me=VT(me)),J[parseInt(N.si,10)]=[N,me,w.r]}}else(v=D.match(/<f[^>]*\/>/))&&(N=ke(v[0]),J[N.si]&&(A.f=F9(J[N.si][1],J[N.si][2],w.r)));var ae=jn(w.r);for(_=0;_<ge.length;++_)ae.r>=ge[_][0].s.r&&ae.r<=ge[_][0].e.r&&ae.c>=ge[_][0].s.c&&ae.c<=ge[_][0].e.c&&(A.F=ge[_][1])}if(w.t==null&&A.v===void 0)if(A.f||A.F)A.v=0,A.t="n";else if(F)A.t="z";else continue;else A.t=w.t||"n";switch(d.s.c>E&&(d.s.c=E),d.e.c<E&&(d.e.c=E),A.t){case"n":if(A.v==""||A.v==null){if(!F)continue;A.t="z"}else A.v=parseFloat(A.v);break;case"s":if(typeof A.v>"u"){if(!F)continue;A.t="z"}else P=Vc[parseInt(A.v,10)],A.v=P.t,A.r=P.r,c.cellHTML&&(A.h=P.h);break;case"str":A.t="s",A.v=A.v!=null?wt(A.v):"",c.cellHTML&&(A.h=f1(A.v));break;case"inlineStr":v=D.match(r),A.t="s",v!=null&&(P=S1(v[1]))?(A.v=P.t,c.cellHTML&&(A.h=P.h)):A.v="";break;case"b":A.v=Dt(A.v);break;case"d":c.cellDates?A.v=dn(A.v,1):(A.v=Un(dn(A.v,1)),A.t="n");break;case"e":(!c||c.cellText!==!1)&&(A.w=A.v),A.v=BD[A.v];break}if(O=Y=0,ie=null,se&&w.s!==void 0&&(ie=h.CellXf[w.s],ie!=null&&(ie.numFmtId!=null&&(O=ie.numFmtId),c.cellStyles&&ie.fillId!=null&&(Y=ie.fillId))),mI(A,O,Y,c,f,h),c.cellDates&&se&&A.t=="n"&&jo(je[O])&&(A.t="d",A.v=ap(A.v)),w.cm&&c.xlmeta){var tt=(c.xlmeta.Cell||[])[+w.cm-1];tt&&tt.type=="XLDAPR"&&(A.D=!0)}if(_e){var R=jn(w.r);u[R.r]||(u[R.r]=[]),u[R.r][R.c]=A}else u[w.r]=A}}}}de.length>0&&(u["!rows"]=de)}}();function b7(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=i/20),t}var E7=Ta;function A7(){}function C7(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=q5(n,e-19),t}function S7(n){var e=Ar(n);return[e]}function T7(n){var e=Sa(n);return[e]}function D7(n){var e=Ar(n),t=n.read_shift(1);return[e,t,"b"]}function I7(n){var e=Sa(n),t=n.read_shift(1);return[e,t,"b"]}function k7(n){var e=Ar(n),t=n.read_shift(1);return[e,t,"e"]}function M7(n){var e=Sa(n),t=n.read_shift(1);return[e,t,"e"]}function F7(n){var e=Ar(n),t=n.read_shift(4);return[e,t,"s"]}function P7(n){var e=Sa(n),t=n.read_shift(4);return[e,t,"s"]}function R7(n){var e=Ar(n),t=Cn(n);return[e,t,"n"]}function _I(n){var e=Sa(n),t=Cn(n);return[e,t,"n"]}function N7(n){var e=Ar(n),t=E1(n);return[e,t,"n"]}function O7(n){var e=Sa(n),t=E1(n);return[e,t,"n"]}function L7(n){var e=Ar(n),t=w1(n);return[e,t,"is"]}function B7(n){var e=Ar(n),t=Dn(n);return[e,t,"str"]}function V7(n){var e=Sa(n),t=Dn(n);return[e,t,"str"]}function j7(n,e,t){var r=n.l+e,i=Ar(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(t.cellFormula){n.l+=2;var o=up(n,r-n.l,t);a[3]=An(o,null,i,t.supbooks,t)}else n.l=r;return a}function U7(n,e,t){var r=n.l+e,i=Ar(n);i.r=t["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(t.cellFormula){n.l+=2;var o=up(n,r-n.l,t);a[3]=An(o,null,i,t.supbooks,t)}else n.l=r;return a}function H7(n,e,t){var r=n.l+e,i=Ar(n);i.r=t["!row"];var s=Cn(n),a=[i,s,"n"];if(t.cellFormula){n.l+=2;var o=up(n,r-n.l,t);a[3]=An(o,null,i,t.supbooks,t)}else n.l=r;return a}function $7(n,e,t){var r=n.l+e,i=Ar(n);i.r=t["!row"];var s=Dn(n),a=[i,s,"str"];if(t.cellFormula){n.l+=2;var o=up(n,r-n.l,t);a[3]=An(o,null,i,t.supbooks,t)}else n.l=r;return a}var W7=Ta;function z7(n,e){var t=n.l+e,r=Ta(n,16),i=b1(n),s=Dn(n),a=Dn(n),o=Dn(n);n.l=t;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function G7(){}function q7(n,e,t){var r=n.l+e,i=ND(n,16),s=n.read_shift(1),a=[i];if(a[2]=s,t.cellFormula){var o=Z$(n,r-n.l,t);a[1]=o}else n.l=r;return a}function X7(n,e,t){var r=n.l+e,i=Ta(n,16),s=[i];if(t.cellFormula){var a=e7(n,r-n.l,t);s[1]=a,n.l=r}else n.l=r;return s}var Y7=["left","right","top","bottom","header","footer"];function K7(n){var e={};return Y7.forEach(function(t){e[t]=Cn(n,8)}),e}function Q7(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function Z7(){}function J7(){}function eW(n,e,t,r,i,s,a){if(!n)return n;var o=e||{};r||(r={"!id":{}}),Jt!=null&&o.dense==null&&(o.dense=Jt);var l=o.dense?[]:{},u,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],f=!1,h=!1,p,g,m,v,x,_,b,D,A,w=[];o.biff=12,o["!row"]=0;var T=0,E=!1,P=[],N={},O=o.supbooks||i.supbooks||[[]];if(O.sharedf=N,O.arrayf=P,O.SheetNames=i.SheetNames||i.Sheets.map(function(ye){return ye.name}),!o.supbooks&&(o.supbooks=O,i.Names))for(var Y=0;Y<i.Names.length;++Y)O[0][Y+1]=i.Names[Y];var se=[],ie=[],ge=!1;ip[16]={n:"BrtShortReal",f:_I};var J,_e;if(Ji(n,function(K,F,U){if(!h)switch(U){case 148:u=K;break;case 0:p=K,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),D=xn(v=p.r),o["!row"]=p.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=qc(K.hpt)),ie[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:K[2]},K[2]){case"n":g.v=K[1];break;case"s":b=Vc[K[1]],g.v=b.t,g.r=b.r;break;case"b":g.v=!!K[1];break;case"e":g.v=K[1],o.cellText!==!1&&(g.w=Da[g.v]);break;case"str":g.t="s",g.v=K[1];break;case"is":g.t="s",g.v=K[1].t;break}if((m=a.CellXf[K[0].iStyleRef])&&mI(g,m.numFmtId,null,o,s,a),x=K[0].c==-1?x+1:K[0].c,o.dense?(l[v]||(l[v]=[]),l[v][x]=g):l[sn(x)+D]=g,o.cellFormula){for(E=!1,T=0;T<P.length;++T){var j=P[T];p.r>=j[0].s.r&&p.r<=j[0].e.r&&x>=j[0].s.c&&x<=j[0].e.c&&(g.F=st(j[0]),E=!0)}!E&&K.length>3&&(g.f=K[3])}if(c.s.r>p.r&&(c.s.r=p.r),c.s.c>x&&(c.s.c=x),c.e.r<p.r&&(c.e.r=p.r),c.e.c<x&&(c.e.c=x),o.cellDates&&m&&g.t=="n"&&jo(je[m.numFmtId])){var L=_a(g.v);L&&(g.t="d",g.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}J&&(J.type=="XLDAPR"&&(g.D=!0),J=void 0),_e&&(_e=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},x=K[0].c==-1?x+1:K[0].c,o.dense?(l[v]||(l[v]=[]),l[v][x]=g):l[sn(x)+D]=g,c.s.r>p.r&&(c.s.r=p.r),c.s.c>x&&(c.s.c=x),c.e.r<p.r&&(c.e.r=p.r),c.e.c<x&&(c.e.c=x),J&&(J.type=="XLDAPR"&&(g.D=!0),J=void 0),_e&&(_e=void 0);break;case 176:w.push(K);break;case 49:J=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var Q=r["!id"][K.relId];for(Q?(K.Target=Q.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=Q):K.relId==""&&(K.Target="#"+K.loc),v=K.rfx.s.r;v<=K.rfx.e.r;++v)for(x=K.rfx.s.c;x<=K.rfx.e.c;++x)o.dense?(l[v]||(l[v]=[]),l[v][x]||(l[v][x]={t:"z",v:void 0}),l[v][x].l=K):(_=Be({c:x,r:v}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=K);break;case 426:if(!o.cellFormula)break;P.push(K),A=o.dense?l[v][x]:l[sn(x)+D],A.f=An(K[1],c,{r:p.r,c:x},O,o),A.F=st(K[0]);break;case 427:if(!o.cellFormula)break;N[Be(K[0].s)]=K[1],A=o.dense?l[v][x]:l[sn(x)+D],A.f=An(K[1],c,{r:p.r,c:x},O,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)se[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},ge||(ge=!0,T1(K.w/256)),Vo(se[K.e+1]);break;case 161:l["!autofilter"]={ref:st(K)};break;case 476:l["!margins"]=K;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),K.name&&(i.Sheets[t].CodeName=K.name),(K.above||K.left)&&(l["!outline"]={above:K.above,left:K.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),K.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:d.push(U),f=!0;break;case 38:d.pop(),f=!1;break;default:if(!F.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(c.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=st(u||c)),o.sheetRows&&l["!ref"]){var de=Lt(l["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>c.e.r&&(de.e.r=c.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>c.e.c&&(de.e.c=c.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),l["!fullref"]=l["!ref"],l["!ref"]=st(de))}return w.length>0&&(l["!merges"]=w),se.length>0&&(l["!cols"]=se),ie.length>0&&(l["!rows"]=ie),l}function tW(n){var e=[],t=n.match(/^<c:numCache>/),r;(n.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var i=lt((n.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(n.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[e,i,r]}function nW(n,e,t,r,i,s){var a=s||{"!type":"chart"};if(!n)return s;var o=0,l=0,u="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(n.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var f=tW(d);c.s.r=c.s.c=0,c.e.c=o,u=sn(o),f[0].forEach(function(h,p){a[u+xn(p)]={t:"n",v:h,z:f[1]},l=p}),c.e.r<l&&(c.e.r=l),++o}),o>0&&(a["!ref"]=st(c)),a}function rW(n,e,t,r,i){if(!n)return n;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=n.match(vI);return o&&I1(o[0],s,i,t),(a=n.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function iW(n,e){n.l+=10;var t=Dn(n,e-10);return{name:t}}function sW(n,e,t,r,i){if(!n)return n;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=[],o=!1;return Ji(n,function(u,c,d){switch(d){case 550:s["!rel"]=u;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),u.name&&(i.Sheets[t].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d);break;case 38:a.pop();break;default:if(c.T>0)a.push(d);else if(c.T<0)a.pop();else if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},e),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var xI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aW=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oW=[],lW=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function WT(n,e){for(var t=0;t!=n.length;++t)for(var r=n[t],i=0;i!=e.length;++i){var s=e[i];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Dt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function zT(n,e){for(var t=0;t!=e.length;++t){var r=e[t];if(n[r[0]]==null)n[r[0]]=r[1];else switch(r[2]){case"bool":typeof n[r[0]]=="string"&&(n[r[0]]=Dt(n[r[0]]));break;case"int":typeof n[r[0]]=="string"&&(n[r[0]]=parseInt(n[r[0]],10));break}}}function yI(n){zT(n.WBProps,xI),zT(n.CalcPr,lW),WT(n.WBView,aW),WT(n.Sheets,oW),Oo.date1904=Dt(n.WBProps.date1904)}var cW="][*?/\\".split("");function uW(n,e){if(n.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return cW.forEach(function(r){if(n.indexOf(r)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var dW=/<\w+:workbook/;function fW(n,e){if(!n)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",s={},a=0;if(n.replace(kn,function(l,u){var c=ke(l);switch(_i(c[0])){case"<?xml":break;case"<workbook":l.match(dW)&&(i="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":xI.forEach(function(d){if(c[d[0]]!=null)switch(d[2]){case"bool":t.WBProps[d[0]]=Dt(c[d[0]]);break;case"int":t.WBProps[d[0]]=parseInt(c[d[0]],10);break;default:t.WBProps[d[0]]=c[d[0]]}}),c.codeName&&(t.WBProps.CodeName=wt(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=lt(wt(c.name)),delete c[0],t.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=wt(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Dt(c.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=lt(wt(n.slice(a,u))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],t.CalcPr=c;break;case"<calcPr/>":delete c[0],t.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),I5.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return yI(t),t}function hW(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=Kx(n,e-8),t.name=Dn(n),t}function pW(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?Dn(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function gW(n,e){var t={};return n.read_shift(4),t.ArchID=n.read_shift(4),n.l+=e-8,t}function mW(n,e,t){var r=n.l+e;n.l+=4,n.l+=1;var i=n.read_shift(4),s=X5(n),a=J$(n,0,t),o=b1(n);n.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function vW(n,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],ip[16]={n:"BrtFRTArchID$",f:gW},Ji(n,function(l,u,c){switch(c){case 156:a.SheetNames.push(l.name),t.Sheets.push(l);break;case 153:t.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=An(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([c,l]):a[0]=[c,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(c),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(c),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},e),yI(t),t.Names=s,t.supbooks=a,t}function _W(n,e,t){return e.slice(-4)===".bin"?vW(n,t):fW(n,t)}function xW(n,e,t,r,i,s,a,o){return e.slice(-4)===".bin"?eW(n,r,t,i,s,a,o):h7(n,r,t,i,s,a,o)}function yW(n,e,t,r,i,s,a,o){return e.slice(-4)===".bin"?sW(n,r,t,i,s,a,o):rW(n,r,t,i,s,a,o)}function wW(n,e,t,r,i,s,a,o){return e.slice(-4)===".bin"?I9(n,r,t,i,s,a,o):k9(n,r,t,i,s,a,o)}function bW(n,e,t,r,i,s,a,o){return e.slice(-4)===".bin"?T9(n,r,t,i,s,a,o):D9(n,r,t,i,s,a,o)}function EW(n,e,t,r){return e.slice(-4)===".bin"?WH(n,t,r):BH(n,t,r)}function AW(n,e,t){return aI(n,t)}function CW(n,e,t){return e.slice(-4)===".bin"?aH(n,t):iH(n,t)}function SW(n,e,t){return e.slice(-4)===".bin"?A9(n,t):x9(n,t)}function TW(n,e,t){return e.slice(-4)===".bin"?m9(n,e,t):p9(n,e,t)}function DW(n,e,t,r){return t.slice(-4)===".bin"?v9(n,e,t,r):void 0}function IW(n,e,t){return e.slice(-4)===".bin"?f9(n,e,t):h9(n,e,t)}var wI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,bI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jr(n,e){var t=n.split(/\s+/),r=[];if(e||(r[0]=t[0]),t.length===1)return r;var i=n.match(wI),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(bI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}function kW(n){var e=n.split(/\s+/),t={};if(e.length===1)return t;var r=n.match(wI),i,s,a,o;if(r)for(o=0;o!=r.length;++o)i=r[o].match(bI),(s=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),t[a]=i[2].slice(1,i[2].length-1));return t}var Uc;function MW(n,e){var t=Uc[n]||lt(n);return t==="General"?wa(e):Er(t,e)}function FW(n,e,t,r){var i=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Dt(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=dn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}n[lt(e)]=i}function PW(n,e,t){if(n.t!=="z"){if(!t||t.cellText!==!1)try{n.t==="e"?n.w=n.w||Da[n.v]:e==="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=Hc(n.v):n.w=wa(n.v):n.w=MW(e||"General",n.v)}catch(s){if(t.WTF)throw s}try{var r=Uc[e]||e||"General";if(t.cellNF&&(n.z=r),t.cellDates&&n.t=="n"&&jo(r)){var i=_a(n.v);i&&(n.t="d",n.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(t.WTF)throw s}}}function RW(n,e,t){if(t.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=FH[r.Pattern]||r.Pattern)}n[e.ID]=e}function NW(n,e,t,r,i,s,a,o,l,u){var c="General",d=r.StyleID,f={};u=u||{};var h=[],p=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&a&&(d=a.StyleID);s[d]!==void 0&&(s[d].nf&&(c=s[d].nf),s[d].Interior&&h.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=Dt(n);break;case"String":r.t="s",r.r=hT(lt(n)),r.v=n.indexOf("<")>-1?lt(e||n).replace(/<.*?>/g,""):r.r;break;case"DateTime":n.slice(-1)!="Z"&&(n+="Z"),r.v=(dn(n)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=lt(n):r.v<60&&(r.v=r.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+n),r.t||(r.t="n");break;case"Error":r.t="e",r.v=BD[n],u.cellText!==!1&&(r.w=n);break;default:n==""&&e==""?r.t="z":(r.t="s",r.v=hT(e||n));break}if(PW(r,c,u),u.cellFormula!==!1)if(r.Formula){var g=lt(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=No(g,i),delete r.Formula,r.ArrayRange=="RC"?r.F=No("RC:RC",i):r.ArrayRange&&(r.F=No(r.ArrayRange,i),l.push([Lt(r.F),r.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(r.F=l[p][1]);u.cellStyles&&(h.forEach(function(m){!f.patternType&&m.patternType&&(f.patternType=m.patternType)}),r.s=f),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function OW(n){n.t=n.v||"",n.t=n.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.v=n.w=n.ixfe=void 0}function zx(n,e){var t=e||{};pD();var r=Ic(h1(n));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof ht<"u"?r=ht.utils.decode(65001,Xx(r)):r=wt(r));var i=r.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=_n(t);return a.type="string",zc.to_workbook(r,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Bt){i.indexOf("<"+Bt)>=0&&(s=!0)}),s)return zW(r,t);Uc={"General Number":"General","General Date":je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":je[15],"Short Date":je[14],"Long Time":je[19],"Medium Time":je[18],"Short Time":je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:je[2],Standard:je[4],Percent:je[10],Scientific:je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u;Jt!=null&&t.dense==null&&(t.dense=Jt);var c={},d=[],f=t.dense?[]:{},h="",p={},g={},m=jr('<Data ss:Type="String">'),v=0,x=0,_=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},A={},w="",T=0,E=[],P={},N={},O=0,Y=[],se=[],ie={},ge=[],J,_e=!1,de=[],ye=[],K={},F=0,U=0,j={Sheets:[],WBProps:{date1904:!1}},L={};Wc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=Wc.exec(r);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?NW(r.slice(v,o.index),w,m,l[l.length-1][0]=="comment"?ie:p,{c:x,r:_},D,ge[x],g,de,t):(w="",m=jr(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(se.length>0&&(p.c=se),(!t.sheetRows||t.sheetRows>_)&&p.v!==void 0&&(t.dense?(f[_]||(f[_]=[]),f[_][x]=p):f[sn(x)+xn(_)]=p),p.HRef&&(p.l={Target:lt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=x+(parseInt(p.MergeAcross,10)|0),U=_+(parseInt(p.MergeDown,10)|0),E.push({s:{c:x,r:_},e:{c:F,r:U}})),!t.sheetStubs)p.MergeAcross?x=F+1:++x;else if(p.MergeAcross||p.MergeDown){for(var oe=x;oe<=F;++oe)for(var ue=_;ue<=U;++ue)(oe>x||ue>_)&&(t.dense?(f[ue]||(f[ue]=[]),f[ue][oe]={t:"z"}):f[sn(oe)+xn(ue)]={t:"z"});x=F+1}else++x;else p=kW(o[0]),p.Index&&(x=+p.Index-1),x<b.s.c&&(b.s.c=x),x>b.e.c&&(b.e.c=x),o[0].slice(-2)==="/>"&&++x,se=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<b.s.r&&(b.s.r=_),_>b.e.r&&(b.e.r=_),o[0].slice(-2)==="/>"&&(g=jr(o[0]),g.Index&&(_=+g.Index-1)),x=0,++_):(g=jr(o[0]),g.Index&&(_=+g.Index-1),K={},(g.AutoFitHeight=="0"||g.Height)&&(K.hpx=parseInt(g.Height,10),K.hpt=sI(K.hpx),ye[_]=K),g.Hidden=="1"&&(K.hidden=!0,ye[_]=K));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(h),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=st(b),t.sheetRows&&t.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=t.sheetRows-1,f["!ref"]=st(b))),E.length&&(f["!merges"]=E),ge.length>0&&(f["!cols"]=ge),ye.length>0&&(f["!rows"]=ye),c[h]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=x=0,l.push([o[3],!1]),u=jr(o[0]),h=lt(u.Name),f=t.dense?[]:{},E=[],de=[],ye=[],L={name:h,Hidden:0},j.Sheets.push(L);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ge=[],_e=!1}break;case"style":o[1]==="/"?RW(D,A,t):A=jr(o[0]);break;case"numberformat":A.nf=lt(jr(o[0]).Format||"General"),Uc[A.nf]&&(A.nf=Uc[A.nf]);for(var me=0;me!=392&&je[me]!=A.nf;++me);if(me==392){for(me=57;me!=392;++me)if(je[me]==null){xa(A.nf,me);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(J=jr(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!_e&&J.wpx>10){_e=!0,Vn=rI;for(var ae=0;ae<ge.length;++ae)ge[ae]&&Vo(ge[ae])}_e&&Vo(J),ge[J.Index-1||ge.length]=J;for(var tt=0;tt<+J.Span;++tt)ge[ge.length]=_n(J);break;case"namedrange":if(o[1]==="/")break;j.Names||(j.Names=[]);var R=ke(o[0]),It={Name:R.Name,Ref:No(R.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(It.Sheet=j.Sheets.length-1),j.Names.push(It);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=r.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;A.Interior=jr(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?xj(P,Q,r.slice(O,o.index)):O=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));OW(ie),se.push(ie)}else l.push([o[3],!1]),u=jr(o[0]),ie={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var at=jr(o[0]);f["!autofilter"]={ref:No(at.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return QT(r,t);var mt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:mt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:mt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:mt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:mt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(r.slice(O,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else O=o.index+o[0].length;break;case"header":f["!margins"]||jc(f["!margins"]={},"xlml"),isNaN(+ke(o[0]).Margin)||(f["!margins"].header=+ke(o[0]).Margin);break;case"footer":f["!margins"]||jc(f["!margins"]={},"xlml"),isNaN(+ke(o[0]).Margin)||(f["!margins"].footer=+ke(o[0]).Margin);break;case"pagemargins":var Ye=ke(o[0]);f["!margins"]||jc(f["!margins"]={},"xlml"),isNaN(+Ye.Top)||(f["!margins"].top=+Ye.Top),isNaN(+Ye.Left)||(f["!margins"].left=+Ye.Left),isNaN(+Ye.Right)||(f["!margins"].right=+Ye.Right),isNaN(+Ye.Bottom)||(f["!margins"].bottom=+Ye.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:mt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:mt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:mt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:mt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:mt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:mt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:mt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:mt=!1}break;case"smarttags":break;default:mt=!1;break}if(mt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?FW(N,Q,Y,r.slice(O,o.index)):(Y=o,O=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!t.bookSheets&&!t.bookProps&&(xe.Sheets=c),xe.SheetNames=d,xe.Workbook=j,xe.SSF=_n(je),xe.Props=P,xe.Custprops=N,xe}function e1(n,e){switch(F1(e=e||{}),e.type||"base64"){case"base64":return zx(ur(n),e);case"binary":case"buffer":case"file":return zx(n,e);case"array":return zx(Ca(n),e)}}function LW(n){var e={},t=n.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Q5(t),t.length-t.l<=4)return e;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=Z5(t),r=t.read_shift(4),r==0||r>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var BW=[60,1084,2066,2165,2175];function VW(n,e,t,r,i){var s=r,a=[],o=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(n){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),t.l+=s;for(var l=Yi(t,t.l),u=t1[l],c=0;u!=null&&BW.indexOf(l)>-1;)s=Yi(t,t.l+2),c=t.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),o=t.slice(c,t.l+4+s),a.push(o),t.l+=4+s,u=t1[l=Yi(t,t.l)];var d=Ts(a);vn(d,0);var f=0;d.lens=[];for(var h=0;h<a.length;++h)d.lens.push(f),f+=a[h].length;if(d.length<r)throw"XLS Record 0x"+n.toString(16)+" Truncated: "+d.length+" < "+r;return e.f(d,d.length,i)}function pi(n,e,t){if(n.t!=="z"&&n.XF){var r=0;try{r=n.z||n.XF.numFmtId||0,e.cellNF&&(n.z=je[r])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{n.t==="e"?n.w=n.w||Da[n.v]:r===0||r=="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=Hc(n.v):n.w=wa(n.v):n.w=Er(r,n.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&r&&n.t=="n"&&jo(je[r]||String(r))){var i=_a(n.v);i&&(n.t="d",n.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function qh(n,e,t){return{v:n,ixfe:e,t}}function jW(n,e){var t={opts:{}},r={};Jt!=null&&e.dense==null&&(e.dense=Jt);var i=e.dense?[]:{},s={},a={},o=null,l=[],u="",c={},d,f="",h,p,g,m,v={},x=[],_,b,D=[],A=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},E=function(Ge){return Ge<8?ya[Ge]:Ge<64&&A[Ge-8]||ya[Ge]},P=function(Ge,Vt,fr){var en=Vt.XF.data;if(!(!en||!en.patternType||!fr||!fr.cellStyles)){Vt.s={},Vt.s.patternType=en.patternType;var Rs;(Rs=Gc(E(en.icvFore)))&&(Vt.s.fgColor={rgb:Rs}),(Rs=Gc(E(en.icvBack)))&&(Vt.s.bgColor={rgb:Rs})}},N=function(Ge,Vt,fr){if(!(K>1)&&!(fr.sheetRows&&Ge.r>=fr.sheetRows)){if(fr.cellStyles&&Vt.XF&&Vt.XF.data&&P(Ge,Vt,fr),delete Vt.ixfe,delete Vt.XF,d=Ge,f=Be(Ge),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<a.s.r&&(a.s.r=Ge.r),Ge.c<a.s.c&&(a.s.c=Ge.c),Ge.r+1>a.e.r&&(a.e.r=Ge.r+1),Ge.c+1>a.e.c&&(a.e.c=Ge.c+1),fr.cellFormula&&Vt.f){for(var en=0;en<x.length;++en)if(!(x[en][0].s.c>Ge.c||x[en][0].s.r>Ge.r)&&!(x[en][0].e.c<Ge.c||x[en][0].e.r<Ge.r)){Vt.F=st(x[en][0]),(x[en][0].s.c!=Ge.c||x[en][0].s.r!=Ge.r)&&delete Vt.f,Vt.f&&(Vt.f=""+An(x[en][1],a,Ge,de,O));break}}fr.dense?(i[Ge.r]||(i[Ge.r]=[]),i[Ge.r][Ge.c]=Vt):i[f]=Vt}},O={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var Y,se=[],ie=[],ge=[],J=[],_e=!1,de=[];de.SheetNames=O.snames,de.sharedf=O.sharedf,de.arrayf=O.arrayf,de.names=[],de.XTI=[];var ye=0,K=0,F=0,U=[],j=[],L;O.codepage=1200,$r(1200);for(var Q=!1;n.l<n.length-1;){var oe=n.l,ue=n.read_shift(2);if(ue===0&&ye===10)break;var me=n.l===n.length?0:n.read_shift(2),ae=t1[ue];if(ae&&ae.f){if(e.bookSheets&&ye===133&&ue!==133)break;if(ye=ue,ae.r===2||ae.r==12){var tt=n.read_shift(2);if(me-=2,!O.enc&&tt!==ue&&((tt&255)<<8|tt>>8)!==ue)throw new Error("rt mismatch: "+tt+"!="+ue);ae.r==12&&(n.l+=10,me-=10)}var R={};if(ue===10?R=ae.f(n,me,O):R=VW(ue,ae,n,me,O),K==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(ue){case 34:t.opts.Date1904=w.WBProps.date1904=R;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(O.enc||(n.l=0),O.enc=R,!e.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=R;break;case 66:var It=Number(R);switch(It){case 21010:It=1200;break;case 32768:It=1e4;break;case 32769:It=1252;break}$r(O.codepage=It),Q=!0;break;case 317:O.rrtabid=R;break;case 25:O.winlocked=R;break;case 439:t.opts.RefreshAll=R;break;case 12:t.opts.CalcCount=R;break;case 16:t.opts.CalcDelta=R;break;case 17:t.opts.CalcIter=R;break;case 13:t.opts.CalcMode=R;break;case 14:t.opts.CalcPrecision=R;break;case 95:t.opts.CalcSaveRecalc=R;break;case 15:O.CalcRefMode=R;break;case 2211:t.opts.FullCalc=R;break;case 129:R.fDialog&&(i["!type"]="dialog"),R.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),R.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:D.push(R);break;case 430:de.push([R]),de[de.length-1].XTI=[];break;case 35:case 547:de[de.length-1].push(R);break;case 24:case 536:L={Name:R.Name,Ref:An(R.rgce,a,null,de,O)},R.itab>0&&(L.Sheet=R.itab-1),de.names.push(L),de[0]||(de[0]=[],de[0].XTI=[]),de[de.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(j[R.itab-1]={ref:st(R.rgce[0][0][1][2])});break;case 22:O.ExternCount=R;break;case 23:de.length==0&&(de[0]=[],de[0].XTI=[]),de[de.length-1].XTI=de[de.length-1].XTI.concat(R),de.XTI=de.XTI.concat(R);break;case 2196:if(O.biff<8)break;L!=null&&(L.Comment=R[1]);break;case 18:i["!protect"]=R;break;case 19:R!==0&&O.WTF&&console.error("Password verifier: "+R);break;case 133:s[R.pos]=R,O.snames.push(R.name);break;case 10:{if(--K)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=st(a),e.sheetRows&&e.sheetRows<=a.e.r){var at=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=st(a),a.e.r=at}a.e.r++,a.e.c++}se.length>0&&(i["!merges"]=se),ie.length>0&&(i["!objects"]=ie),ge.length>0&&(i["!cols"]=ge),J.length>0&&(i["!rows"]=J),w.Sheets.push(T)}u===""?c=i:r[u]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),O.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(O.biff=5,Q=!0,$r(O.codepage=28591)),O.biff==8&&R.BIFFVer==0&&R.dt==16&&(O.biff=2),K++)break;if(i=e.dense?[]:{},O.biff<8&&!Q&&(Q=!0,$r(O.codepage=e.codepage||1252)),O.biff<5||R.BIFFVer==0&&R.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var mt={pos:n.l-me,name:u};s[mt.pos]=mt,O.snames.push(u)}else u=(s[oe]||{name:""}).name;R.dt==32&&(i["!type"]="chart"),R.dt==64&&(i["!type"]="macro"),se=[],ie=[],O.arrayf=x=[],ge=[],J=[],_e=!1,T={Hidden:(s[oe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[R.r]||[])[R.c]:i[Be({c:R.c,r:R.r})])&&++R.c,_={ixfe:R.ixfe,XF:D[R.ixfe]||{},v:R.val,t:"n"},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e);break;case 5:case 517:_={ixfe:R.ixfe,XF:D[R.ixfe],v:R.val,t:R.t},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e);break;case 638:_={ixfe:R.ixfe,XF:D[R.ixfe],v:R.rknum,t:"n"},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e);break;case 189:for(var Ye=R.c;Ye<=R.C;++Ye){var xe=R.rkrec[Ye-R.c][0];_={ixfe:xe,XF:D[xe],v:R.rkrec[Ye-R.c][1],t:"n"},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:Ye,r:R.r},_,e)}break;case 6:case 518:case 1030:{if(R.val=="String"){o=R;break}if(_=qh(R.val,R.cell.ixfe,R.tt),_.XF=D[_.ixfe],e.cellFormula){var Bt=R.formula;if(Bt&&Bt[0]&&Bt[0][0]&&Bt[0][0][0]=="PtgExp"){var dr=Bt[0][0][1][0],Gr=Bt[0][0][1][1],yi=Be({r:dr,c:Gr});v[yi]?_.f=""+An(R.formula,a,R.cell,de,O):_.F=((e.dense?(i[dr]||[])[Gr]:i[yi])||{}).F}else _.f=""+An(R.formula,a,R.cell,de,O)}F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N(R.cell,_,e),o=R}break;case 7:case 519:if(o)o.val=R,_=qh(R,o.cell.ixfe,"s"),_.XF=D[_.ixfe],e.cellFormula&&(_.f=""+An(o.formula,a,o.cell,de,O)),F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(R);var Wo=Be(R[0].s);if(h=e.dense?(i[R[0].s.r]||[])[R[0].s.c]:i[Wo],e.cellFormula&&h){if(!o||!Wo||!h)break;h.f=""+An(R[1],a,R[0],de,O),h.F=st(R[0])}}break;case 1212:{if(!e.cellFormula)break;if(f){if(!o)break;v[Be(o.cell)]=R[0],h=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Be(o.cell)],(h||{}).f=""+An(R[0],a,d,de,O)}}break;case 253:_=qh(l[R.isst].t,R.ixfe,"s"),l[R.isst].h&&(_.h=l[R.isst].h),_.XF=D[_.ixfe],F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:R.ixfe,XF:D[R.ixfe],t:"z"},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e));break;case 190:if(e.sheetStubs)for(var es=R.c;es<=R.C;++es){var Qn=R.ixfe[es-R.c];_={ixfe:Qn,XF:D[Qn],t:"z"},F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:es,r:R.r},_,e)}break;case 214:case 516:case 4:_=qh(R.val,R.ixfe,"s"),_.XF=D[_.ixfe],F>0&&(_.z=U[_.ixfe>>8&63]),pi(_,e,t.opts.Date1904),N({c:R.c,r:R.r},_,e);break;case 0:case 512:K===1&&(a=R);break;case 252:l=R;break;case 1054:if(O.biff==4){U[F++]=R[1];for(var wi=0;wi<F+163&&je[wi]!=R[1];++wi);wi>=163&&xa(R[1],F+163)}else xa(R[1],R[0]);break;case 30:{U[F++]=R;for(var ts=0;ts<F+163&&je[ts]!=R;++ts);ts>=163&&xa(R,F+163)}break;case 229:se=se.concat(R);break;case 93:ie[R.cmo[0]]=O.lastobj=R;break;case 438:O.lastobj.TxO=R;break;case 127:O.lastobj.ImData=R;break;case 440:for(m=R[0].s.r;m<=R[0].e.r;++m)for(g=R[0].s.c;g<=R[0].e.c;++g)h=e.dense?(i[m]||[])[g]:i[Be({c:g,r:m})],h&&(h.l=R[1]);break;case 2048:for(m=R[0].s.r;m<=R[0].e.r;++m)for(g=R[0].s.c;g<=R[0].e.c;++g)h=e.dense?(i[m]||[])[g]:i[Be({c:g,r:m})],h&&h.l&&(h.l.Tooltip=R[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;h=e.dense?(i[R[0].r]||[])[R[0].c]:i[Be(R[0])];var zo=ie[R[2]];h||(e.dense?(i[R[0].r]||(i[R[0].r]=[]),h=i[R[0].r][R[0].c]={t:"z"}):h=i[Be(R[0])]={t:"z"},a.e.r=Math.max(a.e.r,R[0].r),a.s.r=Math.min(a.s.r,R[0].r),a.e.c=Math.max(a.e.c,R[0].c),a.s.c=Math.min(a.s.c,R[0].c)),h.c||(h.c=[]),p={a:R[1],t:zo.TxO.t},h.c.push(p)}break;case 2173:l9(D[R.ixfe],R.ext);break;case 125:{if(!O.cellStyles)break;for(;R.e>=R.s;)ge[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},_e||(_e=!0,T1(R.w/256)),Vo(ge[R.e+1])}break;case 520:{var Mn={};R.level!=null&&(J[R.r]=Mn,Mn.level=R.level),R.hidden&&(J[R.r]=Mn,Mn.hidden=!0),R.hpt&&(J[R.r]=Mn,Mn.hpt=R.hpt,Mn.hpx=qc(R.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||jc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=R;break;case 161:i["!margins"]||jc(i["!margins"]={}),i["!margins"].header=R.header,i["!margins"].footer=R.footer;break;case 574:R.RTL&&(w.Views[0].RTL=!0);break;case 146:A=R;break;case 2198:Y=R;break;case 140:b=R;break;case 442:u?T.CodeName=R||T.name:w.WBProps.CodeName=R||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),n.l+=me}return t.SheetNames=vi(s).sort(function(qr,Ge){return Number(qr)-Number(Ge)}).map(function(qr){return s[qr].name}),e.bookSheets||(t.Sheets=r),!t.SheetNames.length&&c["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=c)):t.Preamble=c,t.Sheets&&j.forEach(function(qr,Ge){t.Sheets[t.SheetNames[Ge]]["!autofilter"]=qr}),t.Strings=l,t.SSF=_n(je),O.enc&&(t.Encryption=O.enc),Y&&(t.Themes=Y),t.Metadata={},b!==void 0&&(t.Metadata.Country=b),de.names.length>0&&(w.Names=de.names),t.Workbook=w,t}var GT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function UW(n,e,t){var r=it.find(n,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=IT(r,ij,GT.DSI);for(var s in i)e[s]=i[s]}catch(u){if(t.WTF)throw u}var a=it.find(n,"/!SummaryInformation");if(a&&a.size>0)try{var o=IT(a,sj,GT.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(t.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(jD(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function EI(n,e){e||(e={}),F1(e),nD(),e.codepage&&a1(e.codepage);var t,r;if(n.FullPaths){if(it.find(n,"/encryption"))throw new Error("File is password-protected");t=it.find(n,"!CompObj"),r=it.find(n,"/Workbook")||it.find(n,"/Book")}else{switch(e.type){case"base64":n=Hr(ur(n));break;case"binary":n=Hr(n);break;case"buffer":break;case"array":Array.isArray(n)||(n=Array.prototype.slice.call(n));break}vn(n,0),r={content:n}}var i,s;if(t&&LW(t),e.bookProps&&!e.bookSheets)i={};else{var a=et?"buffer":"array";if(r&&r.content)i=jW(r.content,e);else if((s=it.find(n,"PerfectOffice_MAIN"))&&s.content)i=Bc.to_workbook(s.content,(e.type=a,e));else if((s=it.find(n,"NativeContent_MAIN"))&&s.content)i=Bc.to_workbook(s.content,(e.type=a,e));else throw(s=it.find(n,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&n.FullPaths&&it.find(n,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=S9(n))}var o={};return n.FullPaths&&UW(n,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=n),i}var ip={0:{f:b7},1:{f:S7},2:{f:N7},3:{f:k7},4:{f:D7},5:{f:R7},6:{f:B7},7:{f:F7},8:{f:$7},9:{f:H7},10:{f:j7},11:{f:U7},12:{f:T7},13:{f:O7},14:{f:M7},15:{f:I7},16:{f:_I},17:{f:V7},18:{f:P7},19:{f:w1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:mW},40:{},42:{},43:{f:jH},44:{f:VH},45:{f:UH},46:{f:$H},47:{f:HH},48:{},49:{f:W5},50:{},51:{f:u9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZD},62:{f:L7},63:{f:g9},64:{f:Z7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:In,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Q7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:C7},148:{f:E7,p:16},151:{f:G7},152:{},153:{f:pW},154:{},155:{},156:{f:hW},157:{},158:{},159:{T:1,f:sH},160:{T:-1},161:{T:1,f:Ta},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:W7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:c9},336:{T:-1},337:{f:d9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:q7},427:{f:X7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:K7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:z7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E9},633:{T:1},634:{T:-1},635:{T:1,f:b9},636:{T:-1},637:{f:G5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iW},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:J7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},t1={6:{f:$x},10:{f:Ss},12:{f:Qt},13:{f:Qt},14:{f:Ht},15:{f:Ht},16:{f:Cn},17:{f:Ht},18:{f:Ht},19:{f:Qt},20:{f:PT},21:{f:PT},23:{f:QD},24:{f:NT},25:{f:Ht},26:{},27:{},28:{f:yU},29:{},34:{f:Ht},35:{f:RT},38:{f:Cn},39:{f:Cn},40:{f:Cn},41:{f:Cn},42:{f:Ht},43:{f:Ht},47:{f:AH},49:{f:tU},51:{f:Qt},60:{},61:{f:Zj},64:{f:Ht},65:{f:eU},66:{f:Qt},77:{},80:{},81:{},82:{},85:{f:Qt},89:{},90:{},91:{},92:{f:Wj},93:{f:bU},94:{},95:{f:Ht},96:{},97:{},99:{f:Ht},125:{f:ZD},128:{f:dU},129:{f:zj},130:{f:Qt},131:{f:Ht},132:{f:Ht},133:{f:Gj},134:{},140:{f:DU},141:{f:Qt},144:{},146:{f:kU},151:{},152:{},153:{},154:{},155:{},156:{f:Qt},157:{},158:{},160:{f:NU},161:{f:FU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oU},190:{f:lU},193:{f:Ss},197:{},198:{},199:{},200:{},201:{},202:{f:Ht},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Qt},220:{},221:{f:Ht},222:{},224:{f:uU},225:{f:$j},226:{f:Ss},227:{},229:{f:wU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:qj},253:{f:nU},255:{f:Xj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zD},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ht},353:{f:Ss},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:hU},431:{f:Ht},432:{},433:{},434:{},437:{},438:{f:CU},439:{f:Ht},440:{f:SU},441:{},442:{f:Qc},443:{},444:{f:Qt},445:{},446:{},448:{f:Ss},449:{f:Qj,r:2},450:{f:Ss},512:{f:MT},513:{f:RU},515:{f:fU},516:{f:rU},517:{f:FT},519:{f:OU},520:{f:Yj},523:{},545:{f:OT},549:{f:kT},566:{},574:{f:Jj},638:{f:aU},659:{},1048:{},1054:{f:iU},1084:{},1212:{f:vU},2048:{f:TU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ss},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MU,r:12},2173:{f:o9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ht,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:mU,r:12},2197:{},2198:{f:t9,r:12},2199:{},2200:{},2201:{},2202:{f:_U,r:12},2203:{f:Ss},2204:{},2205:{},2206:{},2207:{},2211:{f:Kj},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:IU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:MT},1:{},2:{f:jU},3:{f:VU},4:{f:BU},5:{f:FT},7:{f:UU},8:{},9:{f:Wh},11:{},22:{f:Qt},30:{f:sU},31:{},32:{},33:{f:OT},36:{},37:{f:kT},50:{f:HU},62:{},52:{},67:{},68:{f:Qt},69:{},86:{},126:{},127:{f:LU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$U},223:{},234:{},354:{},421:{},518:{f:$x},521:{f:Wh},536:{f:NT},547:{f:RT},561:{},579:{},1030:{f:$x},1033:{f:Wh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ur(n,e,t,r){var i=e;if(!isNaN(i)){var s=r||(t||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&FD(t)&&n.push(t)}}function qT(n,e){var t=e||{};Jt!=null&&t.dense==null&&(t.dense=Jt);var r=t.dense?[]:{};n=n.replace(/<!--.*?-->/g,"");var i=n.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=n.match(/<\/table/i),a=i.index,o=s&&s.index||n.length,l=f5(n.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,c=0,d=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<l.length;++a){var g=l[a].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++u,t.sheetRows&&t.sheetRows<=u){--u;break}c=0;continue}if(!(m!="<td"&&m!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var x=v[o].trim();if(x.match(/<t[dh]/i)){for(var _=x,b=0;_.charAt(0)=="<"&&(b=_.indexOf(">"))>-1;)_=_.slice(b+1);for(var D=0;D<p.length;++D){var A=p[D];A.s.c==c&&A.s.r<u&&u<=A.e.r&&(c=A.e.c+1,D=-1)}var w=ke(x.slice(0,x.indexOf(">")));f=w.colspan?+w.colspan:1,((d=+w.rowspan)>1||f>1)&&p.push({s:{r:u,c},e:{r:u+(d||1)-1,c:c+f-1}});var T=w.t||w["data-t"]||"";if(!_.length){c+=f;continue}if(_=AD(_),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>c&&(h.s.c=c),h.e.c<c&&(h.e.c=c),!_.length){c+=f;continue}var E={t:"s",v:_};t.raw||!_.trim().length||T=="s"||(_==="TRUE"?E={t:"b",v:!0}:_==="FALSE"?E={t:"b",v:!1}:isNaN(zr(_))?isNaN(Bo(_).getDate())||(E={t:"d",v:dn(_)},t.cellDates||(E={t:"n",v:Un(E.v)}),E.z=t.dateNF||je[14]):E={t:"n",v:zr(_)}),t.dense?(r[u]||(r[u]=[]),r[u][c]=E):r[Be({r:u,c})]=E,c+=f}}}}return r["!ref"]=st(h),p.length&&(r["!merges"]=p),r}function HW(n,e,t,r){for(var i=n["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>t||i[u].s.c>a)&&!(i[u].e.r<t||i[u].e.c<a)){if(i[u].s.r<t||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var c=Be({r:t,c:a}),d=r.dense?(n[t]||[])[a]:n[c],f=d&&d.v!=null&&(d.h||f1(d.w||(Zi(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),h.id=(r.id||"sjs")+"-"+c,s.push(T5("td",f,h))}}var p="<tr>";return p+s.join("")+"</tr>"}var $W='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',WW="</body></html>";function zW(n,e){var t=n.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ps(qT(t[0],e),e);var r=R1();return t.forEach(function(i,s){N1(r,qT(i,e),"Sheet"+(s+1))}),r}function GW(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function qW(n,e){var t=e||{},r=t.header!=null?t.header:$W,i=t.footer!=null?t.footer:WW,s=[r],a=Ho(n["!ref"]);t.dense=Array.isArray(n),s.push(GW(n,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(HW(n,a,o,t));return s.push("</table>"+i),s.join("")}function AI(n,e,t){var r=t||{};Jt!=null&&(r.dense=Jt);var i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?jn(r.origin):r.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(n["!ref"]){var c=Ho(n["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var d=[],f=0,h=n["!rows"]||(n["!rows"]=[]),p=0,g=0,m=0,v=0,x=0,_=0;for(n["!cols"]||(n["!cols"]=[]);p<o.length&&g<l;++p){var b=o[p];if(XT(b)){if(r.display)continue;h[g]={hidden:!0}}var D=b.children;for(m=v=0;m<D.length;++m){var A=D[m];if(!(r.display&&XT(A))){var w=A.hasAttribute("data-v")?A.getAttribute("data-v"):A.hasAttribute("v")?A.getAttribute("v"):AD(A.innerHTML),T=A.getAttribute("data-z")||A.getAttribute("z");for(f=0;f<d.length;++f){var E=d[f];E.s.c==v+s&&E.s.r<g+i&&g+i<=E.e.r&&(v=E.e.c+1-s,f=-1)}_=+A.getAttribute("colspan")||1,((x=+A.getAttribute("rowspan")||1)>1||_>1)&&d.push({s:{r:g+i,c:v+s},e:{r:g+i+(x||1)-1,c:v+s+(_||1)-1}});var P={t:"s",v:w},N=A.getAttribute("data-t")||A.getAttribute("t")||"";w!=null&&(w.length==0?P.t=N||"z":r.raw||w.trim().length==0||N=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(zr(w))?isNaN(Bo(w).getDate())||(P={t:"d",v:dn(w)},r.cellDates||(P={t:"n",v:Un(P.v)}),P.z=r.dateNF||je[14]):P={t:"n",v:zr(w)})),P.z===void 0&&T!=null&&(P.z=T);var O="",Y=A.getElementsByTagName("A");if(Y&&Y.length)for(var se=0;se<Y.length&&!(Y[se].hasAttribute("href")&&(O=Y[se].getAttribute("href"),O.charAt(0)!="#"));++se);O&&O.charAt(0)!="#"&&(P.l={Target:O}),r.dense?(n[g+i]||(n[g+i]=[]),n[g+i][v+s]=P):n[Be({c:v+s,r:g+i})]=P,u.e.c<v+s&&(u.e.c=v+s),v+=_}}++g}return d.length&&(n["!merges"]=(n["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+i),n["!ref"]=st(u),g>=l&&(n["!fullref"]=st((u.e.r=o.length-p+g-1+i,u))),n}function CI(n,e){var t=e||{},r=t.dense?[]:{};return AI(r,n,e)}function XW(n,e){return Ps(CI(n,e),e)}function XT(n){var e="",t=YW(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function YW(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function KW(n){var e=n.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=lt(e.replace(/<[^>]*>/g,""));return[t]}var YT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function SI(n,e){var t=e||{};Jt!=null&&t.dense==null&&(t.dense=Jt);var r=h1(n),i=[],s,a,o={name:""},l="",u=0,c,d,f={},h=[],p=t.dense?[]:{},g,m,v={value:""},x="",_=0,b,D=[],A=-1,w=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,P={},N=[],O={},Y=0,se=0,ie=[],ge=1,J=1,_e=[],de={Names:[]},ye={},K=["",""],F=[],U={},j="",L=0,Q=!1,oe=!1,ue=0;for(Wc.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Wc.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":g[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?p["!ref"]=st(T):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=T.e.r&&(p["!fullref"]=p["!ref"],T.e.r=t.sheetRows-1,p["!ref"]=st(T)),N.length&&(p["!merges"]=N),ie.length&&(p["!rows"]=ie),c.name=c.\u540D\u79F0||c.name,typeof JSON<"u"&&JSON.stringify(c),h.push(c.name),f[c.name]=p,oe=!1):g[0].charAt(g[0].length-2)!=="/"&&(c=ke(g[0],!1),A=w=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,p=t.dense?[]:{},N=[],ie=[],oe=!0);break;case"table-row-group":g[1]==="/"?--E:++E;break;case"table-row":case"\u884C":if(g[1]==="/"){A+=ge,ge=1;break}if(d=ke(g[0],!1),d.\u884C\u53F7?A=d.\u884C\u53F7-1:A==-1&&(A=0),ge=+d["number-rows-repeated"]||1,ge<10)for(ue=0;ue<ge;++ue)E>0&&(ie[A+ue]={level:E});w=-1;break;case"covered-table-cell":g[1]!=="/"&&++w,t.sheetStubs&&(t.dense?(p[A]||(p[A]=[]),p[A][w]={t:"z"}):p[Be({r:A,c:w})]={t:"z"}),x="",D=[];break;case"table-cell":case"\u6570\u636E":if(g[0].charAt(g[0].length-2)==="/")++w,v=ke(g[0],!1),J=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&t.cellFormula!=!1&&(m.f=$T(lt(v.formula))),(v.\u6570\u636E\u7C7B\u578B||v["value-type"])=="string"&&(m.t="s",m.v=lt(v["string-value"]||""),t.dense?(p[A]||(p[A]=[]),p[A][w]=m):p[Be({r:A,c:w})]=m),w+=J-1;else if(g[1]!=="/"){++w,x="",_=0,D=[],J=1;var me=ge?A+ge-1:A;if(w>T.e.c&&(T.e.c=w),w<T.s.c&&(T.s.c=w),A<T.s.r&&(T.s.r=A),me>T.e.r&&(T.e.r=me),v=ke(g[0],!1),F=[],U={},m={t:v.\u6570\u636E\u7C7B\u578B||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=lt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(Y=parseInt(v["number-matrix-rows-spanned"],10)||0,se=parseInt(v["number-matrix-columns-spanned"],10)||0,O={s:{r:A,c:w},e:{r:A+Y-1,c:w+se-1}},m.F=st(O),_e.push([O,m.F])),v.formula)m.f=$T(v.formula);else for(ue=0;ue<_e.length;++ue)A>=_e[ue][0].s.r&&A<=_e[ue][0].e.r&&w>=_e[ue][0].s.c&&w<=_e[ue][0].e.c&&(m.F=_e[ue][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(Y=parseInt(v["number-rows-spanned"],10)||0,se=parseInt(v["number-columns-spanned"],10)||0,O={s:{r:A,c:w},e:{r:A+Y-1,c:w+se-1}},N.push(O)),v["number-columns-repeated"]&&(J=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Dt(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=dn(v["date-value"]),t.cellDates||(m.t="n",m.v=Un(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=c5(v["time-value"])/86400,t.cellDates&&(m.t="d",m.v=ap(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.\u6570\u636E\u6570\u503C);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(x=lt(v["string-value"]),D=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(Q=!1,m.t==="s"&&(m.v=x||"",D.length&&(m.R=D),Q=_==0),ye.Target&&(m.l=ye),F.length>0&&(m.c=F,F=[]),x&&t.cellText!==!1&&(m.w=x),Q&&(m.t="z",delete m.v),(!Q||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=A))for(var ae=0;ae<ge;++ae){if(J=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(p[A+ae]||(p[A+ae]=[]),p[A+ae][w]=ae==0?m:_n(m);--J>0;)p[A+ae][w+J]=_n(m);else for(p[Be({r:A+ae,c:w})]=m;--J>0;)p[Be({r:A+ae,c:w+J})]=_n(m);T.e.c<=w&&(T.e.c=w)}J=parseInt(v["number-columns-repeated"]||"1",10),w+=J-1,J=0,m={},x="",D=[]}ye={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;U.t=x,D.length&&(U.R=D),U.a=j,F.push(U)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);j="",L=0,x="",_=0,D=[];break;case"creator":g[1]==="/"?j=r.slice(L,g.index):L=g.index+g[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);x="",_=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(P[o.name]=l,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=ke(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ke(g[0],!1),l+=YT[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=ke(g[0],!1),l+=YT[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=r.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":a=ke(g[0],!1),K=Wx(a["cell-range-address"]);var tt={Name:a.name,Ref:K[0]+"!"+K[1]};oe&&(tt.Sheet=h.length),de.Names.push(tt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var R=KW(r.slice(_,g.index),b);x=(x.length>0?x+`
`:"")+R[0]}else b=ke(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{K=Wx(ke(g[0])["target-range-address"]),f[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(ye=ke(g[0],!1),!ye.href)break;ye.Target=lt(ye.href),delete ye.href,ye.Target.charAt(0)=="#"&&ye.Target.indexOf(".")>-1?(K=Wx(ye.Target.slice(1)),ye.Target="#"+K[0]+"!"+K[1]):ye.Target.match(/^\.\.[\\\/]/)&&(ye.Target=ye.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(g)}}var It={Sheets:f,SheetNames:h,Workbook:de};return t.bookSheets&&delete It.Sheets,It}function KT(n,e){e=e||{},br(n,"META-INF/manifest.xml")&&fj(Kt(n,"META-INF/manifest.xml"),e);var t=cr(n,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=SI(wt(t),e);return br(n,"meta.xml")&&(r.Props=VD(Kt(n,"meta.xml"))),r}function QT(n,e){return SI(n,e)}function k1(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function n1(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):wt(Ca(n))}function r1(n){var e=n.reduce(function(i,s){return i+s.length},0),t=new Uint8Array(e),r=0;return n.forEach(function(i){t.set(i,r),r+=i.length}),t}function ZT(n){return n-=n>>1&1431655765,n=(n&858993459)+(n>>2&858993459),(n+(n>>4)&252645135)*16843009>>>24}function QW(n,e){for(var t=(n[e+15]&127)<<7|n[e+14]>>1,r=n[e+14]&1,i=e+13;i>=e;--i)r=r*256+n[i];return(n[e+15]&128?-r:r)*Math.pow(10,t-6176)}function Xc(n,e){var t=e?e[0]:0,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),r}function an(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function Sn(n){for(var e=[],t=[0];t[0]<n.length;){var r=t[0],i=Xc(n,t),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=t[0];n[t[0]++]>=128;);o=n.slice(l,t[0])}break;case 5:a=4,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=Xc(n,t),o=n.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function M1(n,e){return n?.map(function(t){return e(t.data)})||[]}function ZW(n){for(var e,t=[],r=[0];r[0]<n.length;){var i=Xc(n,r),s=Sn(n.slice(r[0],r[0]+i));r[0]+=i;var a={id:an(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Sn(o.data),u=an(l[3][0].data);a.messages.push({meta:l,data:n.slice(r[0],r[0]+u)}),r[0]+=u}),(e=s[3])!=null&&e[0]&&(a.merge=an(s[3][0].data)>>>0>0),t.push(a)}return t}function JW(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],r=Xc(e,t),i=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}i.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(e[t[0]]>>2&7)+4,l=(e[t[0]++]&224)<<3,l|=e[t[0]++]):(u=(e[t[0]++]>>2)+1,s==2?(l=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(l=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),i=[r1(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=r1(i);if(c.length!=r)throw new Error("Unexpected length: ".concat(c.length," != ").concat(r));return c}function ez(n){for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(JW(r,n.slice(t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return r1(e)}function tz(n,e,t,r){var i=k1(n),s=i.getUint32(4,!0),a=(r>1?12:8)+ZT(s&(r>1?3470:398))*4,o=-1,l=-1,u=NaN,c=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=ZT(s&(r>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(c.setTime(c.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var d;switch(n[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:t[o]};else if(l>-1)d={t:"s",v:e[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(n.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(n.slice(0,4)))}return d}function nz(n,e,t){var r=k1(n),i=r.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,c=new Date(2001,0,1);i&1&&(l=QW(n,s),s+=16),i&2&&(u=r.getFloat64(s,!0),s+=8),i&4&&(c.setTime(c.getTime()+r.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=r.getUint32(s,!0),s+=4),i&16&&(a=r.getUint32(s,!0),s+=4);var d;switch(n[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[o]};break;case 5:d={t:"d",v:c};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(i&31," : ").concat(n.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(i&31," : ").concat(n.slice(0,4)))}return d}function rz(n,e,t){switch(n[0]){case 0:case 1:case 2:case 3:return tz(n,e,t,n[0]);case 5:return nz(n,e,t);default:throw new Error("Unsupported payload version ".concat(n[0]))}}function ks(n){var e=Sn(n);return Xc(e[1][0].data)}function JT(n,e){var t=Sn(e.data),r=an(t[1][0].data),i=t[3],s=[];return(i||[]).forEach(function(a){var o=Sn(a.data),l=an(o[1][0].data)>>>0;switch(r){case 1:s[l]=n1(o[3][0].data);break;case 8:{var u=n[ks(o[9][0].data)][0],c=Sn(u.data),d=n[ks(c[1][0].data)][0],f=an(d.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Sn(d.data);s[l]=h[3].map(function(p){return n1(p.data)}).join("")}break}}),s}function iz(n,e){var t,r,i,s,a,o,l,u,c,d,f,h,p,g,m=Sn(n),v=an(m[1][0].data)>>>0,x=an(m[2][0].data)>>>0,_=((r=(t=m[8])==null?void 0:t[0])==null?void 0:r.data)&&an(m[8][0].data)>0||!1,b,D;if((s=(i=m[7])==null?void 0:i[0])!=null&&s.data&&e!=0)b=(o=(a=m[7])==null?void 0:a[0])==null?void 0:o.data,D=(u=(l=m[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(c=m[4])==null?void 0:c[0])!=null&&d.data&&e!=1)b=(h=(f=m[4])==null?void 0:f[0])==null?void 0:h.data,D=(g=(p=m[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var A=_?4:1,w=k1(b),T=[],E=0;E<b.length/2;++E){var P=w.getUint16(E*2,!0);P<65535&&T.push([E,P])}if(T.length!=x)throw"Expected ".concat(x," cells, found ").concat(T.length);var N=[];for(E=0;E<T.length-1;++E)N[T[E][0]]=D.subarray(T[E][1]*A,T[E+1][1]*A);return T.length>=1&&(N[T[T.length-1][0]]=D.subarray(T[T.length-1][1]*A)),{R:v,cells:N}}function sz(n,e){var t,r=Sn(e.data),i=(t=r?.[7])!=null&&t[0]?an(r[7][0].data)>>>0>0?1:0:-1,s=M1(r[5],function(a){return iz(a,i)});return{nrows:an(r[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function az(n,e,t){var r,i=Sn(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(an(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(an(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=st(s);var a=Sn(i[4][0].data),o=JT(n,n[ks(a[4][0].data)][0]),l=(r=a[17])!=null&&r[0]?JT(n,n[ks(a[17][0].data)][0]):[],u=Sn(a[3][0].data),c=0;u[1].forEach(function(d){var f=Sn(d.data),h=n[ks(f[2][0].data)][0],p=an(h.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=sz(n,h);g.data.forEach(function(m,v){m.forEach(function(x,_){var b=Be({r:c+v,c:_}),D=rz(x,o,l);D&&(t[b]=D)})}),c+=g.nrows})}function oz(n,e){var t=Sn(e.data),r={"!ref":"A1"},i=n[ks(t[2][0].data)],s=an(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return az(n,i[0],r),r}function lz(n,e){var t,r=Sn(e.data),i={name:(t=r[1])!=null&&t[0]?n1(r[1][0].data):"",sheets:[]},s=M1(r[2],ks);return s.forEach(function(a){n[a].forEach(function(o){var l=an(o.meta[1][0].data);l==6e3&&i.sheets.push(oz(n,o))})}),i}function cz(n,e){var t=R1(),r=Sn(e.data),i=M1(r[1],ks);if(i.forEach(function(s){n[s].forEach(function(a){var o=an(a.meta[1][0].data);if(o==2){var l=lz(n,a);l.sheets.forEach(function(u,c){N1(t,u,c==0?l.name:l.name+"_"+c,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Gx(n){var e,t,r,i,s={},a=[];if(n.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),n.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=ez(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var c;try{c=ZW(u)}catch(d){return console.log("## "+(d.message||d))}c.forEach(function(d){s[d.id]=d.messages,a.push(d.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(r=(t=(e=s?.[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&an(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var c=an(u.meta[1][0].data)>>>0;if(c==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return cz(s,o)}function uz(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function F1(n){uz([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(n)}function dz(n){return Xi.WS.indexOf(n)>-1?"sheet":Xi.CS&&n==Xi.CS?"chart":Xi.DS&&n==Xi.DS?"dialog":Xi.MS&&n==Xi.MS?"macro":n&&n.length?n:"sheet"}function fz(n,e){if(!n)return 0;try{n=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,n["!id"][r.id].Target,dz(n["!id"][r.id].Type)]})}catch{return null}return!n||n.length===0?null:n}function hz(n,e,t,r,i,s,a,o,l,u,c,d){try{s[r]=Oc(cr(n,t,!0),e);var f=Kt(n,e),h;switch(o){case"sheet":h=xW(f,e,i,l,s[r],u,c,d);break;case"chart":if(h=yW(f,e,i,l,s[r],u,c,d),!h||!h["!drawel"])break;var p=Mc(h["!drawel"].Target,e),g=Qx(p),m=_9(cr(n,p,!0),Oc(cr(n,g,!0),p)),v=Mc(m,p),x=Qx(v);h=nW(cr(n,v,!0),v,l,Oc(cr(n,x,!0),v),u,h);break;case"macro":h=wW(f,e,i,l,s[r],u,c,d);break;case"dialog":h=bW(f,e,i,l,s[r],u,c,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[r]=h;var _=[];s&&s[r]&&vi(s[r]).forEach(function(b){var D="";if(s[r][b].Type==Xi.CMNT){D=Mc(s[r][b].Target,e);var A=SW(Kt(n,D,!0),D,l);if(!A||!A.length)return;BT(h,A,!1)}s[r][b].Type==Xi.TCMNT&&(D=Mc(s[r][b].Target,e),_=_.concat(y9(Kt(n,D,!0),l)))}),_&&_.length&&BT(h,_,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function yr(n){return n.charAt(0)=="/"?n.slice(1):n}function pz(n,e){if(pD(),e=e||{},F1(e),br(n,"META-INF/manifest.xml")||br(n,"objectdata.xml"))return KT(n,e);if(br(n,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gx<"u"){if(n.FileIndex)return Gx(n);var t=it.utils.cfb_new();return dT(n).forEach(function(se){p5(t,se,yD(n,se))}),Gx(t)}throw new Error("Unsupported NUMBERS file")}if(!br(n,"[Content_Types].xml"))throw br(n,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):br(n,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=dT(n),i=uj(cr(n,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Kt(n,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Kt(n,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(Vc=[],i.sst)try{Vc=CW(Kt(n,yr(i.sst)),i.sst,e)}catch(se){if(e.WTF)throw se}e.cellStyles&&i.themes.length&&(l=AW(cr(n,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(u=EW(Kt(n,yr(i.style)),i.style,l,e))}i.links.map(function(se){try{var ie=Oc(cr(n,Qx(yr(se))),se);return DW(Kt(n,yr(se)),ie,se,e)}catch{}});var c=_W(Kt(n,yr(i.workbooks[0])),i.workbooks[0],e),d={},f="";i.coreprops.length&&(f=Kt(n,yr(i.coreprops[0]),!0),f&&(d=VD(f)),i.extprops.length!==0&&(f=Kt(n,yr(i.extprops[0]),!0),f&&gj(f,d,e)));var h={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(f=cr(n,yr(i.custprops[0]),!0),f&&(h=vj(f,e)));var p={};if((e.bookSheets||e.bookProps)&&(c.Sheets?a=c.Sheets.map(function(ie){return ie.name}):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),e.bookProps&&(p.Props=d,p.Custprops=h),e.bookSheets&&typeof a<"u"&&(p.SheetNames=a),e.bookSheets?p.SheetNames:e.bookProps))return p;a={};var g={};e.bookDeps&&i.calcchain&&(g=TW(Kt(n,yr(i.calcchain)),i.calcchain,e));var m=0,v={},x,_;{var b=c.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var D=0;D!=b.length;++D)d.SheetNames[D]=b[D].name}var A=s?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),T=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");br(n,T)||(T="xl/_rels/workbook."+A+".rels");var E=Oc(cr(n,T,!0),T.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=IW(Kt(n,yr(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=w9(Kt(n,yr(i.people[0])),e)),E&&(E=fz(E,c.Sheets));var P=Kt(n,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=d.Worksheets;++m){var N="sheet";if(E&&E[m]?(x="xl/"+E[m][1].replace(/[\/]?xl\//,""),br(n,x)||(x=E[m][1]),br(n,x)||(x=T.replace(/_rels\/.*$/,"")+E[m][1]),N=E[m][2]):(x="xl/worksheets/sheet"+(m+1-P)+"."+A,x=x.replace(/sheet0\./,"sheet.")),_=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(m!=e.sheets)continue e;break;case"string":if(d.SheetNames[m].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,Y=0;Y!=e.sheets.length;++Y)typeof e.sheets[Y]=="number"&&e.sheets[Y]==m&&(O=1),typeof e.sheets[Y]=="string"&&e.sheets[Y].toLowerCase()==d.SheetNames[m].toLowerCase()&&(O=1);if(!O)continue e}}hz(n,x,_,d.SheetNames[m],m,v,a,N,e,c,l,u)}return p={Directory:i,Workbook:c,Props:d,Custprops:h,Deps:g,Sheets:a,SheetNames:d.SheetNames,Strings:Vc,Styles:u,Themes:l,SSF:_n(je)},e&&e.bookFiles&&(n.files?(p.keys=r,p.files=n.files):(p.keys=[],p.files={},n.FullPaths.forEach(function(se,ie){se=se.replace(/^Root Entry[\/]/,""),p.keys.push(se),p.files[se]=n.FileIndex[ie]}))),e&&e.bookVBA&&(i.vba.length>0?p.vbaraw=Kt(n,yr(i.vba[0]),!0):i.defaults&&i.defaults.bin===C9&&(p.vbaraw=Kt(n,"xl/vbaProject.bin",!0))),p}function gz(n,e){var t=e||{},r="Workbook",i=it.find(n,r);try{if(r="/!DataSpaces/Version",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(oH(i.content),r="/!DataSpaces/DataSpaceMap",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=cH(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=uH(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);fH(i.content)}catch{}if(r="/EncryptionInfo",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=hH(i.content);if(r="/EncryptedPackage",i=it.find(n,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function P1(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=ur(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function mz(n,e){return it.find(n,"EncryptedPackage")?gz(n,e):EI(n,e)}function vz(n,e){var t,r=n,i=e||{};return i.type||(i.type=et&&Buffer.isBuffer(n)?"buffer":"base64"),t=wD(r,i),pz(t,i)}function TI(n,e){var t=0;e:for(;t<n.length;)switch(n.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return e1(n.slice(t),e);default:break e}return zc.to_workbook(n,e)}function _z(n,e){var t="",r=P1(n,e);switch(e.type){case"base64":t=ur(n);break;case"binary":t=n;break;case"buffer":t=n.toString("binary");break;case"array":t=ba(n);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=wt(t)),e.type="binary",TI(t,e)}function xz(n,e){var t=n;return e.type=="base64"&&(t=ur(t)),t=ht.utils.decode(1200,t.slice(2),"str"),e.type="binary",TI(t,e)}function yz(n){return n.match(/[^\x00-\x7F]/)?Fc(n):n}function qx(n,e,t,r){return r?(t.type="string",zc.to_workbook(n,t)):zc.to_workbook(e,t)}function sp(n,e){nD();var t=e||{};if(typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer)return sp(new Uint8Array(n),(t=_n(t),t.type="array",t));typeof Uint8Array<"u"&&n instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=n,i=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Oo={},t.dateNF&&(Oo.dateNF=t.dateNF),t.type||(t.type=et&&Buffer.isBuffer(n)?"buffer":"base64"),t.type=="file"&&(t.type=et?"buffer":"binary",r=o5(n),typeof Uint8Array<"u"&&!et&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,r=yz(n)),t.type=="array"&&typeof Uint8Array<"u"&&n instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=_n(t),t.type="array",sp(o1(r),t)}switch((i=P1(r,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return mz(it.read(r,t),t);break;case 9:if(i[1]<=8)return EI(r,t);break;case 60:return e1(r,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return XU(r,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return GU.to_workbook(r,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?vz(r,t):qx(n,r,t,s);case 239:return i[3]===60?e1(r,t):qx(n,r,t,s);case 255:if(i[1]===254)return xz(r,t);if(i[1]===0&&i[2]===2&&i[3]===0)return Bc.to_workbook(r,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Bc.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return LT.to_workbook(r,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return CH.to_workbook(r,t);break;case 10:case 13:case 32:return _z(r,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return WU.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?LT.to_workbook(r,t):qx(n,r,t,s)}function wz(n,e,t,r,i,s,a,o){var l=xn(t),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:t,enumerable:!1})}catch{f.__rowNum__=t}else f.__rowNum__=t;if(!a||n[t])for(var h=e.s.c;h<=e.e.c;++h){var p=a?n[t][h]:n[r[h]+l];if(p===void 0||p.t===void 0){if(u===void 0)continue;s[h]!=null&&(f[s[h]]=u);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[h]!=null){if(g==null)if(p.t=="e"&&g===null)f[s[h]]=null;else if(u!==void 0)f[s[h]]=u;else if(c&&g===null)f[s[h]]=null;else continue;else f[s[h]]=c&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?g:Zi(p,g,o);g!=null&&(d=!1)}}return{row:f,isempty:d}}function i1(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},c=u.range!=null?u.range:n["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof c){case"string":l=Lt(c);break;case"number":l=Lt(n["!ref"]),l.s.r=c;break;default:l=c}r>0&&(i=0);var d=xn(l.s.r),f=[],h=[],p=0,g=0,m=Array.isArray(n),v=l.s.r,x=0,_={};m&&!n[v]&&(n[v]=[]);var b=u.skipHidden&&n["!cols"]||[],D=u.skipHidden&&n["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(b[x]||{}).hidden)switch(f[x]=sn(x),t=m?n[v][x]:n[f[x]+d],r){case 1:s[x]=x-l.s.c;break;case 2:s[x]=f[x];break;case 3:s[x]=u.header[x-l.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=Zi(t,null,u),g=_[a]||0,!g)_[a]=1;else{do o=a+"_"+g++;while(_[o]);_[a]=g,_[o]=1}s[x]=o}for(v=l.s.r+i;v<=l.e.r;++v)if(!(D[v]||{}).hidden){var A=wz(n,l,v,f,r,s,m,u);(A.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(h[p++]=A.row)}return h.length=p,h}var eD=/"/g;function bz(n,e,t,r,i,s,a,o){for(var l=!0,u=[],c="",d=xn(t),f=e.s.c;f<=e.e.c;++f)if(r[f]){var h=o.dense?(n[t]||[])[f]:n[r[f]+d];if(h==null)c="";else if(h.v!=null){l=!1,c=""+(o.rawNumbers&&h.t=="n"?h.v:Zi(h,null,o));for(var p=0,g=0;p!==c.length;++p)if((g=c.charCodeAt(p))===i||g===s||g===34||o.forceQuotes){c='"'+c.replace(eD,'""')+'"';break}c=="ID"&&(c='"ID"')}else h.f!=null&&!h.F?(l=!1,c="="+h.f,c.indexOf(",")>=0&&(c='"'+c.replace(eD,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(a)}function DI(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";var i=Lt(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",d=[];r.dense=Array.isArray(n);for(var f=r.skipHidden&&n["!cols"]||[],h=r.skipHidden&&n["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(f[p]||{}).hidden||(d[p]=sn(p));for(var g=0,m=i.s.r;m<=i.e.r;++m)(h[m]||{}).hidden||(c=bz(n,i,m,d,a,l,s,r),c!=null&&(r.strip&&(c=c.replace(u,"")),(c||r.blankrows!==!1)&&t.push((g++?o:"")+c)));return delete r.dense,t.join("")}function Ez(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=DI(n,e);if(typeof ht>"u"||e.type=="string")return t;var r=ht.utils.encode(1200,t,"str");return"\xFF\xFE"+r}function Az(n){var e="",t,r="";if(n==null||n["!ref"]==null)return[];var i=Lt(n["!ref"]),s="",a=[],o,l=[],u=Array.isArray(n);for(o=i.s.c;o<=i.e.c;++o)a[o]=sn(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=xn(c),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,t=u?(n[c]||[])[o]:n[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}l[l.length]=e+"="+r}return l}function II(n,e,t){var r=t||{},i=+!r.skipHeader,s=n||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?jn(r.origin):r.origin;a=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var d=Lt(s["!ref"]);c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),a==-1&&(a=d.e.r+1,c.e.r=a+e.length-1+i)}else a==-1&&(a=0,c.e.r=e.length-1+i);var f=r.header||[],h=0;e.forEach(function(g,m){vi(g).forEach(function(v){(h=f.indexOf(v))==-1&&(f[h=f.length]=v);var x=g[v],_="z",b="",D=Be({c:o+h,r:a+m+i});u=Yc(s,D),x&&typeof x=="object"&&!(x instanceof Date)?s[D]=x:(typeof x=="number"?_="n":typeof x=="boolean"?_="b":typeof x=="string"?_="s":x instanceof Date?(_="d",r.cellDates||(_="n",x=Un(x)),b=r.dateNF||je[14]):x===null&&r.nullError&&(_="e",x=0),u?(u.t=_,u.v=x,delete u.w,delete u.R,b&&(u.z=b)):s[D]=u={t:_,v:x},b&&(u.z=b))})}),c.e.c=Math.max(c.e.c,o+f.length-1);var p=xn(a);if(i)for(h=0;h<f.length;++h)s[sn(h+o)+p]={t:"s",v:f[h]};return s["!ref"]=st(c),s}function Cz(n,e){return II(null,n,e)}function Yc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var r=jn(e);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Yc(n,Be(e)):Yc(n,Be({r:e,c:t||0}))}function Sz(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function R1(){return{SheetNames:[],Sheets:{}}}function N1(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=a+i)!=-1;++i);}if(uW(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function Tz(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=Sz(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function Dz(n,e){return n.z=e,n}function kI(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function Iz(n,e,t){return kI(n,"#"+e,t)}function kz(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function Mz(n,e,t,r){for(var i=typeof e!="string"?e:Lt(e),s=typeof e=="string"?e:st(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Yc(n,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=t,r&&(l.D=!0))}return n}var MI={encode_col:sn,encode_row:xn,encode_cell:Be,encode_range:st,decode_col:y1,decode_row:x1,split_cell:$5,decode_cell:jn,decode_range:Ho,format_cell:Zi,sheet_add_aoa:RD,sheet_add_json:II,sheet_add_dom:AI,aoa_to_sheet:$o,json_to_sheet:Cz,table_to_sheet:CI,table_to_book:XW,sheet_to_csv:DI,sheet_to_txt:Ez,sheet_to_json:i1,sheet_to_html:qW,sheet_to_formulae:Az,sheet_to_row_object_array:i1,sheet_get_cell:Yc,book_new:R1,book_append_sheet:N1,book_set_sheet_visibility:Tz,cell_set_number_format:Dz,cell_set_hyperlink:kI,cell_set_internal_link:Iz,cell_add_comment:kz,sheet_set_array_formula:Mz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var Zee=tD.version;var Pz=(n,e)=>({"table-primary":n,"table-secondary":e});function Rz(n,e){if(n&1&&re(0,"th",9),n&2){let t=e.$implicit,r=ot(2);Z("innerHTML",r.formatHeader(t,25),$b)}}function Nz(n,e){if(n&1&&(B(0,"span",16),q(1),V()),n&2){let t=ot().$implicit;ne(),Tt(t)}}function Oz(n,e){if(n&1&&(B(0,"span",17),q(1),V()),n&2){let t=ot().$implicit;ne(),Tt(t)}}function Lz(n,e){if(n&1&&(B(0,"span",16),q(1),V()),n&2){let t=ot().$implicit;ne(),Tt(t)}}function Bz(n,e){if(n&1&&(B(0,"span"),q(1),yl(2,"currency"),V()),n&2){let t=ot().$implicit,r=ot(3);vl("color",r.getColor(t)),ne(),Tt(wl(2,3,t,"USD","symbol","1.2-2"))}}function Vz(n,e){if(n&1&&(B(0,"span"),q(1),yl(2,"currency"),V()),n&2){let t=ot().$implicit,r=ot(3);vl("color",r.getColor(t)),ne(),Tt(wl(2,3,t,"EUR","symbol","1.2-2"))}}function jz(n,e){if(n&1&&(B(0,"span",18),q(1),yl(2,"currency"),V()),n&2){let t=ot().$implicit;ne(),Tt(wl(2,1,t,"USD","symbol","1.2-2"))}}function Uz(n,e){if(n&1&&(B(0,"span",18),q(1),yl(2,"currency"),V()),n&2){let t=ot().$implicit;ne(),Tt(wl(2,1,t,"EUR","symbol","1.2-2"))}}function Hz(n,e){if(n&1&&(B(0,"td"),zt(1,Nz,2,1,"span",12)(2,Oz,2,1,"span",13)(3,Lz,2,1,"span",12)(4,Bz,3,8,"span",14)(5,Vz,3,8,"span",14)(6,jz,3,6,"span",15)(7,Uz,3,6,"span",15),V()),n&2){let t=e.index,r=ot().$implicit;ne(),Z("ngIf",t<=2&&r[0]===null),ne(),Z("ngIf",t<=2&&r[0]!==null),ne(),Z("ngIf",t>=2&&r[0]===null),ne(),Z("ngIf",t>2&&r[1]==="$"),ne(),Z("ngIf",t>2&&r[1]==="\u20AC"),ne(),Z("ngIf",t>2&&r[0]==="TOTAL (Dollar)"),ne(),Z("ngIf",t>2&&r[0]==="TOTAL (Euro)")}}function $z(n,e){if(n&1&&(B(0,"tr",10),zt(1,Hz,8,7,"td",11),V()),n&2){let t=e.$implicit,r=e.index;Z("ngClass",RE(2,Pz,r%2===0,r%2!==0)),ne(),Z("ngForOf",t)}}function Wz(n,e){if(n&1&&(B(0,"div",2)(1,"div",3)(2,"table",4)(3,"caption",5),q(4,"Contribution des membres"),V(),B(5,"thead",6)(6,"tr"),zt(7,Rz,1,1,"th",7),V()(),B(8,"tbody"),zt(9,$z,2,5,"tr",8),V()()()()),n&2){let t=ot();ne(7),Z("ngForOf",t.excelData[0]),ne(2),Z("ngForOf",t.excelData.slice(1))}}function zz(n,e){n&1&&(B(0,"div",2)(1,"div",19)(2,"div",20)(3,"span",21),q(4,"Loading..."),V()(),q(5," Loading Excel data... "),V()())}var FI=(()=>{class n{constructor(){this.excelData=[]}ngOnInit(){this.loadExcelFile()}loadExcelFile(){fetch("assets/Excells/CotisationSpeciale2.xlsx").then(r=>r.arrayBuffer()).then(r=>{let i=sp(r,{type:"array"}),s=i.SheetNames[0],a=i.Sheets[s];this.excelData=MI.sheet_to_json(a,{header:1})}).catch(r=>{console.error("Error reading the Excel file:",r)})}isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}getColor(t){return this.isNumeric(t)&&parseFloat(t)<=0?"red":"black"}formatHeader(t,r){return t.length<=r?t:t.slice(0,r)+"<br>"+t.slice(r)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-finance"]],standalone:!0,features:[Ve],decls:3,vars:2,consts:[[2,"margin-top","15px","margin-bottom","55px"],["class","container mt-5",4,"ngIf"],[1,"container","mt-5"],[1,"table-responsive",2,"max-height","1000px","overflow-y","auto"],[1,"table","table-bordered","table-hover","caption-top"],[1,"fs-2"],[1,"table-light"],[3,"innerHTML",4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"innerHTML"],[3,"ngClass"],[4,"ngFor","ngForOf"],["style","font-size: 0;",4,"ngIf"],["style","text-align: center;",4,"ngIf"],[3,"color",4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[2,"font-size","0"],[2,"text-align","center"],[2,"font-weight","bold"],["role","alert",1,"alert","alert-warning"],["role","status",1,"spinner-border","text-warning","me-2"],[1,"visually-hidden"]],template:function(r,i){r&1&&(B(0,"div",0),zt(1,Wz,10,2,"div",1)(2,zz,6,0,"div",1),V()),r&2&&(ne(),Z("ngIf",i.excelData.length>0),ne(),Z("ngIf",i.excelData.length===0))},dependencies:[On,nA,uo,mr,iA]})}}return n})();var PI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/DeclarationDintention2.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-decl-intention"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var RI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/viabilite.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-viabilite"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var NI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/Fonctionnement2.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-fonctionnement"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var OI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/ActNotarisation.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-act-of-notary"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var O1=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/VueEnPlanDeLaMorgue.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-vue-en-plan"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var LI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/FICHE_DE_PROJET1.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-fiche-de-project"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var BI=(()=>{class n{constructor(){this.pdfSrc="assets/pdfs/PLANSTRATEGIQUE25_29.pdf"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Oe({type:n,selectors:[["app-plan-strategique"]],standalone:!0,features:[Ve],decls:1,vars:3,consts:[[2,"display","block","width","100vw","height","100vh",3,"src","show-borders","fit-to-page"]],template:function(r,i){r&1&&re(0,"pdf-viewer",0),r&2&&Z("src",i.pdfSrc)("show-borders",!0)("fit-to-page",!0)},dependencies:[Xt,qt]})}}return n})();var VI=[{path:"",component:Cf},{path:"Accueil",component:Cf},{path:"LesDirigeants",component:hf},{path:"TousLesMembres",component:ff},{path:"Contact",component:QS},{path:"Finance",component:FI},{path:"N\xE9crologie",component:BC},{path:"Ndaya/:videoId",component:Ee},{path:"Mukungu/:videoId",component:Ee},{path:"PesaPosition/:videoId",component:Ee},{path:"BonSamaritain/:videoId",component:Ee},{path:"Monzo/:videoId",component:Ee},{path:"JamaisKolonga/:videoId",component:Ee},{path:"KaribouYaBintou/:videoId",component:Ee},{path:"TokomaBaCamarade/:videoId",component:Ee},{path:"Ngobila/:videoId",component:Ee},{path:"Jesus3/:videoId",component:Ee},{path:"Kelya/:videoId",component:Ee},{path:"Mikolo/:videoId",component:Ee},{path:"BonbonSucr\xE9/:videoId",component:Ee},{path:"NzotoMoko/:videoId",component:Ee},{path:"Z\xE9roFaute/:videoId",component:Ee},{path:"PointFinal/:videoId",component:Ee},{path:"Coucou/:videoId",component:Ee},{path:"EbaleYaZaire/:videoId",component:Ee},{path:"Maya/:videoId",component:Ee},{path:"MayaVersion2/:videoId",component:Ee},{path:"Ngungi/:videoId",component:Ee},{path:"Djino/:videoId",component:Ee},{path:"CarelessWhisper/:videoId",component:Ee},{path:"WhenIseeYouAngain/:videoId",component:Ee},{path:"ASummerPlace/:videoId",component:Ee},{path:"Kinshasa/:videoId",component:Ee},{path:"LaVieEnRose/:videoId",component:Ee},{path:"Carnavale/:videoId",component:Ee},{path:"LikeALady/:videoId",component:Ee},{path:"WhatToKnow/:videoId",component:Ee},{path:"CoastLine/:videoId",component:Ee},{path:"PrendSoinDelle/:videoId",component:Ee},{path:"Fideles/:videoId",component:Ee},{path:"Shiver/:videoId",component:Ee},{path:"OurDream/:videoId",component:Ee},{path:"SummerInCity/:videoId",component:Ee},{path:"VousLesFemmes/:videoId",component:Ee},{path:"RockYourBaby/:videoId",component:Ee},{path:"KissOfLife/:videoId",component:Ee},{path:"AinTNobody/:videoId",component:Ee},{path:"Holiday/:videoId",component:Ee},{path:"Fresh/:videoId",component:Ee},{path:"TheFinest/:videoId",component:Ee},{path:"SaturdayLove/:videoId",component:Ee},{path:"Accident/:videoId",component:Ee},{path:"Centi\xE8meDossier/:videoId",component:Ee},{path:"Orgasy/:videoId",component:Ee},{path:"Koukoulou/:videoId",component:Ee},{path:"Ikea/:videoId",component:Ee},{path:"Nzale/:videoId",component:Ee},{path:"Longo/:videoId",component:Ee},{path:"LembaLemba/:videoId",component:Ee},{path:"AdiosTete/:videoId",component:Ee},{path:"Constantation/:videoId",component:Ee},{path:"Mabele/:videoId",component:Ee},{path:"Matoba/:videoId",component:Ee},{path:"Souvenir3/:videoId",component:Ee},{path:"FauteYaCommer\xE7ant/:videoId",component:Ee},{path:"Deliya/:videoId",component:Ee},{path:"Messages",component:XS},{path:"ROI",component:YS},{path:"Status",component:KS},{path:"Intention",component:PI},{path:"Viabilite",component:RI},{path:"Fonctionnement",component:NI},{path:"Notarie",component:OI},{path:"vueEnPlan",component:O1},{path:"FicheDeProject1",component:LI},{path:"PlanStrategique",component:BI},{path:"morgue",component:O1},{path:"**",component:Cf}];hA(OC,{providers:[rC(VI),{provide:Nr,useClass:$d}]}).catch(n=>console.error(n));
